2004-09-20  Andreas Krebbel  <krebbel1@de.ibm.com>

	* config/s390/s390.c (s390_frame_info): Added alignment statement for
	floating point register area on stack.

2004-09-20  Jakub Jelinek  <jakub@redhat.com>

	* predict.c (expr_expected_value): Use *_CLASS_P macros.

2004-09-20  Daniel Berlin  <dberlin@dberlin.org>

	* tree-ssa-pre.c (compute_antic_aux): Use malloc'd worklist, to avoid 
	generating useless garbage.

2004-09-20  Paolo Bonzini  <bonzini@gnu.org>

	* builtins.c (fold_builtin): Call the new omonymous
	target hook for machine-dependent built-ins.
	* target-def.h (TARGET_FOLD_BUILTIN): New.
	* target.h (struct gcc_target): Add the fold_builtin hook.
	* targhooks.c (default_fold_builtin): New.
	* targhooks.h (default_fold_builtin): Declare it.

2004-09-20  Kazu Hirata  <kazu@cs.umass.edu>

	* cfg.c, tree-ssa-threadupdate.c, tree-vectorizer.c: Fix
	comment typos.

2004-09-20  Richard Sandiford  <rsandifo@redhat.com>

	PR target/17565
	* config/mips/mips.md (define_asm_attributes): Set can_delay to no.

2004-09-20  Jan Hubicka  <jh@suse.cz>

	* predict.c (estimate_probability): Remove unnecesary code.

2004-09-19  Ira Rosen  <irar@il.ibm.com>

	* tree-vectorizer.h (stmt_vec_info): Add vect_dr_base field.
	(STMT_VINFO_VECT_DR_BASE): Declare.
	(VECT_SMODULO): Declare.
	* tree-vectorizer.c (vect_compute_array_ref_alignment): New function.
	(vect_compute_array_base_alignment): New function.
	(vect_analyze_data_ref_access): Check array indices. Remove one
	dimensional arrays restriction.
	(vect_get_ptr_offset): New function.
	(vect_get_symbl_and_dr): New function.
	(vect_get_base_and_bit_offset): Support additional data refs. Renamed
	(former name vect_get_base_decl_and_bit_offset).
	(vect_create_index_for_array_ref): Removed.
	(vect_create_index_for_vector_ref): New function.
	(vect_create_addr_base_for_vector_ref): New function.
	(vect_create_data_ref): Handle additional data refs. Call
	vect_create_index_for_vector_ref and vect_create_addr_base_for_vector_ref.
	(vect_compute_data_ref_alignment): Support the changes. Call
	vect_get_base_and_bit_offset.
	(vect_analyze_data_refs): Call vect_get_symbl_and_dr. Support additional
	data refs. Store vect_dr_base.
	(vect_analyze_data_ref_accesses): Support nonconstant init.
	(new_stmt_vec_info): Initialize vect_dr_base field.
	(vect_is_simple_iv_evolution): Call initial_condition_in_loop_num.
	(get_vectype_for_scalar_type): Check for BLKmode.
	* tree-chrec.h (initial_condition_in_loop_num): Declare.
	* tree-chrec.c (initial_condition_in_loop_num): New function.
	(chrec_component_in_loop_num): New function.
	(evolution_part_in_loop_num): Call chrec_component_in_loop_num.
	* tree-data-ref.c (analyze_array_indexes): Change parameter (access_fns)
	to be pointer to varray_type.

2004-09-19  Jan Hubicka  <jh@suse.cz>

	* basic-block.h (update_bb_profile_after_threading): Declare.
	* cfg.c (update_bb_profile_after_threading): Break out from ...
	* cfgcleanup.c (try_forward_edges): ... here; use it.
	* tree-ssa-dom.c (thread_across_edge): Use it.
	* tree-ssa-threadupdate.c (create_block_for_threading): Zero out
	profile of the new BB.

2004-09-19  Daniel Berlin  <dberlin@dberlin.org>

	* tree-ssa-pre.c (insert_into_set): Don't put
	is_gimple_min_invariant values into the set.

2004-09-19  Andreas Jaeger  <aj@suse.de>

	* tree-ssa-dom.c (restore_nonzero_vars_to_original_value): Fix
	prototype.

2004-09-18  Kazu Hirata  <kazu@cs.umass.edu>

	* config/cris/cris.h: Preserve the original spelling in a
	quote.

2004-09-18 Jeff Law  <law@redhat.com>

	* tree-ssa-dom.c (nonzero_vars_stack, vrp_variables_stack): New
	global varrays to replace the block local varrays.
	(struct dom_walk_block_data): Remove, no longer used.
	(get_eq_expr_value): No longer need to pass around pointers to local
	varrays.  Callers updated.  Unused markers added to unused parameters.
	(record_range, record_equivalences_from_stmt): Likewise.
	(record_equivalences_from_incoming_edge): Likewise.
	(record_var_is_nonzero): Likewise.  Update now that we have a
	single global varray of SSA_NAMEs that need restoring.
	(dom_opt_initialize_block_local_data): Kill, no longer used.
	(tree_ssa_dominator_optimize): Initialize new global varrays.
	Update callbacks in dominator walker structure.
	(dom_opt_initialize_block): Add markers to NONZERO_VAR_STACK and
	VRP_VARIABLES_STACK.
	(restore_nonzero_vars_to_original_value): Update now that we have
	a single global varray of SSA_NAMEs that need restoring.
	(dom_opt_finalize_block): Similarly for VRP_VARIABLES_STACK.
	Remove unused variables.
	(optimize_stmt): Remove unused variable.

2004-09-18  Jan Hubicka  <jh@suse.cz>

	* tree-cfg.c (thread_jumps):  Fix updating of the profile.

	* tree-optimize.c (tree_rest_of_compilation): Kill forgotten
	verify_cgraph call.

2004-09-18  Kazu Hirata  <kazu@cs.umass.edu>

	* alias.c, crtstuff.c, dbxout.c, domwalk.c, domwalk.h, gcc.c,
	gcse.c, global.c, lambda-code.c, loop.c, mips-tdump.c,
	optabs.h, predict.c, reg-stack.c, regclass.c, sched-rgn.c,
	tree-optimize.c, tree-ssa-dom.c, tree-ssa-forwprop.c,
	tree-ssa-operands.c, tree-ssa-phiopt.c,
	tree-ssa-threadupdate.c: Fix comment typos.

2004-09-18  Kazu Hirata  <kazu@cs.umass.edu>

	* config/darwin-c.c, config/arc/arc.c, config/arc/arc.md,
	config/arm/README-interworking, config/arm/arm-cores.def,
	config/arm/arm.c, config/arm/arm.h, config/arm/pe.c,
	config/arm/vfp.md, config/c4x/c4x.c, config/c4x/c4x.h,
	config/cris/cris.c, config/cris/cris.h, config/fr30/fr30.c,
	config/fr30/fr30.h, config/fr30/fr30.md, config/frv/frv.c,
	config/frv/frv.md, config/i386/winnt.c,
	config/ia64/unwind-ia64.c, config/iq2000/iq2000.c,
	config/iq2000/iq2000.h, config/m68hc11/m68hc11.c,
	config/m68hc11/m68hc11.md, config/m68k/m68k.c,
	config/mcore/mcore.c, config/mips/mips.h,
	config/mn10300/mn10300.md, config/pa/pa.c,
	config/pa/pa64-regs.h, config/pdp11/pdp11.c,
	config/rs6000/rs6000.c, config/sh/symbian.c,
	config/sparc/sparc.h: Fix comment typos.  Follow spelling
	conventions.

2004-09-18  Joseph S. Myers  <jsm@polyomino.org.uk>

	PR c/17424
	* c-typeck.c (c_expr_sizeof_expr): Check for error_mark_node.

2004-09-18  Diego Novillo  <dnovillo@redhat.com>

	* tree-ssa-alias.c (setup_pointers_and_addressables): Don't
	remove TREE_ADDRESSABLE from RESULT_DECL.

2004-09-18  Diego Novillo  <dnovillo@redhat.com>

	* tree-ssa-alias.c (dump_alias_info): Ignore NULL SSA_NAMEs.

2004-09-18  Jan Hubicka  <jh@suse.cz>

	* tree-into-ssa.c (rewrite_ssa_into_ssa):  Expect ssa_name to return
	NULL.
	* tree-ssa-alias.c (init_alias_info): Likewise.
	* tree-ssa.c (verify_flow_sensitive_alias_info): Likewise.
	(verify_ssa): Likewise.
	* tree-ssanames.c (make_ssa_name): Clear out ssa_names arrays.

2004-09-18  Jan Hubicka  <jh@suse.cz>

	* i386.c (legitimize_pic_address): Fix splitting of PLUS with
	huge offset.

2004-09-18  Kaz Kojima  <kkojima@gcc.gnu.org>

	* config/sh/linux.h (ASM_PREFERRED_EH_DATA_FORMAT): Remove.
	* config/sh/sh.h (ASM_PREFERRED_EH_DATA_FORMAT): Use
	DW_EH_PE_sdata* for data.
	(ASM_MAYBE_OUTPUT_ENCODED_ADDR_RTX): Likewise.

2004-09-17  Geoffrey Keating  <geoffk@apple.com>

	* tree-inline.c (copy_tree_r): Don't duplicate constants, they're
	shared anyway.

	PR pch/13361
	* c-typeck.c (constructor_asmspec): Delete.
	(struct initializer_stack): Delete field 'asmspec'.
	(start_init): Delete saving of asmspec.
	(finish_init): Don't update constructor_asmspec.
	* dwarf2out.c (rtl_for_decl_location): Duplicate string from tree.
	* stmt.c (expand_asm): Duplicate strings from tree.
	(expand_asm_operands): Likewise.
	* tree.c (tree_size): Update computation of size of STRING_CST.
	(make_node): Don't make STRING_CST nodes.
	(build_string): Allocate string with tree node.
	(tree_code_size): Clean up assertions, don't allow requests
	for "the size of a STRING_CST".
	* tree.def (STRING_CST): Update comment.
	* tree.h (TREE_STRING_POINTER): Adjust for change to STRING_CST.
	(tree_string): Place contents of string in tree node.
	* config/sh/sh.c (sh_handle_sp_switch_attribute): Duplicate string
	from tree.

2004-09-17  Zack Weinberg  <zack@codesourcery.com>

	* Makefile.in (c-parse.o): Depend on $(C_PRAGMA_H).
	* objc/Make-lang.in (objc/objc-parse.o): Likewise.

2004-09-17  Jones Desougi  <jones@ingate.com>

	* configure.ac: Replace AC_COMPILE_CHECK_SIZEOF with AC_CHECK_SIZEOF.
	* configure, config.in: Regenerate.

2004-09-17  Zack Weinberg  <zack@codesourcery.com>

	* tree.c, tree.h (tree_class_strings): Make array const.
	Reindent per coding convention.  Move asterisk to proper place
	per coding convention.

2004-09-18  Andreas Schwab  <schwab@suse.de>

	* Makefile.in (gimple-low.o): Depend on $(EXPR_H).
	(tree-vectorizer.o): Likewise.
	(targhooks.o): Likewise.

2004-09-17  Jeffrey D. Oldham  <oldham@codesourcery.com>
	    Zack Weinberg  <zack@codesourcery.com>

	* alias.c (find_base_decl): Remove unreachable case '3' block.
	* expr.c (safe_from_p): Abort if passed a type.
	* tree-gimple.c (recalculate_side_effects): Abort if passed
	anything other than an expression.
	* tree-ssa-pre.c (phi_translate): Return expr immediately if
	is_gimple_min_invariant is true for it.  Reorder cases for clarity.
	Abort on un-handled tree classes.
	(valid_in_set): Likewise.
	* tree.c (tree_code_class_strings): New static data.

	* tree.h (enum tree_code_class): New.
	(tree_code_class_strings): Declare.
	(TREE_CODE_CLASS_STRING, EXCEPTIONAL_CLASS_P, CONSTANT_CLASS_P)
	(REFERENCE_CLASS_P, COMPARISON_CLASS_P, UNARY_CLASS_P, BINARY_CLASS_P)
	(STATEMENT_CLASS_P, EXPRESSION_CLASS_P, IS_TYPE_OR_DECL_P): New macros.
	(TYPE_P, DECL_P, IS_NON_TYPE_CODE_CLASS, IS_EXPR_CODE_CLASS)
	(checking macros, EXPR_LOCATION, SET_EXPR_LOCATION, EXPR_LOCUS): Update.

	* tree.def, c-common.def, objc/objc-tree.def: Use
	tree_code_class enumeration constants instead of code letters.

	* alias.c, builtins.c, c-common.c, c-format.c, c-lang.c, c-pragma.c
	* c-typeck.c, cgraphunit.c, convert.c, dbxout.c, dwarf2out.c
	* emit-rtl.c expr.c, fold-const.c, gimplify.c, lambda-code.c
	* langhooks.c, langhooks.h, predict.c, print-tree.c, reload1.c, stmt.c
	* tree-browser.c, tree-cfg.c, tree-chrec.c, tree-complex.c, tree-dfa.c
	* tree-dump.c, tree-eh.c, tree-gimple.c, tree-inline.c, tree-nested.c
	* tree-outof-ssa.c, tree-pretty-print.c, tree-sra.c, tree-ssa-ccp.c
	* tree-ssa-dce.c, tree-ssa-dom.c, tree-ssa-forwprop.c, tree-ssa-live.c
	* tree-ssa-loop-im.c, tree-ssa-loop-ivopts.c, tree-ssa-operands.c
	* tree-ssa-phiopt.c, tree-ssa-pre.c, tree-ssa-propagate.c
	* tree-ssa.c, tree-ssanames.c, tree-tailcall.c, tree.c, varasm.c
	* config/sol2-c.c, config/arm/arm.c, config/i386/winnt.c
	* config/pa/pa.c, config/pa/pa.h, config/sh/sh.c, objc/objc-lang.c
	Update to match.

	* LANGUAGES: Add note about change.

2004-09-17  Diego Novillo  <dnovillo@redhat.com>

	PR tree-optimization/17319
	* tree-ssa-alias.c (compute_points_to_and_addr_escape): Also
	examine pointers on the LHS of an assignment.
	(collect_points_to_info_r): Handle RETURN_EXPR.

2004-09-17 Jeff Law  <law@redhat.com>

	* tree-ssa-dom.c (const_and_copies_stack): New.
	(dom_walk_block_data): Remove const_and_copies field.
	(record_const_or_copy): No longer need to pass in varray_type *.
	Use CONST_AND_COPIES_STACK rather than passed in block local stack.
	Callers updated.
	(record_equality): Similarly.
	(restore_vars_to_original_value): Similarly.  Revamp to use new
	single global stack rather than per-block stacks.
	(tree_ssa_dominator_optimize): Initialize the CONST_AND_COPIES_STACK.
	(thread_across_edge): Remove now unused parameters.
	(dom_opt_initialize_block_local_data): No longer test the block
	local CONST_AND_COPIES.
	(dom_opt_initialize_block): Push a marker on CONST_AND_COPIES_STACK.

2004-09-17  Jan Hubicka  <jh@suse.cz>

	PR tree-optimization/17509
	* tree-optimize.c (update_inlined_to_pointers): New function.
	(tree_rest_of_compilation): Use it.

2004-09-17  Devang Patel  <dpatel@apple.com>

	* dbxout.c (get_lang_number): New.
	(dbxout_init): Include lang number in N_SO  stab.
	* dbxout.h (N_SO_AS, N_SO_C, N_SO_ANSI_C, N_SO_CC, N_SO_FORTRAN,
	N_SO_PASCAL, N_SO_FORTRAN90, N_SO_OBJC, N_SO_OBJCPLUS): New #define.

2004-09-17  Diego Novillo  <dnovillo@redhat.com>

	PR tree-optimization/17273
	* tree-ssa.c (replace_immediate_uses): Call fold_stmt if the
	replacement is a constant.

2004-09-17  Joseph S. Myers  <jsm@polyomino.org.uk>

	* c-tree.h (enum c_typespec_keyword): New.
	(struct c_declspecs): Adjust description of "type".  Remove
	specbits, explicit_int_p and explicit_char_p.  Rename
	typedef_signed_p to explicit_signed_p.  Add default_int_p, long_p,
	short_p, signed_p, unsigned_p and complex_p.
	(finish_declspecs): New.
	* c-parse.in (datadef, datadecl, setspecs, decl, component_decl,
	typename): Call finish_declspecs.
	* c-decl.c (finish_declspecs): New.
	(declspecs_add_type): Check for combinations which cannot occur in
	valid specifier lists.  Update comments.
	(shadow_tag_warned): Remove checks done in finish_declspecs.
	Don't report useless type name if type defaulted to int.
	(grokdeclarator): Remove checks and actions done in
	finish_declspecs.  Don't allow for type being NULL.  Update for
	datastructures changes.  Initialize decl_attr.
	(build_null_declspecs, quals_from_declspecs): Update for
	datastructures changes.

2004-09-17  Sylvain Pion  <Sylvain.Pion@sophia.inria.fr>

	* doc/extend.texi: Fix duplicated word.

2004-09-17  Toon Moene  <toon@moene.indiv.nluug.nl>

	* doc/invoke.texi: Remove stray explanation on
	-freduce-all-givs and -fmove-all-movables.

2004-09-17  James Morrison  <phython@gcc.gnu.org>

	* doc/cfg.texi: Use @smallexample.
	* doc/md.texi: Likewise.
	* doc/tree-ssa.texi: Likewise.
	* doc/extend.texi: Likewise.  Use @r{} in comments.
	* doc/trouble.texi: Use @r{} in comments.

2004-09-17  Hans-Peter Nilsson  <hp@bitrange.com>

	* configure.ac (gcc_cv_gld_version): Handle whitespace before
	"VERSION=".
	* aclocal.m4 (_gcc_COMPUTE_GAS_VERSION): Ditto.
	* configure: Regenerate.

2004-09-17  J"orn Rennecke <joern.rennecke@superh.com>

	* sh.c (sh_gimplify_va_arg_expr): Don't call pass_by_reference.
	(sh_pass_by_reference): Work around std_gimplify_va_arg_expr bug.
	* t-sh (MULTILIB_CPUS): s/ML_m/ML_sh/g .
	* t-sh64 (MULTILIB_CPU_DIRS): Likewise.  Match dashes and trailing
	slashes in substitutions.
	(MULTILIB_DIRNAMES): Remove defunct removal of /media32.

2004-09-17  Kazu Hirata  <kazu@cs.umass.edu>

	* basic-block.h, c-decl.c, c-parse.in, cgraphunit.c, ddg.c,
	gimplify.c, lambda-code.c, optabs.c, predict.c,
	tree-scalar-evolution.c, tree-sra.c, tree-ssa-loop-ch.c,
	tree-ssa.c, vec.h: Fix comment typos.  Follow spelling
	conventions.

2004-09-17  Kazu Hirata  <kazu@cs.umass.edu>

	* doc/compat.texi, doc/cpp.texi, doc/cppopts.texi,
	doc/extend.texi, doc/install.texi, doc/invoke.texi,
	doc/sourcebuild.texi, doc/tm.texi, doc/tree-ssa.texi,
	doc/trouble.texi: Use @option around options.

2004-09-17  Richard Sandiford  <rsandifo@redhat.com>

	* Makefile.in (gen-protos.o): Depend on errors.h.

2004-09-17  Steven Bosscher  <stevenb@suse.de>

	PR tree-optimization/17513
	* cfgexpand.c (construct_init_block): Clear EDGE_EXECUTABLE
	for successors of the entry block.

2004-09-17  Uros Bizjak  <uros@kss-loka.si>

	PR rtl-optimization/15187
	* ifcvt.c (noce_try_cmove_arith): Exit early if total
	insn_rtx_cost of both branches > BRANCH_COST

2004-09-16  Diego Novillo  <dnovillo@redhat.com>

	PR tree-optimization/17528
	* tree-ssa-alias.c (compute_flow_insensitive_aliasing): Do not
	erase the may-alias set for a tag when merging it with
	another.

2004-09-16  Kaz Kojima  <kkojima@gcc.gnu.org>

	* config/sh/sh.md (call): Extend 32-bit addresses to DImode
	for 32-bit TARGET_SHMEDIA.
	(call_value): Likewise.

2004-09-16  Diego Novillo  <dnovillo@redhat.com>

	* tree-ssa-operands.c (add_call_clobber_ops): Make read-only
	test apply only to TREE_STATIC and DECL_EXTERNAL.

2004-09-16  Zdenek Dvorak  <rakdver@atrey.karlin.mff.cuni.cz>

	* Makefile.in (tree-cfg.o): Add CFGLAYOUT_H dependency.
	* basic-block.h (get_dominated_by_region): Declare.
	* dominance.c (get_dominated_by_region): New function.
	* tree-cfg.c: Include cfglayout.h.
	(tree_duplicate_bb): Duplicate also phi nodes.
	(struct ssa_name_map_entry): New type.
	(add_phi_args_after_copy_bb, add_phi_args_after_copy,
	ssa_name_map_entry_hash, ssa_name_map_entry_eq,
	allocate_ssa_names, rewrite_to_new_ssa_names_def,
	rewrite_to_new_ssa_names_use, rewrite_to_new_ssa_names_bb,
	rewrite_to_new_ssa_names, tree_duplicate_sese_region): New functions.
	* tree-flow.h (tree_duplicate_sese_region, add_phi_args_after_copy_bb,
	add_phi_args_after_copy, rewrite_to_new_ssa_names_bb,
	rewrite_to_new_ssa_names, allocate_ssa_names,
	rewrite_into_loop_closed_ssa, verify_loop_closed_ssa): Declare.
	* tree-ssa-loop-ch.c (duplicate_blocks): Removed.
	(copy_loop_headers): Use tree_duplicate_sese_region.

2004-09-16  Frank Ch. Eigler  <fche@redhat.com>

	* profile.c (branch_prob): Restore support for USE_MAPPED_LOCATION.

2004-09-16 Jeff Law  <law@redhat.com>

	* tree-into-ssa.c (block_defs_stack): New toplevel varray.
	(rewrite_block_data): Remove, no longer used.
	(rewrite_initialize_block_local_data): Remove, no longer used.
	(rewrite_initialize_block): Mark parameters as unused as needed.
	Change references to the block local block_defs to be block_defs_stack.
	Push a marker onto the block_defs_stack.
	(ssa_rewrite_initialize_block): Similarly.
	(rewrite_stmt, ssa_rewrite_stmt): Similarly.
	(ssa_register_new_def): No longer needs varray argument.  Use
	block_defs_stack instead.  No longer handle possibly null block_defs
	varray.  Reverse order of items we push on the stack to make it
	easier to identify our marker.
	(register_new_def): No longer handle possibly null block_defs
	varray.
	(rewrite_finalize_block): Revamp to look for markers in the global
	block_defs_stack varray rather than wiping a block local varray.
	Mark arguments as unused as needed.
	(ssa_rewrite_finalize_block): Similarly.
	(rewrite_into_ssa): Update initialization of dom walker structure
	to reflect that we don't need block local data anymore.  Initialize
	the block_defs_stack varray.
	(rewrite_ssa_into_ssa): Similarly.
	* tree-ssa-dom.c (block_defs_stack): New toplevel varray.
	(struct dom_walk_data): Kill block_defs field.
	(tree_ssa_dominator_optimize): Initialize block_defs_stack.
	(thread_across_edge): Use the global block_defs_stack instead of
	the old block_defs varray.
	(dom_opt_initialize_block_local_data): Update now that we don't have
	block_defs field to check anymore.
	(dom_opt_initialize_block): Push a marker onto block_defs_stack.
	(restore_currdefs_to_original_value): Use the new block_defs_stack
	instead of a block local varray.
	(dom_opt_finalize_block): Similarly.
	(record_equivalencs_from_phis): Similarly.
	(optimize_stmt, register_definitions_for_stmt): Similarly.

2004-09-16  Andrew MacLeod  <amacleod@redhat.com>

	PR tree-optimization/17517
	* tree-ssa-copyrename.c (copy_rename_partition_coalesce): Don't
	coalesce same-root variables without checking for abnormal PHI usage.

2004-09-16  Daniel Berlin  <dberlin@dberlin.org>

	* cfgloop.h (duplicate_loop):  Add prototype.
	* cfgloopmanip.c (duplicate_loop): Make non-static.
	* lambda-code.c (perfect_nestify): Factor out test whether
	we can handle this loop into separate function.
	Call it.
	(can_convert_to_perfect_nest): New function.
	(replace_uses_of_x_with_y): Add modify_stmt call.
	* tree-loop-linear.c (linear_transform_loops): Call
	rewrite_into_loop_closed_ssa and free_df.

2004-09-16  Daniel Berlin  <dberlin@dberlin.org>

	* lambda-code.c (invariant_in_loop): is_gimple_min_invariant is
	loop invariant as well.
	(perfect_nestify): new function.
	(gcc_loop_to_lambda_loop): New parameters to track lower bounds,
	upper bounds, and steps.
	Set outerinductionvar properly.
	(gcc_loopnest_to_lambda_loopnest): Add loops and need_perfect
	parameters.
	Return NULL if we need a perfect loop and can't make one.
	(lambda_loopnest_to_gcc_loopnest): Correct algorithm.
	(not_interesting_stmt): New function.
	(phi_loop_edge_uses_def): Ditto.
	(stmt_uses_phi_result): Ditto.
	(stmt_is_bumper_for_loop): Ditto.
	(perfect_nest_p): Ditto.
	(nestify_update_pending_stmts): Ditto.
	(replace_uses_of_x_with_y): Ditto.
	(stmt_uses_op): Ditto.
	(perfect_nestify): Ditto.
	* lambda-mat.c (lambda_matrix_id_p): New function.
	* lambda-trans.c (lambda_trans_matrix_id_p): Ditto.
	* lambda.h: Update prototypes.
	* tree-loop-linear (linear_transform_loop): Use new
	perfect_nest_p. Detect and ignore identity transform.
	* tree-ssa-loop.c (pass_linear_transform): Use TODO_write_loop_closed.

2004-09-16  Sebastian Pop  <pop@cri.ensmp.fr>

	* tree-loop-linear.c (gather_interchange_stats): Add more comments.
	Gather also strides of accessed data.  Pass in the data references
	array.
	(try_interchange_loops): Add a new heuristic for handling the temporal
	locality.  Pass in the data references array.
	(linear_transform_loops): Pass the data references array to
	try_interchange_loops.

2004-09-16  Kazu Hirata  <kazu@cs.umass.edu>

	* doc/invoke.texi: Fix typos.  Follow spelling conventions.

2004-09-16  Nathan Sidwell  <nathan@codesourcery.com>

	* doc/c-tree.texi (Classes): Remove index entries for
	TREE_VIA_{PUBLIC,PROTECTED,PRIVATE}.

2004-09-16  Zdenek Dvorak  <rakdver@atrey.karlin.mff.cuni.cz>

	* fold-const.c (fold): Fold difference of addresses.
	(ptr_difference_const): Moved from tree-ssa-loop-ivopts, based on
	get_inner_reference.
	* tree-ssa-loop-ivopts.c (peel_address): Removed.
	(ptr_difference_const): Moved to fold-const.c.
	(split_address_cost): Use get_inner_reference instead of peel_address.
	(ptr_difference_cost): Change type of diff to HOST_WIDE_INT.
	* tree.h (ptr_difference_const): Export.

	* tree-ssa-loop-ivopts.c (dump_iv, dump_use, dump_cand): Add induction
	variable type to the dump.  Fix indentation.
	(idx_find_step): Handle nonconstant array_ref_element_size and
	array_ref_low_bound.
	(idx_record_use): Handle array_ref_element_size and
	array_ref_low_bound.
	(find_interesting_uses_stmt): Handle memory = nontrivial_expression
	statements correctly.
	(get_computation_at, iv_value): Do not unshare expressions here.
	(rewrite_use_outer): Unshare the expression before it is emitted
	to code.
	* tree-ssa-loop-niter.c (unsigned_type_for, signed_type_for):
	Moved to tree.c.
	* tree.c (unsigned_type_for, signed_type_for): Moved from
	tree-ssa-loop-niter.c.  Use langhooks.
	* tree.h (signed_type_for): Export.

2004-09-16  David Edelsohn  <edelsohn@gnu.org>

	* config/rs6000/rs6000.c (rs6000_xcoff_asm_named_section): Update
	prototype.

2004-09-15  Andrew Pinski  <pinskia@physics.uc.edu>

	PR target/11572
	* c-incpath.h (target_c_incpath_s): Add extra_pre_includes.
	Add two parameters to extra_includes.
	(C_INCPATH_INIT): Remove.
	* c-incpath.c (register_include_chains): Call extra_pre_includes
	before adding the standard include directory.
	Update call to extra_includes.
	(!defined TARGET_EXTRA_INCLUDES): Update
	hook_void_charptr_charptr_int and add !define
	TARGET_EXTRA_PRE_INCLUDES.
	(!define TARGET_EXTRA_INCLUDES): Define as
	hook_void_charptr_charptr_int.
	(!define TARGET_EXTRA_PRE_INCLUDES): Likewise.
	(target_c_incpath): Always declare.
	* fixinclude.c (defined TARGET_EXTRA_INCLUDES): Declare a
	empty function.
	(define TARGET_EXTRA_PRE_INCLUDES): Likewise.
	* config/darwin.h: (darwin_register_frameworks): Update for
	the two new parameters.
	(darwin_register_objc_includes): Add prototype.
	(TARGET_EXTRA_PRE_INCLUDES): Define.
	* config/darwin-c.c (darwin_register_objc_includes): New function.
	(darwin_register_frameworks): Update for the two new parameters.
	(target_c_incpath): Remove.
	* config/t-darwin (darwin-c.o): Add $(PREPROCESSOR_DEFINES) to
	the compile line.
	* doc/tm.texi (TARGET_EXTRA_INCLUDES): Document the two new
	parameters.
	(TARGET_EXTRA_PRE_INCLUDES): Document.

	* gcc.c (spec_function): Add replace-outfile.
	(replace_outfile_spec_function): New function.
	* config/darwin.h (LINK_SPEC): Add replace
	-lobjc with -lobjc-gnu if -fgnu-runtime is
	supplied.
	* invoke.texi (replace-outfile): Document.

2004-09-13  Jan Hubicka  <jh@suse.cz>

	* predict.c (expr_expected_value, strip_builtin_expect): New function.
	(tree_predict_by_opcode): Use it.
	(tree_estimate_probability): Add, for now disabled,
	strip_builtin_expect call.

2004-09-15  James E Wilson  <wilson@specifixinc.com>

	PR target/17455
	* config/ia64/ia64.c (ia64_function_ok_for_sibcall): Return false
	if current_function_decl is a sibcall.

2004-09-15  Mark Mitchell  <mark@codesourcery.com>

	* varasm.c (default_function_rdodata_section): Make sure to pass
	along a decl for a link-once section.

2004-09-15  Richard Henderson  <rth@redhat.com>

	* tree-ssa-operands.c (add_call_clobber_ops): Fix unused variable
	warning with code disable.  Fix formatting.

2004-09-15  Steven Bosscher  <stevenb@suse.de>

	* Makefile.in (tree-ssa-dom.o): Depend on tree-ssa-propagate.h.
	* tree-ssa-dom.c (cprop_into_stmt): Recompute TREE_INVARIANT
	after propagating into an ADDR_EXPR.

2004-09-15  Andrew Pinski  <apinski@apple.com>

	PR rtl-opt/17427
	* gcse.c (process_insert_insn): insn_invalid_p has side effects.
	Move it out of gcc_assert.

2004-09-15  Joseph S. Myers  <jsm@polyomino.org.uk>

	* attribs.c, builtins.c, c-format.c, c-pch.c, coverage.c,
	except.c, fold-const.c, function.c, langhooks.c, params.c,
	reload.c, reload1.c, stmt.c, stor-layout.c, toplev.c, tree-cfg.c,
	tree-dump.c, tree-mudflap.c, tree.c, varasm.c: Use %<, %> and %q
	for quoting in diagnostics going through pretty-print.c.  Use ''
	for quoting in other diagnostic text.
	* langhooks.c: Include intl.h.  Mark text locating diagnostics for
	translation.
	* Makefile.in (langhooks.o): Update dependencies.
	* pretty-print.h (pp_printf): Mark as accepting GCC diagnostic
	formats.

2004-09-15  Mark Mitchell  <mark@codesourcery.com>

	* configure.ac: Check for COMDAT support.  Robustify check for
	SHF_MERGE support.
	* configure: Regenerated.
	* config.in: Likewise.
	* langhooks-def.h (lhd_comdat_group): New function.
	(LANG_HOOKS_COMDAT_GROUP): New macro.
	(LANG_HOOKS_DECLS): Use it.
	* langhooks.c (lhd_comdat_group): Define.
	* langhooks.h (lang_hooks_for_decls): Add comdat_group.
	* output.h (named_section_flags): Make it a macro.
	(named_section_real): New function.
	(default_no_named_section): Add decl parameter.
	(default_elf_asm_named_section): Likewise.
	(default_coff_asm_named_section): Likewise.
	(default_pe_asm_named_section): Likewise.
	* target.h (gcc_target): Adjust type of named_section.
	* varasm.c (named_section_flags): Rename to named_section_real.
	Add decl parameter.
	(default_no_named_section): Add decl parameter.
	(default_elf_asm_named_section): Use COMDAT, if available.  Deal
	with the case that ASM_COMMENT_START is "@".
	(default_coff_asm_named_section): Add decl parameter.
	(default_pe_asm_named_section): Likewise.
	* config/alpha/alpha.c (vms_asm_named_section): Add decl
	parameter.
	(unicosmk_asm_named_section): Likewise.
	* config/arm/arm.c (arm_elf_asm_named_section): Remove.
	* config/arm/elf.h (TARGET_ASM_NAMED_SECTION): Likewise.
	* config/c4x/c4x.c (c4x_asm_named_section): Add decl parameter.
	* config/cris/cris-protos.h (cris_target_asm_named_section):
	Likewise.
	* config/cris/cris.c (cris_target_asm_named_section):
	Likewise.
	* config/darwin/darwin-protos.h (darwin_asm_named_section):
	Likewise.
	* config/darwin/darwin.c (darwin_asm_named_section): Likewise.
	* config/h8300/h8300.c (h8300_asm_named_section): Likewise.
	* config/i386/i386-protos.h (i386_pe_asm_named_section):
	Likewise.
	* config/i386/winnt.c (i386_pe_asm_named_section): Likewise.
	* config/m68k/m68k.c (m68k_coff_asm_named_section): Likewise.
	* config/mcore/mcore.c (mcore_asm_named_section): Likewise.
	* config/rs6000/rs6000.c (rs6000_xcoff_asm_named_section):
	Likewise.
	* config/sparc/sparc.c (sparce_elf_asm_named_section): Likewise.
	* cp/cp-lang.h (LANG_HOOKS_COMDAT_GROUP): Define.
	* cp/cp-tree.h (cxx_comdat_group): Declare.
	* cp/decl.c (cxx_comdat_group): New function.

2004-09-15  Jan Hubicka  <jh@suse.cz>

	* tree-ssa.c (verify_flow_sensitive_alias_info): Do not walk dead nodes.
	* tree-tailcall.c (eliminate_tail_call): Release SSA name.

	* tree-cfg.c (remove_bb): Release SSA defs.

2004-09-15  Kazu Hirata  <kazu@cs.umass.edu>

	* doc/tm.texi: Follow spelling conventions.

2004-09-15  Kazu Hirata  <kazu@cs.umass.edu>

	* tree-ssa-dom.c: Fix comment typos.

2004-09-15  Alan Modra  <amodra@bigpond.net.au>

	* config/rs6000/linux-unwind.h (struct gcc_pt_regs): Extend to
	include ccr.
	(ppc_fallback_frame_state): Save location of CR.

2004-09-15  Jakub Jelinek  <jakub@redhat.com>

	* expr.c (string_constant): Handle also read-only variables
	initialized to string literals.

	* builtins.c (expand_builtin_memmove): Optimize memmove (x, y, 1)
	into memcpy (x, y, 1) if memcpy can be expanded inline.

2004-09-15  Zdenek Dvorak  <rakdver@atrey.karlin.mff.cuni.cz>

	PR tree-optimization/17468
	* tree-ssa.c (verify_use, verify_phi_args, verify_ssa):  Verify that
	definition inside a block precede uses.
	* tree-tailcall.c (adjust_return_value): Emit statements in the
	correct order.

2004-09-15  Richard Sandiford  <rsandifo@redhat.com>

	* config/mips/mips.h (POINTERS_EXTEND_UNSIGNED): Delete.

2004-09-15  Eric Botcazou  <ebotcazou@libertysurf.fr>

	* doc/install.texi (sparc-sun-solaris2*): Properly format warning.

2004-09-14 Jeff Law  <law@redhat.com>

	* tree-ssa-dom.c (avail_exprs_stack): New global varray.
	(struct dom_walk_block_data): Remove avail_exprs member.
	(tree_ssa_dominator_optimize): Initialize avail_exprs_stack.
	(lookup_avail_expr): No longer need to pass in address of
	the block local available exprs stack.  All callers changed.
	(simplify_cond_and_lookup_avail_expr): Similarly.
	(simplify_switch_and_lookup_avail_expr): Similarly.
	(get_eq_expr_value, record_cond): Likewise.
	(record_dominating_conditions): Likewise.
	(update_rhs_and_lookup_avail_expr): Likewise.
	(record_equivalences_from_stmt): Likewise.
	(dom_opt_initialize_block_local_data): No longer test state of
	block local avail_exprs.
	(dom_opt_initialize_block): Mark unwind point in the global
	avail_expr stack.
	(remove_expressions_from_table): Update to unwind to the
	most recent unwind marker in the global avail_expr stack.
	All callers changed.
	(dom_opt_finalize_block): Mark unwind point in the global
	avail_expr stack as needed.
	(record_cond): Push elements into the global avail_exprs stack.

	* tree-dfa.c (free_df_for_stmt): No longer static.
	(free_df): Update comments.
	* tree-flow.h (free_df_for_stmt): Prototype.
	* tree-ssa-dse.c (dse_optimize_stmt): Call free_df_for_stmt.  Also
	call release_defs.

2004-09-14  Diego Novillo  <dnovillo@redhat.com>

	PR tree-optimization/17252
	* tree-ssa-alias.c (may_alias_p): Don't assume that a
	pointer may not point to itself when using relaxed
	aliasing rules.

2004-09-14  Richard Henderson  <rth@redhat.com>

	PR middle-end/17397
	* gimplify.c (gimplify_addr_expr): Don't inadvertently change types
	while folding <ADDR_EXPR <INDIRECT_REF X>>.

2004-09-14  Andrew Pinski  <apinski@apple.com>

	* tree-ssa-copy.c (may_propagate_copy): Don't check the aliasing
	sets of the pointers but the aliasing sets of what they point to.

2004-09-14  Roger Sayle  <roger@eyesopen.com>

	PR rtl-optimization/9771
	* regclass.c (CALL_REALLY_USED_REGNO_P): New macro to eliminate
	conditional compilation in init_reg_sets_1.
	(init_reg_sets_1): Let global_regs[i] take priority over the frame
	(but not stack) pointer exceptions to regs_invalidated_by_call.
	(globalize_reg): Globalizing a fixed register may need to update
	regs_invalidated_by_call.

2004-09-14  Diego Novillo  <dnovillo@redhat.com>

	PR tree-optimization/15262
	* tree-dfa.c (dump_variable): Also print the type of the
	variable.
	* tree-ssa-alias.c (compute_flow_insensitive_aliasing): If two
	memory tags are of conflicting alias sets but have no aliased
	symbols in common, add one tag to the alias set of the other.
	(setup_pointers_and_addressables): Remove hack to deal with
	programs with no aliased symbols.
	(may_alias_p): Don't special case aggregate types.

2004-09-14  Joseph S. Myers  <jsm@polyomino.org.uk>

	PR c/15498
	* doc/invoke.texi (Environment Variables): Correct example locale.

2004-09-14  Jan Hubicka  <jh@suse.cz>

	* cfg.c (expunge_block): Revert previous change adding ggc_free call.

2004-09-14  Mark Mitchell  <mark@codesourcery.com>

	* config.gcc: Do not build a shared libgcc for arm-none-eabi.

2004-09-14  Joseph S. Myers  <jsm@polyomino.org.uk>

	* c-tree.h (struct c_declspecs): Add const_p, volatile_p and
	restrict_p.
	(struct c_declarator): Change u.array.quals and pointer_quals to
	int.  Add u.array.attrs.
	(quals_from_declspecs): New.
	* c-decl.c (quals_from_declspecs): New.
	(shadow_tag_warned): Give more specific message for useless type
	qualifiers.
	(build_array_declarator, set_array_declarator_inner,
	grokdeclarator, make_pointer_declarator, build_null_declspecs,
	declspecs_add_qual): Update for changed structures.

2004-09-14  Jeff Law  <law@redhat.com>

	* tree-ssa-dom.c (stmts_to_rescan): Move from a block-local
	to a global varray.
	(tree_ssa_dominator_optimize): Allocate stmts_to_rescan.
	(dom_opt_initialize_block_local_data): No longer test state
	of stmts_to_rescan.
	(dom_opt_finalize_block): Update due to change in scope of
	stmts_to_rescan.
	(optimize_stmt): Similarly.

2004-09-14  Kazu Hirata  <kazu@cs.umass.edu>

	* cgraph.h, cgraphunit.c, fold-const.c, lambda-mat.c,
	lambda.h, profile.c, tree-optimize.c, tree-sra.c, vec.h: Fix
	comment typos.  Follow spelling conventions.

2004-09-14  Kazu Hirata  <kazu@cs.umass.edu>

	* config/darwin-c.c, config/alpha/alpha.c, config/i386/i386.c,
	config/i386/predicates.md, config/sparc/sparc.c: Follow
	spelling conventions.

2004-09-14  Zdenek Dvorak  <rakdver@atrey.karlin.mff.cuni.cz>
	    Steven Bosscher  <stevenb@suse.de>

	* Makefile.in (loop-unroll.o): Add HASHTAB_H and RECOG_H dependency.
	* basic-block.h (struct reorder_block_def): Add copy_number field.
	* cfgloop.h (biv_p): Declare.
	* cfgloopmanip.c (duplicate_loop_to_header_edge): Set copy_number.
	* common.opt (fsplit-ivs-in-unroller): New flag.
	* loop-iv.c (biv_p): New function.
	* loop-unroll.c: Include hashtab.h and recog.h.
	(struct iv_to_split, struct split_ivs_info): New types.
	(analyze_ivs_to_split, si_info_start_duplication, split_ivs_in_copies,
	free_si_info, si_info_hash, si_info_eq, analyze_iv_to_split_insn,
	determine_split_iv_delta, get_ivts_expr, allocate_basic_variable,
	insert_base_initialization, split_iv): New functions.
	(peel_loop_completely, unroll_loop_constant_iterations,
	unroll_loop_runtime_iterations, peel_loop_simple, unroll_loop_stupid):
	Use them.
	* doc/invoke.texi (-fsplit-ivs-in-unroller): Document.

2004-09-14  Zdenek Dvorak  <rakdver@atrey.karlin.mff.cuni.cz>

	* tree-cfg.c (thread_jumps): Update dominators correctly in
	case destination of threaded edge dominates its source.

2004-09-14  Zdenek Dvorak  <rakdver@atrey.karlin.mff.cuni.cz>

	* unroll.c: Removed.
	* loop.h: Removed.
	* Makefile.in (LOOP_H, unroll.o): Removed.
	(toplev.o, passes.o, stmt.o, integrate.o, loop.o): Remove LOOP_H
	dependency.
	* alias.c (init_alias_analysis): Remove flag_old_unroll_loops
	reference.
	* cfgloop.h (LOOP_PREFETCH, loop_optimize): Moved from loop.h.
	* common.opt (fold-unroll-loops, fold-unroll-all-loops): Removed.
	* loop.c: Do not include loop.h.
	(LOOP_INFO, LOOP_MOVABLES, LOOP_REGS, LOOP_IVS, INSN_LUID,
	REGNO_FIRST_LUID, REGNO_LAST_LUID, enum g_types, struct induction,
	struct iv_class, enum iv_mode, struct iv, REG_IV_TYPE, REG_IV_INFO,
	REG_IV_CLASS, struct loop_ivs, struct loop_mem_info, struct loop_reg,
	struct loop_regs, struct loop_movables, struct loop_info): Moved
	from loop.h.
	(back_branch_in_range_p, fold_rtx_mult_add, biv_total_increment,
	reg_dead_after_loop, final_biv_value, loop_find_equiv_value,
	find_common_reg_term, loop_iterations, final_giv_value): Moved
	from unroll.c.
	(uid_luid, uid_loop, max_uid_for_loop, max_reg_before_loop,
	loop_dump_stream, for_each_insn_in_loop, express_from,
	extend_value_for_giv, loop_iv_add_mult_emit_before,
	loop_iv_add_mult_sink, loop_iv_add_mult_hoist,
	loop_insn_first_p, get_condition_for_loop,
	loop_insn_emit_before, loop_insn_hoist,
	loop_insn_sink): Made static.
	(loop_invariant_p): Made static.  Removed flag_old_unroll_loops
	reference.
	(strength_reduce): Do not call unroller.
	(record_giv): Do not initialize unrolled field.
	(prescan_loop): Do not set loop_info->preconditioned.
	* passes.c: Do not include loop.h.
	(rest_of_handle_loop_optimize): Do not call unroller.
	* predict.c: Do not include loop.h.
	* rtl.h (NOTE_PRECONDITIONED): Removed.
	* stmt.c: Do not include loop.h.
	* toplev.c: Do not include loop.h.
	(process_options): Do not handle flag_old_unroll_loops.

	* doc/invoke.texi (fold-unroll-loops, fold-unroll-all-loops):
	Documentation removed.
	* doc/passes.texi (unroll.c, loop.h): Documentation removed.

2004-09-14  Nathan Sidwell  <nathan@codesourcery.com>

	* Makefile.in (STAGE1_CHECKING): New variable.
	(stage1_build): Use it.
	* tree-ssa.c (verify_ssa): Preserve state of dominance
	information.

2004-09-14  Uros Bizjak  <uros@kss-loka.si>

	* config/i386/i386.c (output_fp_compare): Add generation
	of ftst instruction.
	* config/i386/i386.md (*cmpfp_0_sf, cmpfp_0_df, cmpfp_0_xf):
	Use output_fp_compare () function.
	(cmpfp_i, *cmpfp_i_sse, *cmpfp_i_sse_only): Fix insn constraint.
	(fix_truncdi_memory): Remove operands[5] copy.

2004-09-14  Kazu Hirata  <kazu@cs.umass.edu>

	* config/m32r/m32r.md, config/m68k/m68kelf.h,
	config/mcore/mcore.md, config/rs6000/linux64.h,
	config/rs6000/rs6000.c, config/sparc/sparc.c: Fix comment
	typos.

2004-09-13  James E Wilson  <wilson@specifixinc.com>

	* Makefile.in (GEN_PROTOS_OBJS): Add $(BUILD_ERRORS).
	* gen-protos.c: Include errors.h.
	(progname): Delete.

2004-09-14  Jan Hubicka  <jh@suse.cz>

	* Makefile.in (predict.o): Depend on tree-scalar-evolution.h
	* predict.c: Include tree-scalar-evolution.h and cfgloop.h
	(predict_loops): Use number_of_iterations_exit to predict
	number of iterations on trees.

2004-09-13  Dale Johannesen  <dalej@apple.com>

	PR 17408
	PR 17409
	* c-decl.c (start_decl): Repair TREE_STATIC for initialized
	objects declared extern.

2004-09-14  Paul Brook  <paul@codesourcery.com>

	* config/arm/arm.c (arm_expand_prologue): Make args_to_push a
	HOST_WIDE_INT.

2004-09-13  Daniel Jacobowitz  <dan@debian.org>

	* fold-const.c (fold_checksum_tree): Ignore TYPE_CACHED_VALUES.
	Only use TYPE_BINFO for aggregates.

2004-09-13  Daniel Jacobowitz  <dan@debian.org>

	* expmed.c (synth_mult): Initialize latency.  Check cost before
	checking ops count.

2004-09-13  Kenneth Zadeck  <Kenneth.Zadeck@NaturalBridge.com>

	* tree-ssa-operands.c (get_call_expr_operands): Added parm to
	add_call_clobber_ops and add_call_read_ops.
	(add_call_clobber_ops, add_call_read_ops): Added code to reduce
	the number of vdefs and vuses inserted based on analysis of global
	variables across calls.  * tree-dfa.c (find_referenced_vars):
	Needed to reset static var maps before each function is compiled.
	* cgraphunit.c:
	(static_vars_to_consider_by_tree,static_vars_to_consider_by_uid,
	static_vars_info,functions_to_static_vars_info,module_statics_escape,
	all_module_statics,searchc_env,dfs_info): New fields to support
	analysis of static global variables.
	(print_order, convert_UIDs_in_bitmap, new_static_vars_info,
	cgraph_reset_static_var_maps, get_global_static_vars_info,
	get_global_statics_not_read, get_global_statics_not_written,
	searchc, cgraph_reduced_inorder, has_proper_scope_for_analysis,
	check_rhs_var, check_lhs_var, get_asm_expr_operands,
	process_call_for_static_vars, scan_for_static_refs,
	cgraph_characterize_statics_local, cgraph_get_static_name_by_uid,
	clear_static_vars_maps, cgraph_propagate_bits,
	cgraph_characterize_statics): New. Functions to support analysis
	of static global variables.
	(cgraph_mark_local_and_external_functions): Renamed from:
	(cgraph_mark_local_functions)
	(cgraph_expand_all_functions): Remove call to
	cgraph_mark_local_and_external_functions.
	(cgraph_optimize): Added driver to analyze static variables whose
	scope is within the compilation unit.  * cgraph.h (struct
	cgraph_local_info, GTY): Added statics_read, statics_written,
	local, calls_read_all, calls_write_all, for_functions_valid.
	(struct cgraph_node): Added next_cycle.  * cgraph.c
	(dump_cgraph_node): Added print routines for new fields.  *
	makefile.in: macroized cgraph.h, added cgraphunit.c to the ggc
	list.

2004-09-13  Joseph S. Myers  <jsm@polyomino.org.uk>

	* c-decl.c (grokdeclarator): Correct comments about where storage
	class specifiers are rejected by grammar and add corresponding
	asserts.  Diagnose typedefs and parameters declared inline.
	Change warning for inline main to a pedwarn.  Only diagnose inline
	main if hosted.
	(declspecs_add_scspec): Allow duplicate "inline".

2004-09-13  Steve Ellcey  <sje@cup.hp.com>

	* config/ia64/ia64.c (ia64_scalar_mode_supported_p): New.
	(TARGET_SCALAR_MODE_SUPPORTED_P): New.

2004-09-13  Richard Henderson  <rth@redhat.com>

	PR 17436
	* tree.h (TYPE_CONTAINS_PLACEHOLDER_INTERNAL): New.
	(tree_type): Replace spare with contains_placeholder_bits.
	(type_contains_placeholder_1): Rename from type_contains_placeholder_p,
	make static.  Remove seen_types list.
	(type_contains_placeholder_p): New.

2004-09-13  James E Wilson  <wilson@specifixinc.com>

	* config/mips/mips.c (CODE_FOR_mips_sqrt_ps): New.
	(sb1_bdesc, bdesc_map, bdesc_arrays): New.
	(mips_expand_builtin): Add SB-1 support.  Use bdesc_map and
	bdesc_arrays instead of mips_bdesc.
	(mips_init_builtins): Likewise.
	* config/mips/mips.h (TARGET_SB1): New.
	(HAVE_SQRT_P): Delete.
	* config/mips/mips.md (divide_condition): Support V2SF.
	(sqrt_condition, recip_condition): New.
	(div<mode>3): Use ANYF instead of SCALARF.
	(*div<mode>3): Use ANYF instead of SCALARF.  Use UNITMODE instead of
	MODE.
	(*recip<mode>3, *rsqrt<mode>a, *rsqrt<mode>b): Use recip_condition
	instead of ISA_HAS_FP4.  Use ANYF instead of SCALARF.  Use UNITMODE
	instead of MODE.
	(sqrt<mode>2): Use sqrt_condition instead of HAVE_SQRT_P.  Use ANYF
	instead of SCALARF.  Use UNITMODE instead of MODE.

2004-09-13  Zack Weinberg  <zack@codesourcery.com>

	* config.in: Regenerate after removal of libbanshee.

2004-09-13  Andrew MacLeod  <amacleod@redhat.com>

	PR tree-optimization/17400
	* tree-ssa-copyrename.c (copy_rename_partition_coalesce): Don't
	coalesce partitions when one occurs in an abnormal PHI.

2004-09-13  Andrew Pinski  <apinski@apple.com>

	* config/rs6000/darwin.h (ASM_OUTPUT_COMMON): Change variable size's
	name to _new_size.

2004-09-13  Richard Henderson  <rth@redhat.com>

	PR inline-asm/6806
	* cselib.c (cselib_invalidate_rtx): Export.  Remove unused args.
	(cselib_invalidate_rtx_note_stores): New.
	(cselib_record_sets, cselib_process_insn): Update to match.
	* cselib.h (cselib_invalidate_rtx): Declare.
	* postreload.c (reload_cse_simplify): Invalidate asm clobbers.

2004-09-13  Richard Henderson  <rth@redhat.com>

	PR tree-opt/10528
	* tree-inline.c (copy_body_r): Recompute bits for ADDR_EXPR,
	after copying its argument.

2004-09-13  Joseph S. Myers  <jsm@polyomino.org.uk>

	* c-common.c, c-decl.c, c-lex.c, c-objc-common.c, c-opts.c,
	c-parse.in, c-pragma.c, c-typeck.c: Use %q, %< and %> for quoting
	in diagnostics.  Use %' for English apostrophes.
	* c-tree.h (ATTRIBUTE_GCC_CDIAG): Define.
	(pedwarn_c90, pedwarn_c99): Use it.
	* c-decl.c (lookup_label): Quote label name in diagnostic.
	* c-parse.in (yyprint): Use ' instead of ` for left quote.
	* c-typeck.c (warn_for_assignment): Likewise.

2004-09-13  Jan Hubicka  <jh@suse.cz>

	* i386.c (x86_schedule): New global variable.
	(override_options): Disable scheduling when not supported.
	* i386.h (x86_schedule): Declare.
	(TARGET_SCHEDULE): New macro.

2004-09-12  Richard Henderson  <rth@redhat.com>

	PR c++/16254
	* fold-const.c (fold) <case CLEANUP_POINT_EXPR>: Remove.
	* tree.c, tree.h (has_cleanups): Remove.

2004-09-12  Zdenek Dvorak  <rakdver@atrey.karlin.mff.cuni.cz>

	* tree-ssa-loop-manip.c (split_loop_exit_edge): Handle non-ssaname
	arguments of the phi nodes correctly.

2004-09-12  Jan Hubicka  <jh@suse.cz>

	* ggc-common.c (cmp_statistics): Fix sorting.

2004-09-12  David Edelsohn  <edelsohn@gnu.org>

	PR target/16795
	* expmed.c (expand_divmod): If cheap power of 2 divide is
	available, use it for negative constant as well.

2004-09-12  Andrew Pinski  <apinski@apple.com>

	* darwin.h (ASM_OUTPUT_COMMON): Make sure we do not have a
	size of 0.

	* tree-chrec.c (initialize_scalar_evolutions_analyzer): Remove.

2004-09-12  Richard Henderson  <rth@redhat.com>

	* config/i386/i386.c (ix86_split_ashldi): Special case op1 as one
	or minus one.
	(ix86_split_ashrdi, ix86_split_lshrdi): Clean up conditions for
	post-reload, and scratch NULL.
	* config/i386/i386.md (testqi_1): Use FLAGS_REG name.
	(x86_shift_adj_2): Use ix86_expand_clear.
	(ashldi3): Remove CMOVE expansion difference.
	(ashldi3_1): Remove.
	(*ashldi3_1): Rename from *ashldi3_2.  Use reg_or_pm1_operand and
	add constraints for immediates.  New peephole for split-with-temp.
	Run splitter after peep2 pass.
	(ashrdi3, ashrdi3_1, ashrdi3_2): Similarly.
	(lshrdi3, lshrdi3_1, lshrdi3_2): Similarly.
	(setcc_2): Rename with *.
	* config/i386/predicates.md (reg_or_pm1_operand): New.
	(ashldi_input_operand): New.

2004-09-12  Richard Henderson  <rth@redhat.com

	* print-rtl.c (print_decl_name): New.
	(print_mem_expr): Use it.

2004-09-12  Richard Henderson  <rth@redhat.com

	PR 17186, part deux
	* except.c (sjlj_emit_function_exit): Fix logic locating
	sjlj_exit_after in final block.

2004-09-12  Toon Moene  <toon@moene.indiv.nluug.nl>

	* common.opt: Remove flags -fmove-all-movables and
	-freduce-all-givs.
	* loop-invariant.c (find_invariants_to_move):
	Remove all uses of flag_move_all_movables.
	* loop.c (move_movables): Remove all uses of
	flag_move_all_movables.
	(strength_reduce): Remove all uses of
	flag_reduce_all_givs.
	* doc/invoke.texi: Remove documentation of flags
	-fremove-all-movables and -freduce-all-givs.

2004-09-11  Roger Sayle  <roger@eyesopen.com>

	PR middle-end/17411
	* tree-sra.c (generate_element_zero): Revert recent build_int_cst
	change. elt->type may be a floating point type, so use fold_convert.

2004-09-11  Geoffrey Keating  <geoffk@apple.com>

	* config/darwin.c (machopic_validate_stub_or_non_lazy_ptr): Mark
	the thing referenced as used, not the stub itself.

2004-09-11  Joseph S. Myers  <jsm@polyomino.org.uk>

	* c-tree.h (enum c_storage_class): New.
	(struct c_declspecs): Add storage_class, inline_p and thread_p.
	* c-decl.c (shadow_tag_warned): Give errors for "inline" in empty
	declarations and "auto" or "register" in file scope empty
	declarations.  Give more specific warnings for other cases of
	storage class specifiers in empty declarations.
	(grokdeclarator): Update for new structures.  Don't check for
	multiple storage classes.  Diagnose file-scope "register" if
	pedantic.
	(build_null_declspecs): Update.
	(declspecs_add_scspec): Update.  Diagnose multiple storage class
	specifiers and invalid uses of "__thread".

2004-09-11  Zack Weinberg  <zack@codesourcery.com>

	* tree.c (tree_code_size): New function, bulk of code from tree_size.
	(tree_size, make_node): Use it.
	* tree-ssa-pre.c (init_pre): Use it.
	* tree.h: Prototype it.

2004-09-11  Zdenek Dvorak  <rakdver@atrey.karlin.mff.cuni.cz>

	* tree-cfg.c (set_bb_for_stmt): Use PHI_BB.
	* tree-dfa.c (compute_immediate_uses, add_immediate_use,
	redirect_immediate_use): Use PHI_DF.
	* tree-flow-inline.h (stmt_ann): Abort on phi nodes.
	(bb_for_stmt): Use PHI_BB.
	(get_immediate_uses): Use PHI_DF.
	* tree-ssa-dse.c (max_stmt_uid): New variable.
	(get_stmt_uid): New function.
	(dse_optimize_stmt, dse_record_phis, tree_ssa_dse): Do not use phi
	node annotations.
	* tree-ssa-loop-im.c (LIM_DATA): Do not use phi statement annotations.
	(max_uid): Renamed to max_stmt_uid.
	(get_stmt_uid): New function.
	(maybe_queue_var, single_reachable_address, determine_lsm): Do not use
	phi node annotations.
	* tree-ssa.c (replace_immediate_uses): Do not use phi node annotations.
	* tree.h (PHI_BB, PHI_DF): New accessor functions.
	(struct tree_phi_node): Add bb and df fields.

2004-09-11  Richard Henderson  <rth@redhat.com>

	PR middle-end/17416
	* cfgexpand.c (expand_used_vars_for_block): Fix off-by-one bug
	in conflict loop.

2004-09-11  Jan Hubicka  <jh@suse.cz>

	* i386.h (MODE_NEEDED): Calls need UNINITIALIZED mode; add comment.
	(EMIT_MODE_SET): UNINITIALIZED mode needs no set.
	* i386.md (i387_cw): Add 'uninitialized' mode.

	* profile.c (BB_TO_GCOV_INDEX): move more to the front.
	(output_location): Break out from ....
	(branch_prob): ... here; handle gcov output on trees.
	* toplev.c (process_options): No longer be sorry about coverage for
	trees.

2004-09-11  Steven Bosscher  <stevenb@suse.de>

	PR c++/17412
	* fold-const.c (fold): Do not try to fold the operand of a
	CLEANUP_POINT_EXPR if that operand does itself not have any
	operands.

	PR middle-end/17417
	* langhooks.c (lhd_decl_printable_name): Make sure that this
	function is called with is a decl node that has an identifier.
	* tree-pretty-print.c (dump_function_name): New function to
	wrap PRINT_FUNCTION_NAME and dump_decl_name.
	(print_call_name): Use it.

2004-09-11  Mohan Embar  <gnustuff@thisiscool.com>

	* ggc-none.c: Include "bconfig.h" if -DGENERATOR_FILE,
	"config.h" if not.

2004-09-11  Jakub Jelinek  <jakub@redhat.com>

	* tree-ssa-alias.c (collect_points_to_info_r): Handle
	pointing to PTR + OFFSET as PTR, not as pointing to PTR or pointing
	to OFFSET.

2004-09-11  Richard Henderson  <rth@redhat.com>

	* expr.c (expand_expr_addr_expr_1) Rename from expand_expr_addr_expr.
	(expand_expr_addr_expr): New function.  Take ADDR_EXPR instead of the
	operand of the ADDR_EXPR.
	(expand_expr_real_1): Update to match.

2004-09-11  David Edelsohn  <edelsohn@gnu.org>

	PR target/17277
	* config/rs6000/aix.h (MD_FROB_UPDATE_CONTEXT): Use __64BIT__ to
	choose 64-bit version.

2004-09-11  Richard Henderson  <rth@redhat.com>

	PR c/17396
	* c-typeck.c (build_unary_op): Add legacy offsetof hack.

2004-09-11  Kazu Hirata  <kazu@cs.umass.edu>

	* doc/cfg.texi, doc/hostconfig.texi, doc/install.texi,
	doc/invoke.texi, doc/md.texi, doc/tm.texi, doc/tree-ssa.texi:
	Insert @: after i.e. or e.g.

2004-09-10  Geoffrey Keating  <geoffk@apple.com>

	* tree-pretty-print.c (dump_decl_name): Print unnamed decls as
	D.xxx rather than <Dxxx>.

2004-09-10  Adam Nemet  <anemet@lnxw.com>

	* configure.ac (AC_MSG_CHECKING(what linker to use)):
	in_tree_ld_is_elf should be true for LynxOS.
	* configure: Regenerate.

2004-09-10  Adam Nemet  <anemet@lnxw.com>

	* Makefile.in (all.cross): Add srcextra.

2004-09-10  Roger Sayle  <roger@eyesopen.com>

	PR middle-end/17024
	* fold-const.c (fold_cond_expr_with_comparison): Handle unordered
	floating point comparison operators.  Change aborts to gcc_asserts.

2004-09-10  Geoffrey Keating  <geoffk@apple.com>

	* final.c (output_asm_insn): Correct problem with -fverbose-asm.

2004-09-10  James E Wilson  <wilson@specifixinc.com>

	* Makefile.in (LIBGCC_DEPS): Delete duplicate stmp-int-hdrs reference.
	(stmp-fixproto): Change stmp-int-headers to stmp-int-hdrs in comment.

	* convert.c (convert_to_vector): Replace recursive call with
	error_mark_node.

	* emit-rtl.c (gen_const_vector): Renamed from gen_const_vector_0.
	Add integer argument named constant.  Use const_tiny_rtx instead of
	CONST0_RTX.
	(gen_rtx_CONST_VECTOR): Rewrite to handle checks for both CONST0_RTX
	and CONST1_RTX.
	(init_emit_once): Fix users of gen_const_vector.  Set CONST1_RTX for
	vector types.
	* expr.c (const_vector_from_tree): Call gen_rtx_CONST_VECTOR instead
	of gen_rtx_raw_CONST_VECTOR.

2004-09-10  Eric Christopher  <echristo@redhat.com>

	PR c/16046
	* c-parse.in (attribute): Add NULL_TREE for error case
	for error recovery.

2004-09-10  Zack Weinberg  <zack@codesourcery.com>

	* c-common.h (struct c_fileinfo): Comment moved here from cp-tree.h.
	(extract_interface_info): Delete prototype.
	* c-decl.c (extract_interface_info): Delete stub.
	* c-lex.c (get_fileinfo): Initialize file_info_tree here, if
	it's not already been done ...
	(init_c_lex): ... not here.
	(fe_file_change): Don't call extract_interface_info.

2004-09-11  Joseph S. Myers  <jsm@polyomino.org.uk>

	* c-tree.h (struct c_declspecs): Remove typedef_decl.  Add
	typedef_p and typedef_signed_p.
	* c-decl.c (shadow_tag_warned): Check typedef_p, not typedef_decl.
	(grokdeclarator): Don't use typedef_decl for warn_deprecated_use.
	Check typedef_p and typedef_signed_p, not typedef_decl.
	(grokfield): Check typedef_p, not typedef_decl.
	(build_null_declspecs): Initialize typedef_p and typedef_signed_p,
	not typedef_decl.
	(declspecs_add_type): Set typedef_p and typedef_signed_p, not
	typedef_decl.

2004-09-10  Kazu Hirata  <kazu@cs.umass.edu>

	* doc/tm.texi, doc/tree-ssa.texi: Fix typos.

2004-09-10  Geoffrey Keating  <geoffk@apple.com>

	* gimplify.c (create_tmp_var_raw): Don't name otherwise-nameless
	temporary variables.

	* dbxout.c (dbxout_block): Update for
	current_function_func_begin_label a string.
	* dwarf2out.c (dwarf2out_begin_prologue): Likewise.
	* except.c (dw2_output_call_site_table): Likewise.
	* toplev.c (current_function_func_begin_label): Likewise.
	* tree.h (current_function_func_begin_label): Likewise.
	* config/rs6000/linux64.h (DBX_OUTPUT_BRAC): Likewise.

	* final.c (output_asm_insn): Use strtoul instead of atoi, save a
	loop.

	* config/darwin.c: Include target.h.
	(struct machopic_indirection): Make ptr_name a string.
	(machopic_indirection_hash): Update for ptr_name a string.
	(machopic_indirection_eq): Likewise.
	(machopic_indirection_name): Likewise.
	(machopic_output_indirection): Likewise.
	(machopic_validate_stub_or_non_lazy_ptr): Update for ptr_name a
	string.  Don't expect stub names to be in the identifier hash table.
	Do call strip_name_encoding before looking up entry in ID hash table.
	* config/t-darwin (darwin.o): Add target.h to dependencies.

	* gcc/config/rs6000/rs6000.c (print_operand): Use fputs instead
	of fprintf for register names.

	* output.h (unlikely_section_label): Delete declaration.
	(unlikely_text_section_name): Likewise.
	* varasm.c (unlikely_section_label_printed): Make static.
	(unlikely_section_label): Likewise.
	(unlikely_text_section_name): Likewise.
	(assemble_start_function): Use reconcat.

	* rtl.def (REG): Add comment to describe third field.

2004-09-10  Andrew Pinski  <apinski@apple.com>

	* config/darwin.c (machopic_mcount_stub_name): Call
	machopic_indirection_name instead of making the string
	ourselves.

2004-09-10  Diego Novillo  <dnovillo@redhat.com>

	Revert

	2004-09-08  Jie Zhang  <zhangjie@magima.com.cn>

	    * tree-ssa-alias.c (compute_flow_insensitive_aliasing): If type
	    memory tag is call clobbered, so are its aliases.
	    (group_aliases): When two memory tags being grouped, if one is
	    call clobbered, so are the other and its aliases.
	    (add_may_alias): Remove call-clobbering stuff.
	    (replace_may_alias): Likewise.
	    (merge_pointed_to_info): Merge pt_global_mem

2004-09-10  Kazu Hirata  <kazu@cs.umass.edu>

	* bb-reorder.c, c-common.c, c-incpath.c, c-typeck.c,
	genrecog.c, lambda-code.c, mips-tdump.c, mips-tfile.c,
	passes.c, tree-data-ref.c, tree-data-ref.h, tree-mudflap.c,
	tree-scalar-evolution.c, tree-ssa-copyrename.c,
	tree-ssa-live.c, tree-ssa-live.h: Fix comment typos.

2004-09-10  Richard Sandiford  <rsandifo@redhat.com>

	* config/frv/frv.md (UNSPEC_MASACCS, UNSPEC_MDASACCS): New constants.
	(maddaccs, msubaccs, *maddacc): Turn operand 0 into a single ACC/ACCG
	pair.  Remove match_dup from inputs.  Remove masaccs handling.
	(mdaddaccs, mdsubaccs, *mdaddacc): Likewise a dual ACC/ACCG pair.
	(masaccs, mdasaccs): Turn into define_insns.

2004-09-10  Richard Sandiford  <rsandifo@redhat.com>

	* tree-tailcall.c (process_assignment): Only do accumulator transforms
	for floating-point types if flag_unsafe_math_optimizations.

2004-09-10  Kazu Hirata  <kazu@cs.umass.edu>

	* config/darwin.c, config/alpha/alpha.h, config/arm/arm.c,
	config/arm/arm.h, config/arm/arm.md, config/arm/bpabi.h,
	config/arm/predicates.md, config/frv/frv.c, config/frv/frv.md,
	config/h8300/h8300.md, config/i386/gmm_malloc.h,
	config/ia64/ia64.md, config/ip2k/libgcc.S,
	config/mips/mips-ps-3d.md, config/mips/mips.c,
	config/rs6000/rs6000.c, config/s390/s390.c,
	config/sh/symbian.c: Fix comment typos.

2004-09-10  Andreas Krebbel  <krebbel1@de.ibm.com>

	* config/s390/s390.c (s390_emit_prologue): Added missing
	"{}" brackets.

2004-09-10  Kazu Hirata  <kazu@cs.umass.edu>

	* doc/extend.texi, doc/invoke.texi, doc/passes.texi: Fix
	typos.  Follow spelling conventions.

2004-09-10  Joseph S. Myers  <jsm@polyomino.org.uk>

	* toplev.c (warn_deprecated_use): Correct logic for saying "type"
	in diagnostic.  Don't dereference NULL TYPE_NAME.

2004-09-10  Kazu Hirata  <kazu@cs.umass.edu>

	* c-common.c, c-pch.c, defaults.h, lambda-code.c, passes.c,
	tree-data-ref.c, tree-flow.h, tree-ssa-operands.c,
	tree-ssa-threadupdate.c, tree-vectorizer.c, tree-vectorizer.h,
	value-prof.c: Fix comment typos.  Follow spelling conventions.

2004-09-10  Jan Hubicka  <jh@suse.cz>

	* tree-ssa-dce.c (remove_dead_stmt): Update profile.
	* tree-split_edge.c (tree_split_edge): Likewise.
	(thread_jumps): Likewise.

2004-09-10  Kazu Hirata  <kazu@cs.umass.edu>

	* cgraphunit.c, predict.c, tree-ssa-loop-ivopts.c: Fix comment
	typos.

2004-09-10  Paolo Bonzini  <bonzini@gnu.org>

	* cgraph.h (cgraph_dump_file): Do not declare.
	* cgraphunit.c (cgraph_dump_file): Declare as static.
	(init_cgraph): New.
	* toplev.c (cgraph_dump_file): Do not declare.
	(compile_file): Call init_cgraph.
	* tree-dump.c (dump_files): Add IPA dump file, remove
	XML dump of call graph.
	(get_dump_file_name): Support IPA dump file naming scheme.
	* tree.h (enum tree_dump_index): Add IPA dump file, remove
	XML dump of call graph.
	* doc/invoke.texi (Debugging Options): Document the new options.

2004-09-10  Richard Sandiford  <rsandifo@redhat.com>

	* doc/extend.texi: Document the FR-V built-in functions.

2004-09-09  James E Wilson  <wilson@specifixinc.com>

	* doc/sourcebuild.texi: Delete libbanshee reference.

2004-09-10  Kelley Cook  <kcook@gcc.gnu.org>

	* Makefile.in (s-gtype): Add $(build_exeext) to gengtype command.

2004-09-09  James E Wilson  <wilson@specifixinc.com>

	* c-typeck.c (convert_for_assignment): Check that rhs has VECTOR_TYPE
	before calling vector_types_convertible_p.
	(digest_init): Check that inside_init has VECTOR_TYPE before calling
	vector_types_convertible_p.  Don't give another error if
	convert_for_assignment returns error_mark_node.

2004-09-09  Roger Sayle  <roger@eyesopen.com>

	PR middle-end/17055
	* fold-const.c (build_zero_vector): New function to construct a
	vector (either floating point or integer) of zeros.
	(fold_convert): Internally, enable conversions of integer zero
	to arbitrary vector types, using the new build_zero_vector.

2004-09-09  Roger Sayle  <roger@eyesopen.com>

	* config/i386/i386.c (ix86_expand_ashlsi3_const): New function to
	expand a left shift by an immediate constant as either an ashl or
	a sequence of additions.
	(ix86_split_ashldi): Use new ix86_expand_ashlsi3_const function
	instead of calling gen_ashlsi3 with a constant directly.

2004-09-09  Roger Sayle  <roger@eyesopen.com>

	* config/i386/i386.c (ix86_split_long_move): When optimizing for
	size, and the low and high parts of a DImode constant are equal,
	copy one register to another instead of loading the same immediate
	value twice.

2004-09-09  Richard Henderson  <rth@redhat.com>

	PR middle-end/17367
	* function.c (assign_parm_setup_block): Only put PARALLELs into
	a register if use_register_for_decl.

2004-09-09  Eric Christopher  <echristo@redhat.com>

	* ra-colorize.c (reset_lists): Move variable declaration inside
	ENABLE_CHECKING to avoid unused variable warnings when
	not --enable-checking.
	(check_colors): Ditto.

2004-09-09  Mike Stump  <mrs@apple.com>

	* version.c (version_string): Bump to 4.0.0.
	* doc/include/gcc-common.texi (version-GCC): Likewise.

2004-09-10  Jakub Jelinek  <jakub@redhat.com>

	* doc/extend.texi (nothrow attribute): The attribute is not
	implemented in 3.2 and earlier.

2004-09-09  Steve Ellcey  <sje@cup.hp.com>

	* genrecog.c (compute_predicate_codes): Use op0_codes
	instead of codes.

2004-09-09  Ulrich Weigand  <uweigand@de.ibm.com>

	* ra-colorize.c (hardregset_to_string): Adapt to HARD_REG_SET
	implementation changes.

2004-09-09  Ulrich Weigand  <uweigand@de.ibm.com>

	* combine.c (try_combine): When swapping i2 and i3, newi2pat may be
	a PARALLEL instead of a SET due to added clobbers.

2004-09-09  Ulrich Weigand  <uweigand@de.ibm.com>

	* reload.c (find_reloads_address): Pass correct operand to
	maybe_memory_address_p.

2004-09-09  Daniel Berlin  <dberlin@dberlin.org>

	* Makefile.in: Remove libbanshee, tree-alias-*.
	Remove tree-alias-common.h dependencies.
	* common.opt: Remove -ftree-points-to.
	* configure.ac: Remove libbanshee.
	* flags.h: Remove pta_type, flag_tree_points_to.
	* gengtype.c (open_base_files): Remove tree-alias-type.h.
	* opts.c (OPT_ftree_points_to): Remove.
	* toplev.c: Remove tree-alias-common.h, flag_tree_points_to.
	* tree-dfa.c: Remove tree-alias-common.h
	* tree-into-ssa.c: Ditto.
	* tree-outof-ssa.c: Ditto.
	* tree-ssa-copyrename.c: Ditto.
	* tree-ssa-live.c: Ditto.
	* tree-optimize.c: Ditto.
	* tree-ssa.c: Ditto.
	Remove pass_build_pta, pass_del_pta.
	* tree-pass.h: Ditto.
	* tree-ssa-alias.c: Remove tree-alias-common.h.
	(struct alias_stats_d):	Remove pta_queries, pta_resolved.
	(pass_may_alias): Remove PROP_pta requirement.
	(may_alias_p): Remove pta_queries, pta_resolved, use of andersens.
	(get_tmt_for): Ditto.
	(dump_alias_stats): Ditto.
	* doc/passes.texi: Remove blurb about points-to analysis.
	* fortran/Make-lang.in: Remove tree-alias-*.o.

2004-09-09  Richard Sandiford  <rsandifo@redhat.com>

	* genattrtab.c (write_insn_cases): New function, split out from
	write_attr_case.  Correctly handle define_peepholes when printing
	the instruction name.
	(write_attr_case, write_const_num_delay_slots): Use write_insn_cases.

2004-09-09  Hans-Peter Nilsson  <hp@axis.com>

	PR target/17377
	* config/cris/cris-protos.h (cris_return_address_on_stack): Declare.
	* config/cris/cris.c (cris_return_address_on_stack): New function.
	* config/cris/cris.md ("return"): For location of return address,
	also check cris_return_address_on_stack.

2004-09-09  Diego Novillo  <dnovillo@redhat.com>

	* tree-outof-ssa.c (coalesce_abnormal_edges): Fix typo in
	calling phi_ssa_name_p.

2004-09-09  Richard Henderson  <rth@redhat.com>

	PR c/17322
	* c-typeck.c (valid_compound_expr_initializer): Use only
	initializer_constant_valid_p, and not TREE_CONSTANT.
	(digest_init): Likewise.
	(output_init_element): Likewise.

2004-09-09  Giovanni Bajo  <giovannibajo@gcc.gnu.org>

	* ra-build.c (copy_insn_p, remember_move, defuse_overlap_p_1,
	live_out_1, prune_hardregs_for_mode, init_one_web_common,
	reinit_one_web, add_subweb, add_subweb_2, init_web_parts,
	record_conflict, compare_and_free_webs, init_webs_defs_uses,
	parts_to_webs_1, parts_to_webs, reset_conflicts,
	check_conflict_numbers, remember_web_was_spilled, handle_asm_insn,
	ra_build_free): Use gcc_assert and gcc_unreachable instead of abort.
	* ra-colorize.c (push_list, put_web, reset_lists, put_web_at_end,
	put_move, remove_move, combine, select_spill, colorize_one_web,
	try_recolor_web, insert_coalesced_conflicts, check_colors,
	break_precolored_alias, restore_conflicts_from_coalesce,
	sort_and_combine_web_pairs, check_uncoalesced_moves): Likewise.
	* ra-rewrite.c (spill_coalescing, slots_overlap_p, emit_loads,
	reloads_to_loads, rewrite_program2, emit_colors): Likewise.
	* ra.c (first_hard_reg, create_insn_info, find_subweb, init_ra,
	check_df): Likewise.
	* real.c (do_add, do_multiply, do_divide, do_compare, do_fix_trunc,
	real_arithmetic, real_compare, real_exponent, real_ldexp,
	real_identical, real_to_integer, real_to_integer2, real_to_decimal,
	real_to_hexadecimal, real_from_integer, ten_to_ptwo, ten_to_mptwo,
	real_digit, real_nan, real_maxval, round_for_format, real_convert,
	real_to_target, real_from_target, real_hash, encode_ieee_single,
	encode_ieee_double, encode_ieee_extended, encode_ieee_quad,
	encode_vax_f, encode_vax_d, encode_vax_g, encode_i370_single,
	encode_i370_double, encode_c4x_single, encode_c4x_extended): Likewise.
	* recog.c (validate_change, validate_replace_rtx_1, asm_operand_ok,
	extract_insn, peep2_next_insn, peep2_reg_dead_p,
	peep2_find_free_register, peephole2_optimize, store_data_bypass_p,
	if_test_bypass_p): Likewise.
	* reg-stack.c (record_label_references, get_asm_operand_n_inputs,
	stack_result, remove_regno_note, get_hard_regnum, emit_pop_insn,
	emit_swap_insn, swap_to_top, move_for_stack_reg,
	subst_stack_regs_pat, subst_asm_stack_regs, change_stack,
	compensate_edge, convert_regs_1): Likewise.
	* regclass.c (init_reg_sets, init_reg_sets_1,
	memory_move_secondary_cost): Likewise.
	* regrename.c (note_sets, clear_dead_regs, scan_rtx_reg, scan_rtx):
	Likewise.
	* reload.c (push_secondary_reload, find_valid_class, push_reload,
	operands_match_p, decompose, immune_p, find_reloads,
	find_reloads_toplev, find_reloads_address_1, subst_reloads,
	copy_replacements, refers_to_regno_for_reload_p,
	reg_overlap_mentioned_for_reload_p): Likewise.
	* reload1.c (compute_use_by_pseudos, replace_pseudos_in, reload,
	count_pseudo, find_reg, eliminate_regs, eliminate_regs_in_insn,
	verify_initial_elim_offsets, finish_spills, clear_reload_reg_in_use,
	reload_reg_free_p, reload_reg_reaches_end_p, reloads_conflict,
	choose_reload_regs, merge_assigned_reloads, emit_input_reload_insns,
	do_output_reload, fixup_abnormal_edges): Likewise.
	* reorg.c (stop_search_p, emit_delay_sequence, get_jump_flags,
	fill_slots_from_thread, relax_delay_slots): Likewise.
	* resource.c (mark_referenced_resources, mark_set_resources):
	Likewise.
	* rtl.c (copy_rtx, rtx_equal_p): Likewise.
	* rtlanal.c (insn_dependent_p, reg_overlap_mentioned_p,
	dead_or_set_p, find_reg_fusage, remove_note, replace_rtx,
	subreg_lsb_1, subreg_regno_offset, subreg_offset_representable_p,
	find_first_parameter_load, can_hoist_insn_p, hoist_update_store,
	hoist_insn_after, hoist_insn_to_edge, nonzero_bits1): Likewise.
	* rtlhooks.c (gen_lowpart_general): Likewise.
	* sbitmap.c (sbitmap_difference): Likewise.
	* sched-deps.c (add_dependence, sched_analyze_1, sched_analyze_2,
	sched_analyze, add_forward_dependence): Likewise.
	* sched-ebb.c (fix_basic_block_boundaries, schedule_ebb): Likewise.
	* sched-rgn.c (debug_regions, compute_trg_info, schedule_region,
	schedule_insns): Likewise.
	* sched-vis.c (print_pattern): Likewise.
	* sdbout.c (sdbout_symbol, sdbout_toplevel_data): Likewise.
	* simplify-rtx.c (simplify_unary_operation, simplify_binary_operation,
	simplify_const_relational_operation, simplify_ternary_operation,
	simplify_immed_subreg, simplify_subreg, simplify_gen_subreg):
	Likewise.
	* sreal.c (copy, sreal_sub, sreal_div): Likewise.
	* stmt.c (force_label_rtx, expand_goto, expand_asm_operands,
	resolve_operand_name_1, expand_return, expand_decl,
	expand_anon_union_decl, emit_case_bit_tests, expand_case): Likewise.
	* stor-layout.c (put_pending_size, smallest_mode_for_size,
	int_mode_for_mode, layout_decl, finish_builtin_struct, layout_type,
	set_sizetype, get_mode_bounds): Likewise.

2004-09-09  Zack Weinberg  <zack@codesourcery.com>

	* defaults.h (MULTIPLE_SYMBOL_SPACES): Provide default.
	* config/arm/pecoff.h, config/i386/beos-elf.h
	* config/i386/cygming.h, config/i386/i386-interix.h:
	Define MULTIPLE_SYMBOL_SPACES to 1, not nothing.  Remove
	comment cloned from manual.
	* doc/tm.texi: Update description of MULTIPLE_SYMBOL_SPACES.

2004-09-09  Frank Ch. Eigler  <fche@redhat.com>

	* builtins.c (build_va_arg_indirect_ref): New function.
	(std_gimplify_va_arg_expr): Call it instead of mudflap check and
	build_fold_indirect_ref.
	* config/i386/i386.c (ix86_gimplify_va_arg): Ditto.
	* config/ia64/ia64.c (ia64_gimplify_va_arg): Ditto.
	* tree.h: Declare new function.

2004-09-09  Nathan Sidwell  <nathan@codesourcery.com>

	* cgraphunit.c (cgraph_mark_functions_to_output): Renable node
	dumping for development builds.
	* emit-rtl.c (verify_rtx_sharing): Give verbose failure for
	development builds only.
	* genattrtab.c (write_eligible_delay): Fix typo in previous
	commit.
	* tree.c (iterative_hash_expr): Replace gcc_unreachable with
	gcc_assert.

2004-09-09  Nathan Sidwell  <nathan@codesourcery.com>

	* gcse.c (INSN_CUID, insert_set_in_table, find_avail_set,
	cprop_insn, do_local_cprop, local_cprop_pass, find_bypass_set,
	process_insert_insn, insert_insn_end_bb, pre_insert_copy_insn,
	hoist_code, extract_mentioned_regs_helper, compute_store_table,
	insert_store): Use gcc_assert and gcc_unreachable.
	* ggc-common.c (ggc_splay_alloc, ggc_splay_dont_free,
	gt_pch_note_object, gt_pch_note_reorder, relocate_ptrs,
	ggc_record_overhead): Likewise.
	* ggc-page.c (alloc_page, free_page, ggc_set_mark, ggc_marked_p,
	init_ggc, ggc_push_context, ggc_recalculate_in_use_p,
	ggc_pop_context, clear_marks, validate_free_objects,
	ggc_pch_read): Likewise.
	* ggc-zone.c (ggc_allocated_p, free_chunk, ggc_set_mark,
	ggc_marked_p, ggc_get_size, init_ggc, destroy_ggc_zone,
	ggc_push_context, check_cookies, ggc_collect,
	ggc_print_statistics): Likewise.
	* gimple-low.c (lower_function_body, lower_stmt,
	lower_bind_expr): Likewise.
	* gimplify.c (gimple_tree_eq, push_gimplify_context,
	pop_gimplify_context, gimple_pop_condition, create_tmp_var,
	declare_tmp_vars, gimple_add_tmp_var, annotate_all_with_locus,
	mostly_copy_tree_r, gimplify_return_expr, gimplify_switch_expr,
	gimplify_case_label_expr, gimplify_exit_block_expr,
	canonicalize_component_ref, gimplify_compound_lval,
	gimplify_self_mod_expr, gimplify_call_expr,
	gimplify_init_ctor_eval, gimplify_init_constructor,
	gimplify_modify_expr, gimplify_save_expr, gimplify_target_expr,
	gimplify_expr, check_pointer_types_r,
	force_gimple_operand): Likewise.
	* global.c (global_alloc, build_insn_chain): Likewise.
	* graph.c (clean_graph_dump_file,
	finish_graph_dump_file): Likewise.
	gcov-io.c (gcov_open): Use GCOV_CHECK.

2004-09-09  Richard Sandiford  <rsandifo@redhat.com>

	* config/frv/frv.c (acc_operand, accg_operand): Use REGNO.

2004-09-09  Jan Hubicka  <jh@suse.cz>

	middle-end/17128
	* tree-inline.c (expand_call_inline): Make overactive sanity check
	happy.

2004-09-09  Jan Hubicka  <jh@suse.cz>

	* tree-ssa-loop-ivopts.c (peel_address): Fix abort on
	VIEW_CONVERT_EXPR.

2004-09-09  Nathan Sidwell  <nathan@codesourcery.com>

	* Makefile.in (gengtype): Use $(BUILD_ERRORS).
	(gengtype.o): Depend on errors.h.
	* genattrtab.c (strcmp_check): Use gcc_assert and gcc_unreachable.
	(attr_rtx_1, attr_printf, attr_copy_rtx, evaluate_eq_attr,
	attr_alt_subset_p, attr_alt_subset_of_compl_p,
	attr_alt_intersection, attr_alt_union, optimize_attrs, gen_insn,
	write_test_expr, write_attr_value, write_eligible_delay,
	make_internal_attr, make_numeric_value): Likewise.
	* genautomata.c (regexp_name, get_str_vect,
	gen_presence_absence_set, automaton_decl_hash,
	automaton_decl_eq_p, insn_decl_hash, insn_decl_eq_p, decl_hash,
	decl_eq_p, process_regexp, loop_in_regexp, check_loops_in_regexps,
	process_regexp_cycles, reserv_sets_cmp, set_unit_reserv,
	test_unit_reserv, it_is_empty_reserv_sets,
	reserv_sets_are_intersected, reserv_sets_shift, reserv_sets_or,
	reserv_sets_and, output_cycle_reservs, get_free_state,
	intersected_state_reservs_p, states_union, remove_arc,
	copy_insn_regexp, transform_1, transform_2, transform_3,
	regexp_transform_func, store_alt_unit_usage,
	check_regexp_units_distribution, process_seq_for_forming_states,
	process_alts_for_forming_states, make_automaton,
	form_arcs_marked_by_insn, create_composed_state,
	set_out_arc_insns_equiv_num, partition_equiv_class,
	process_insn_equiv_class, set_insn_equiv_classes,
	units_to_automata_heuristic_distr, form_regexp,
	longest_path_length, output_dfa_max_issue_rate, add_vect,
	out_state_arcs_num, add_vect_el, output_trans_table,
	output_state_alts_table, output_dead_lock_vect,
	output_max_insn_queue_index_def,
	output_min_insn_conflict_delay_func,
	output_internal_insn_latency_func, output_print_reservation_func,
	output_cpu_unit_reservation_p, output_state_arcs,
	make_insn_alts_attr, make_internal_dfa_insn_code_attr,
	make_default_insn_latency_attr,
	form_important_insn_automata_lists): Likewise.
	* genemit.c (gen_exp, output_add_clobbers,
	output_added_clobbers_hard_reg_p): Likewise.
	* genextract.c (print_path, main): Likewise.
	* genflags.c (gen_macro): Likewise.
	* gengenrtl.c: Include errors.h
	(type_from_format, accessor_from_format): Likewise.
	* gengtype.c (get_file_basename, output_mangled_typename,
	walk_type, write_types_process_field,
	write_types_local_process_field): Likewise.
	* genmodes.c (complete_mode): Likewise.
	* genopinit.c (gen_insn): Likewise.
	* genoutput.c (output_insn_data, check_constraint_len,
	constraint_len): Likewise.
	* genpreds.c (add_mode_tests):Likewise.
	* gen-protos.c (add_hash): Likewise.
	* genrecog.c (find_operand, find_matching_operand,
	validate_pattern, add_to_sequence, maybe_both_true,
	nodes_identical_1, merge_trees, write_switch, write_cond,
	write_action, is_unconditional, make_insn_sequence,
	debug_decision_2): Likewise.
	* gensupport.c (is_predicable, collect_insn_data,
	alter_predicate_for_insn, maybe_eval_c_test): Likewise.

2004-09-09  Jan Hubicka  <jh@suse.cz>

	* basic-block.h (guess_outgoing_edge_probabilities): Declare.
	* cfgbuild.c (compute_outgoing_frequencies): When probability is
	missing, guess it.
	(find_many_sub_basic_blocks): Do update profile only when it is
	present.
	* predict.c (set_even_probabilities): Break out from ...
	(combine_predictions_for_insn): ... here; deal with
	!can_predict_insn_p insns.
	(combine_predictions_for_bb): Use set_even_probabilities.
	(bb_estimate_probability_locally): Break out from ....
	(estimate_probability): ... here.
	(guess_outgoing_edge_probabilities): New entry point.

2004-09-09  Nathan Sidwell  <nathan@codesourcery.com>

	* gcc.c (add_sysrooted_prefix, execute, do_self_spec, do_spec_1,
	handle_braces, process_brace_body, main, used_arg,
	set_multilib_dir, print_multilib_info): Use fatal, not abort.

	* tree-nested.c (create_tmp_var_for): Correct missinverted assert.

	* tree-outof-ssa.c (free_temp_expr_table): Add missed assert.
	* tree-ssa-ccp.c (set_lattice_value): Correct missapplied de
	Morgan's theorem in last checkin.

2004-09-09  Giovanni Bajo  <giovannibajo@gcc.gnu.org>
	    Nathan Sidwell  <nathan@codesourcery.com>

	* targhooks.c (default_unwind_emit, default_scalar_mode_supported_p):
	Use gcc_assert, gcc_unreachable & internal_error instead of abort.
	* timevar.c (timevar_push, timevar_pop, timevar_start,
	timevar_stop): Likewise.
	* toplev.c (default_pch_valid_p): Likewise.
	* tracer.c (tail_duplicate): Likewise.
	* tree-alias-common.c (get_alias_var_decl,
	get_values_from_constructor, create_alias_var, delete_alias_vars,
	empty_points_to_set, same_points_to_set, ptr_may_alias_var):
	Likewise.
	* tree.c (tree_size, make_node_stat, copy_node_stat,
	build_int_cst_wide, integer_all_onesp, list_length, chainon,
	tree_node_structure, type_contains_placeholder_p, substitute_in_expr,
	substitute_placeholder_in_expr, tabilize_reference_1, build0_stat,
	build1_stat, build2_stat, build3_stat, build4_stat, is_attribute_p,
	lookup_attribute, type_hash_canon, host_integerp, iterative_hash_expr,
	build_method_type_directly, decl_type_context, get_callee_fndecl,
	get_set_constructor_bits, build_vector_type_for_mode, int_cst_value,
	tree_fold_gcd): Likewise.
	* tree-cfg.c (create_bb, make_ctrl_stmt_edges, make_exit_edges,
	make_cond_expr_edges, group_case_labels, tree_merge_blocks,
	cleanup_control_expr_graph, find_taken_edge,
	find_taken_edge_switch_expr, phi_alternatives_equal,
	is_ctrl_altering_stmt, disband_implicit_edges, set_bb_for_stmt,
	stmt_for_bsi, tree_find_edge_insert_loc, bsi_insert_on_edge_immediate,
	tree_split_edge, tree_verify_flow_info, thread_jumps,
	tree_redirect_edge_and_branch, tree_flow_call_edges_add): Likewise.
	* tree-chrec.c (chrec_fold_poly_cst, chrec_fold_plus_poly_poly,
	chrec_fold_multiply_poly_poly): Likewise.
	* tree-complex.c (extract_component, expand_complex_division,
	expand_complex_comparison, expand_complex_operations_1,
	build_replicated_const, expand_vector_operations_1): Likewise.
	* tree-data-ref.c (tree_fold_bezout, build_classic_dist_vector,
	build_classic_dir_vector): Likewise.
	* tree-dfa.c (compute_immediate_uses_for_phi,
	compute_immediate_uses_for_stmt, create_var_ann, create_stmt_ann,
	create_tree_ann, collect_dfa_stats, get_virtual_var): Likewise.
	* tree-dump.c (dequeue_and_dump): Likewise.
	* tree-eh.c (record_stmt_eh_region, add_stmt_to_eh_region,
	record_in_finally_tree, replace_goto_queue_1,
	maybe_record_in_goto_queue, verify_norecord_switch_expr,
	do_return_redirection): Likewise.
	* tree-if-conv.c (tree_if_convert_stmt, tree_if_convert_cond_expr,
	add_to_dst_predicate_list, find_phi_replacement_condition,
	replace_phi_with_cond_modify_expr, get_loop_body_in_if_conv_order):
	Likewise.
	* tree-inline.c (remap_decl, remap_type, remap_decls, copy_body_r,
	initialize_inlined_parameters, declare_return_variable,
	estimate_num_insns_1, expand_call_inline, expand_calls_inline,
	optimize_inline_calls, copy_tree_r): Likewise.
	* tree-into-ssa.c (rewrite_initialize_block_local_data, rewrite_stmt,
	ssa_rewrite_stmt, rewrite_into_ssa): Likewise.
	* tree-iterator.c (alloc_stmt_list, tsi_link_before, tsi_link_after,
	tsi_split_statement_list_after, tsi_split_statement_list_before):
	Likewise.
	* tree-mudflap.c (mf_varname_tree): Likewise.
	* tree-nested.c (create_tmp_var_for, lookup_field_for_decl,
	lookup_tramp_for_decl, convert_all_function_calls): Likewise.
	* tree-optimize.c (tree_rest_of_compilation): Likewise.
	* tree-outof-ssa.c (create_temp, eliminate_build, eliminate_phi,
	coalesce_abnormal_edges, coalesce_ssa_name, eliminate_virtual_phis,
	free_temp_expr_table, add_dependance, finish_expr, rewrite_trees):
	Likewise.
	* tree-phinodes.c (resize_phi_node, add_phi_arg,
	remove_all_phi_nodes_for): Likewise.
	* tree-pretty-print.c (op_prio, print_call_name): Likewise.
	* tree-profile.c (tree_gen_interval_profiler, tree_gen_pow2_profiler,
	tree_gen_one_value_profiler, tree_gen_const_delta_profiler): Likewise.
	* tree-sra.c (type_can_instantiate_all_elements, sra_hash_tree,
	sra_elt_eq, sra_walk_expr, instantiate_missing_elements,
	generate_one_element_ref, generate_element_copy,
	generate_element_zero, scalarize_copy, scalarize_init,
	scalarize_ldst): Likewise.
	* tree-ssa-alias.c (delete_alias_info, group_aliases, may_alias_p,
	add_may_alias, add_pointed_to_expr, add_pointed_to_var,
	collect_points_to_info_r, get_tmt_for, get_ptr_info): Likewise.
	* tree-ssa.c (walk_use_def_chains, check_phi_redundancy): Likewise.
	* tree-ssa-ccp.c (dump_lattice_value, get_default_value, get_value,
	set_lattice_value, likely_value, ccp_visit_phi_node, visit_assignment,
	widen_bitfield, ccp_fold_builtin): Likewise.
	* tree-ssa-copy.c (may_propagate_copy, merge_alias_info,
	replace_exp_1, propagate_tree_value): Likewise.
	* tree-ssa-copyrename.c (copy_rename_partition_coalesce): Likewise.
	* tree-ssa-dce.c (set_control_dependence_map_bit,
	find_control_dependence, find_pdom, mark_operand_necessary,
	mark_stmt_if_obviously_necessary,
	mark_control_dependent_edges_necessary, remove_dead_stmt): Likewise.
	* tree-ssa-dom.c (dom_opt_initialize_block_local_data,
	simplify_switch_and_lookup_avail_expr, cprop_into_successor_phis,
	eliminate_redundant_computations, avail_expr_eq): Likewise.
	* tree-ssa-dse.c (fix_stmt_v_may_defs): Likewise.
	* tree-ssa-loop-ch.c (should_duplicate_loop_header_p,
	duplicate_blocks): Likewise.
	* tree-ssa-loop-im.c (for_each_index, set_level,
	is_call_clobbered_ref): Likewise.
	* tree-ssa-loop-ivopts.c (dump_use, divide, stmt_after_ip_normal_pos,
	stmt_after_increment, set_iv, contains_abnormal_ssa_name_p,
	find_interesting_uses_outer_or_nonlin, add_derived_ivs_candidates,
	peel_address, ptr_difference_cost, may_replace_final_value,
	determine_use_iv_cost, rewrite_use_nonlinear_expr, rewrite_use_outer,
	rewrite_use, rewrite_uses): Likewise.
	* tree-ssa-loop-manip.c (rewrite_into_loop_closed_ssa,
	check_loop_closed_ssa_use): Likewise.
	* tree-ssanames.c (make_ssa_name): Likewise.
	* tree-ssa-operands.c (finalize_ssa_defs, finalize_ssa_uses,
	finalize_ssa_v_must_defs, finalize_ssa_stmt_operands,
	get_stmt_operands, get_expr_operands, get_asm_expr_operands,
	get_indirect_ref_operands, add_stmt_operand): Likewise.
	* tree-ssa-pre.c (value_exists_in_set_bitmap,
	value_remove_from_set_bitmap, bitmap_insert_into_set, insert_into_set,
	phi_translate, valid_in_set, compute_antic,
	find_or_generate_expression, create_expression_by_pieces, insert_aux,
	create_value_expr_from, eliminate): Likewise.
	* tree-ssa-propagate.c (cfg_blocks_get): Likewise.
	* tree-ssa-threadupdate.c (remove_last_stmt_and_useless_edges):
	Likewise.
	* tree-tailcall.c (independent_of_stmt_p, adjust_return_value,
	eliminate_tail_call): Likewise.
	* tree-vectorizer.c (vect_create_index_for_array_ref,
	vect_align_data_ref, vect_create_data_ref,
	vect_create_destination_var, vect_get_vec_def_for_operand,
	vect_finish_stmt_generation, vect_transform_stmt,
	vect_transform_loop_bound, vect_transform_loop,
	vect_analyze_operations): Likewise.
	* tree-vn.c (vn_compute, set_value_handle, get_value_handle):
	Likewise.
	* tree-flow-inline.h (var_ann, get_var_ann, get_def_from_ptr,
	get_use_op_ptr, immediate_use, phi_ssa_name_p, bsi_start,
	bsi_after_labels, bsi_last): Likewise.
	* tree-ssa-live.c (var_union, change_partition_var,
	create_ssa_var_map, calculate_live_on_entry, root_var_init,
	type_var_init, add_coalesce, sort_coalesce_list, pop_best_coalesce):
	Likewise.
	* tree-ssa-live.h (partition_is_global, live_entry_blocks,
	tpa_find_tree): Likewise.
	(register_ssa_partition_check): Declare.
	(register_ssa_partition): use it.
	* tree-ssa-live.c: Include errors.h.
	(register_ssa_partition_check): New.
	* tree-ssa-operands.c: Include errors.h.
	* Makefile.in (tree-ssa-operands.o): Depend on errors.h.

2004-09-09  Richard Sandiford  <rsandifo@redhat.com>
	    Catherine Moore  <clm@redhat.com>

	* config/frv/frv-protos.h (FRV_CPU_FR550, FRV_CPU_FR450)
	(FRV_CPU_FR405): New processor enums.
	(frv_issue_rate, frv_acc_group): Declare.
	* config/frv/frv.h (CPP_SPEC, CPP_FRV_SPEC, CPP_FR500_SPEC): Delete.
	(CPP_FR400_SPEC, CPP_SIMPLE_SPEC): Delete.
	(MASK_DEFAULT_FR550, MASK_DEFAULT_FR450): New macros.
	(SUBTARGET_EXTRA_SPECS, EXTRA_SPECS, CPP_CPU_DEFAULT_SPEC): Delete.
	(TARGET_CPU_CPP_BUILTINS): Define the macros that were previously
	handled by CPP_SPEC.
	(MASK_LONG_CALLS, TARGET_LONG_CALLS): New macros.
	(MASK_ALIGN_LABELS, TARGET_ALIGN_LABELS): New macros.
	(ACC_MASK): New macro.
	(TARGET_MEDIA_REV2): Include FRV_CPU_{FR405,FR450,FR550}.
	(TARGET_MEDIA_FR450): New macro.
	(TARGET_FR500_FR550_BUILTINS, TARGET_FR405_BUILTINS): New macros.
	(TARGET_SWITCHES): Add -m{no-,}align-labels and -m{no-,}long-calls.
	(LABEL_ALIGN_AFTER_BARRIER): Define.
	(ACC_LAST, ACCG_LAST): Add four new accumulator registers.
	(IACC_FIRST, IACC_LAST): New pair of SPRs.
	(ACCG_FIRST, AP_FIRST, SPR_FIRST, SPR_LAST): Adjust accordingly.
	(FIXED_REGISTERS, CALL_USED_REGISTERS, REG_ALLOC_ORDER)
	(REGISTER_NAMES): Add entries for new registers.
	(REG_CLASS_CONTENTS): Update for new register ranges.
	(EXTRA_CONSTRAINT_FOR_S): Redefine in terms of call_operand.
	(ISSUE_RATE, CLEAR_VLIW_START, SET_VLIW_START): Delete.
	(PACKING_FLAG_USED_P): Delete.
	(FRV_BUILTIN_MQLCLRHS, FRV_BUILTIN_MQLMTHS, FRV_BUILTIN_MQSLLHI)
	(FRV_BUILTIN_MQSRAHI, FRV_BUILTIN_SMUL, FRV_BUILTIN_UMUL)
	(FRV_BUILTIN_PREFETCH0, FRV_BUILTIN_PREFETCH, FRV_BUILTIN_SMASS)
	(FRV_BUILTIN_SMSSS, FRV_BUILTIN_SMU, FRV_BUILTIN_SCUTSS)
	(FRV_BUILTIN_ADDSS, FRV_BUILTIN_SUBSS, FRV_BUILTIN_SLASS)
	(FRV_BUILTIN_IACCread{l,ll}, FRV_BUILTIN_IACCset{ll,l})
	(FRV_BUILTIN_SCAN): New members of frv_builtin_enum.
	(FRV_BUILTIN_FIRST_NONMEDIA): New macro.
	(CPU_UNITS_QUERY): Define to 1.
	* config/frv/frv.c: Include gt-frv.h
	(NUM_NOP_PATTERNS, NTH_UNIT, UNIT_NUMBER, PACKING_FLAG_P): New macros.
	(SET_PACKING_FLAG, CLEAR_PACKING_FLAG, FOR_EACH_REGNO): New macros.
	(frv_insn_group): New enumeration.
	(frv_unit_names, frv_unit_groups, frv_unit_codes): New variables.
	(frv_type_to_unit, frv_nops, frv_num_nops): New variables.
	(REGSTATE_DEAD, REGSTATE_LIVE, REGSTATE_UNUSED, REGSTATE_MASK)
	(REGSTATE_CONDJUMP): Delete.  Shuffle other numbers to cover the
	gap left by REGSTATE_LIVE.
	(regstate_t): New typedef.
	(TARGET_MACHINE_DEPENDENT_REORG): Define.
	(frv_default_flags_for_cpu): Handle FRV_CPU_{FR550,FR450,FR405}.
	(frv_override_options): Check for -mcpu={fr550,fr450,fr405}.
	Initialize frv_unit_codes[] and frv_type_to_unit[].
	(frv_conditional_register_usage): Remove redundant fixing of
	accumulator registers.
	(frv_insn_packing_flag): Update specification.
	(frv_function_prologue): Don't set frv_insn_packing_flag here.
	Zero out frv_nops[].
	(frv_expand_epilogue): Remove comments about the no-longer-present
	SIBCALL_P argument.
	(frv_asm_output_mi_thunk): Check frv_issue_rate() rather than
	PACKING_FLAG_USED_P() when deciding whether to pack instructions.
	(frv_asm_output_opcode, frv_final_prescan_insn): Simplify in light
	of the new meaning of frv_insn_packing_flag.  Emit an mnop.p if
	packing is disabled and if INSN can only issue to M1.
	(call_operand): Check TARGET_LONG_CALLS.
	(acc_operand, even_acc_operand, quad_acc_operand)
	(accg_operand): Simplify.  Don't accept pseudo registers.
	(output_move_single): Handle SPR<-zero moves.
	(frv_issue_rate): Make non-static.  Handle FRV_CPU_{FR550,FR450,FR405}.
	(frv_registers_update, frv_registers_used_p): Delete.
	(frv_registers_set_p): Delete.
	(frv_acc_group_1, frv_acc_group, frv_insn_unit): New functions.
	(frv_issues_to_branch_unit_p): New function.
	(frv_packet): New structure.
	(frv_cond_flags, frv_regstate_conflict_p): New functions.
	(frv_registers_conflict_p_1, frv_registers_conflict_p): New functions.
	(frv_registers_update_1, frv_registers_update): New functions.
	(frv_start_packet, frv_start_packet_block, frv_finish_packet)
	(frv_pack_insn_p, frv_add_insn_to_packet, frv_insert_nop_in_packet)
	(frv_for_each_packet, frv_sort_insn_group_1, frv_compare_insns)
	(frv_sort_insn_group, frv_reorder_packet): New functions.
	(frv_pack_insns): Use frv_reorder_packet.
	(frv_packet_address): New variable.
	(frv_fill_unused_units, frv_align_label, frv_reorg_packet)
	(frv_register_nop, frv_reorg): New functions.
	(bdesc_1arg): Add __SCUTSS.
	(bdesc_2arg): Add __MQLCLRHS, __MQLMTHS, __SMUL, __UMUL, __ADDSS,
	__SUBSS, __SLASS and __SCAN.
	(bdesc_2argimm): Add __MQSLLHI and __MQSRAHI.
	(bdesc_int_void2arg, bdesc_prefetches): New arrays.
	(frv_init_builtins): Register the above builtins.
	(frv_int_to_acc): Use ACC_MASK to check for valid accumulator
	registers.  Turn the referenced accumulators into global registers.
	(frv_read_iacc_argument): New function.
	(frv_expand_int_void2arg, frv_expand_prefetches): New functions.
	(frv_split_iacc_move): New function.
	(frv_expand_builtin): Handle the new builtins.
	* config/frv/frv.md: Replace old schedulers with new order-independent
	ones.  Add schedulers for the FR405, FR450 and FR550.  Describe new
	packing algorithm.
	(cpu): Add fr550, fr450 and fr405.
	(type): Add macc, scan, cut, fnop, fscmp, fdcmp, mnop, mqlimh and
	mqshift.  Replace fmas with fsmadd and fmad with fdmadd.  Delete m7.
	(*muladd[sd]f4, *mulsub[sd]f4): Fix types.
	(*cmp[sd]f_cc_fp): Use new f[sd]cmp types.
	(fnop, mnop): New patterns.
	(UNSPEC_MQLCLRHS, UNSPEC_MQLMTHS, UNSPEC_MQSLLHI, UNSPEC_MQSRAHI):
	New constants.
	(mexpdhw, *cond_exec_mexpdhw): Fix destination operands.
	(mclracca8): Use ACC_MASK to determine the upper set of accumulator
	registers.
	(mqlclrhs, mqlmths, mqsllhi, mqsrahi): New patterns.
	(UNSPEC_SMUL, UNSPEC_UMUL, UNSPEC_SMU, UNSPEC_ADDSS, UNSPEC_SUBSS)
	(UNSPEC_SLASS, UNSPEC_SCAN, UNSPEC_INTSS, UNSPEC_SCUTSS)
	(UNSPEC_PREFETCH0, UNSPEC_PREFETCH, UNSPEC_IACCreadll)
	(UNSPEC_IACCreadl, UNSPEC_IACCsetll, UNSPEC_IACCsetl, UNSPEC_SMASS)
	(UNSPEC_SMSSS, UNSPEC_IMUL, IACC0_REG): New constants.
	(smul, umul, smass, smsss, smu, addss, subss, slass, scan, scutss)
	(frv_prefetch0, frv_prefetch): New patterns.
	* config/frv/t-frv (MULTILIB_OPTIONS): Remove -mcpu=frv and
	-mcpu=simple.  Add -mcpu=fr550.
	(MULTILIB_DIRNAMES): Update accordingly.
	(MULTILIB_MATCHES): Use the fr400 multilibs for -mcpu=fr405 and
	-mcpu=fr450.
	* doc/invoke.texi: Document the new -mcpu={fr550,fr450,fr405},
	-mlong-calls and -malign-labels options for FR-V.

2004-09-09  Joseph S. Myers  <jsm@polyomino.org.uk>

	PR c/8420
	* c-tree.h (struct c_declspecs): New.
	(struct c_declarator, struct c_type_name, struct c_parm): Update
	element types.
	(build_array_declarator, grokfield, shadow_tag, shadow_tag_warned,
	start_function, start_decl, build_c_parm,
	make_pointer_declarator): Update prototypes.
	(build_null_declspecs, declspecs_add_qual, declspecs_add_type,
	declspecs_add_scspec, declspecs_add_attrs): New.
	(split_specs_attrs): Remove.
	* c-parse.in (%union): Add dsptype.
	(declspecs_nosc_nots_nosa_noea, declspecs_nosc_nots_nosa_ea,
	declspecs_nosc_nots_sa_noea, declspecs_nosc_nots_sa_ea,
	declspecs_nosc_ts_nosa_noea, declspecs_nosc_ts_nosa_ea,
	declspecs_nosc_ts_sa_noea, declspecs_nosc_ts_sa_ea,
	declspecs_sc_nots_nosa_noea, declspecs_sc_nots_nosa_ea,
	declspecs_sc_nots_sa_noea, declspecs_sc_nots_sa_ea,
	declspecs_sc_ts_nosa_noea, declspecs_sc_ts_nosa_ea,
	declspecs_sc_ts_sa_noea, declspecs_sc_ts_sa_ea, declspecs_ts,
	declspecs_nots, declspecs_ts_nosa, declspecs_nots_nosa,
	declspecs_nosc_ts, declspecs_nosc_nots, declspecs_nosc, declspecs,
	maybe_type_quals_attrs): Change to dsptype.
	(struct c_declspec_stack): New.
	(current_declspecs, declspec_stack): Change type.
	(PUSH_DECLSPEC_STACK, POP_DECLSPEC_STACK): Update to new
	structures.
	(extdefs): Likewise.
	(setspecs): Likewise.
	(fndef): Use current_declspecs for empty declspecs list.
	(declspecs_nosc_nots_nosa_noea, declspecs_nosc_nots_nosa_ea,
	declspecs_nosc_nots_sa_noea, declspecs_nosc_nots_sa_ea,
	declspecs_nosc_ts_nosa_noea, declspecs_nosc_ts_nosa_ea,
	declspecs_nosc_ts_sa_noea, declspecs_nosc_ts_sa_ea,
	declspecs_sc_nots_nosa_noea, declspecs_sc_nots_nosa_ea,
	declspecs_sc_nots_sa_noea, declspecs_sc_nots_sa_ea,
	declspecs_sc_ts_nosa_noea, declspecs_sc_ts_nosa_ea,
	declspecs_sc_ts_sa_noea, declspecs_sc_ts_sa_ea): Update to new
	structures and helper functions.  Update comments.
	(typespec_nonattr): Correct comment.
	(maybe_type_quals_attrs, typename): Update to new structures.
	* c-decl.c (grokdeclarator, build_array_declarator, grokfield,
	shadow_tag, shadow_tag_warned, start_function, start_decl,
	build_c_parm, make_pointer_declarator,
	set_array_declarator_inner, groktypename): Update to new
	structures.
	(build_null_declspecs, declspecs_add_qual, declspecs_add_type,
	declspecs_add_scspec, declspecs_add_attrs): New.
	(split_specs_attrs): Remove.
	(shadow_tag_warned): Make warning for useless type names a
	pedwarn.  Give hard error for long, short, signed, unsigned or
	_Complex used with struct, union or enum in empty declaration.
	Make found_tag a bool.
	(grokdeclarator): Remove checks now done at parse time.

2004-09-09  Joseph S. Myers  <jsm@polyomino.org.uk>

	* c-tree.h (enum c_declarator_kind, struct c_arg_info, struct
	c_declarator, struct c_type_name, struct c_parm): New.
	(build_array_declarator, set_array_declarator_inner,
	get_parm_info, grokfield, groktypename, grokparm, push_parm_decl,
	start_function, start_decl, build_c_parm, build_attrs_declarator,
	build_function_declarator, make_pointer_declarator, c_cast_expr,
	store_parm_decls_newstyle, c_expr_sizeof_type): Update prototypes.
	(build_id_declarator): New.
	* c-typeck.c (c_cast_expr, c_expr_sizeof_type): Update to new
	structures.
	* c-decl.c (ARG_INFO_PARMS, ARG_INFO_TAGS, ARG_INFO_TYPES,
	ARG_INFO_OTHERS): Remove.
	(build_id_declarator): New.
	(build_array_declarator, set_array_declarator_inner, groktypename,
	start_decl, grokparm, push_parm_decl, grokparms, get_parm_info,
	grokfield, start_function, store_parm_decls_newstyle,
	store_parm_decls_oldstyle, store_parm_decls,
	build_c_parm, build_attrs_declarator, build_function_declarator,
	make_pointer_declarator, grokdeclarator): Update to new
	structures.
	* c-parse.in (%union): Add arginfotype, dtrtype, typenametype and
	parmtype.
	(declarator, notype_declarator, after_type_declarator,
	parm_declarator, parm_declarator_starttypename,
	parm_declarator_nostarttypename, array_declarator, typename,
	absdcl, absdcl1, absdcl1_ea, absdcl1_noea, direct_absdcl1,
	absdcl_maybe_attribute, parm, firstparm, parms, parmlist,
	parmlist_1, parmlist_2, parmlist_or_identifiers,
	parmlist_or_identifiers_1): Use these types.
	(primary, after_type_declarator, parm_declarator_starttypename,
	notype_declarator, component_decl, component_declarator,
	component_notype_declarator, typename, absdcl,
	absdcl_maybe_attribute, absdcl1_ea, direct_absdcl1, parmlist_1,
	parmlist_2, parmlist_or_identifiers_1): Update to new structures.

2004-09-09  Joseph S. Myers  <jsm@polyomino.org.uk>

	* c-tree.h (C_DECL_USED, parser_obstack, in_alignof, in_sizeof,
	in_typeof, record_maybe_used_decl, pop_maybe_used,
	c_expr_sizeof_expr, c_expr_sizeof_type): New.
	* c-decl.c (parser_obstack): New.
	(c_init_decl_processing): Initialize parser_obstack.
	(c_write_global_declarations_1): Check for used but undefined
	static functions.
	* c-parse.in (%union): Add otype.
	(save_obstack_position): New.
	(extdefs): Use it.
	(unary_expr): Update in_sizeof and in_alignof.  Use
	c_expr_sizeof_expr and c_expr_sizeof_type.
	(sizeof): Update in_sizeof.
	(alignof): Update in_alignof.
	(typeof): Update in_typeof.
	(typespec_nonreserved_nonattr): Call pop_maybe_used.
	* c-typeck.c (in_alignof, in_sizeof, in_typeof, struct
	maybe_used_decl, maybe_used_decls, record_maybe_used_decl,
	pop_maybe_used, c_expr_sizeof_expr, c_expr_sizeof_type): New.
	(build_external_ref): Set C_DECL_USED or call
	record_maybe_used_decl if appropriate.
	* toplev.c (check_global_declarations): Check TREE_NO_WARNING.

2004-09-08  Eric Christopher  <echristo@redhat.com>

	* builtins.c: Fix prototype for fold_builtin_atan.

2004-09-08  Eric Christopher  <echristo@redhat.com>

	* builtins.c (fold_builtin_strlen, fold_builtin_sqrt, fold_builtin_cbrt,
	fold_builtin_pow, fold_builtin_sin, fold_builtin_cos, fold_builtin_tan,
	fold_builtin_atan): New functions. Migrate function bodies...
	(fold_builtin_1): ... from here.

2004-09-09  Alan Modra  <amodra@bigpond.net.au>

	* config/rs6000/rs6000.c (rs6000_stack_info): Correct alignment of
	save_size.

2004-09-08  David Edelsohn  <edelsohn@gnu.org>

	* config/rs6000/power4.md (power4-lmul): du4 feeds iu1.
	* config/rs6000/power5.md (power5-lmul): Same.

2004-09-08  Richard Henderson  <rth@redhat.com>

	PR rtl-opt/17186
	* function.c (expand_function_end): Have fall-off-the-end
	return path jump around return register setup.

2004-09-08  Eric Botcazou  <ebotcazou@libertysurf.fr>

	* config/sparc/sparc.c (sparc_indent_opcode): New variable.
	(output_return): Do not test for the presence of the 'unimp' insn.
	Use 'current_function_uses_only_leaf_regs' and 'final_sequence'
	as predicates instead of custom ones.  Return raw strings when
	possible.
	(output_sibcall): Likewise.  Concatenate strings.
	(output_ubranch): Remove kludge for TurboSPARC.
	(output_cbranch): Remove 'noop' parameter.  Do not output 'nop'.
	(output_v9branch): Likewise.
	(print_operand): Use 'final_sequence' instead of 'dbr_sequence_length'.
	<#>: Set sparc_indent_opcode if the delay slot is filled.
	<(>: Likewise.
	<)>: New operand to emit the displacement from the saved PC on return.
	<@>: Remove.
	* config/sparc/sparc.h (sparc_indent_opcode): Declare it.
	(ASM_OUTPUT_OPCODE): New macro.
	(PRINT_OPERAND_PUNCT_VALID_P): Remove '^' and add ')'.
	* config/sparc/sparc.md (normal_branch, inverted_branch,
	normal_fp_branch, inverted_fp_branch, normal_fpe_branch,
	inverted_fpe_branch): Adjust call to output_cbranch.
	(normal_int_branch_sp64, inverted_int_branch_sp64): Adjust
	call to output_v9branch.
	* config/sparc/sparc-protos.h (output_cbranch): Adjust.
	(output_v9branch): Likewise.

2004-09-08  Devang Patel  <dpatel@apple.com>

	* config/darwin.h  (TARGET_OPTION_TRANSLATE_TABLE): Add -segaddr,
	-segs_read_only_addr and -segs_read_write_addr.
	(WORD_SWITCH_TAKES_ARG): Same.
	(LINK_SPEC): Same.
	* doc/invoke.texi: Document -segaddr, -segs_read_only_addr and
	-segs_read_write_addr.

2004-09-08  Richard Henderson  <rth@redhat.com>

	* function.c (reference_callee_copied): New.
	(assign_parm_setup_reg): Use it.
	* calls.c (initialize_argument_information): Likewise.
	(emit_library_call_value_1): Likewise.
	* function.h (reference_callee_copied): Declare.

	* target.h (struct gcc_target): Add callee_copies.
	* target-def.h (TARGET_CALLEE_COPIES): New.
	(TARGET_PASS_BY_REFERENCE): Update default.
	* expr.h (FUNCTION_ARG_CALLEE_COPIES): Remove.
	* targhooks.c (hook_callee_copies_named): New.
	(hook_bool_CUMULATIVE_ARGS_mode_tree_bool_false): Rename from
	hook_pass_by_reference_false.
	(hook_bool_CUMULATIVE_ARGS_mode_tree_bool_true): New.
	* targhooks.h: Update decls.
	* config/arc/arc.c (TARGET_CALLEE_COPIES): New.
	* config/arc/arc.h (FUNCTION_ARG_CALLEE_COPIES): Remove.
	* config/frv/frv-protos.h (frv_function_arg_callee_copies): Remove.
	* config/frv/frv.c (frv_function_arg_callee_copies): Remove.
	* config/frv/frv.h (FUNCTION_ARG_CALLEE_COPIES): Remove.
	* config/iq2000/iq2000.c (TARGET_CALLEE_COPIES): New.
	* config/iq2000/iq2000.h (FUNCTION_ARG_CALLEE_COPIES): Remove.
	* config/m68hc11/m68hc11.c (TARGET_CALLEE_COPIES): New.
	* config/m68hc11/m68hc11.h (FUNCTION_ARG_CALLEE_COPIES): Remove.
	* config/mips/mips.c (TARGET_CALLEE_COPIES): New.
	(mips_callee_copies): New.
	* config/mips/mips.h (FUNCTION_ARG_CALLEE_COPIES): Remove.
	* config/mmix/mmix.c (TARGET_CALLEE_COPIES): New.
	* config/mmix/mmix.h (FUNCTION_ARG_CALLEE_COPIES): Remove.
	* config/mn10300/mn10300.c (TARGET_CALLEE_COPIES): New.
	* config/mn10300/mn10300.h (FUNCTION_ARG_CALLEE_COPIES): Remove.
	* config/pa/pa.c (TARGET_CALLEE_COPIES): New.
	* config/pa/pa.h (FUNCTION_ARG_CALLEE_COPIES): Remove.
	* config/sh/sh.c (sh_callee_copies): New.
	(TARGET_CALLEE_COPIES): New.
	* config/sh/sh.h (FUNCTION_ARG_CALLEE_COPIES): Remove.
	* config/v850/v850.c (TARGET_CALLEE_COPIES): New.
	* config/v850/v850.h (FUNCTION_ARG_CALLEE_COPIES): Remove.
	* doc/tm.texi (TARGET_CALLEE_COPIES): Replace documentation
	for FUNCTION_ARG_CALLEE_COPIES.
	* doc/rtl.texi (CALL_INSN_FUNCTION_USAGE): Update.

2004-09-08  Devang Patel  <dpatel@apple.com>

	* tree-if-conv.c (find_phi_replacement_condition): Return true
	edge block.
	(replace_phi_with_cond_modify_expr): Select conditional expr args
	based on true edge basic block.

2004-09-08  Jan Hubicka  <jh@suse.cz>

	* tree-ssa-operands.c (add_stmt_operand): Use V_MUST_DEF even for
	variables being alias set.

2004-09-08  Nathan Sidwell  <nathan@codesourcery.com>

	* final.c (shorten_branches, final, get_insn_template,
	output_alternate_entry_point, final_scan_insn, alter_subreg,
	alter_cond, output_operand, asm_fprintf, final_forward_branch_p,
	leaf_renumber_regs_insn): Use gcc_assert and gcc_unreachable.
	* fix-header.c (lookup_std_proto): Likewise.
	* flow.c (first_insn_after_basic_block_note, verify_wide_reg,
	verify_local_live_at_start, update_life_info, mark_reg,
	calculate_global_regs_live, allocate_reg_life_data,
	init_propagate_block_info, mark_set_regs, flush_reg_cond_reg_1,
	ior_reg_cond, not_reg_cond, and_reg_cond, elim_reg_cond,
	attempt_auto_inc, mark_used_reg, mark_used_regs): Likewise.
	* fold-const.c (force_fit_type, div_and_round_double,
	may_negate_without_overflow_p, int_const_binop, const_binop,
	size_binop, size_diffop, fold_convert_const, fold_convert,
	invert_tree_comparison, swap_tree_comparison,
	comparison_to_compcode, compcode_to_comparison, invert_truthvalue,
	range_binop, make_range, fold_cond_expr_with_comparison,
	fold_div_compare, fold, fold_checksum_tree, fold_negate_const,
	fold_abs_const, fold_not_const, fold_relational_const, round_up,
	round_down): Likewise.
	* function.c (find_function_data, assign_stack_temp_for_type,
	instantiate_virtual_regs_lossage, aggregate_value_p,
	assign_parm_find_entry_rtl, assign_parm_setup_block,
	expand_function_start, expand_function_end, keep_stack_depressed,
	handle_epilogue_set, thread_prologue_and_epilogue_insns): Likewise.

2004-09-08  Daniel Berlin  <dberlin@dberlin.org>

	* Makefile.in (tree-loop-linear.o): Added.
	(OBJS-common): Add tree-loop-linear.o
	* common.opt: New flag, ftree-loop-linear.
	* timevar.def: New timevar, TV_TREE_LOOP_LINEAR.
	* tree-flow.h: Add prototype for linear_transform_loops.
	* tree-optimize.c: Add linear transform after vectorization.
	* tree-pass.h: Add struct pass_linear_transform.
	* tree-ssa-loop.c: Add pass_linear_transform.
	* tree-loop-linear.c: New file.
	* lambda-code.c: gcc_assertify.
	(gcc_loop_to_lambda_loop): Handle all exit tests.
	Handle case where we have (invariant >= induction var).
	(find_induction_var_from_exit_cond): Ditto.

2004-09-08  Jie Zhang  <zhangjie@magima.com.cn>

	* tree-ssa-alias.c (compute_flow_insensitive_aliasing): If type
	memory tag is call clobbered, so are its aliases.
	(group_aliases): When two memory tags being grouped, if one is
	call clobbered, so are the other and its aliases.
	(add_may_alias): Remove call-clobbering stuff.
	(replace_may_alias): Likewise.
	(merge_pointed_to_info): Merge pt_global_mem

2004-09-08  Jan Hubicka  <jh@suse.cz>

	* cgraph.c (cgraph_remove_node): Free DECL_INITIAL field of node.
	* cgraphunit.c (verify_cgraph): Don't verify on syntax errors.
	(cgraph_expand_function): Remove stale cgraph edges of currently
	compiled function; fix non-unit-at-a-time code copying function
	node for later reuse.

2004-09-08  Nathan Sidwell  <nathan@codesourcery.com>

	* vec.c (vec_p_reserve, vec_o_reserve): Rename to ...
	(vec_gc_p_reserve, vec_gc_o_reserve): ... here. Clone to
	(vec_heap_p_reserve, vec_heap_o_reserve): ... here, adjust.
	(vec_gc_free, vec_heap_free): New.
	* vec.h (DEF_VEC_GC_P, DEF_VEC_MALLOC_P): New.
	(DEF_VEC_P): Add allocator argument. Adjust.
	(DEF_VEC_GC_O, DEF_VEC_MALLOC_O): New.
	(DEF_VEC_O): Add allocator argument. Adjust.
	(VEC(free)): New.

	* tree.h (tree): Define a GC'd vector.
	* lamba-code.c (lambda_loop): Likewise.
	* value-prof.h (histogram_value): Likewise.

2004-09-08  Nathan Sidwell  <nathan@codesourcery.com>

	* emit-rtl.c (immed_double_const): Use gcc_assert and gcc_unreachable.
	(gen_rtx_SUBREG, gen_reg_rtx, mark_user_reg, subreg_hard_regno,
	gen_lowpart_common, gen_highpart, gen_highpart_mode,
	subreg_highpart_offset, operand_subword, operand_subword_force,
	mem_expr_equal_p, set_mem_attributes_minus_bitpos,
	set_mem_alias_set, change_address_1, verify_rtx_sharing,
	copy_most_rtx, set_first_insn, set_last_insn, prev_cc0_setter,
	try_split, add_insn_after, add_insn_before, remove_insn,
	remove_unnecessary_notes, emit_insn_before, emit_jump_insn_before,
	emit_call_insn_before, emit_insn_after, emit_jump_insn_after,
	emit_call_insn_after, emit_insn, emit_jump_insn, emit_call_insn,
	set_unique_reg_note, emit, push_to_full_sequence, copy_insn_1,
	gen_const_vector_0, emit_copy_of_insn_after): Likewise.
	* et-forest.c (set_prev, set_next, et_check_occ_sanity,
	record_path_before_1, check_path_after_1, check_path_after): Likewise.
	* except.c (gen_eh_region, resolve_one_fixup_region,
	remove_unreachable_regions, convert_from_eh_region_ranges_1,
	add_ehl_entry, duplicate_eh_region_1, build_post_landing_pads,
	connect_post_landing_pads, sjlj_emit_function_exit,
	remove_exception_handler_label, remove_eh_handler,
	reachable_next_level, collect_one_action_chain,
	output_function_exception_table): Likewise.
	* explow.c (trunc_int_for_mode, copy_to_mode_reg,
	optimize_save_area_alloca, allocate_dynamic_stack_space,
	probe_stack_range, hard_function_value): Likewise.
	* expmed.c (mode_for_extraction, store_bit_field,
	store_fixed_bit_field, extract_bit_field, expand_shift,
	expand_mult_const, expand_mult, choose_multiplier,
	expand_mult_highpart, expand_divmod, emit_store_flag,
	do_cmp_and_jump): Likewise.
	* expr.c (convert_move, convert_modes, move_by_pieces,
	move_by_pieces_ninsns, move_by_pieces_1, emit_block_move,
	move_block_from_reg, gen_group_rtx, emit_group_load,
	emit_group_move, emit_group_store, use_reg, use_regs,
	can_store_by_pieces, store_by_pieces, store_by_pieces_1,
	emit_move_insn, emit_move_insn_1, emit_push_insn,
	expand_assignment, store_expr, count_type_elements,
	store_constructor, store_field, safe_from_p, expand_var,
	expand_expr_addr_expr, expand_expr_real_1, do_store_flag): Likewise.

2004-09-08  Nathan Sidwell  <nathan@codesourcery.com>

	* dbxout.c (dbxout_type, dbxout_type_name, dbxout_symbol): Use
	gcc_assert and gcc_unreachable.
	* ddg.c (create_ddg_dependence, add_deps_for_def,
	add_deps_for_use, create_ddg, add_edge_to_ddg): Likewise.
	* df.c (df_ref_unlink, df_ref_record, df_uses_record,
	df_reg_def_chain_create, df_reg_use_chain_create, df_analyze,
	df_insn_delete, df_refs_reg_replace, df_ref_reg_replace,
	df_insns_modify, df_pattern_emit_before, df_bb_reg_live_start_p,
	df_bb_reg_live_end_p, df_bb_regs_lives_compare,
	df_bb_single_def_use_insn_find, dataflow_set_a_op_b,
	dataflow_set_copy, hybrid_search, diagnostic.c,
	diagnostic_build_prefix, diagnostic_count_diagnostic): Likewise.
	* dojump.c (do_jump): Likewise.
	* dominance.c (calc_dfs_tree_nonrec, calc_dfs_tree,
	compute_dom_fast_query, calculate_dominance_info,
	free_dominance_info, get_immediate_dominator,
	set_immediate_dominator, get_dominated_by,
	redirect_immediate_dominators, nearest_common_dominator,
	dominated_by_p, verify_dominators, recount_dominator,
	iterate_fix_dominators, add_to_dominance_info,
	delete_from_dominance_info): Likewise.
	* dwarf2asm.c (size_of_encoded_value, eh_data_format_name,
	dw2_asm_output_delta_uleb128, dw2_asm_output_delta_sleb128,
	dw2_force_const_mem, dw2_asm_output_encoded_addr_rtx): Likewise.
	* dwarf2out.c (expand_builtin_init_dwarf_reg_sizes, reg_save,
	initial_return_save, stack_adjust_offset, dwarf2out_stack_adjust,
	flush_queued_reg_saves, dwarf2out_frame_debug_expr,
	dwarf2out_frame_debug, dw_cfi_oprnd1_desc, output_cfi,
	output_call_frame_info, output_loc_operands, build_cfa_loc,
	decl_ultimate_origin, AT_flag, AT_int, AT_unsigned, AT_string,
	AT_string_form, add_AT_specification, AT_ref, set_AT_ref_external,
	AT_loc, AT_loc_list, AT_addr, AT_lbl, add_child_die,
	splice_child_die, attr_checksum, same_dw_val_p,
	break_out_includes, build_abbrev_table, size_of_die, mark_dies,
	unmark_dies, value_format, output_loc_list, output_die,
	output_pubnames, output_aranges, base_type_die, is_base_type,
	modified_type_die, dbx_reg_number, multiple_reg_loc_descriptor,
	mem_loc_descriptor, loc_descriptor, loc_descriptor_from_tree_1,
	field_byte_offset, add_data_member_location_attribute,
	add_const_value_attribute, rtl_for_decl_location,
	add_location_or_const_value_attribute, add_byte_size_attribute,
	add_bit_offset_attribute, add_bit_size_attribute,
	add_abstract_origin_attribute, pop_decl_scope, scope_die_for,
	decl_start_label, gen_formal_parameter_die,
	gen_type_die_for_member, gen_subprogram_die, gen_label_die,
	gen_typedef_die, gen_type_die, gen_tagged_type_instantiation_die,
	force_decl_die, force_type_die, gen_decl_die,
	dwarf2out_imported_module_or_decl, prune_unused_types_prune,
	dwarf2out_finish): Likewise.

2004-09-08  Andreas Tobler  <toa@pop.agri.ch>

	* Makefile.in (builtins.o): Depend on tree-mudflap.h.
	* builtins.c: Include tree-mudflap.h.

2004-09-08  Uros Bizjak  <uros@kss-loka.si>

	* config/i386/i386.c (ix86_prepare_fp_compare_args): Do not
	force operand 0.0 into register in XFmode. Also do not force
	operand 0.0 into register if !TARGET_CMOVE.
	* config/i386/i386.md (*cmpfp_0): Delete. Remove comment.
	(*cmpfp_0_sf, cmpfp_0_df, cmpfp_0_xf): New patterns to
	implement ftst x87 instruction.
	(*fp_jcc_7): New insn pattern. Change corresponding split
	pattern to handle "general_operand" instead of
	"nonimmediate_operand".

2004-09-08  Ben Elliston  <bje@au.ibm.com>

	* doc/rtl.texi (Insns): Document NOTE_INSN_FUNCTION_BEG.

2004-09-07  Frank Ch. Eigler  <fche@redhat.com>

	* builtins.c (std_gimplify_va_arg_expr): Mark INDIRECT_REF nodes
	generated from standard va_arg expansion.
	* tree-mudflap.c (mx_xform_derefs_1): Omit instrumentation from
	marked nodes.
	(mf_varname_tree, mf_file_function_line_tree): Add some support
	for column numbers if compiled with USE_MAPPED_LOCATION.

2004-09-07  Ziemowit Laski  <zlaski@apple.com>

	* c-decl.c (groktypename_in_parm_context): Remove function.
	* c-tree.h (groktypename_in_parm_context): Remove prototype.

2004-09-07  Ziemowit Laski  <zlaski@apple.com>

	* Makefile.in (c-parse.o): Depend on $(C_COMMON_H).
	* c-parse.in: Include c-common.h instead of objc-act.h.
	(ivar_decl_list, ivar_decls, ivar_decl, ivars, ivar_declarator,
	myparms, myparm): Remove %type declarations.
	(methodtype, optparms, OBJC_TYPE_QUAL, objc_quals, objc_qual,
	objc_typename, objc_try_catch_stmt, optellipsis): Add %type
	declarations.
	(objc_inherit_code, objc_public_flag): Remove.
	(typespec_nonreserved_nonattr): Call
	objc_get_protocol_qualified_type() instead of get_static_reference()
	and get_protocol_reference().
	(stmt_nocomp): Call grokparm() on @catch parameter.
	(objcdef): Move semantic action to objc_finish_implementation().
	(classdef): Move semantic action to objc_start_class_interface(),
	objc_continue_interface(), objc_finish_interface(),
	objc_start_class_implementation(), objc_continue_implementation(),
	objc_start_category_interface() and
	objc_start_category_implementation().
	(protocoldef): Move semantic actions to objc_start_protocol() and
	objc_finish_interface().
	(ivar_decl_list): Remove nonterminal.
	(visibility_spec): Move semantic actions to objc_set_visibility().
	(ivar_decls): Remove assignment to $$.
	(ivar_decl): Rephrase in terms of component_decl; call
	objc_add_instance_variable().
	(ivars, ivar_declarator): Remove nonterminals.
	(opt_semi): New nonterminal.
	(methodtype): Remove semantic actions.
	(methoddef): Move semantic actions to objc_set_method_type(),
	objc_start_method_definition() and objc_finish_method_definition().
	(methodproto): Move semantic actions to objc_set_method_type() and
	objc_add_method_declaration().
	(methoddecl): Use objc_typename instead of typename; move semantic
	actions to objc_build_method_signature().
	(optarglist, myxdecls, mydecl, myparms, myparm): Remove nonterminals.
	(optparmlist): Express in terms of optparms and optellipsis.
	(optparms, optellipsis, objc_qual, objc_quals, objc_typename): New
	nonterminals.
	(keyworddecl): Use objc_typename instead of typename.
	(rid_to_yy): Mark RID_IN, RID_OUT, RID_INOUT, RID_BYCOPY, RID_BYREF
	and RID_ONEWAY as returning OBJC_TYPE_QUAL to yyparse().

2004-09-08  Alan Modra  <amodra@bigpond.net.au>

	* doc/tm.texi (MD_UNWIND_SUPPORT): Document.
	(MD_FALLBACK_FRAME_STATE_FOR): Update.
	* unwind-dw2.c (MD_UNWIND_SUPPORT): #include if defined.
	(uw_frame_state_for): Adjust MD_FALLBACK_FRAME_STATE_FOR invocation.
	(MD_FROB_UPDATE_CONTEXT): Remove default.
	(uw_update_context_1): Instead #ifdef invocation.
	* config/ia64/unwind-ia64.c (MD_UNWIND_SUPPORT): #include if defined.
	(uw_frame_state_for): Adjust MD_FALLBACK_FRAME_STATE_FOR invocation.
	* config/alpha/gnu.h (MD_FALLBACK_FRAME_STATE_FOR): Don't undef.
	(MD_UNWIND_SUPPORT): Undefine this instead.
	* config/i386/gnu.h: Likewise.
	* config/alpha/linux-unwind.h: New file, macro converted to
	function, extracted from..
	* config/alpha/linux.h (MD_FALLBACK_FRAME_STATE_FOR): ..this.
	(MD_UNWIND_SUPPORT): Define.
	* config/alpha/vms-unwind.h, config/alpha/vms.h: Likewise.
	* config/i386/linux-unwind.h, config/i386/linux.h,
	config/i386/linux64.h: Likewise.
	* config/ia64/linux-unwind.h, config/ia64/linux.h: Likewise.
	MD_HANDLE_UNWABI too.
	* config/mips/linux-unwind.h, config/mips/linux.h: Likewise.
	* config/pa/linux-unwind.h, config/pa/pa32-linux.h: Likewise.
	* config/rs6000/darwin-unwind.h, config/rs6000/darwin.h: Likewise.
	* config/s390/linux-unwind.h, config/s390/linux.h: Likewise.
	* config/sparc/linux-unwind.h, config/sparc/linux.h,
	config/sparc/linux64.h: Likewise.
	* config/sh/linux-unwind.h, config/sh/linux.h: Likewise, but merge
	SH_FALLBACK_FRAME_FLOAT_STATE into sh_fallback_frame_state.
	* config/rs6000/linux-unwind.h, config/rs6000/linux.h,
	config/rs6000/linux64.h: Likewise.  Split out get_sigcontext
	function.  Use ARG_POINTER_REGNUM for 32-bit temp reg too.

2004-09-07  Jan Hubicka  <jh@suse.cz>

	* cse.c (fold_rtx):  Avoid building of
	(CONST (MINUS (CONST_INT) (SYMBOL_REF)))

	* tree-ssa-pre.c (grand_bitmap_obstack): New.
	(value_insert_into_set_bitmap, bitmap_set_new): Use the obstack.
	(init_pre): Initialize obstack.
	(fini_pre): Free obstack.

2004-09-07  David Daney  <ddaney@avtrex.com>

	* config.gcc: Added support for --with-divide=[breaks|traps] for
	mips targets.
	* config/mips/mips.h (MASK_DIVIDE_BREAKS): New target_flags bit.
	(TARGET_DIVIDE_TRAPS): New macro.
	(TARGET_SWITCHES): Added -mdivide-traps and -mdivide-breaks.
	(OPTION_DEFAULT_SPECS): Added --with-divide= support.
	* config/mips/mips.c (mips_idiv_insns): Generate proper count on
	GENERATE_DIVIDE_TRAPS.
	(mips_output_division): Emit conditional trap if
	GENERATE_DIVIDE_TRAPS is set.
	* doc/install.texi: Document --with-divide.
	* doc/invoke.texi: Document -mdivide-traps and -mdivide-breaks.

2004-09-07  Caroline Tice  <ctice@apple.com>

	* cfgrtl.c (rtl_verify_flow_info_1):  Add new edge flag,
	EDGE_CROSSING, to flags test case.

2004-09-07  Jan Hubicka  <jh@suse.cz>

	* tree-ssa-loop-ivopts.c (contains_abnormal_ssa_name_p): Deal with '<'
	class too.

2004-09-07  Nathan Sidwell  <nathan@codesourcery.com>

	* cfganal.c (flow_depth_first_order_compute, dfs_enumerate_from,
	cfgbuild.c, inside_basic_block_p, control_flow_insn_p,
	make_label_edge, make_edges, find_basic_blocks_1): Use gcc_assert
	or gcc_unreachable.
	* cfg.c (clear_edges, initialize_bb_rbi, compact_blocks,
	remove_edge, alloc_aux_for_blocks, free_aux_for_blocks,
	alloc_aux_for_edges, free_aux_for_edges): Likewise.
	* cfgcleanup.c (try_forward_edges,
	merge_blocks_move_predecessor_nojumps,
	merge_blocks_move_successor_nojumps): Likewise.
	* cfgexpand.c (expand_gimple_cond_expr,
	expand_gimple_tailcall): Likewise.
	* cfghooks.c (duplicate_block): Likewise.
	* cfglayout.c (record_effective_endpoints,
	insn_locators_initialize, change_scope, fixup_reorder_chain,
	verify_insn_chain, fixup_fallthru_exit_predecessor,
	duplicate_insn_chain, cfg_layout_finalize): Likewise.
	* cfgloopanal.c (check_irred): Likewise.
	* cfgloop.c (superloop_at_depth, flow_loops_free,
	flow_loop_entry_edges_find, flow_loops_find,
	flow_loop_outside_edge_p, get_loop_body,
	get_loop_body_in_dom_order, get_loop_body_in_bfs_order,
	get_loop_exit_edges, num_loop_branches, cancel_loop,
	verify_loop_structure): Likewise.
	cfgloopmanip.c (find_path, remove_path, loop_delete_branch_edge,
	duplicate_loop_to_header_edge, create_preheader,
	create_loop_notes): Likewise.
	* cfgrtl.c (delete_insn, try_redirect_by_replacing_jump,
	edirect_branch_edge, force_nonfallthru_and_redirect,
	rtl_split_edge, insert_insn_on_edge, commit_one_edge_insertion,
	commit_edge_insertions, commit_edge_insertions_watch_calls,
	purge_dead_edges, cfg_layout_redirect_edge_and_branch,
	cfg_layout_redirect_edge_and_branch_force,
	cfg_layout_merge_blocks, rtl_flow_call_edges_add): Likewise.
	* cgraph.c (cgraph_node, cgraph_create_edge, cgraph_remove_edge,
	cgraph_redirect_edge_callee, cgraph_global_info, cgraph_rtl_info,
	cgraph_varpool_node): Likewise.
	* cgraphunit.c (cgraph_finalize_function,
	cgraph_finalize_compilation_unit, cgraph_mark_functions_to_output,
	cgraph_expand_function, cgraph_remove_unreachable_nodes,
	cgraph_clone_inlined_nodes, cgraph_mark_inline_edge,
	cgraph_mark_inline, cgraph_expand_all_functions,
	cgraph_build_static_cdtor): Likewise.
	* combine.c  (do_SUBST, try_combine, subst, combine_simplify_rtx,
	simplify_logical, distribute_notes, insn_cuid): Likewise.
	* conflict.c (conflict_graph_add, print_conflict): Likewise.
	* coverage.c (rtl_coverage_counter_ref, tree_coverage_counter_ref,
	coverage_checksum_string): Likewise.
	* cse.c (make_new_qty, make_regs_eqv, insert, invalidate,
	hash_rtx, exp_equiv_p, cse_basic_block, count_reg_usage,
	cse_cc_succs, cse_condition_code_reg): Likewise.
	* cselib.c (entry_and_rtx_equal_p, remove_useless_values,
	rtx_equal_for_cselib_p, wrap_constant, cselib_hash_rtx,
	new_cselib_val, cselib_subst_to_values, cselib_invalidate_regno,
	cselib_record_set): Likewise.

2004-09-07  Jan Hubicka  <jh@suse.cz>

	* tree-ssa-loop-ivopts.c (iv_value): Avoid invalid sharing on niter.

2004-09-07  Nathan Sidwell  <nathan@codesourcery.com>

	* builtins.c (fold_builtin_strchr): Use build_int_cst, not
	fold_convert.
	(fold_builtin_strpbrk): Likewise.
	* expr.c (array_ref_low_bound): Likewise.
	* tree-scalar-evolution.c (chrec_is_positive, add_to_evolution_1,
	interpret_rhs_modify_expr, number_of_iterations_in_loop): Likewise.
	* tree-sra.c (generate_element_zero): Likewise.
	* tree-ssa-dom.c (simplify_rhs_and_lookup_avail_expr): Likewise.
	* tree-ssa-loop-ivopts.c (determine_biv_step, idx_find_step,
	add_old_iv_candidates, add_iv_candidates): Likewise.
	* tree-tailcall.c (tree_optimize_tail_calls_1): Likewise.

2004-09-07  Nathan Sidwell  <nathan@codesourcery.com>

	* c-aux-info.c (gen_type): Use gcc_assert or gcc_unreachable.
	* c-common.c (c_type_hash, c_common_nodes_and_builtins,
	c_expand_expr, boolean_increment, nonnull_check_p,
	check_function_arguments_recurse, fold_offsetof_1): Likewise.
	* c-cppbuiltin.c (define__GNUC__, builtin_define_stdint_macros,
	builtin_define_type_max): Likewise.
	* c-decl.c (bind, pop_scope, merge_decls, pushdecl_top_level,
	implicit_decl_warning, builtin_function, build_compound_literal,
	complete_array_type, grokdeclarator, get_parm_info,
	start_function, store_parm_decls_oldstyle,
	c_write_global_declarations): Likewise.
	* c-format.c (get_constant, decode_format_attr,
	maybe_read_dollar_number, get_flag_spec, check_format_arg,
	check_format_types, format_type_warning,
	find_char_info_specifier_index, init_dynamic_asm_fprintf_info,
	init_dynamic_diag_info, handle_format_attribute): Likewise.
	* c-gimplify.c (push_context, pop_context, finish_bc_block):
	* c-lex.c (c_lex_with_flags, lex_string): Likewise.
	* c-objc-common.c (c_tree_printer): Likewise.
	* c-pch.c (pch_init): Likewise.
	* c-pragma.c (maybe_apply_pragma_weak): Likewise.
	* c-pretty-print.c (pp_c_tree_decl_identifier): Likewise.
	* c-typeck.c (c_incomplete_type_error, composite_type,
	common_pointer_type, common_type, same_translation_unit_p,
	tagged_types_tu_compatible_p, finish_init, pop_init_level,
	set_designator, set_nonincremental_init_from_string,
	process_init_element, c_finish_if_stmt): Likewise.
	* caller-save.c (init_caller_save, save_call_clobbered_regs,
	insert_restore, insert_save, insert_one_insn): Likewise.
	* calls.c (emit_call_1, compute_argument_block_size,
	precompute_arguments, expand_call, emit_library_call_value_1,
	store_one_arg): Likewise.

2004-09-07  Nathan Sidwell  <nathan@codesourcery.com>

	* configure.ac (enable-checking): Add release option. Reorganize
	to avoid repetition.
	* configure: Rebuilt.
	* doc/install.texi (enable-checking): Amend documentation.

2004-09-06  H.J. Lu  <hongjiu.lu@intel.com>

	PR bootstrap/17313
	* Makefile.in (specs.ready): Depend on cc1$(exeext).

2004-09-06  James E Wilson  <wilson@specifixinc.com>

	* config/mips/mips.md (movsf_hardfloat, movdf_hardfloat_64bit,
	movdf_hardfloat_32bit): Split fG into two alternatives.
	(movv2sf_hardfloat_64bit): Split fYG into two alternatives.

	* emit-rtl.c (try_split): Check INSN_P before may_trap_p call.

2004-09-06  Eric Botcazou  <ebotcazou@libertysurf.fr>

	* final.c (output_in_slot): Delete.
	(final_scan_insn): Revert 2004-09-03 change.
	(output_asm_insn): Likewise.
	* config/sparc/sparc.c (output_return): Likewise.
	(output_sibcall): Likewise.

2004-09-06  Jan Hubicka  <jh@suse.cz>

	* loop.c (loop_dump_aux): Do not print RTL when not available.
	* tree-ssa-loop-ivopts.c (add_standard_iv_candidates): Do not use
	frontend specific type nodes.
	(produce_memory_decl_rtl): Break out from ...
	(prepare_decl_rtl): ... here.  Handle ADDR_EXPR correctly.
	(get_computation_at): Avoid random tree sharing.
	(tree_ssa_iv_optimize): Verify tree sharing; dump loops.

2004-09-06  Zack Weinberg  <zack@codesourcery.com>

	* Makefile.in (rtl.o, bitmap.o): Correct dependencies, remove
	unnecessary commands.

2004-09-06  Mohan Embar  <gnustuff@thisiscool.com>

	* Makefile.in (rtl.o): Remove -DGENERATOR_FILE.
	(bitmap.o): Likewise.

2004-09-06  Paolo Bonzini  <bonzini@gnu.org>

	Unify the management of RTL and tree-level dump files.

	* cfgexpand.c (tree_expand_cfg): Fix incorrect comment.
	Don't print function name to the dump file, the pass manager
	would do this for us. Add code from the top of
	rest_of_compilation, up to the initial RTL dump.
	* passes.c (rest_of_handle_jump): Call fixup_tail_calls and
	close the DFI_sibling dump file.
	(rest_of_compilation): Don't do that here.  Remove code up to the
	initial RTL dump.
	(init_optimization_passes): Remove.
	(pass_rest_of_compilation): Change pass name to NULL.
	* toplev.c (lang_dependent_init): Do not use an empty dump file prefix.
	Do not call init_optimization_passes.
	* toplev.h (init_optimization_passes): Remove.

	* graph.c (print_rtl_graph_with_bb, clean_graph_dump_file,
	finish_graph_dump_file): Remove SUFFIX parameter.
	* graph.h (print_rtl_graph_with_bb, clean_graph_dump_file,
	finish_graph_dump_file): Likewise.

	* tree-pass.h (struct tree_opt_pass): Add `letter' field.
	* cfgexpand.c (pass_expand): Adjust.
	* gimple-low.c (pass_lower_cf, pass_remove_useless_vars): Adjust.
	* passes.c (pass_rest_of_compilation): Adjust.
	* predict.c (pass_profile): Adjust.
	* tree-alias-common.c (pass_build_pta, pass_del_pta): Adjust.
	* tree-cfg.c (pass_build_cfg, pass_remove_useless_stmts,
	pass_split_crit_edges, pass_warn_function_return): Adjust.
	* tree-complex.c (pass_lower_vector_ssa, pass_pre_expand): Adjust.
	* tree-dfa.c (pass_referenced_vars): Adjust.
	* tree-eh.c (pass_lower_eh): Adjust.
	* tree-if-conv.c (pass_build_ssa): Adjust.
	* tree-into-ssa.c (pass_build_ssa): Adjust.
	* tree-mudflap.c (pass_mudflap_1, pass_mudflap_2): Adjust.
	* tree-nomudflap.c (pass_mudflap_1, pass_mudflap_2): Adjust.
	* tree-nrv.c (pass_nrv): Adjust.
	* tree-optimize.c (pass_gimple, pass_all_optimizations,
	pass_cleanup_cfg_post_optimizing, pass_free_datastructures,
	pass_init_datastructures): Adjust.
	* tree-outof-ssa.c (pass_del_ssa): Adjust.
	* tree-profile.c (pass_tree_profile): Adjust.
	* tree-sra.c (pass_sra): Adjust.
	* tree-ssa-alias.c (pass_may_alias): Adjust.
	* tree-ssa-ccp.c (pass_ccp, pass_fold_builtins): Adjust.
	* tree-ssa-copyrename.c (pass_rename_ssa_copies): Adjust.
	* tree-ssa-dce.c (pass_dce, pass_cd_dce): Adjust.
	* tree-ssa-dom.c (pass_dominator): Adjust.
	* tree-ssa-dse.c (pass_dse): Adjust.
	* tree-ssa-forwprop.c (pass_forwprop): Adjust.
	* tree-ssa-if-conv.c (pass_if_conversion): Adjust.
	* tree-ssa-loop-ch.c (pass_ch): Adjust.
	* tree-ssa-loop.c (pass_loop, pass_loop_init, pass_lim,
	pass_loop_done, pass_complete_unroll, pass_iv_canon,
	pass_iv_optimize, pass_vectorize): Adjust.
	* tree-ssa-phiopt.c (pass_phiopt): Adjust.
	* tree-ssa-pre.c (pass_pre, pass_fre): Adjust.
	* tree-ssa.c (pass_redundant_phi, pass_early_warn_uninitialized,
	pass_late_warn_uninnitialized): Adjust.
	* tree-tailcall.c (pass_tail_recursion, pass_tail_calls): Adjust.

	* Makefile.in (tree-dump.o): Add new dependencies.
	* cgraph.c (cgraph_remove_node): TDF_all -> TDF_tree_all.
	* cgraphunit.c (cgraph_preserve_function_body_p, cgraph_optimize):
	Likewise.
	* toplev.c (dump_file_name): New.
	* tree-dump.c (dump_enable_all): Add LETTER parameter.
	(struct dump_file_info): Add NUM and LETTER fields.
	(dump_files): Adjust and add RTL dump files.
	(dump_register): Add NUM and LETTER fields.
	(get_dump_file_name, dump_initialized_p, enable_rtl_dump_file): New.
	(dump_begin): Use get_dump_file_name.
	(dump_switch_p_1): Adjust call to dump_enable_all.
	* tree-dump.h (dump_register): Adjust prototype.
	* tree-optimize.c (register_one_dump_file): Take dump file index.
	Support flags for RTL dumps.
	(register_dump_files): Fill in NUM field of struct dump_file_info.
	Track properties both when the gate is executed and when it is not.
	(execute_todo): Dump RTL.  Add PROPERTIES parameter.
	(execute_one_pass): Pass properties to execute_todo.  Handle VCG
	dumps of RTL.
	* tree-pass.h (dump_file_name): New.
	* tree.h (TDF_TREE, TDF_RTL, get_dump_file_name, dump_initialized_p):
	New.

	* Makefile.in (passes.o): Add new dependencies.
	* passes.c (struct dump_file_info, enum dump_file_index,
	dump_file_tbl, init_optimization_passes): Remove.
	(open_dump_file, close_dump_file): Use tree-dumping infrastructure.
	(rest_of_handle_new_regalloc, rest_of_handle_old_regalloc): Use
	dump_enabled_p.
	(finish_optimization_passes): Update finish_graph_dump_file loop.
	(enable_rtl_dump_file): Remove.
	* tree-dump.c (dump_files): Adjust and add RTL dump files.
	(enable_rtl_dump_file): Add here.
	* tree.h (enum tree_dump_index): Add RTL dump file indices.
	* doc/invoke.texi (Debugging options): Document new RTL debugging
	options.  Update.

2004-09-05  Kazu Hirata  <kazu@cs.umass.edu>

	* c-common.c, c-decl.c, combine.c, defaults.h, fold-const.c,
	gimplify.c, gthr-nks.h, hooks.c, lambda-code.c, lambda-mat.c,
	stor-layout.c, target.h, tree-cfg.c, tree-chrec.c,
	tree-if-conv.c, tree-inline.c, tree-into-ssa.c,
	tree-mudflap.c, tree-optimize.c, tree-scalar-evolution.c,
	tree-ssa-alias.c, tree-ssa-ccp.c, tree-ssa-dce.c,
	tree-ssa-pre.c, tree-vectorizer.c, tree-vectorizer.h, tree.h,
	vec.h: Fix comment formatting.

2004-09-05  Kazu Hirata  <kazu@cs.umass.edu>

	* c-common.c, cfgexpand.c, cgraphunit.c, defaults.h,
	et-forest.c, expr.c, gimplify.c, global.c, gthr-lynx.h,
	hard-reg-set.h, modulo-sched.c, optabs.c, postreload-gcse.c,
	tree-data-ref.c, tree-flow.h, tree-if-conv.c, tree-inline.c,
	tree-sra.c, tree-ssa-loop-im.c, tree-ssa-loop-ivopts.c,
	tree-ssa-loop-niter.c, tree-ssa-operands.c,
	tree-ssa-operands.h, tree-ssa-propagate.c,
	tree-ssa-propagate.h, tree-ssa-threadupdate.c, value-prof.c,
	vec.c, vec.h: Fix comment typos.  Follow spelling conventions.

2004-09-05  Diego Novillo  <dnovillo@redhat.com>

	* tree-if-conv.c (gate_tree_if_conversion): Enable only if the
	vectorizer is enabled.

2004-09-05  Andreas Jaeger  <aj@suse.de>

	* tree-if-conv.c: Spell check comments and clean up whitespace.

2004-09-05  Zdenek Dvorak  <rakdver@atrey.karlin.mff.cuni.cz>

	* tree-ssa-loop-ivopts.c: New file.
	* Makefile.in (tree-ssa-loop-ivopts.c): Add.
	* cfgloop.h (target_avail_regs, target_res_regs, target_small_cost,
	target_pres_cost, target_spill_cost): Declare.
	* cfgloopanal.c (avail_regs, res_regs, small_cost, pres_cost,
	spill_cost): Renamed to ...
	(target_avail_regs, target_res_regs, target_small_cost,
	target_pres_cost, target_spill_cost): ... and exported.
	(init_set_costs, global_cost_for_size): Work with renamed variables.
	* common.opt (flag_ivopts): New flag.
	* expr.c (expand_expr_real_1): Handle SSA_NAME case.  Handle
	REF_ORIGINAL.
	* gimplify.c (struct gimplify_ctx): Add into_ssa field.
	(internal_get_tmp_var, gimplify_modify_expr, gimplify_expr): Support
	generating SSA form.
	(force_gimple_operand): New function.
	* timevar.def (TV_TREE_LOOP_IVOPTS): New timevar.
	* tree-cfg.c (stmt_bsi): New function.
	* params.def (PARAM_IV_CONSIDER_ALL_CANDIDATES_BOUND,
	PARAM_IV_MAX_CONSIDERED_USES): New.
	* tree-flow.h (stmt_bsi, tree_ssa_iv_optimize, split_loop_exit_edge,
	bsi_insert_on_edge_immediate_loop. standard_iv_increment_position,
	ip_end_pos, ip_normal_pos, force_gimple_operand): Declare.
	* tree-gimple.c (is_gimple_formal_tmp_var): Accept ssa names.
	* tree-nested.c (build_addr): Export.
	* tree-optimize.c (init_tree_optimization_passes): Add
	pass_iv_optimize.
	* tree-pass.h (pass_iv_optimize): Declare.
	* tree-ssa-loop-im.c (for_each_index): Handle REALPART_EXPR and
	IMAGPART_EXPR.
	* tree-ssa-loop-manip.c (create_iv): Force the base to be acceptable
	as a phi node argument.
	(split_loop_exit_edge, bsi_insert_on_edge_immediate_loop,
	ip_end_pos, ip_normal_pos, standard_iv_increment_position): New
	functions.
	* tree-ssa-loop-niter.c (zero_p, unsigned_type_for): Export.
	* tree-ssa-loop.c (tree_ssa_loop_ivopts, gate_tree_ssa_loop_ivopts,
	pass_iv_optimize): New pass.
	* tree-ssa-operands.c (get_indirect_ref_operands): Handle REF_ORIGINAL.
	* tree-ssanames.c (release_ssa_name): Allow calling with var = NULL.
	* tree.c (build_int_cst_type, cst_and_fits_in_hwi): New functions.
	* tree.h (REF_ORIGINAL): New macro.
	(build_int_cst_type, unsigned_type_for, zero_p,
	cst_and_fits_in_hwi, build_addr): Declare.
	* doc/invoke.texi (-fivopts): Document.
	(PARAM_IV_CONSIDER_ALL_CANDIDATES_BOUND,
	PARAM_IV_MAX_CONSIDERED_USES): Document.
	* doc/passes.texi: Document induction variable optimizations pass.

2004-09-04  Kaveh R. Ghazi  <ghazi@caip.rutgers.edu>

	* builtin-attrs.def (ATTR_NOTHROW_SENTINEL_1): New.
	* builtins.def (BUILT_IN_EXECLE): Set ATTR_NOTHROW_SENTINEL_1.
	* c-common.c (c_common_attribute_table): Accept parameters to
	sentinel attribute.
	(check_function_sentinel, handle_sentinel_attribute): Likewise.
	* doc/extend.texi: Update accordingly.

2004-09-04  Kaveh R. Ghazi  <ghazi@caip.rutgers.edu>

	* builtin-attrs.def (ATTR_SENTINEL, ATTR_SENTINEL_NOTHROW_LIST):
	New.
	* builtins.def (BUILT_IN_EXECL, BUILT_IN_EXECLP): Add `sentinel'
	attribute.
	* c-common.c (handle_sentinel_attribute, check_function_sentinel):
	New functions.
	(c_common_attribute_table): Add `sentinel' attribute.
	(check_function_arguments): Handle `sentinel' attribute.
	* doc/extend.texi: Document `sentinel' attribute.

2004-09-04  H.J. Lu  <hongjiu.lu@intel.com>

	* configure: Regenerated.

2004-09-04  Richard Kenner  <kenner@vlsi1.ultra.nyu.edu>

	* gimplify.c (internal_get_tmp_var): Remove unused var CLASS.

	* tree.c (save_expr): No longer TREE_READONLY.

2004-09-04  Jan Hubicka  <jh@suse.cz>

	* passes.c (rest_of_clean_state):  Fix merge conflict made during
	commiting the patch.

2004-09-04  Jan Hubicka  <jh@suse.cz>

	* passes.c (rest_of_clean_state):  Decompose the instruction stream.

2004-09-04  Richard Sandiford  <rsandifo@redhat.com>

	* doc/md.texi (shift patterns): New anchor.  Add reference to
	TARGET_SHIFT_TRUNCATION_MASK.
	* doc/tm.texi (TARGET_SHIFT_TRUNCATION_MASK): Document.
	* target.h (shift_truncation_mask): New target hook.
	* targhook.h (default_shift_truncation_mask): Declare.
	* targhook.c (default_shift_truncation_mask): Define.
	* target-def.h (TARGET_SHIFT_TRUNCATION_MASK): Define.
	(TARGET_INITIALIZER): Include it.
	* simplify-rtx.c (simplify_binary_operation): Combine ASHIFT, ASHIFTRT
	and LSHIFTRT cases.  Truncate arg1 if SHIFT_COUNT_TRUNCATED, otherwise
	reject all out-of-range values.  Fix sign-extension code for modes
	whose width is smaller than HOST_BITS_PER_WIDE_INT.
	* optabs.c (simplify_expand_binop, force_expand_binop): New functions.
	(expand_superword_shift, expand_subword_shift): Likewise.
	(expand_doubleword_shift_condmove, expand_doubleword_shift): Likewise.
	(expand_binop): Use them to implement double-word shifts.
	* config/arm/arm.c (arm_shift_truncation_mask): New function.
	(TARGET_SHIFT_TRUNCATION_MASK): Define.

2004-09-04  Jan Hubicka  <jh@suse.cz>

	* tree.c (iterate_hash_expr): Optimize, avoid use of iterative_hash_object.
	(mix): New macro copied from hashtab.c
	(iterative_hash_hashval_t, iterative_hash_pointer,
	iterative_hash_host_wide_int): New functions based on hashtab.c
	implementation.

2004-09-04  Richard Sandiford  <rsandifo@redhat.com>

	* config/mips/mips.md (mask): New mode attribute.
	(zero_extendsidi2): Add memory alternative.
	(*zero_extendsidi2_mem): Delete.
	(zero_extend[qh]i[sd]i2): Redefine using :GPR and :SHORT.  Use
	memory_operand in the TARGET_MIPS16 check.
	(*zero_extend[qh]i[sd]i2{,_mips16}): Name previously unnamed patterns.
	Redefine using :GPR and :SHORT.
	(zero_extendqihi2): Use memory_operand in the TARGET_MIPS16 check.

2004-09-04  Uros Bizjak  <uros@kss-loka.si>

	* builtins.c (expand_builtin_mathfn): Handle BUILT_IN_RINT{,F,L}
	using rint_optab.
	(expand_builtin): Expand BUILT_IN_RINT{,F,L} using
	expand_builtin_mathfn.
	* genopinit.c (optabs): Rename trunc_optab to btrunc_optab. Use
	btrunc?f patterns for btrunc_optab. Implement rint_optab using
	rint?f patterns.
	* optabs.c (init_optabs): Initialize rint_optab.
	* optabs.h (enum optab_index): Rename OTI_trunc to OTI_btrunc.
	Add new OTI_rint.
	(btrunc_optab): Rename macro from trunc_optab.
	(rint_optab): Define corresponding macro.

	* reg-stack.c (subst_stack_regs_pat): Handle UNSPEC_FRNDINT_FLOOR,
	UNSPEC_FRNDINT_CEIL, UNSPEC_FRNDINT_TRUNC, UNSPEC_FRNDINT_MASK_PM.

	* config/i386/i386-protos.h (emit_i387_cw_initialization):
	Change prototype. Add new int parameter.
	* config/i386/i386.c (emit_i387_cw_initialization):
	Handle new rounding modes.

	* config/i386/i386.h (enum fp_cw_mode): Delete.
	(MODE_NEEDED): Handle new rounding modes.
	(EMIT_MODE_SET): Change condition to handle new rounding modes.

	* config/i386/i386.md (UNSPEC_FRNDINT_FLOOR, UNSPEC_FRNDINT_CEIL,
	UNSPEC_FRNDINT_TRUNC, UNSPEC_FRNDINT_MASK_PM): New unspecs to
	represent different rounding modes of frndint insn.
	(type): Add frndint type.
	(i387, length, memory): Handle this type.
	(i387_cw): New attribute definition.
	(*fix_truncdi_1, fix_truncdi_nomemory, fix_truncdi_memory,
	*fix_truncsi_1, fix_truncsi_nomemory, fix_truncsi_memory,
	*fix_trunchi_1, fix_trunchi_nomemory, fix_trunchi_memory):
	Add "i387_cw" attribute defined to "trunc".
	(x86_fnstcw_1): Remove comment.
	(*frndintxf2): Rename insn definition to frndintxf2. Move
	insn definition near rint?f2 expanders.
	(rintdf2, rintsf2, rintxf2): New expanders to implement rint,
	rintf and rintl built-ins as inline x87 intrinsics.
	(frndintxf2_floor): New pattern to implement floor rounding
	mode with frndint x87 instruction.
	(floordf2, floorsf2, floorxf2): New expanders to implement floor,
	floorf and floorl built-ins as inline x87 intrinsics.
	(frndintxf2_ceil): New pattern to implement ceil rounding
	mode with frndint x87 instruction.
	(ceildf2, ceilsf2, ceilxf2): New expanders to implement ceil,
	ceilf and ceill built-ins as inline x87 intrinsics.
	(frndintxf2_trunc): New pattern to implement trunc rounding
	mode with frndint x87 instruction.
	(btruncdf2, btruncsf2, btruncxf2): New expanders to implement trunc,
	truncf and truncl built-ins as inline x87 intrinsics.
	(frndintxf2_mask_pm): New pattern to implement rounding
	mode with exceptions with frndint x87 instruction.
	(nearbyintdf2, nearbyintsf2, nearbyintxf2): New expanders to
	implement nearbyint, nearbyintf and nearbyintl built-ins as
	inline x87 intrinsics.

2004-09-04  Richard Sandiford  <rsandifo@redhat.com>

	* config/mips/mips.md (SHORT): New mode macro.
	(size): New mode attribute.
	(extend[qh]i[sd]i2): Redefine using :GPR and :SHORT.
	(*extend[qh]i[sd]i2): New define_insn_and_split, combining previous
	*extend[qh]i[sd]i2 and *extend[qh]i[sd]i2_mem patterns.  Use only if
	!ISA_HAS_SEB_SEH.
	(*extend[qh]i[sd]i2_se[bh]): New pattern, combining previous
	*extend[qh]isi2_hw patterns and extending them to di.
	(extendqihi2): Implement as define_insn_and_split that produces
	extendqisi2 after reload.

2004-09-03  Devang Patel  <dpatel@apple.com>

	* Makefile.in (OBJS-common): Add tree-if-conv.o
	(tree-if-conv.o): New rule.
	* cfgloop.c (flow_loop_exit_edges_find): Set EDGE_LOOP_EXIT flag.
	(get_loop_body_in_bfs_order): New.
	* cfgloop.h (get_loop_body_in_bfs_order): New.
	* tree-flow.h (enum move_pos): Move here from ..
	* tree-ssa-loop-im.c (enum move_pos): here.
	(movement_possibility): Make externally visible.
	* tree-optimize.c (init_tree_optimization_passes): New entry for
	if conversion pass.
	* tree-pass.h (pass_if_conversion): New.
	* tree-ssa-operands.c (get_expr_operands): Handle COND_EXPR.
	* tree-if-conv.c: New file.
	* doc/passes.texi: Document tree if-conversion pass.
	* doc/tree-ssa.texi: Same.

2004-09-03  H.J. Lu  <hongjiu.lu@intel.com>

	PR target/14925:
	Makefile.in (LIB2ADDEHSTATIC): New.
	(LIB2ADDEHSHARED): New.
	(LIBUNWIND): New.
	(LIBUNWINDDEP): New.
	(SHLIBUNWIND_LINK): New.
	(SHLIBUNWIND_INSTALL): New.
	(libgcc.mk): Pass LIB2ADDEHSTATIC, LIB2ADDEHSHARED, LIBUNWIND,
	LIBUNWINDDEP, SHLIBUNWIND_LINK and SHLIBUNWIND_INSTALL.
	(clean): Remove libunwind*
	(stage1-start): Remove and copy stage1/libunwind*.
	(stage2-start): Remove and copy stage2/libunwind*.
	(stage3-start): Remove and copy stage3/libunwind*.
	(stage4-start): Remove and copy stage4/libunwind*.
	(stageprofile-start): Remove and copy stageprofile/libunwind*.
	(stagefeedback-start): Remove and copy stagefeedback/libunwind*.

	* config.gcc (ia64*-*-linux*): Always add t-libunwind to
	tmake_file. Add t-libunwind-elf and ia64/t-glibc-libunwind to
	tmake_file if --with-system-libunwind isn't used.

	* config/ia64/t-glibc-libunwind: New file.
	* config/t-libunwind-elf: Likewise.
	* unwind-compat.c: Likewise.
	* unwind-compat.h: Likewise.
	* unwind-dw2-fde-compat.c: Likewise.

	* config/ia64/t-glibc (LIB2ADDEH): Updated.
	* config/ia64/t-hpux (T_CFLAGS): Add -DUSE_LIBUNWIND_EXCEPTIONS.

	* config/ia64/unwind-ia64.c: Include "unwind-compat.h". Define
	aliases if needed.
	* unwind-dw2-fde-glibc.c: Likewise.
	* unwind-dw2.c: Likewise.

	* config/t-libunwind (LIB2ADDEH): Updated.
	(LIB2ADDEHSTATIC): New.
	(T_CFLAGS): Add -DUSE_LIBUNWIND_EXCEPTIONS.
	(TARGET_LIBGCC2_CFLAGS): Set to -DUSE_GAS_SYMVER.

	* configure.ac: Change --enable-libunwind-exceptions to
	--with-system-libunwind. Don't define USE_LIBUNWIND_EXCEPTIONS.
	* configure: Regenerated.
	* config.in: Updated.

	* doc/install.texi (ia64-*-linux): Require libunwind 0.98 or
	above and mention --with-system-libunwind.
	(ia64-*-hpux*): Mention --enable-libunwind-exceptions is
	removed in gcc 3.4.3 and later.

	* gcc.c (init_spec): Add -lunwind to -lgcc_s if
	USE_LIBUNWIND_EXCEPTIONS is defined.

	* mklibgcc.in: Support libunwind.

2004-09-03  H.J. Lu  <hongjiu.lu@intel.com>

	* config/i386/i386.c (x86_branch_hints): Remove m_PENT4 and
	m_NOCONA.

2004-09-03  Richard Henderson  <rth@redhat.com>

	PR middle-end/9997
	* cfgexpand.c (LOCAL_ALIGNMENT): Provide default.
	(STACK_ALIGNMENT_NEEDED, FRAME_GROWS_DOWNWARD): Likewise.
	(struct stack_var, EOC, stack_vars, stack_vars_alloc, stack_vars_num,
	stack_vars_sorted, stack_vars_conflict, stack_vars_conflict_alloc,
	frame_phase, get_decl_align_unit, add_stack_var, triangular_index,
	resize_stack_vars_conflict, add_stack_var_conflict,
	stack_var_conflict_p, add_alias_set_conflicts, stack_var_size_cmp,
	union_stack_vars, partition_stack_vars, dump_stack_var_partition,
	expand_one_stack_var_at, expand_stack_vars, expand_one_stack_var,
	expand_one_static_var, expand_one_hard_reg_var,
	expand_one_register_var, expand_one_error_var, defer_stack_allocation,
	expand_one_var, expand_used_vars_for_block, clear_tree_used): New.
	(expand_used_vars): Rewrite.
	* Makefile.in (cfgexpand.o): Update dependencies.

2004-09-04  Jan Hubicka  <jh@suse.cz>

	* cfg.c (free_edge): Use ggc_free.
	(expunge_block): Use ggc_free.
	* passes.c (rest_of_clean_state): Free after compilation.
	* tree-ssa.c (delete_tree_ssa): Free annotations; call release_defs
	* tree-ssanames.c (release_defs): Ignore non-SSA_NAME arguments.

2004-09-03  James E Wilson  <wilson@specifixinc.com>

	* tree-ssa-alias.c (may_be_aliased): Move TREE_STATIC check after
	DECL_EXTERNAL check.

2004-09-03  Eric Botcazou  <ebotcazou@libertysurf.fr>

	* final.c (output_in_slot): New global variable.
	(final_scan_insn): Add new state '2' to the 'nopeepholes' parameter.
	Pass 2 as 'nopeepholes' to self for insns in a SEQUENCE.  Set
	'output_in_slot' before invoking output_asm_insn.
	(output_asm_insn): Add a space after the tab if 'output_in_slot'
	is set.
	* config/sparc/sparc.c (output_return): Pass 2 as 'nopeepholes' to
	final_scan_insn.
	(output_sibcall): Likewise.

2004-09-03  Jan Hubicka  <jh@suse.cz>

	* tree-ssa-operands.c (fini_ssa_operands): ggc_free unused arrays.
	* tree-ssanames (init_ssanames): Likewise.

2004-09-03  Ziemowit Laski  <zlaski@apple.com>

	* stub-objc.c (objc_is_id, objc_declare_alias, objc_declare_class,
	objc_declare_protocols, objc_start_protocol,
	objc_start_class_interface, objc_start_category_interface,
	objc_continue_interface, objc_finish_interface,
	objc_add_instance_variable, objc_set_visibility, objc_set_method_type,
	objc_start_class_implementation, objc_start_category_implementation,
	objc_continue_implementation, objc_finish_implementation,
	objc_add_method_declaration, objc_start_method_definition,
	objc_finish_method_definition, objc_build_keyword_decl,
	objc_build_method_signature, objc_build_encode_expr,
	objc_build_protocol_expr, objc_build_selector_expr,
	objc_build_message_expr, objc_build_string_object,
	objc_get_class_reference, objc_get_protocol_qualified_type,
	objc_static_init_needed_p, objc_generate_static_init_call): New stubs.

2004-09-03  James E Wilson  <wilson@specifixinc.com>

	* config/mips/mips.h (TARGET_CPU_CPP_BUILTINS): Add __mips3d.

	* config/mips/generic.md (generic_frecip_fsqrt_step): New.
	* config/mips/mips-ps-3d.md (mips_rsqrt1_<fmt>): Use frsqrt1 type.
	(mips_rsqrt2_<fmt>): Use frsqrt2 type.
	(mips_recip1_<fmt>): Use frdiv1 type.
	(mips_recip2_<fmt>): Use frdiv2 type.
	* config/mips/mips.md (type): Add frdiv1, frdiv2, frsqrt1, frsqrt2.
	* config/mips/sb1.md (ir_sb1_fpu_2pipes, ir_sb1_fpu_1pipe): Add frdiv1
	and frsqrt1.
	(ir_sb1_fpu_step2_2pipes, ir_sb1_fpu_step2_1pipe): New.

2004-09-03  Daniel Jacobowitz  <dan@debian.org>

	* reload.c (find_reloads): Swap operand_loc pointers for
	find_dummy_reload if we have swapped two operands.

2004-09-03  Hans-Peter Nilsson  <hp@axis.com>

	* config/cris/cris.h (ASM_OUTPUT_CASE_END): Use prev_nonnote_insn
	to get the tablejump-insn before the jump-table label.

2004-09-03  Ziemowit Laski  <zlaski@apple.com>

	* c-common.h (objc_is_id, objc_declare_alias, objc_declare_class,
	objc_declare_protocols, objc_build_message_expr,
	objc_finish_message_expr, objc_build_selector_expr,
	objc_build_protocol_expr, objc_build_encode_expr,
	objc_build_string_object, objc_get_protocol_qualified_type,
	objc_get_class_reference, objc_get_class_ivars,
	objc_start_class_interface, objc_start_category_interface,
	objc_start_protocol, objc_continue_interface, objc_finish_interface,
	objc_start_class_implementation, objc_start_category_implementation,
	objc_continue_implementation, objc_finish_implementation,
	objc_set_visibility, objc_set_method_type, objc_build_method_signature,
	objc_add_method_declaration, objc_start_method_definition,
	objc_finish_method_definition, objc_add_instance_variable,
	objc_build_keyword_decl, objc_build_throw_stmt, objc_begin_try_stmt,
	objc_finish_try_stmt, objc_begin_catch_clause,
	objc_finish_catch_clause, objc_build_finally_clause,
	objc_build_synchronized, objc_static_init_needed_p,
	objc_generate_static_init_call): New prototypes.

2004-09-03  Steve Ellcey  <sje@cup.hp.com>

	* config/ia64/ia64.c (ia64_function_arg): Use PARALLEL even if there
	is only one reg.
	(ia64_function_value): Ditto.

2004-09-03  Jan Beulich  <jbeulich@novell.com>

	* config.gcc: Resurrect NetWare as a target. Handle special case of
	Novell linker to be used (specified through --with-ld=) and threading
	model of either Posix (default) or NKS.
	* config/i386/i386.c (ix86_return_pops_args): Conditionalize popping
	of incoming hidden argument on KEEP_AGGREGATE_RETURN_POINTER.
	* config/i386/i386.h (KEEP_AGGREGATE_RETURN_POINTER): New.
	* config/i386/netware.c, config/i386/netware.h: New.
	* config/i386/nwld.c, config/i386/nwld.h: New.
	* config/i386/netware-crt0.c: New.
	* config/i386/netware-libgcc.c: New.
	* config/i386/netware-libgcc.def: New.
	* config/i386/netware-libgcc.exp: New.
	* config/i386/t-netware, config/i386/t-nwld: New.
	* gthr-nks.h: New.
	* doc/install.texi: Document NKS threading model.

2004-09-03  Jan Beulich  <jbeulich@novell.com>

	PR c/7054
	* defaults.h (TARGET_DEFAULT_PACK_STRUCT): Provide default.
	* tree.h (initial_max_fld_align): Declare
	* stor-layout.c (initial_max_fld_align): Define and initialize.
	(maximum_field_alignment): Initialize to the same value.
	* common.opt: Add -fpack-struct= variant of switch.
	* opts.c: Handle -fpack-struct= variant of switch.
	* c-pragma.c: Change #pragma pack() handling so that it becomes
	compatible to other compilers: accept individual 'push' argument,
	make final pop restore (command line) default, correct interaction
	of push/pop and sole specification of a new alignment (so that the
	sequence #pragma pack(push) - #pragma pack(<n>) becomes identical
	to #pragma pack(push, <n>).
	* doc/extend.texi: New node "Structure-Packing Pragmas" under
	"Pragmas", describing #pragma pack.
	* doc/invoke.texi: Document -fpack-struct=<n> variant of switch.
	* doc/tm.texi: Adjust description for HANDLE_PRAGMA_PACK_PUSH_POP.
	Document new TARGET_DEFAULT_PACK_STRUCT.

2004-09-03  Devang Patel  <dpatel@apple.com>

	* dwarf2out.c (gen_field_die). Equate decl number to die.

2004-09-03  Vladimir Makarov  <vmakarov@redhat.com>

	PR target/15832
	* global.c (modify_reg_pav): New function.
	(make_accurate_live_analysis): Call the new function.  Move pavin
	modification by earlyclobber set into the new function.

2004-09-03  Andreas Schwab  <schwab@suse.de>

	* config/m68k/m68k.c (output_andsi3): Use -1 instead of
	(HOST_WIDE_INT)0xffffffff since CONST_INT value are always sign
	extended.

2004-09-02  Jan Beulich  <jbeulich@novell.com>

	* Makefile.in (LIB2ADDEHDEP): Add unwind.h and unwind-pe.h.
	* mklibgcc.in (libgcc_dep): New, covering general dependencies, but
	not unwind code specific ones.
	(libgcc2_c_dep): Replace general dependencies with use of libgcc_dep.
	Remove unwind code specific dependencies.
	(libgcov_c_dep): Replace general dependencies with use of libgcc_dep.
	Remove gbl-ctors.h.
	Add libgcc_dep to output generated for LIB2ADD, LIB2ADDEH, and
	LIB2ADD_ST. Add LIB2ADDEHDEP to output generated for LIB2ADDEH.
	* tsystem.h: Declare memcpy and memset when inhibit_libc.

2004-09-02  Roman Zippel  <zippel@linux-m68k.org>

	* combine.c (try_combine): Delay modifying of insns which cannot
	be easily undone.

2004-09-02  Daniel Berlin  <dberlin@dberlin.org>

	* gcc/common.opt: Rename ivcanon to tree-loop-ivcanon, tree-lim to
	tree-loop-im.
	* gcc/tree-ssa-loop.c: Ditto
	* gcc/tree-ssa-loop-ivcanon.c: Ditto
	* gcc/doc/invoke.texi: Ditto.

2004-09-02  Ziemowit Laski  <zlaski@apple.com>

	* c-decl.c (store_parm_decls_newstyle): Make static.
	(store_parm_decls_from): New function.
	* c-tree.h (store_parm_decls_newstyle): Remove prototype.
	(store_parm_decls_from): New prototype.

2004-09-02  David Edelsohn  <edelsohn@gnu.org>

	* config/rs6000/rs6000.c (expand_block_move): Use SImode and
	HImode with STRICT_ALIGNMENT.

2004-09-02  Mark Mitchell  <mark@codesourcery.com>

	* config/arm/bpabi.h (TARGET_BPABI_CPP_BUILTINS): Define.
	(TARGET_OS_CPP_BUILTINS): Likewise.
	* config/arm/symbian.h (TARGET_OS_CPP_BUILTINS): Include
	TARGET_BPABI_CPP_BUILTINS.

2004-09-02  Roman Zippel  <zippel@linux-m68k.org>

	* combine.c (distribute_notes): Don't add REG_LABEL to jump insn.

2004-09-02  Eric Christopher  <echristo@redhat.com>

	* builtins.c (expand_builtin_cabs): Delete.
	(expand_builtin): If unable to fold the values do a normal
	library call for builtin_cab*.
	(fold_builtin_cabs): Depend on optimize and optimize_size.
	* optabs.c (expand_cmplxdiv_straight): Delete.
	(expand_cmplxdiv_wide): Ditto.
	(expand_vector_binop): Ditto.
	(expand_vector_unop): Ditto.
	(expand_complex_abs): Delete.
	(expand_binop): Remove calls to above functions.
	Remove open coding of complex arithmetic.
	(expand_unop): Ditto.
	* optabs.h: Remove prototypes.

2004-09-02  Ziemowit Laski  <zlaski@apple.com>

	* c-decl.c (store_parm_decls_newstyle): Make externally visible.
	* c-tree.h (store_parm_decls_newstyle): New prototype.

2004-09-02  Geoffrey Keating  <geoffk@apple.com>

	* config/rs6000/rs6000.c (expand_block_clear): Use vector
	instructions if available.
	(expand_block_move): Likewise.

2004-09-03  Jan Hubicka  <jh@suse.cz>

	* rtl.def (RANGE_INFO, RANGE_REG, RANGE_VAR, RANGE_LIVE): Kill.

2004-09-02  Mark Mitchell  <mark@codesourcery.com>

	* config/arm/symbian.h (LIB_SPEC): Define to empty.
	* config/arm/t-symbian (SHLIB_LC): Likewise.

2004-09-02  Paul Brook  <paul@codesourcery.com>

	* config/arm/bpabi.c (__aeabi_ul2d, __aeabi_ul2f): Remove.

2004-09-02  Richard Sandiford  <rsandifo@redhat.com>

	* config/mips/mips.c (mips_classify_symbol, mips_fetch_insns):
	(mips_restore_gp, mips_set_return_address, mips_expand_prologue)
	(mips16_fp_args, mips_avoid_hazard): Replace abort with gcc_assert.
	(build_mips16_call_stub): Likewise.  Remove daft CALL_INSN checks.
	(mips_issue_rate): Remove unreachable abort.
	(mips_symbolic_constant_p, mips_symbolic_address_p, mips_symbol_insns)
	(mips_output_move, mips_relational_operand_ok_p, mips_arg_info)
	(mips_block_move_straight, print_operand_address, mips_file_start)
	(mips_initial_elimination_offset, mips16_fp_args, dump_constants_1)
	(mips_output_conditional_branch, mips_expand_builtin_direct)
	(mips_expand_builtin_compare): Replace abort with gcc_unreachable.
	* config/mips/mips.md (rotr<mode>3, consttable_float): Replace abort
	with gcc_assert.

2004-09-02  Richard Sandiford  <rsandifo@redhat.com>

	* config/mips/mips.md (*lea_high64): Change split condition to
	flow2_completed.  Add a peephole2 to generate a more parallel version.

2004-09-02  Jan Hubicka  <jh@suse.cz>

	* gimplify.c (gimplify_compound_lval): Move "stack" varray out of
	GGC.

	* ggc-page.c: include tree-flow.h.
	(extra_order_size_table): Add stmt_ann_d.
	(STAT_LABEL): Rename from ....
	(LABEL): ... this one.
	* Makefile.in (ggc-page.o): Add dependency.

	* ggc-common.c (ggc_force_collect): New global variable.
	(loc_description): Add fields "freed", "collected"
	(ptr_hash): New static hash
	(ptr_hash_entry): New structure.
	(hash_ptr,eq_ptr,ggc_prune_ptr): New static functions.
	(ggc_record_overhead): Take ptr argument, record it
	(ggc_prune_overhead_list, ggc_free_overhead): New functions.
	(cmp_statistics): Imrove sorting.
	(dump_ggc_loc_statistics): Output newly collected statistics
	* ggc-page.c (ggc_alloc): Update call of ggc_record_overhead
	(ggc_free): Call ggc_free_overhead.
	(ggc_collect): Force collection when asked to be forced.
	(ggc_collect): Call ggc_prune_overhead_list.
	* ggc.h (ggc_force_collect): Declare
	(ggc_record_overhead): Update prototype.
	(ggc_free_overhead, ggc_prune_overhead_list): Declare.

2004-09-02  James E Wilson  <wilson@specifixinc.com>

	* common.opt (ftrapping-math): Default to on.

2004-09-02  Richard Earnshaw  <rearnsha@arm.com>

	* arm/predicates.md (arm_reload_memory_operand): Allow MEM.

2004-09-02  Denis Chertykov  <denisc@overta.ru>

	PR target/16884
	* config/avr/avr.md ("movmemhi"): Substitute match_dup to
	match_scratch.
	(*movmemqi_insn): Likewise.
	(*movmemhi): Likewise.
	(clrmemhi): Likewise.
	(*clrmemqi): Likewise.
	(*clrmemhi): Likewise.

2004-09-02  Paul Brook  <paul@codesourcery.com>

	* config.gcc (arm*-*-eabi* | arm*-*-symbianelf*): Set
	default_use_cxa_atexit=yes.

2004-09-02  Alan Modra  <amodra@bigpond.net.au>

	* config/rs6000/linux64.h: Don't include signal.h or sys/ucontext.h.
	(struct kernel_old_ucontext): Delete.
	(struct gcc_pt_regs, gcc_sigcontext, gcc_ucontext): New.
	(MD_FALLBACK_FRAME_STATE_FOR): Use gcc_* structs.  Only define
	when IN_LIGGCC2.

2004-09-02  Richard Sandiford  <rsandifo@redhat.com>

	* toplev.c (process_options): Fix typo.

2004-09-01  Richard Henderson  <rth@redhat.com>

	PR middle-end/17258
	* calls.c (initialize_argument_information): Tighten pass-through
	conditions for pass-by-reference.  Remove dead TARGET_EXPR code.
	Use build_fold_addr_expr.
	(emit_library_call_value_1): Use build_fold_addr_expr.  Remove code
	that assumes ADDR_EXPR allocates stack space.
	* fold-const.c (build_fold_addr_expr_with_type): Look through
	WITH_SIZE_EXPR.

2004-09-01  Dan Nicolaescu  <dann@ics.uci.edu>

	* gengenrtl.c (gendef): Use rtx_alloc, don't do PUT_CODE.
	* ggc.h (ggc_alloc_rtx): Delete.

2004-09-01  Roger Sayle  <roger@eyesopen.com>

	* expmed.c (enum alg_code): Remove long unused enumeration values.
	(struct mult_cost): New structure to hold the "score" of a synthetic
	multiply sequence, including both a rtx_cost and a latency field.
	(MULT_COST_LESS): New macro to compare mult_cost to a constant.
	(CHEAPER_MULT_COST): New macro to compare two mult_costs.
	(struct algorithm): Change type of cost field to be mult_cost.
	(synth_mult): Change type of cost_limit argument to be a
	pointer to a mult_cost.  Update all cost comparisons to use the
	new mult_cost infrastructure.  For alg_add_factor and
	alg_sub_factor operations, latency is lower than the rtx_cost.
	(choose_mult_variant):  Update calls to synth_mult.  Perform
	cost comparisons using the new mult_cost infrastructure.
	(expand_mult_highpart): Use alg.cost.cost instead of alg.cost
	to optain the total rtx_cost of a synth_mult "algorithm".

2004-09-01  David Edelsohn  <edelsohn@gnu.org>

	* config/rs6000/power4.md: Increase store latency to 12.
	* config/rs6000/power5.md: Same.

2004-09-01  James E Wilson  <wilson@specifixinc.com>

	PR target/14064
	* config/avr/avr.c (avr_unique_section): Delete prototype and
	definition.
	(TARGET_ASM_UNIQUE_SECTION): Delete.

2004-09-01  Ziemowit Laski  <zlaski@apple.com>

	* c-parse.in (primary): Call objc_build_message_expr(),
	objc_build_selector_expr(), objc_build_protocol_expr(),
	objc_build_encode_expr() and objc_build_string_object() instead of
	build_message_expr(), build_selector_expr(), build_protocol_expr(),
	build_encode_expr() and build_objc_string_object(), respectively.
	(component_decl_list2): Call objc_get_class_ivars() instead of
	get_class_ivars_from_name().
	(keyworddecl): Call objc_build_keyword_decl() instead of
	build_keyword_decl().
	(receiver): Call objc_get_class_reference() instead of
	get_class_reference().
	(reswords): Add blank line before @@ifobjc section, for clarity.

2002-09-01  Fariborz Jahanian <fjahanian@apple.com>

	* config/rs6000/darwin.h (ROUND_TYPE_ALIGN): Restrict alignment
	to Altivec vetors.

2004-09-01  Wu Yongwei  <adah@sh163.net>
	    Danny Smith  <dannysmith@users.sourceforge.net>

	* gthr-win32.h (__gthread_recursive_mutex_t): Use 'unsigned long',
	not Windows 'DWORD'.
	(__GTHREAD_RECURSIVE_MUTEX_INIT_FUNCTION): Correct typo.
	(__GTHREAD_RECURSIVE_MUTEX_INIT_DEFAULT): Likewise.
	(__gthr_win32_recursive_mutex_init_function): Add prototype for
	__GTHREAD_HIDE_WIN32API case..
	(__gthr_win32_recursive_mutex_lock): Likewise.
	(__gthr_win32_recursive_mutex_trylock): Likewise.
	(__gthr_win32_recursive_mutex_unlock): Likewise.
	(__gthread_recursive_mutex_init_function); Add definition for
	__GTHREAD_HIDE_WIN32API case.
	(__gthread_recursive_mutex_lock): Correct call to InterlockedDecrement.
	* config/i386/grthr-win32.c (__gthread_recursive_mutex_lock): Correct
	call to InterlockedDecrement.

2004-09-01  Richard Kenner  <kenner@vlsi1.ultra.nyu.edu>

	* tree-tailcall.c (find_tail_calls): Also fail is statement has
	volatile operands.

	* tree-ssa.c (propagate_into_addr): Properly test for LHR.

	* doc/c-tree.texi: Document new operands for ARRAY_REF and
	COMPONENT_REF.

2004-09-01  Zdenek Dvorak  <rakdver@atrey.karlin.mff.cuni.cz>

	* Makefile.in (rtl-profile.o, value-prof.o): Add GCC_H dependency.
	* common.opt (fspeculative-prefetching): New.
	* flags.h (flag_speculative_prefetching_set): Declare.
	* gcov-io.c (gcov_write_counter, gcov_read_counter): Allow negative
	values.
	* opts.c (flag_sepculative_prefetching_set): New variable.
	(common_handle_option): Handle -fspeculative-prefetching.
	* passes.c (rest_of_compilation): Ditto.
	* profile.c (instrument_values, compute_value_histograms, branch_prob):
	Use vectors instead of arrays.
	* toplev.c (process_options): Handle -fspeculative-prefetching.
	* rtl-profile.c: Include ggc.h.
	(rtl_gen_interval_profiler, rtl_gen_pow2_profiler,
	rtl_gen_one_value_profiler_no_edge_manipulation,
	rtl_gen_one_value_profiler, rtl_gen_const_delta_profiler): Type of
	argument changed.
	* tree-profile.c (tree_gen_interval_profiler, tree_gen_pow2_profiler,
	tree_gen_one_value_profiler, tree_gen_const_delta_profiler): Type of
	argument changed.
	* value-prof.c: Include ggc.h.
	(NOPREFETCH_RANGE_MIN, NOPREFETCH_RANGE_MAX): New
	macros.
	(insn_prefetch_values_to_profile, find_mem_reference_1,
	find_mem_reference_2, find_mem_reference, gen_speculative_prefetch,
	speculative_prefetching_transform): New.
	(value_profile_transformations): Call speculative_prefetching_transform.
	(insn_values_to_profile): Call insn_prefetch_values_to_profile.
	(insn_divmod_values_to_profile, rtl_find_values_to_profile,
	tree_find_values_to_profile, find_values to profile): Use vectors
	instead of arrays.
	(free_profiled_values): Removed.
	* value-prof.h (struct histogram_value): Renamed to
	struct histogram_value_t.
	(histogram_value, histogram_values): New types.
	(find_values_to_profile): Declaration changed.
	(free_profiled_values): Removed.
	(struct profile_hooks): Type of argument of the hooks changed to
	histogram_value.
	* doc/invoke.texi (-fspeculative-prefetching): Document.

2004-09-01  Zdenek Dvorak  <rakdver@atrey.karlin.mff.cuni.cz>

	PR rtl-optimization/16408
	* gcse.c (replace_store_insn): Fix LIBCALL/RETVAL notes.

2004-09-01  Richard Henderson  <rth@redhat.com>

	* config/ns32k/ns32k.h (TRANSFER_FROM_TRAMPOLINE): Remove.
	(TRAMPOLINE_TEMPLATE): Merge code from __trampoline inline.

2004-09-01  Jakub Jelinek  <jakub@redhat.com>

	* libgcc-std.ver (GCC_3.4.2): Export also __trampoline_setup.

2004-09-01  Mike Stump  <mrs@apple.com>

	* config/darwin.c (machopic_symbol_defined_p): In addition to
	being SYMBOL_REF_LOCAL_P, a symbol must also be
	! SYMBOL_REF_EXTERNAL_P, as only those are _always_ locally
	defined in this output file, or translation unit in the case
	of IMA not being used.
	(machopic_output_indirection): SYMBOL_REF_LOCAL_P symbols
	never need .indirect_symbol when indirecting.

2004-09-01  Jakub Jelinek  <jakub@redhat.com>

	* Makefile.in (bb-reorder.o): Add several dependencies.

2004-09-01  Jakub Jelinek  <jakub@redhat.com>

	* fold-const.c (operand_equal_p): Require equal sign also for
	FIX_{CEIL,TRUNC,FLOOR,ROUND}_EXPR.

2004-09-01  Richard Earnshaw  <rearnsha@arm.com>

	* config.gcc (--with-cpu on ARM): Preserve the canonical cpu name
	for use in configargs.h.  Put the cname in a separate variable.  Use
	that to set target_cpu_default2.

2004-09-01  J"orn Rennecke <joern.rennecke@superh.com>
	    Nick Clifton  <nickc@redhat.com>

	* config/sh/sh.md ("length"): Increase branch length when
	SH1 pic code to 18: 12 bytes of instructions, 4 byte for the
	constant, 2 byte for aligning the constant.

2004-09-01  Richard Earnshaw  <rearnsha@arm.com>

	* arm/arm-cores.def (ARM_CORE): Add new field for the real name of the
	CPU.
	(arm7tdmi-s): New CPU name.
	* arm/arm.c (ARM_CORE): Update for new format.
	* arm/arm.h (ARM_CORE): Likewise.
	* arm/gentune.sh: Update for extra field.
	* config.gcc: Likewise.
	* arm/arm-tune.md: Regenerate.
	* doc/invoke.texi: Document the real processor names for ARM cpus.

2004-09-01  Richard Earnshaw  <rearnsha@arm.com>

	* arm/ieee754-df.S (aeabi_ul2d, aeabi_l2d, floatundidf)
	(floatdidf): New functions.
	* arm/ieee754-sf.S (aeabi_ul2f, aeabi_l2f, floatundisf)
	(floatdisf): New functions.
	* t-arm-elf: Use them.

2004-09-01  Ziemowit Laski  <zlaski@apple.com>

	* c-common.h (lookup_interface): Remove prototype.
	(is_class_name): Rename to objc_is_class_name.
	(lookup_objc_ivar): Rename to objc_lookup_ivar.
	(get_current_scope): Rename to objc_get_current_scope.
	* c-decl.c (get_current_scope): Rename to objc_get_current_scope.
	* c-parse.in (parmlist_or_identifiers_1): Get rid of unused variable.
	(yylexname): Call objc_is_class_name() instead of is_class_name().
	* c-typeck.c (build_external_ref): Call objc_lookup_ivar()
	instead of lookup_objc_ivar().
	* stub-objc.c (lookup_interface): Remove stub.
	(is_class_name): Rename to objc_is_class_name.
	(lookup_objc_ivar): Rename to objc_lookup_ivar.

2004-08-31  Mark Mitchell  <mark@codesourcery.com>

	* config.gcc (arm*-*-symbianelf*): Do not include t-bpabi.
	* config/arm/lib1funcs.asm: Do not include supplemental .S files
	when compiling for Symbian.
	* config/arm/symbian.h (RENAME_LIBRARY): New macro.
	(TARGET_OS_CPP_BUILTINS): Likewise.
	* config/arm/t-symbian (LIB1ASMFUNCS): Define.

2004-08-31  Stan Shebs  <shebs@apple.com>

	* toplev.c (process_options): Ensure debug_hooks is initialized.

2004-08-31  Mark Mitchell  <mark@codesourcery.com>

	* target-def.h (TARGET_CXX): Add TARGET_CXX_EXPORT_CLASS_DATA.
	* target.h (cxx): Add export_class_data.
	* config/arm/arm.c (arm_cxx_export_class_data): New function.
	(TARGET_CXX_EXPORT_CLASS_DATA): Use it.
	* doc/tm.texi (TARGET_CXX_EXPORT_CLASS_DATA): Document it.

2004-08-31  Kaz Kojima  <kkojima@gcc.gnu.org>

	* config/sh/sh.c (output_branch): Check the insn length possibly
	in the delayed slot.

2004-08-31  Richard Kenner  <kenner@vlsi1.ultra.nyu.edu>

	* tree-pretty-print.c (dump_generic_node, case CONVERT_EXPR): Add
	blank after ')'.
	(op_symbol, case *_{DIV,MOD}_EXPR): Say what rounding is being used.

	* c-common.c (c_alignof_expr): Use DECL_ALIGN_UNIT and TYPE_ALIGN_UNIT.
	(c_sizeof_of_alignof_type): Likewise.
	* expr.c (array_ref_element_size): Likewise.
	(highest_pow2_factor_for_target): Likewise.
	* gimplify.c (canonicalize_addr_expr): Likewise.
	(gimplify_compound_lval): Likewise.
	* stor-layout.c (finalize_record_size, finalize_type_size): Likewise.
	* tree-ssa-ccp.c (maybe_fold_offset_to_array_ref): Likewise.
	* varasm.c (assemble_variable): Likewise.
	(output_constant_def_contents): Alignments are unsigned.

2004-08-31  Richard Kenner  <kenner@vlsi1.ultra.nyu.edu>
	    Jeff Law  <law@redhat.com>

	* tree-cfg.c (cfg_remove_useless_stmts_bb): Also invalidate if VAL
	gets modified.

2004-08-31  Mark Mitchell  <mark@codesourcery.com>

	* hooks.c (hook_bool_void_true): New function.
	* hooks.h (hook_bool_void_true): Declare.
	* target-def.h (TARGET_CXX): Add
	TARGET_CXX_KEY_METHOD_MAY_BE_INLINE.
	* target.h (struct cxx): Add key_method_may_be_inline.
	* config/arm/arm.c (arm_cxx_key_method_may_be_inline): New
	function.
	(TARGET_CXX_KEY_METHOD_MAY_BE_INLINE): New macro.
	* config/arm/bpabi.h: Use __THUMB_INTERWORK__ instead of
	__THUMB_INTERWORK.

2004-08-31  Denis Chertykov  <denisc@overta.ru>

	PR target/15417
	* config/avr/avr.c (avr_hard_regno_mode_ok): Enable usage of
	frame pointer register only in Pmode while reload in progress.

2004-08-31  Stephane Carrez  <stcarrez@nerim.fr>

	PR target/15334
	* config/m68hc11/m68hc11.c (m68hc11_override_options): Disable -fweb
	because it breaks the 32-bit shift patterns that rely on a match_dup.

2004-08-31  Matt Austern  <austern@apple.com>

	* config/darwin.c (darwin_make_decl_one_only): Allocate section
	names once per compilation, instead of once per symbol.

2004-08-31  Paolo Bonzini  <bonzini@gnu.org>

	* Makefile.in (build_subdir): New substitution.
	(fixinc.sh): Simplify heavily since fixincludes is already built.
	(stmp-fixinc): Depend on specs.ready.
	(install-mkheaders): Use new location of fixincludes.
	(clean): Do not descend into fixinc.
	(FORBUILD): Replace with ../$(build_subdir).
	* configure.ac (build_subdir): Substitute.
	(FORBUILD): Do not set.
	(all_outputs): Remove fixinc/Makefile.
	(default commands): Do not create links in fixinc.
	* mkfixinc.sh: New, from fixinc/mkfixinc.sh without
	the fixincludes configuration steps and substituting
	@FIXINCL@ in fixinc.in.
	* fixinc.in: New, from fixinc/fixincl.sh.

	* fixinc/*: Removed.

2004-08-31  Joseph S. Myers  <jsm@polyomino.org.uk>

	* attribs.c (strip_attrs): Remove.
	(split_specs_attrs): Move ...
	* c-decl.c: ... to here.
	* tree.h (split_specs_attrs, strip_attrs): Remove.
	* c-tree.h (split_specs_attrs): Declare.

2004-08-31  Richard Sandiford  <rsandifo@redhat.com>

	* read-rtl.c: Disable RTL checking.
	(apply_macro_to_rtx): Use XTMPL to access 'T' fields.

2004-08-31  Richard Sandiford  <rsandifo@redhat.com>

	* config/mips/mips.md (fcond): New code macro and attribute.
	(sunordered_[sd]f, suneq_[sd]f, sunlt_[sd]f, sunle_[sd]f)
	(seq_[sd]f, slt_[sd]f, sle_[sd]f): Redefine using :SCALARF and fcond.
	(sgt_[sd]f, sge_[sd]f): Redefine using :SCALARF.

2004-08-30  Mark Mitchell  <mark@codesourcery.com>

	Revert:
	2004-08-29  Mark Mitchell  <mark@codesourcery.com>
	PR rtl-optimization/16590
	* gcse.c (pre_delete): Do not create invalid REG_EQUAL notes.

2004-08-30  Andrew Pinski  <apinski@apple.com>

	* hard-reg-set.h:
	s/HOST_BITS_PER_WIDES_FAST_INT/HOST_BITS_PER_WIDEST_FAST_INT.
	* ChangeLog: Fix previous ChangeLog entry.

	PR rtl-opt/13987
	* config.host (use_long_long_for_widest_fast_int): New, default is
	off.
	(ia64-*-hpux*): Enable use_long_long_for_widest_fast_int.
	* configure.ac: If use_long_long_for_widest_fast_int, then
	define USE_LONG_LONG_FOR_WIDEST_FAST_INT.
	* configure: Regenerate.
	* config.in: Regenerate.
	* hwint.h (HOST_WIDEST_FAST_INT, HOST_BITS_PER_WIDEST_FAST_INT):
	New: widest integer type supported efficiently in hardware for the
	host.
	* sbitmap.h (SBITMAP_ELT_BITS): Define based on
	HOST_BITS_PER_WIDEST_FAST_INT.
	(SBITMAP_ELT_TYPE): Define based on HOST_WIDEST_FAST_INT.
	* hard-reg-set.h (HARD_REG_ELT_TYPE): Define based on
	HOST_WIDEST_FAST_INT
	instead of HOST_WIDE_INT.
	(HARD_REG_SET_LONGS): Likewise.
	(UHOST_BITS_PER_WIDE_INT): Likewise.
	Change the checks for the fast cases to be based on
	HOST_BITS_PER_WIDEST_FAST_INT instead of HOST_BITS_PER_WIDE_INT.

2004-08-30  Steven Bosscher  <stevenb@suse.de>

	* cfgcleanup.c (merge_memattrs): Look at the value of MEM_SIZE,
	not the pointers.

2004-08-30  Geoffrey Keating  <geoffk@apple.com>

	PR 12738
	PR 17205
	Radar 3460526
	Radar 3775729
	* c-decl.c (grokdeclarator): Produce error for 'static' on local
	function declaration.

2004-08-30  Richard Henderson  <rth@redhat.com>

	* expr.c (array_ref_element_size): Force aligned_size back to
	sizetype.
	(component_ref_field_offset): Similarly for aligned_offset.
	* tree.c (recompute_tree_invarant_for_addr_expr): Mark raw
	low-bound, element-size, field-offset fields rather than
	computed values.

2004-08-30  Joseph S. Myers  <jsm@polyomino.org.uk>

	* c-parse.in (parmlist_or_identifiers_1): Remove unreachable and
	redundant code.

2004-08-30  Joseph S. Myers  <jsm@polyomino.org.uk>

	* c-tree.h (struct language_function): Add arg_info element.
	* c-decl.c (current_function_arg_info): New.
	(grokdeclarator, store_parm_decls): Use it instead of
	DECL_ARGUMENTS.
	(c_push_function_context, c_pop_function_context): Save and
	restore it.

2004-08-30  Richard Henderson  <rth@redhat.com>

	* c-typeck.c (build_unary_op): Don't expand ADDR_EXPR of a
	COMPONENT_REF to pointer arithmetic.
	* varasm.c (initializer_constant_valid_p): Allow "&(*c).f", for
	constant "c" as a valid constant initializer.  Allow narrowing of
	differences against the same base object, for any base object.

2004-08-30  Richard Henderson  <rth@redhat.com>

	* expr.c (expand_expr_addr_expr): New.
	(expand_expr_real_1) <case ADDR_EXPR>: Use it.

2004-08-30  Richard Sandiford  <rsandifo@redhat.com>

	* config/mips/mips.c (MIPS_FP_CONDITIONS): New macro.
	(mips_fp_condition): New enum.
	(mips_fp_conditions): New array.
	(print_fcc_operand): Delete.
	(print_operand): Remove %V, %v and %Q.  Redefine %Z so that it prints
	the operand and comma if and only if ISA_HAS_8CC.  Add %Y.
	(builtin_description): Add "cond" field.
	(DIRECT_BUILTIN): Initialize it.
	(CMP_{SCALAR,PS,4S}_BUILTINS, MOVTF_BUILTINS): Split INSN parameter
	into INSN and CODE.  Initialize the "cond" field.
	(CMP_BUILTINS): Update accordingly.
	(mips_bdesc): Use MIPS_FP_CONDITIONS to invoke CMP_BUILTINS.
	(mips_expand_builtin_movtf, mips_expand_builtin_compare): Take the
	mips_fp_condition as argument.  Make it the final operand of the
	comparison instruction.
	(mips_expand_builtin): Update accordingly.
	* config/mips/mips.md (UNSPEC_C_*, UNSPEC_CABS_*): Delete.
	(UNSPEC_C, UNSPEC_CABS): New constants.  Shuffle others to fill
	the gaps.
	* config/mips/mips-ps-3d.md (mips_cond_move_tf_ps, bc1any[24][ft]):
	Don't use the 'Q' operand prefix; just print the operand normally.
	(mips_cabs_*, mips_c_*): Delete, replacing with...
	(mips_c_cond_{ps,4s}, mips_cabs_cond_{s,d,ps,4s}): ...these new
	patterns.  Split the 4s versions into 2 ps patterns after reload.

2004-08-30  Richard Henderson  <rth@redhat.com>

	* fold-const.c (tree_expr_nonzero_p): Use get_base_address before
	assuming an ADDR_EXPR is non-null.

2004-08-30  Jason Merrill  <jason@redhat.com>

	* gthr-posix.h, gthr-dce.h: Add #pragma weaks.

2004-08-30  Nathan Sidwell  <nathan@codesourcery.com>

	* alias.c (mems_in_disjoint_alias_sets_p, record_alias_subset,
	record_set, rtx_equal_for_memref_p, init_alias_analysis): Use
	gcc_assert and gcc_unreachable instead of abort.
	* alloc-pool.c (abort, fancy_abort): Remove.
	(create_alloc_pool, free_alloc_pool, pool_alloc, pool_free): Use
	gcc_assert or gcc_unreachable.
	* attribs.c (init_attributes, decl_attributes): Likewise.
	* bb-reorder.c (FREE, find_traces_1_round, copy_bb,
	mark_bb_for_unlikely_executed_section,
	add_labels_and_missing_jumps, fix_crossing_conditional_branches,
	fix_crossing_unconditional_branches):  Likewise.
	* bitmap.c (bitmap_first_set_bit, bitmap_last_set_bit,
	bitmap_operation):  Likewise.
	* bt-load.c (insn_sets_btr_p, augment_live_range,
	move_btr_def):  Likewise.
	* builtins.c (c_readstr, expand_builtin_longjmp, apply_args_size,
	apply_result_size, expand_builtin_apply, expand_builtin_mathfn,
	expand_builtin_mathfn_2, expand_builtin_mathfn_3,
	builtin_memcpy_read_str, expand_movstr, expand_builtin_stpcpy,
	expand_builtin_memcmp, expand_builtin_args_info,
	std_gimplify_va_arg_expr, expand_builtin_unop,
	expand_builtin_fputs, expand_builtin_profile_func,
	expand_builtin_fork_or_exec, fold_builtin_bitop,
	fold_builtin_classify, fold_builtin_fputs): Likewise.

2004-08-30  Nathan Sidwell  <nathan@codesourcery.com>

	* gcov-io.c (GCOV_CHECK): Use gcc_assert when available.
	* gcov.c (abort): Remove undef.

	* tree.h (BINFO_PRIMARY_BASE_OF): Remove.
	(struct tree_binfo): Remove primary field.

2004-08-30  Paolo Bonzini  <bonzini@gnu.org>

	* fixinc/Makefile.in (machname.h): Remove.
	(fixincl.x): Do not pass $@ to genfixes.
	* fixinc/genfixes: Remove code to produce machname.h.
	* fixinc/fixincl.sh: Move it here instead.
	* fixinc/fixlib.c: Do not conditionalize on MN_NAME_PAT's presence,
	instead check if pz_mn_name_pat is NULL.  Make mn_get_regexps
	return a bool indicating whether pz_mn_name_pat is NULL.
	* fixinc/fixlib.h: Do not conditionalize on MN_NAME_PAT's presence.
	Declare extern C variables for the ENV_TABLE.
	* fixinc/fixfixes.c: Do not conditionalize on MN_NAME_PAT's presence,
	instead use the result of mn_get_regexps.
	* fixinc/fixtests.c: Likewise.

2004-08-30  Paolo Bonzini  <bonzini@gnu.org>

	* configure.ac: Do not run fixincludes after stage1 during
	toplevel bootstrap.
	* configure: Regenerate.

2004-08-30  Richard Earnshaw  <rearnsha@arm.com>

	* sched-deps.c (get_condition): Partially revert previous, by never
	trying to extract the condition from a condjump.

2004-08-30  Nathan Sidwell  <nathan@codesourcery.com>

	* c-common.c (c_sizeof_or_alignof_type): Use gcc_assert.
	(handle_visibility_attribute, c_determine_visibility): Likewise.
	* c-common.h (my_friendly_assert): Remove.

2004-08-30  Richard Sandiford  <rsandifo@redhat.com>

	* config/mips/mips.md (UNSPEC_{RSQRT,RECIP}[12]_{S,D,PS}): Delete.
	(UNSPEC_{RSQRT,RECIP}[12]): New constants.
	(UNSPEC_MOVE_TF_PS): Renumber to avoid gaps.
	* config/mips/mips-ps-3d.md (*movcc_v2sf_[sd]i): Use :GPR.
	(mips_{rsqrt,recip}[12]_{s,d,ps}): Use :ANYF.

2004-08-30  Diego Novillo  <dnovillo@redhat.com>

	* tree-pretty-print.c (dump_generic_node): Handle VALUE_HANDLE
	in COMPONENT_REF nodes.

2004-08-29  Gabriel Dos Reis  <gdr@integrable-solutions.net>

	PR c++/15378
	* c-opts.c (c_common_handle_option): <case OPT_Werror> set
	global_dc->warning_as_error_requested.
	* diagnostic.c (diagnostic_initialize): Tidy.
	* diagnostic.h (diagnostic_context::x_data): Remove
	(diagnostic_context::issue_warnings_are_errors_message): Rename
	from warnings_are_errors_message.
	(diagnostic_context::warning_as_error_requested): New.

2004-08-30  Richard Earnshaw  <rearnsha@arm.com>

	* sched-deps.c (get_condition): Fix breakage in previous patch.

2004-08-30  Paul Brook  <paul@codesourcery.com>

	* doc/install.texi: Fix broken mpfr link.

2004-08-29  David O'Brien  <obrien@FreeBSD.org>

	* config/rs6000/sysv4.h (LINK_OS_FREEBSD_SPEC): Sync '-p' handling with
	other FreeBSD platforms.

2004-08-29  Richard Earnshaw  <rearnsha@arm.com>

	* arm.h (REVERSE_CONDITION): Define.
	(REVERSIBLE_CC_MODE): All comparisons are now reversible.

2004-08-29  Richard Earnshaw  <rearnsha@arm.com>

	* flow.c (REVERSE_CONDEXEC_PREDICATES_P): Use the whole comparison, not
	just the codes, call reversed_comparison_code ().
	(ior_reg_cond): Update arguments to REVERSE_CONDEXEC_PREDICATES_P.
	(not_reg_cond): Use reversed_comparison_code.
	(and_reg_cond): Likewise.
	* ifcvt.c (cond_exec_process_if_block): Likewise.
	* doc/tm.texi (REVERSE_CONDEXEC_PREDICATES_P): Update documentation.

2004-08-29  Richard Earnshaw  <rearnsha@arm.com>

	* sched-deps.c (get_condition): Rewrite using jump support functions.
	Use reversed_comparison_code.
	(conditions_mutex_p): Use reversed_comparison_code.

2004-08-29  Richard Sandiford  <rsandifo@redhat.com>

	* config/mips/mips.c (override_options): Disable hot/cold partitioning
	for MIPS16.

2004-08-29  Richard Sandiford  <rsandifo@redhat.com>

	* config/mips/mips.h (mips_builtins, mips_cmp_choice): Delete.
	(mips_function_type): Move to mips.c.
	* config/mips/mips.c (mips_builtin_type): New enum.
	(builtin_description): Replace code and ftype with builtin_type
	and function_type.
	(DIRECT_BUILTIN, CMP_SCALAR_BUILTINS, CMP_PS_BUILTINS, CMP_4S_BUILTINS)
	(MOVTF_BUILTINS, CMP_BUILTINS): New macros.
	(CODE_FOR_mips_abs_ps): Define.
	(mips_bdesc): Use new macros.
	(mips_expand_builtin): Use builtin_type.  Update calls to subroutines.
	(mips_init_builtins): Use the mips_bdesc[] index as the function code.
	(mips_expand_builtin_direct): New function.
	(mips_expand_builtin_movtf): Renamed from mips_expand_ps_cond_move_
	builtin.  Replace boolean parameter with builtin_type.
	(mips_expand_compare_builtin, mips_expand_scalar_compare_builtin)
	(mips_expand_4s_compare_builtin): Delete, replacing with...
	(mips_expand_builtin_compare): ...this new function.

2004-08-29  Mark Mitchell  <mark@codesourcery.com>

	PR rtl-optimization/16590
	* gcse.c (pre_delete): Do not create invalid REG_EQUAL notes.

2004-08-29  Diego Novillo  <dnovillo@redhat.com>

	* tree-ssa-ccp.c (ccp_visit_stmt): Remove #if 0 guards.
	* tree-ssa-propagate.c: Fix documentation.

2004-08-29  Richard Sandiford  <rsandifo@redhat.com>

	* config/mips/mips.md (*mov[sd]f_on_*): Redefine using :SCALARF.
	(mov[sd]fcc): Likewise.

2004-08-29  Richard Sandiford  <rsandifo@redhat.com>

	* config/mips/mips.md (cmp[sd]f): Redefine using :SCALARF.

2004-08-29  Richard Sandiford  <rsandifo@redhat.com>

	* config/mips/mips.md (divide_condition): New mode attribute.
	(div[sd]f3, *div[sd]f3): Use it.  Redefine using :SCALARF.
	(sqrt[sd]f3): Redefine using SCALARF.
	(*recip[sd]f3, *rsqrt<mode>[ab]): Likewise.  Name formerly unnamed
	patterns.

2004-08-29  Richard Sandiford  <rsandifo@redhat.com>

	* config/mips/mips.md (ANYF, SCALARF): New mode macros.
	(loadx, storex, fmt, UNITMODE): New mode attributes.
	(add{sf,df,v2sf}3, sub{sf,df,v2sf}3): Redefine using :ANYF.
	(mul[sd]f3): Redefine using :SCALARF.
	(*mul[sd]f3): Renamed from mul[sd]f3_internal.  Use :SCALARF.
	(*mul[sd]3_r4300): Likewise mul[sd]f3_r4300.
	(*m{add,sub}{sf,df,v2sf}3): Name formerly unnamed patterns.  Use :ANYF.
	Check TARGET_FUSED_MADD for V2SF too.
	(*nm{add,sub}{sf,df,v2sf}3{,_fastmath}): Likewise, except v2sf patterns
	were already named.
	(abs{sf,df,v2sf}3, neg{sf,df,v2sf}3): Redefine using :ANYF.
	(*[sl][wd]xc1_[sd]i): Redefine using :ANYF.

2004-08-29  Richard Sandiford  <rsandifo@redhat.com>

	* config/mips/mips.c (mips_init_builtins): Simplify.  Only create
	V2SF_type_node if it will be needed.

2004-08-29  Richard Sandiford  <rsandifo@redhat.com>

	* config/mips/mips.h (MIPS_CMP_MOVT, MIPS_CMP_MOVF): Delete.
	* config/mips/mips.c (mips_prepare_builtin_arg): New function.
	(mips_prepare_builtin_target): New function.
	(mips_expand_builtin): Use them.  Update calls to subroutines.
	(mips_expand_ps_cond_move_builtin): Use the new functions.  Replace
	cmp_choice with a boolean argument to select between movt and movf.
	Take the comparison's icode as an argument, not the function's fcode.
	(mips_expand_compare_builtin): New function.  Rename existing function
	to mips_expand_scalar_compare_builtin.
	(mips_expand_scalar_compare_builtin, mips_expand_4s_compare_builtin)
	(mips_expand_ps_compare_builtin): Use the new functions.  Take the
	comparison's icode as an argument, not the builtin's fcode.

2004-08-29  Richard Sandiford  <rsandifo@redhat.com>

	* config/mips/mips.c (print_operand): Remove '%Y' and '%y'.
	(mips_expand_4s_compare_builtin): Redefine CCV4 to be 0 if all
	registers are false and -1 if all registers are true.
	(mips_expand_ps_compare_builtin): Likewise CCV2.  Use subregs for
	MIPS_CMP_UPPER and MIPS_CMP_LOWER.
	* config/mips/mips.md (mips_cond_move_tf_ps): Use %Q rather than %y.
	(bc1any4t, bc1any4f): Adjust for new CCV4 interpretation.
	(bc1any2t, bc1any2f): Likewise CCV2.
	(bc1upper2t, bc1lower2t, bc1upper2f, bc1lower2f): Delete.

2004-08-29  Richard Sandiford  <rsandifo@redhat.com>

	* config/mips/mips.md (UNSPEC_MOVE_TF_PS): New.
	* config/mips/mips-ps-3d.md (mips_cond_move_tf_ps): Express as an
	UNSPEC rather than an IF_THEN_ELSE.
	* config/mips/mips.c (mips_expand_ps_cond_move_builtin): Emit
	mips_cond_move_tf_ps by name.

2004-08-29  Chao-ying Fu  <fu@mips.com>
	    James E Wilson  <wilson@specifixinc.com>

	* config/mips/mips-modes.def (V2SF, CCV2, CCV4): New modes. Give CCV2
	8 byte size and alignment.  Give CCV4 16 byte size and alignment.
	* config/mips/mips-ps-3d.md: New file.
	* config/mips/mips.c (TARGET_VECTOR_MODE_SUPPORTED_P,
	TARGET_INIT_BUILTINS, TARGET_EXPAND_BUILTIN): Define.
	(mips_const_insns): Handle CONST_VECTOR the same as CONST_DOUBLE.
	(mips_output_move): Emit "mov.ps" for V2SFmode.
	(mips_arg_info): Add checks for VECTOR_FLOAT_TYPE_P and
	MODE_VECTOR_FLOAT.
	(override_options): Check if TARGET_MIPS3D and there was an explicit
	!TARGET_PAIRED_SINGLE_FLOAT.  Set MASK_PAIRED_SINGLE, if TARGET_MIPS3D.
	Check if TARGET_FLOAT64 and TARGET_HARD_FLOAT are both true, when
	TARGET_PAIRED_SINGLE_FLOAT is true.  Check if the ISA supports
	TARGET_PAIRED_SINGLE_FLOAT.  Allow MODE_VECTOR_FLOAT in fp registers,
	and allow CCV2 and CCV4 to occupy two and four CC registers.
	(print_fcc_operand): New function.
	(print_operand): Add %Y, %y, %V, %v, %Q for CCV2, CCV4, CC.  Modify
	%Z to call print_fcc_operand.
	(mips_function_value): Handle MODE_VECTOR_FLOAT.
	(mips_class_max_nregs): Check for ST_REGS, and handle CCmodes.
	(mips_vector_mode_supported_p): New function.
	(mips_hard_regno_nregs): Check for ST_REG_P, and handle CCmodes.
	(builtin_description): New struct.
	(mips_bdesc): New array of struct builtin_description.
	(mips_expand_builtin, mips_init_builtins,
	mips_expand_ps_cond_move_builtin, mips_expand_4s_compare_builtin,
	mips_expand_compare_builtin, mips_expand_ps_compare_builtin): New
	functions.
	* config/mips/mips.h (MASK_PAIRED_SINGLE, MASK_MIPS3D): New defines.
	(TARGET_PAIRED_SINGLE_FLOAT, TARGET_MIPS3D): New defines.
	(TARGET_CPU_CPP_BUILTINS): Add __mips_paired_single_float.
	(TARGET_SWITCHES): Added "-mpaired-single", "-mno-paired-single",
	"-mips3d", and "-mno-mips3d".
	(ASM_SPEC): Map -mips3d to -mips3d in gas.
	(EXTRA_CONSTRAINT_Y): New macro.
	(EXTRA_CONSTRAINT_STR): Renamed from EXTRA_CONSTRAINT.  Add new
	multi-letter constraint 'Y'.
	(CONSTRAINT_LEN): New macro.
	(enum mips_builtins): New for MIPS builtin functions.
	(enum mips_function_type): New for the types of MIPS builtin functions.
	(enum mips_cmp_choice): New for the MIPS comparison builtin functions.
	* config/mips/mips.md: New constants for paired single and MIPS-3D
	instructions.  Include the new mips-ps-3d.md file.
	(addv2sf3, subv2sf3, mulv2sf3, absv2sf2, negv2sf2, movv2sf,
	movv2sf_hardfloat_64bit): New named patterns.
	(madd.ps, msub.ps, nmaddv2sf, nmaddv2sf_fastmath, nmsubv2sf,
	nmsubv2sf_fastmath, ldxc1_v2sf_si, ldxc1_v2sf_di, sdxc1_v2sf_si,
	sdxc1_v2sf_di): New unnamed patterns.
	* config/mips/predicates.md (const_0_operand, const_1_operand): Add
	const_vector support.
	(const_0_or_1_operand): New predicate.
	* doc/invoke.texi (MIPS Options): Add -mpaired-single and -mips3d.

2004-08-29  Diego Novillo  <dnovillo@redhat.com>

	* Makefile.in (OBJS-common): Add tree-ssa-propagate.o
	(tree-ssa-propagate.o): New rule.
	(GTFILES): Add tree-ssa-propagate.c.
	* tree-flow.h (struct stmt_ann_d): Remove field
	in_ccp_worklist.
	* tree-ssa-propagate.c: New file.
	* tree-ssa-propagate.h: New file.
	* tree-ssa-ccp.c: Re-write to use the routines from
	tree-ssa-propagate.c.

2004-08-28  Andrew Pinski  <apinski@apple.com>

	* tree-ssa-loop.c: Remove extra include of basic-block.h.

2004-08-28  Ziemowit Laski  <zlaski@apple.com>

	* c-common.h: Update comments about ObjC/ObjC++ entry points.
	(objc_is_reserved_word): New prototype.
	(get_current_scope, objc_mark_locals_volatile): Move prototypes to
	separate section; these are call-backs.
	* c-lex.c (c_lex_with_flags): Call objc_is_reserved_word() to detect
	ObjC/ObjC++ "@" keywords.
	* c-tree.h (get_current_scope, objc_mark_locals_volatile): Remove
	prototypes; they already live in c-common.h.
	* stub-objc.c: Update copyright notice.
	(objc_is_reserved_word): New stub.

2004-08-28  Nathan Sidwell  <nathan@codesourcery.com>

	* system.h (gcc_assert): Remove __builtin_expect.  Evaluate EXPR
	even when not checking.

2004-08-27  Jason Merrill  <jason@redhat.com>

	PR c++/13684
	* gimplify.c (gimplify_cleanup_point_expr): Handle CLEANUP_EH_ONLY.
	(gimple_push_cleanup): Add eh_only parm.
	(gimplify_target_expr): Pass it.
	* c.opt (-fno-threadsafe-statics): New option.
	* c-opts.c (c_common_handle_option): Handle it.
	* c-common.h (flag_threadsafe_statics): Declare it.
	* c-common.c (flag_threadsafe_statics): Record it.
	* doc/invoke.texi: Document it.
	* tsystem.h (_GNU_SOURCE): Define.
	* gthr-posix.h (__gthread_recursive_mutex_t): New typedef.
	(__GTHREAD_RECURSIVE_MUTEX_INIT): New macro.
	(__GTHREAD_RECURSIVE_MUTEX_INIT_FUNCTION): New macro.
	(__gthread_recursive_mutex_init_function): New fn.
	(__gthread_recursive_mutex_lock): New fn.
	(__gthread_recursive_mutex_trylock): New fn.
	(__gthread_recursive_mutex_unlock): New fn.
	* gthr-solaris.h, gthr-single.h, gthr-dce.h: Likewise.
	* gthr-win32.h, gthr-vxworks.h: Likewise.
	* gthr.h: Document.

2004-08-27  David Edelsohn  <edelsohn@gnu.org>

	* config/rs6000/rs6000.c (rs6000_override_options): Increase
	maximum skip to 15.  Set function alignment, jump alignment, and
	loop alignment to 16 for processors that form dispatch groups.
	(rs6000_rtx_costs): outer_code is used.

2004-08-27  Nathan Sidwell  <nathan@codesourcery.com>

	* stor-layout.c (sizetype_set): Remove.
	(set_sizetype): Don't test or set it.

	* tree.h (size_int_type): Remove.
	* fold-const.c: Do not #include gt-fold-const.h.
	(size_htab_hash, size_htab_eq): Remove.
	(size_int_kind): Use build_int_cst.
	(new_const, size_htab): Remove.
	(size_int_type): Remove.
	(round_up): Use build_int_cst.
	(round_down): Likewise. Remove spurious constant build.

2004-08-27  Nathan Sidwell  <nathan@codesourcery.com>

	* configure.ac: Add ENABLE_ASSERT_CHECKING control.
	Add is_release variable, use it for --enable-werror and
	--enable-checking defaults.
	* system.h (gcc_assert, gcc_unreachable): New.
	* doc/install.texi (--enable-checking): Update.
	* configure, config.in: Rebuilt.

2004-08-26  Richard Sandiford  <rsandifo@redhat.com>

	* rtl.h (read_rtx): Change prototype.
	* read-rtl.c (read_rtx): Provide the caller with both an rtx and a
	line number.  Return true on success.
	* gensupport.c (process_include, init_md_reader_args_cb): Adjust
	callers accordingly.

2004-08-26  Richard Henderson  <rth@redhat.com>

	* c-typeck.c (build_offsetof): Remove.
	* c-tree.h (build_offsetof): Remove.
	* c-common.c (fold_offsetof_1, fold_offsetof): New.
	* c-common.h (fold_offsetof): Declare.
	* c-parse.in (offsetof_base): New.
	(offsetof_member_designator): Use it.  Build references, not just
	a tree list.
	(primary): Use fold_offsetof, not build_offsetof.

2004-08-26  Richard Henderson  <rth@redhat.com>

	* tree.c (staticp): Return the static object.
	* tree.h (staticp): Update decl.
	* langhooks.h (struct lang_hooks): Change staticp return type to tree.
	* langhooks.c (lhd_staticp): Return NULL_TREE.
	* langhooks-def.h (lhd_staticp): Update decl.
	* c-common.c (c_staticp): Return the static object.
	* c-common.h (c_staticp): Update decl.

2004-08-26  Richard Henderson  <rth@redhat.com>

	* config/alpha/alpha.h (HARD_REGNO_MODE_OK): Allow complex float
	modes.

2004-08-26  Joseph S. Myers  <jsm@polyomino.org.uk>

	PR c/13801
	* c-decl.c (struct c_binding): Add type and inner_comp fields.
	(bind): Set type and inner_comp fields.
	(pop_scope): Restore type of decl to the correct type from an
	outer scope.  Give error when popping file scope for incomplete
	arrays completed incompatibly with default initialization in an
	inner scope.
	(diagnose_mismatched_decls): Handle externs with initializers at
	block scope.
	(pushdecl): Set type of external declaration at block scope based
	only on the visible declarations.  Save type when changing the
	type of a declaration.  Merge an external declaration at block
	scope with a visible static declaration at file scope.
	(implicitly_declare): Give recycled old declaration the new type
	except for incompatible declarations of built-in functions, saving
	the old type.

2004-08-26  Ziemowit Laski  <zlaski@apple.com>

	* c-parse.in (OBJC_TYPE_QUAL): New %token for ObjC use.

2004-08-26  Daniel Berlin  <dberlin@dberlin.org>

	* tree-alias-common.c (gate_pta): New function.
	(pass_build_pta): Use it.
	(pass_del_pta): Use it.
	(delete_alias_vars): Don't check flag_tree_points_to.

2004-08-26  Fariborz Jahanian  <fjahanian@apple.com>

	* config/rs6000/rs6000.h (HARD_REGNO_CALL_PART_CLOBBERED): Added
	TFmode as additional register mode cloberred by call.

2004-08-26  Fariborz Jahanian  <fjahanian@apple.com>

	* config/rs6000/rs6000.c (rs6000_libcall_value): Generate
	parallel pattern for library call returning DImode in
	mixed mode.

2004-08-26  Fariborz Jahanian  <fjahanian@apple.com>

	* config/rs6000/rs6000.c (function_arg): Generate parallel
	pattern for more split args.

2004-08-26  Fariborz Jahanian  <fjahanian@apple.com>

	* config/rs6000/rs6000.c (rs6000_split_multireg_move): Call
	either gen_movdi_di_update or gen_movdi_si_update depending on
	target mode.
	* config/rs6000/rs6000.md (movdi_update): Changed to movdi_<mode>_update,
	to generate two versions.

2004-08-26  Daniel Berlin  <dberlin@dberlin.org>

	* Makefile.in (lambda-code.o): New.
	(lambda-trans.o): Ditto.
	(TREE_DATA_REF_H): Ditto.
	(LAMBDA_H): Ditto.
	(lambda-mat.o): Use LAMBDA_H.
	(tree-data-ref.o): Ditto.
	* lambda-code.c: New file.  Lambda code generation algorithm.
	* lambda-trans.c: Ditto. Lambda transformation matrix support.
	* lambda.h: Add lambda loop structures.
	Add lambda loopnest structures.
	Add lambda body vector structure.
	Add lambda linear expression structures.
	Add prototypes for functions in new files.
	* lambda-mat.c: Include tree.h

2004-08-26  Daniel Berlin <dberlin@dberlin.org>
	    Sebastian Pop  <pop@cri.ensmp.fr>

	* tree-data-ref.h: Include lambda.h
	(free_dependence_relation): Declared here.
	(free_dependence_relations): Ditto.
	(free_data_refs): Ditto.
	* tree-data-ref.c (free_dependence_relation): New function.
	(free_dependence_relations): Ditto.
	(free_data_refs): Ditot.
	(analyze_all_data_dependences): Free datarefs and dependence_relations.
	(build_classic_dist_vector): Store in the dependence_relations the
	information. Each arc in the dependence_relations graph is labelled
	with the distance and direction vectors.
	(build_classic_dir_vector): Ditto.
	(compute_rw_wr_ww_dependences): Renamed again compute_all_dependences.
	Now computes again the whole dependence graph including read-read
	relations.
	(compute_data_dependences_for_loop): Now dependence_relations contains
	all the data, and thus it doesn't need to initialize the classic_dir
	and classic_dist vectors.
	(analyze_all_data_dependences): Adjusted for using the new interface of
	compute_data_dependences_for_loop.  Remove the statistics dump.

2004-08-26  Bob Wilson  <bob.wilson@acm.org>

	* config/xtensa/xtensa.c (xtensa_ld_opcodes, xtensa_st_opcodes): Delete.
	(xtensa_expand_block_move): Update comment.
	(override_options): Remove initialization of xtensa_{ld,st}_opcodes.

2004-08026  Richard Earnshaw  <rearnsha@arm.com>

	PR target/13506
	* toplev.c (crash_signal): If we crashed while emitting
	a user asm, then die more gracefully.

2004-08-26  Kazuhiro Inaoka  <inaoka.kazuhiro@renesas.com>

	PR target/17119.
	* config/m32r.c (gen_compare): Use reg_or_int16_operand when
	checking for a valid constant, regardless of sign.

2004-08-25  Richard Henderson  <rth@redhat.com>

	PR target/16974
	* config/alpha/alpha.md (adddi_fp_hack): Don't rely on splitting
	if the constant satisfies add_operand.

2004-08-25  Richard Henderson  <rth@redhat.com>

	PR debug/10695
	* config/alpha/alpha.c (emit_frame_store_1, emit_frame_store): New.
	(alpha_expand_prologue): Handle >32-bit frames.  Generate proper
	unwind info for >16-bit frames.

2004-08-25  Richard B. Kreckel  <richard.kreckel@framatome-anp.com>

	PR target/17171
	* config/i386/gas.h (ASM_COMMENT_START): Define to "#".

2004-08-25  Richard Henderson  <rth@redhat.com>

	* config/alpha/alpha.c (alpha_cannot_force_const_mem): New.
	(TARGET_CANNOT_FORCE_CONST_MEM): New.

2004-08-25  Andrew MacLeod  <amacleod@redhat.com>

	* doc/tree-ssa.texi: Document new operand iterator.

2004-08-26  Alan Modra  <amodra@bigpond.net.au>

	PR target/16480
	* config/rs6000/rs6000.c (rs6000_split_multireg_move): Don't abort
	on "(mem (symbol_ref ..))" rtl.  Look at LO_SUM base regs as well
	as PLUS base regs.

2005-08-28  Paul Brook  <paul@codesourcery.com>

	* config/arm/symbian.h (SUBTARGET_ASM_FLOAT_SPEC): Default to
	-mfpu=vfp -march=armv5t
	* config/arm/t-symbian: Change multilib to mfloat-abi=softfp.

2004-08-25  Richard Henderson  <rth@redhat.com>

	* target-def.h (TARGET_SCALAR_MODE_SUPPORTED_P): New.
	* target.h (struct gcc_target): Add scalar_mode_supported_p.
	* targhooks.c (default_scalar_mode_supported_p): New.
	* targhooks.h (default_scalar_mode_supported_p): Declare.
	* doc/tm.texi (TARGET_SCALAR_MODE_SUPPORTED_P): Document.

	* c-common.c (handle_mode_attribute): Query scalar_mode_supported_p
	before attempting to create types.  Tidy.
	* expr.c (vector_mode_valid_p): Use scalar_mode_supported_p.

	* config/alpha/alpha.c (alpha_scalar_mode_supported_p): New.
	(TARGET_SCALAR_MODE_SUPPORTED_P): New.

2004-08-25  Richard Henderson  <rth@redhat.com>

	* config/i386/freebsd.h (SUBTARGET_OVERRIDE_OPTIONS): Don't
	set REAL_MODE_FORMAT for TFmode.

2004-08-25  Ziemowit Laski  <zlaski@apple.com>

	* c-decl.c (grokparm): New function.
	* c-tree.h (grokparm): New prototype.

2004-08-25  Andrew MacLeod  <amacleod@redhat.com>

	* tree-ssa-operands.h (struct ssa_operand_iterator_d): New.  SSA operand
	iterator controlling structure.
	(SSA_OP_USE, SSA_OP_DEF, SSA_OP_VUSE, SSA_OP_VMAYUSE, SSA_OP_VMAYDEF,
	SSA_OP_VMUSTDEF, SSA_OP_VIRTUAL_USES, SSA_OP_VIRTUAL_DEFS,
	SSA_OP_ALL_USES, SSA_OP_ALL_DEFS, SSA_OP_ALL_OPERANDS): New.  Operand
	iterator flags.
	(FOR_EACH_SSA_TREE_OPERAND): New.  Iterate over operands as trees.
	(FOR_EACH_SSA_USE_OPERAND): New.  Iterate over operands as uses.
	(FOR_EACH_SSA_DEF_OPERAND): New.  Iterate over operands as defs.
	(FOR_EACH_SSA_MAYDEF_OPERAND): New.  Iterate over V_MAY_DEFs.
	* tree-ssa-operands.c (NULL_DEF_OPERAND_P, NULL_USE_OPERAND_P): New.
	Empty operand pointers.
	* tree-flow-inline.h (op_iter_done): New.  Return true if finished.
	(op_iter_next_use): New.  Return next use_operand_p.
	(op_iter_next_def): New.  Return next def_operand_p.
	(op_iter_next_tree): New.  Return next operands as a tree.
	(op_iter_init): New.  Initialize an iterator structure.
	(op_iter_init_use): New.  Initialize structure and get the first use.
	(op_iter_init_def): New.  Initialize structure and get the first def.
	(op_iter_init_tree): New.  Initialize structure and get the first tree.
	(op_iter_next_maydef): New.  Return next V_MAY_DEF operands.
	(op_iter_init_maydef): New.  Initialize structure and get the first
	V_MAY_DEF operands.
	* tree-cfg.c (tree_duplicate_bb): Use new operand iterator.
	* tree-dfa.c (compute_immediate_uses_for_stmt,
	redirect_immediate_uses): Use new operand iterator.
	(v_may_defs_disappeared_p, v_must_defs_disappeared_p): Delete.
	(mark_new_vars_to_rename): Use new operand iterator.  Count virtual
	operands instead of using *_disappeared_p routines.
	* tree-into-ssa.c (mark_def_sites, ssa_mark_def_sites, rewrite_stmt,
	ssa_rewrite_stmt): Use new operand iterator.
	* tree-outof-ssa.c (check_replaceable, find_replaceable_in_bb,
	rewrite_trees): Use new operand iterator.
	* tree-pretty-print.c (dump_vops): Use new operand iterator.
	* tree-sra.c (mark_all_v_defs): Use new operand iterator.
	* tree-ssa-alias.c (compute_points_to_and_addr_escape,
	dump_points_to_info): Use new operand iterator.
	* tree-ssa-ccp.c (cp_lattice_meet, visit_stmt, initialize,
	replace_uses_in, replace_vuse_in, likely_value, set_rhs): Use new
	operand iterator.
	* tree-ssa-dce.c (mark_stmt_if_obviously_necessary,
	propagate_necessity): Use new operand iterator.
	* tree-ssa-dom.c (cprop_into_stmt, optimize_stmt): Use operand iterator.
	(register_definitions_for_stmt): Use new operand iterator.  Take stmt as
	a parameter instead of a stmt_ann_t.
	* tree-ssa-live.c (create_ssa_var_map, calculate_live_on_entry,
	build_tree_conflict_graph): Use new operand iterator.
	* tree-ssa-loop-im.c (determine_max_movement, single_reachable_address,
	rewrite_mem_refs): Use new operand iterator.
	* tree-ssa-loop-manip.c (find_uses_to_rename_stmt,
	check_loop_closed_ssa_use): Use new operand iterator.
	* tree-ssa.c (verify_ssa, replace_immediate_uses): Use operand iterator.
	* tree-ssanames.c (release_defs): Use new operand iterator.
	* tree-vectorizer.c (vect_create_data_ref): Use new operand iterator.

2004-08-25  Adam Nemet  <anemet@lnxw.com>

	* tlink.c (initial_cwd): New variable.
	(tlink_init): Initialize it.
	(recompile_files): Use tlink_execute() instead of system().  Don't
	duplicate verbose output of collect_execute.  Restore initial_cwd.
	Update comment before the function.

2004-08-25  Ziemowit Laski  <zlaski@apple.com>

	* c-typeck.c (build_c_cast): In ObjC, always preserve (and silently
	accept) a cast from one Objective-C pointer type to another.

2004-08-25  Paolo Carlini  <pcarlini@suse.de>

	* doc/install.texi: Document that libstdc++-v3 requires
	now automake 1.9.1.

2004-08-25  Caroline Tice  <ctice@apple.com>

	* bb-reorder.c (partition_hot_cold_basic_blocks):  Add more details
	to comments at start of function.
	* cfgbuild.c (make_edges):  Add more details to hot/cold partitioning
	comment.
	* cfgcleanup.c (try_simplify_condjump, try_forward_edges,
	merge_blocks_move_predecessor_nojumps,
	merge_blocks_move_successor_nojumps, merge_blocks_move,
	try_crossjump_to_edge, try_crossjump_bb): Likewise.
	* cfglayout.c (fixup_reorder_chain): Likewise.
	* cfgrtl.c (rtl_can_merge_blocks, try_redirect_by_replacing_jump,
	cfg_layout_can_merge_blocks_p):  Likewise.
	* ifcvt.c (find_if_case_1, find_if_case_2): Likewise.
	* passes.c (rest_of_compilation): Update comments for calling
	optimization that partitions hot/cold basic blocks.
	* doc/invoke.texi:  Update documentation of
	freorder-blocks-and-partition flag.

2004-08-25  Richard Sandiford  <rsandifo@redhat.com>

	* config/mips/mips.md (reg): Renamed mode attribute from ccreg.
	(*mov*_on_*): Adjust accordingly.  Add an explicit MOVECC: prefix.

2004-08-25  Richard Sandiford  <rsandifo@redhat.com>

	* config/mips/mips.md (any_shift): New code macro.
	(optab, insn): New code attributes.
	({ashl,ashr,lshr}[sd]i3): Redefine using :GPR and any_shift.
	Use the standard rather than internal patterns for the MIPS16
	double-shift optimization.
	(*{ashl,ashr,lshr}[sd]i3): New names for the non-mips16 shift patterns.
	Redefine using :GPR and any_shift.
	(*{ashl,ashr,lshr}si3_extend): Generalize ashlsi3_internal1_extend
	to cover all three shifts.
	(*{ashl,ashr,lshr}si3_mips16): New names for the mips16 SImode shifts.
	Redefine using any_shift.  Use :GPR and any_shift to combine splitters.
	(*{ashl,ashr,lshr}di3_mips16): New names for the mips16 DImode shifts.

2004-08-24  Geoffrey Keating  <geoffk@apple.com>

	* gimplify.c (lookup_tmp_var): Separate temporaries when not
	optimizing.

2004-08-25  John David Anglin  <dave.anglin@nrc-cnrc.gc.ca>

	PR libstdc++/17005 (fix for HP-UX 11.11)
	* config.gcc (hppa*-*-*): Move MASK_BIG_SWITCH to target_cpu_default2.
	(hppa*-*-hpux*): Consolidate hppa1.0-*-* code.  Rework handling of
	tm_file including pa-hpux1010.h or pa-hpux1111.h when appropriate.
	* config/pa/pa-hpux1010.h, config/pa/pa-hpux1111.h: New files.
	* config/pa/pa-hpux.h (TARGET_HPUX): Define.
	(LINK_SPEC): Handle march=1.0 option.
	* config/pa/pa-hpux10.h (TARGET_OS_CPP_BUILTINS): Predefine _XOPEN_UNIX
	and _XOPEN_SOURCE_EXTENDED for UNIX 95.
	(SUBTARGET_OPTIONS): New define.
	(LINK_SPEC): Handle march=1.0 option.
	(STARTFILE_SPEC): New define.
	* config/pa/pa-hpux11.h (TARGET_OS_CPP_BUILTINS): Predefine _XOPEN_UNIX
	and _XOPEN_SOURCE_EXTENDED for UNIX 95.  Additionally, predefine
	_INCLUDE__STDC_A1_SOURCE and _INCLUDE_XOPEN_SOURCE_500 for UNIX 98.
	(SUBTARGET_OPTIONS): New define.
	(LINK_SPEC): Handle march=1.0 option.
	(STARTFILE_SPEC): New define.
	* config/pa/pa.c (override_options): Add code to process -munix= option.
	* config/pa/pa.h (pa_unix_string, flag_pa_unix): Declare.
	(TARGET_HPUX, TARGET_HPUX_10_10, TARGET_HPUX_11_11): Provide default
	defines.
	(TARGET_OPTIONS): Add SUBTARGET_OPTIONS to option list.
	(SUBTARGET_OPTIONS): Provide default define.
	* config/pa/pa64-hpux.h (STANDARD_STARTFILE_PREFIX_1,
	STANDARD_STARTFILE_PREFIX_2): New defines.
	(STARTFILE_SPEC): Provide unix95.o or unix98.o startfiles as necessary.
	(ENDFILE_SPEC): Use %O.
	* doc/install.texi (hppa*-*-hpux*): Reword paragraph on -g and gas.
	Mention issue caused by changing namespace and runtime to UNIX 95/98.
	* doc/invoke.texi (HPPA options): Move misplaced text to FRV options.
	Document -munix=std option.

2004-08-25  Steven Bosscher  <stevenb@suse.de>

	* cse.c (cse_around_loop, cse_check_loop_start,
	cse_set_around_loop): Remove.
	(cse_basic_block): Remove the around_loop argument.
	(cse_end_of_basic_block): Remove the after_loop argument.
	(cse_main): Likewise.
	* rtl.h (cse_main): Update prototype.
	* passes.c (rest_of_handle_cse, rest_of_handle_cse2,
	rest_of_handle_gcse): Update cse_main calls.

2004-08-25  Nathan Sidwell  <nathan@codesourcery.com>

	* tree.h  (build_int_cst): New, sign extended constant.
	(build_int_cstu): New, zero extended constant.
	(build_int_cst_wide): Renamed from build_int_cst.
	* tree.c (build_int_cst, build_int_cstu): New.
	(build_int_cst_wide): Renamed from build_int_cst.
	(make_vector_type, build_common_tree_nodes,
	build_common_tree_nodes_2): Adjust build_int_cst calls.
	* builtins.c (expand_builtin_prefetch, expand_builtin_strstr,
	expand_builtin_strpbrk, expand_builtin_fputs,
	build_string_literal, expand_builtin_printf,
	expand_builtin_sprintf, fold_builtin_classify_type,
	fold_builtin_lround, fold_builtin_bitop, fold_builtin_isascii,
	fold_builtin_toascii, fold_builtin_isdigit,
	simplify_builtin_strstr, simplify_builtin_strpbrk,
	fold_builtin_fputs, simplify_builtin_sprintf): Likewise.
	* c-common.c (start_fname_decls, fix_string_type, shorten_compare,
	DEF_ATTR_INT): Likewise.
	* c-decl.c (complete_array_type, check_bitfield_type_and_width):
	Likewise.
	* c-lex.c (interpret_integer, lex_charconst): Likewise.
	* c-parse.in (primary) <TYPES_COMPATIBLE_P> Likewise.
	* c-pretty-print.c (pp_c_integer_constant): Likewise.
	* c-typeck.c (really_start_incremental_init, push_init_level,
	set_nonincremental_init_from_string): Likewise.
	* calls.c (load_register_parameters): Likewise.
	convert.c (convert_to_pointer): Likewise.
	coverage.c (coverage_counter_alloc, tree_coverage_counter_ref,
	build_fn_info_type, build_fn_info_value, build_ctr_info_value,
	build_gcov_info): Likewise.
	* except.c (init_eh, assign_filter_values): Likewise.
	* expmed.c (store_fixed_bit_field, extract_bit_field,
	extract_fixed_bit_field, extract_split_bit_field, expand_shift,
	expand_mult_const, expand_mult_highpart_adjust, extract_high_half,
	expand_sdiv_pow2, expand_divmod, make_tree): Likewise.
	* expr.c (convert_move, emit_group_load, emit_group_store,
	expand_assignment, store_constructor, store_field,
	expand_expr_real_1, reduce_to_bit_field_precision): Likewise.
	fold-const.c (force_fit_type, int_const_binop, fold_convert_const,
	invert_truthvalue, optimize_bit_field_compare,
	decode_field_reference, all_ones_mask_p, constant_boolean_node,
	fold_div_compare, fold, fold_read_from_constant_string,
	fold_negate_const, fold_abs_const, fold_not_const, round_up,
	round_down): Likewise.
	* function.c (assign_parm_setup_block): Likewise.
	* stmt.c (shift_return_value, expand_case, estimate_case_costs):
	Likewise.
	* stor-layout.c (layout_type, initialize_sizetypes,
	set_min_and_max_values_for_integral_type): Likewise.
	* tree-chrec.c (chrec_fold_multiply_poly_poly,
	reset_evolution_in_loop): Likewise.
	* tree-chrec.h (build_polynomial_chrec): Likewise.
	* tree-complex.c (build_replicated_const): Likewise.
	* tree-eh.c (honor_protect_cleanup_actions,
	lower_try_finally_onedest, lower_try_finally_copy,
	lower_try_finally_switch): Likewise.
	* tree-mudflap.c (mf_build_string, mx_register_decls,
	mudflap_register_call, mudflap_enqueue_constant): Likewise.
	* tree-nested.c (get_trampoline_type, get_nl_goto_field): Likewise.
	* tree-pretty-print.c (dump_generic_node): Likewise.
	* tree-ssa-ccp.c (widen_bitfield, maybe_fold_offset_to_array_ref):
	Likewise.
	* tree-ssa-dom.c (simplify_rhs_and_lookup_avail_expr): Likewise.
	* tree-ssa-loop-niter.c (number_of_iterations_cond,
	loop_niter_by_eval, upper_bound_in_type, lower_bound_in_type):
	Likewise.
	* tree-ssa-loop-ivcanon.c (create_canonical_iv,
	canonicalize_loop_induction_variables): Likewise.
	* tree-vectorizer.c (vect_create_index_for_array_ref,
	vect_transform_loop_bound, vect_compute_data_ref_alignment):
	Likewise.

	* config/alpha/alpha.c (alpha_initialize_trampoline, alpha_va_start,
	alpha_gimplify_va_arg_1): Likewise.
	* config/arm/arm.c (arm_get_cookie_size): Likewise.
	* config/c4x/c4x.c (c4x_gimplify_va_arg_expr): Likewise.
	* config/i386/i386.c (ix86_va_start, ix86_gimplify_va_arg): Likewise.
	* config/ia64/ia64.c (ia64_gimplify_va_arg): Likewise.
	* config/mips/mips.c (mips_build_builtin_va_list, mips_va_start,
	mips_gimplify_va_arg_expr): Likewise.
	* config/pa/pa.c (hppa_gimplify_va_arg_expr): Likewise.
	* config/rs6000/rs6000.c (rs6000_va_start, rs6000_gimplify_va_arg,
	add_compiler_branch_island): Likewise.
	* config/s390/s390.c (s390_va_start): Likewise.
	* config/sh/sh.c (sh_va_start): Likewise.
	* config/stormy16/stormy16.c (xstormy16_expand_builtin_va_start):
	Likewise.
	* config/xtensa/xtensa.c (xtensa_va_start,
	xtensa_gimplify_va_arg_expr): Likewise.

	* objc/objc-act.c (build_objc_string_object,
	build_objc_symtab_template, init_def_list, init_objc_symtab,
	init_module_descriptor, generate_static_references,
	build_selector_translation_table, get_proto_encoding,
	build_typed_selector_reference, build_selector_reference,
	build_next_objc_exception_stuff,
	build_method_prototype_list_template, generate_descriptor_table,
	generate_protocols, build_protocol_initializer,
	build_ivar_list_template, build_method_list_template,
	build_ivar_list_initializer, generate_ivars_list,
	generate_dispatch_table, generate_protocol_list,
	build_category_initializer, build_shared_structure_initializer,
	generate_shared_structures, handle_impent,
	generate_objc_image_info): Likewise.

2004-04-25  Paolo Bonzini  <bonzini@gnu.org>

	* cfglayout.c (duplicate_insn_chain): Remove references to
	NOTE_INSN_LOOP_VTOP and NOTE_INSN_LOOP_CONT.
	* cfgloop.h (struct loop): Remove fields vtop, cont and cont_dominator.
	* cfgrtl.c (rtl_delete_block): Remove handling of NOTE_INSN_LOOP_CONT.
	* final.c (final_scan_insn): Remove references to NOTE_INSN_LOOP_VTOP
	and NOTE_INSN_LOOP_CONT.
	* insn-notes.def (NOTE_INSN_LOOP_VTOP, NOTE_INSN_LOOP_CONT): Remove.
	* jump.c (squeeze_notes): Remove references to NOTE_INSN_LOOP_VTOP
	and NOTE_INSN_LOOP_CONT.
	* loop.c (scan_loops, find_and_verify_loops, for_each_insn_in_loop,
	check_dbra_loop, loop_dump_aux): Remove references to removed notes
	and fields.
	* reorg.c (mostly_true_jump): Do not rely on NOTE_INSN_LOOP_VTOPs.
	* unroll.c (unroll_loop, copy_loop_body, loop_iterations): Remove
	references to removed notes and fields.
	(subtract_reg_term, ujump_to_loop_cont): Remove.

2004-08-25  Paolo Bonzini  <bonzini@gnu.org>

	* doc/install.texi: Document that libcpp does not require
	Automake any longer.  Document that Automake 1.9.1 should
	work everywhere.

2004-08-25  Zack Weinberg  <zack@codesourcery.com>

	* flags.h (enum debug_info_type): Remove DWARF_DEBUG.
	* defaults.h (PREFERRED_DEBUGGING_TYPE): Remove check for
	DWARF_DEBUGGING_INFO from choice-of-definition chain;
	restructure using C89 features (#elif, #error).
	* c-lex.c, final.c, opts.c, config/cris/cris.c, config/frv/frv.c
	* config/sh/sh.h: Remove references to DWARF_DEBUG.
	* doc/invoke.texi: Remove references to DWARF version 1;
	clarify why -gdwarf-2<n> doesn't work.

2004-08-25  Zack Weinberg  <zack@codesourcery.com>

	* basic-block.h (BB_SET_PARTITION): Clear old value first.
	* cfg.c (clear_bb_flags): Don't clear partition setting.
	* ifcvt.c (find_if_case_1): Remove ??? comment.

2004-08-25  Alan Modra  <amodra@bigpond.net.au>

	PR target/17052
	* config/rs6000/rs6000.h (machine_function): Remove sysv_varargs_p.
	* config/rs6000/sysv4.h (RS6000_VARARGS_AREA): Use
	current_function_stdarg in place of sysv_varargs_p.
	* config/rs6000/rs6000.c (setup_incoming_varargs): Don't set
	sysv_varargs_p.

2004-08-24  Richard Henderson  <rth@redhat.com>

	PR target/16298
	* config/i386/i386.c (legitimate_constant_p): Rework to not accept
	random codes within CONST.

2004-08-24  James E Wilson  <wilson@specifixinc.com>

	* Makefile.in (STAGEFEEDBACK_FLAGS_TO_PASS): Remove
	-freorder-blocks-and-partition.

2004-08-24  John David Anglin  <dave.anglin@nrc-cnrc.gc.ca>

	PR middle-end/17044
	* tree-ssa-threadupdate.c (redirection_data): Make static.
	(thread_block): Use ggc_alloc_cleared to allocate struct
	redirection_data.  Don't free elements in redirection_data.

2004-08-24  Richard Sandiford  <rsandifo@redhat.com>

	* config/mips/predicates.md (small_data_pattern): Match prefetches.

2004-08-24  Zdenek Dvorak  <rakdver@atrey.karlin.mff.cuni.cz>

	PR tree-optimization/17016
	* tree-ssa-loop-niter.c (number_of_iterations_cond,
	number_of_iterations_exit): Use POINTER_TYPE_P instead
	of testing for POINTER_TYPE.

2004-08-24  Zdenek Dvorak  <rakdver@atrey.karlin.mff.cuni.cz>

	* tree-ssa-loop-ivcanon.c: New file.
	* tree-ssa-loop-manip.c (create_iv): New function.
	* Makefile.in (tree-ssa-loop-ivcanon.o): Add.
	(tree-ssa-loop.o, tree-ssa-loop-manip.o): Add SCEV_H dependency.
	* cfgloop.c (mark_single_exit_loops): New function.
	(verify_loop_structure): Verify single-exit loops.
	* cfgloop.h (struct loop): Add single_exit field.
	(LOOPS_HAVE_MARKED_SINGLE_EXITS): New constant.
	(mark_single_exit_loops): Declare.
	(tree_num_loop_insns): Declare.
	* cfgloopmanip.c (update_single_exits_after_duplication): New function.
	(duplicate_loop_to_header_edge): Use it.
	* common.opt (fivcanon): New flag.
	* timevar.def (TV_TREE_LOOP_IVCANON, TV_COMPLETE_UNROLL): New timevars.
	* tree-cfg.c (tree_find_edge_insert_loc): Return newly created block.
	(bsi_commit_edge_inserts_1): Pass null to tree_find_edge_insert_loc.
	(bsi_insert_on_edge_immediate): New function.
	* tree-flow.h (bsi_insert_on_edge_immediate,
	canonicalize_induction_variables, tree_unroll_loops_completely,
	create_iv): Declare.
	* tree-optimize.c (init_tree_optimization_passes): Add
	pass_iv_canon and pass_complete_unroll.
	* tree-pass.h (pass_iv_canon, pass_complete_unroll): Declare.
	* tree-scalar-evolution.c (get_loop_exit_condition,
	get_exit_conditions_rec, number_of_iterations_in_loop,
	scev_initialize): Use single_exit information.
	* tree-ssa-loop-niter.c (number_of_iterations_cond): Record
	missing assumptions.
	(loop_niter_by_eval):  Return number of iterations as unsigned
	int.
	* tree-ssa-loop.c (tree_ssa_loop_init): Mark single exit loops.
	(tree_ssa_loop_ivcanon, gate_tree_ssa_loop_ivcanon, pass_iv_canon,
	tree_complete_unroll, gate_tree_complete_unroll, pass_complete_unroll):
	New passes.
	(tree_ssa_loop_done): Call free_numbers_of_iterations_estimates.
	* tree-ssanames.c (make_ssa_name): Allow creating ssa name before
	the defining statement is ready.
	* tree-vectorizer.c (vect_create_iv_simple): Removed.
	(vect_create_index_for_array_ref, vect_transform_loop_bound):
	Use create_iv.
	(vect_transform_loop_bound): Use single_exit information.
	(vect_analyze_loop_form): Cleanup bogus tests.
	(vectorize_loops): Do not call flow_loop_scan.
	* tree.h (may_negate_without_overflow_p): Declare.
	* fold-const.c (may_negate_without_overflow_p): Split out from ...
	(negate_expr_p): ... this function.
	(tree_expr_nonzero_p): Handle overflowed constants correctly.
	* doc/invoke.texi (-fivcanon): Document.
	* doc/passes.texi: Document canonical induction variable creation.

2004-08-24  Richard Sandiford  <rsandifo@redhat.com>

	* config/mips/mips.h (ISA_HAS_INT_CONDMOVE): Delete.
	* config/mips/mips.c (print_operand): Fold %B/%b handling into %T/%t,
	using the mode of the operand to decide between them.
	* config/mips/mips.md (MOVECC): New mode macro.
	(ccreg): New mode attribute.
	(*mov{si,di,sf,df}_on_{cc,si,di}): Name formerly unnamed patterns.
	Redefine using :GPR and :MOVECC.  Use %T and %t for the condition.
	(mov[sd]icc): Redefine using :GPR.

2004-08-24  Richard Sandiford  <rsandifo@redhat.com>

	* config/mips/mips-protos.h (mips_emit_prefetch): Delete.
	(mips_prefetch_cookie): New function.
	* config/mips/mips.c (print_operand_address): Fix handling of
	ADDRESS_CONST_INT.
	(mips_emit_prefetch): Delete.
	(mips_prefetch_cookie): New function.
	* config/mips/mips.md (prefetch): Turn into a define_insn.  Use a
	mode of QImode for the address_operand.  Use mips_prefetch_cookie
	to calculate the first "pref" operand.
	(prefetch_[sd]i, prefetch_[sd]i_address): Delete.
	(prefetch_indexed_[sd]i): Redefine using :P.  Use mips_prefetch_cookie.

2004-08-24  Richard Earnshaw  <rearnsha@arm.com>

	* arm.md: Include predicates.md.
	* predicates.md: New file.
	* arm.c (s_register_operand, arm_hard_register_operand)
	(arm_general_register_operand, f_register_operand, reg_or_int_operand)
	(arm_immediate_operand, arm_neg_immediate_operand)
	(arm_not_immediate_operand, arm_rhs_operand, arm_rhsm_operand)
	(arm_add_operand, arm_addimm_operand, arm_not_operand)
	(offsettable_memory_operand, alignable_memory_operand)
	(arm_reload_memory_operand, arm_float_rhs_operand)
	(arm_float_add_operand, vfp_compare_operand, arm_float_compare_operand)
	(index_operand, shiftable_operator, logical_binary_operator)
	(shift_operator, equality_operator, arm_comparison_operator)
	(minmax_operator, cc_register, dominant_cc_register)
	(arm_extendqisi_mem_op, power_of_two_operand, nonimmediate_di_operand)
	(di_operand, nonimmediate_soft_df_operand, soft_df_operand)
	(const_shift_operand, load_multiple_operation)
	(store_multiple_operation, multi_register_push, thumb_cmp_operand)
	(thumb_cmpneg_operand, thumb_cbrch_target_operand)
	(cirrus_register_operand, cirrus_fp_register)
	(cirrus_shift_const): Delete, replaced with equivalents in
	predicates.md.
	(shift_op): Handle ROTATE.
	* arm-protos.h: Delete declarations for above.
	* arm.h (PREDICATE_CODES, SPECIAL_MODE_PREDICATES): Delete.
	* t-arm (MD_INCLUDES): Add predicates.md.
	(s-preds): Depends on MD_INCLUDES.

2004-08-24  Richard Sandiford  <rsandifo@redhat.com>

	* config/mips/mips.c (mips_gen_conditional_trap): Fix mode.
	* config/mips/mips.md (*conditional_trap[sd]i): Name previously unnamed
	patterns.  Redefine using :GPR.  Give the match_operator a mode.
	Use '%2' rather than '%z2' for operand 2.

2004-08-24  Richard Sandiford  <rsandifo@redhat.com>

	* config/mips/mips.md (load_call[sd]i): Redefine using :P.  Add mode
	attribute.

2004-08-24  Richard Sandiford  <rsandifo@redhat.com>

	* config/mips/mips.md (indirect_jump): Use force_reg.  Adjust names
	of internal patterns.
	(indirect_jump[sd]i): Renamed from indirect_jump_internal[12].
	Redefine using :P.
	(tablejump): Use expand_binop to calculate address.  Adjust names
	of internal patterns.
	(tablejump[sd]i): Renamed from tablejump_internal[12].
	Redefine using :P.
	(tablejump_mips16[12]): Delete.

2004-08-24  Richard Sandiford  <rsandifo@redhat.com>

	* config/mips/mips.md (*seq_[sd]i, *seq_[sd]i_mips16, *sne_[sd]i)
	(*sgt_[sd]i, *sgt_[sd]i_mips16, *sge_[sd]i, *slt_[sd]i)
	(*slt_[sd]i_mips16, *sle_[sd]i, *sle_[sd]i_mips16, *sgtu_[sd]i)
	(*sgtu_[sd]i_mips16, *sge_[sd]i, *sltu_[sd]i, *sltu_[sd]i_mips16)
	(*sleu_[sd]i, *sleu_[sd]i_mips16): Redefine using :GPR.

2004-08-24  Richard Sandiford  <rsandifo@redhat.com>

	* config/mips/mips.md (cmpsi, cmpdi): Redefine using :GPR.
	(*branch_zero[sd]i): Renamed from branch_zero{,_di}.  Redefine
	using :GPR.
	(*branch_zero[sd]i_inverted): Likewise branch_zero{,_di}_inverted.
	(*branch_equality[sd]i): Likewise branch_equality{,_di}.
	(*branch_equality[sd]i_inverted): Likewise
	branch_equality{,_di}_inverted.
	(*branch_equality[sd]i_mips16): Name formerly unnamed patterns.
	Redefine using :GPR.

2004-08-24  Zack Weinberg  <zack@codesourcery.com>

	* rtl.def: Reorganize, placing all codes used only in machine
	descriptions at the end.

	* rtl.def: Wrap MD-only codes in #ifdef GENERATOR_FILE.
	* gengtype.c: Don't include rtl.h.  Define enum rtx_code and
	rtx_name, rtx_format arrays by direct reference to rtl.def,
	first undefining GENERATOR_FILE.  Define enum insn_note and
	note_insn_name array by direct reference to insn-notes.def.
	(adjust_field_rtx_def): Remove local definition of rtx_name.
	Use symbolic names for insn notes.
	* Makefile.in (gengtype.o): Update dependencies.

2004-08-24  Zack Weinberg  <zack@codesourcery.com>

	* basic-block.h (struct basic_block_def): Reorder fields to
	eliminate interior padding.  Remove 'partition' field.
	(BB_DISABLE_SCHEDULE, BB_HOT_PARTITION, BB_COLD_PARTITION)
	(BB_UNPARTITIONED, BB_PARTITION, BB_SET_PARTITION)
	(BB_COPY_PARTITION): New macros.
	* bb-reorder.c, cfgcleanup.c, cfglayout.c, cfgrtl.c, ifcvt.c
	Replace all references to the 'partition' field of a basic
	block with new macros.

	* insn-notes.def: Delete NOTE_INSN_DISABLE_SCHED_OF_BLOCK.
	* final.c (final_scan_insn): Don't handle it.
	* modulo-sched.c: Set BB_DISABLE_SCHEDULE flag on g->bb
	instead of emitting a NOTE_INSN_DISABLE_SCHED_OF_BLOCK note.
	* sched-rgn.c (sched_is_disabled_for_current_region_p):
	Look for a BB_DISABLE_SCHEDULE flag on the block instead of a note.

2004-08-24  Nathan Sidwell  <nathan@codesourcery.com>

	* c-decl.c (c_init_decl_processing): Adjust
	build_common_tree_nodes call.
	* expmed.c (const_mult_add_overflow_p): Use
	build_distinct_type_copy.
	* stor-layout.c (early_type_list): Remove.
	(layout_type): Don't append to early_type_list.
	(initialize_sizetypes): Add signed_p argument.
	(set_sizetype): Overwrite the stub type nodes directly.
	* tree.c (copy_node_stat): Clear a type's value cache here ...
	(build_distinct_type): ... not here.
	(build_common_tree_nodes): Add signed_sizetype argument. Adjust.
	* tree.h (initialize_sizetypes): Add signed_p argument.
	(build_common_tree_nodes): Likewise.

	* objc/objc-act.c (get_static_reference): Use
	build_variant_type_copy.
	(get_protocol_reference): Likewise.
	* objc/objc-act.h (TREE_STATIC_TEMPLATE): Use TREE_PRIVATE.

2004-08-24  Richard Henderson  <rth@redhat.com>
	    Andrew Pinski  <apinski@apple.com>

	* gimplify.c (gimplify_array_ref_to_plus): Delete.
	(gimplify_addr_expr): Do not call gimplify_array_ref_to_plus
	for ARRAY_REF.

	* config/rs6000/rs6000.c (altivec_expand_builtin): Go passed
	ARRAY_REF also to get to the STRING_CST.

2004-08-24  Paul Brook  <paul@codesourcery.com>

	* config/arm/arm.c (arm_override_options): Update error message.
	* config/arm/arm.h (TARGET_HARD_FLOAT): Rename to
	TARGET_HARD_FLOAT_ABI.
	(TARGET_SOFT_FLOAT_ABI): Rename to TARGET_HARD_FLOAT.
	(LIBCALL_VALUE, FUNCTION_VALUE_REGNO_P): Use TARGET_HARD_FLOAT_ABI.

2004-08-24  Kazuhiro Inaoka  <inaoka.kazuhiro@renesas.com>

	PR target/17093
	* config/m32r.md (movsi_sda): Add SI mode specification to
	UNSPEC.

2004-08-24  Nick Clifton  <nickc@redhat.com>

	* config/m32r/m32r.h (PREDICATE_CODES): Remove duplicate definition
	of seth_add3_operand.

2004-08-24  Nathan Sidwell  <nathan@codesourcery.com>

	* Makefile.in (PROTO_OBJS): Add errors.o.
	* protoize.c (fancy_abort): Remove.
	* mips-tfile.c (fancy_abort): Add parameters.

2004-08-24  Jonathan Wakely  <redi@gcc.gnu.org>

	* doc/trouble.texi (C++ misunderstandings): Fix example code.

2004-08-24  Andreas Tobler  <a.tobler@schweiz.ch>

	* Makefile.in (HOOKS_H): Add dependency on MACHMODE_H.
	(host-default.o): Add dependency on HOOKS_H.
	* config/x-linux: Likewise.
	* config/x-solaris: Likewise.
	* config/i386/x-mingw32: Likewise.
	* config/rs6000/x-darwin: Likewise.

2004-08-23  James E Wilson  <wilson@specifixinc.com>

	* reg-notes.def (REG_NOTE): In comment, change DEF_INSN_NOTE to
	DEF_REG_NOTE.

2004-08-23  Mark Mitchell  <mark@codesourcery.com>

	PR c/14492
	* dwarf2out.c (loc_descriptor_from_tree): Robustify.

2004-08-23  Diego Novillo  <dnovillo@redhat.com>

	* cfg.c (check_bb_profile): Fix typos.
	* function.c (assign_parm_is_stack_parm): Likewise.
	* tree-nested.c: Likewise.

2004-08-23  Daniel Jacobowitz  <dan@debian.org>

	* ggc-zone.c (struc alloc_chunk): Rearrange flag bits and SIZE.
	Remove TYPECODE.
	(ggc_alloc_zone_1): Mark TYPE as unused.  Don't save it in the chunk.

2004-08-23  Eric Christopher  <echristo@redhat.com>

	* defaults.h (VECTOR_MODE_SUPPORTED_P): Remove macro.
	* system.h (VECTOR_MODE_SUPPORTED_P): Poison.
	* target-def.h (TARGET_VECTOR_MODE_SUPPORTED_P): Define.
	* target.h: Ditto.
	* hooks.h: Include machmode.h.
	(hook_bool_mode_false): Declare.
	* hooks.c (hook_bool_mode_false): Define.
	* expr.c (vector_mode_valid_p): Use targetm.vector_mode_supported_p.
	* stor-layout.c (layout_type): Ditto.
	* config/alpha/alpha.c (alpha_vector_mode_supported_p): New function.
	Define to target macro.
	* config/alpha/alpha.h (VECTOR_MODE_SUPPORTED_P): Delete.
	* config/arm/arm.c: Ditto. Use.
	* config/arm/arm.h: Ditto.
	* config/arm/arm-protos.h: Ditto.
	* config/i386/i386.c: Ditto.
	* config/i386/i386.h: Ditto.
	* config/rs6000/rs6000.c: Ditto.
	* config/rs6000/rs6000.h: Ditto.
	* config/sh/sh.c: Ditto.
	* config/sh/sh.h: Ditto.
	* config/sh/sh-protos.h: Ditto.
	* config/sh/sh.md: Use.
	* doc/tm.texi: Move documentation for VECTOR_MODE_SUPPORTED_P
	to TARGET_VECTOR_MODE_SUPPORTED_P.

2004-08-23  Nathan Sidwell  <nathan@codesourcery.com>

	* Makefile.in (BUILD_ERRORS): Set to build-errors.
	(errors.o): New target for host.
	(build-errors.o): New target for build.
	(genobjs): Replace errors.o with build-errors.
	(gengenrtl$(buildexeext)): Add $(BUILD_ERRORS).
	(GCOV_OBJS, GCOV_DUMP_OBJS): Add errors.o.
	(fix-headers$(build_exeext)): Add $(BUILD_ERRORS).
	(fix-header.o): Add errors.h
	* collect2.c (fancy_abort): Add parameters.
	* collect2.h (fancy_abort): Don't declare.
	* errors.h (fancy_abort): Don't declare.
	* errors.c: Include either bconfig.h or config.h.
	(fancy_abort): Trim filename.
	* fix-header.c (v_fatal, fatal): Remove.
	(progname): Remove definition.
	(main): Set progname here.
	* gcc.c (fancy_abort): Add parameters.
	* gcc.h (fancy_abort): Remove declaration.
	* gcov.c (fancy_abort): Remove.
	* rtl.h (fancy_abort): Don't declare.
	(abort): Don't define.
	* tree.h (fancy_abort): Don't declare.
	(abort): Don't define.
	* system.h (fancy_abort): Declare.
	(abort): Define to fancy_abort.
	* fixinc/Makefile.in (ALLOBJ): Add ../build-errors.o

	* tree.h (enum size_type_kind): Remove USIZETYPE, UBITSIZETYPE.
	(usize_type, ubitsizetype): Remove.
	* stor-layout.c (set_sizetype): Don't initialize usizetype,
	ubitsizetype.
	* fold-const.c (size_diffop): TYPE can never be ubitsizetype.

	* tree.h (build_distinct_type_copy): New.
	(build_type_copy): ... here.  Rename to ...
	(build_variant_type_copy): ... here.
	* tree.c (build_qualified_type): Rename build_type_copy call.
	(build_distinct_type_copy): New, broken out of ...
	(build_type_copy): ... here.  Rename to ...
	(build_variant_type_copy): ... here.  Use
	build_distinct_type_copy.
	(build_common_tree_nodes_2): Rename build_type_copy call.
	* c-common.c (c_common_nodes_and_builtins): Rename build_type_copy
	call.
	(handle_packed_attribute, handle_unused_attribute,
	handle_transparanet_union_attribute, handle_aligned_attribute,
	handle_deprecated_attribute): Likewise.
	* c-decl.c (clone_underlying_type, store_parm_decls_oldstyle):
	Likewise.
	* config/arm/arm.c (arm_handle_isr_attribyte): Likewise.
	* config/rs6000/rs6000.c (rs6000_init_builtins): Use
	build_distinct_type_copy.

2004-08-23  Richard Sandiford  <rsandifo@redhat.com>

	* config/mips/mips.md (mfhilo_[sd]i): Redefine using :GPR.  Add mode
	attribute.

2004-08-23  Richard Sandiford  <rsandifo@redhat.com>

	* config/mips/mips.md (length): Don't use mips_fetch_insns for indexed
	loads and stores.
	(*lwxc1_<mode>, *ldxc1_<mode>, *swxc1_<mode>, *sdxc1_<mode>): Name
	formerly unnamed patterns.  Redefine using :P for the address.  Remove
	explicit length attributes.

2004-08-23  Zdenek Dvorak  <rakdver@atrey.karlin.mff.cuni.cz>

	* tree-ssa-loop-im.c (fem_single_reachable_address, for_each_memref):
	New functions.
	(single_reachable_address): Use them.
	(schedule_sm): Add dump.
	(is_call_clobbered_ref): New function.
	(determine_lsm_reg): Check whether the reference is call clobbered.
	Only work for gimple_reg_type values.

2004-08-23  Richard Sandiford  <rsandifo@redhat.com>

	* config/mips/mips.md (*mov<mode>_ra): Name previously unnamed MIPS16
	$31 store insns.  Redefine using :GPR.

2004-08-23  Richard Sandiford  <rsandifo@redhat.com>

	* config/mips/mips.md (P): New mode macro.
	(*xgot_hi[sd]i, *xgot_lo[sd]i, *got_disp[sd]i, *got_page[sd]i)
	(*load_got[sd]i, *low[sd]i, *low[sd]i_mips16): Redefine using :P.
	Add mode attributes.

2004-08-23  Richard Sandiford  <rsandifo@redhat.com>

	* config/mips/mips.md (UNSPEC_[LS][WD][LR]): Delete in favor of...
	(UNSPEC_{LOAD,STORE}_{LEFT,RIGHT}): ...these new constants.  Shuffle
	later constants to cover the gap.
	(load, store): New mode attributes.
	(mov_l[wd]l, mov_l[wd]r, mov_s[wd]l, mov_s[wd]r): Redefine using :GPR.
	Use new unspec constants.

2004-08-23  Richard Sandiford  <rsandifo@redhat.com>

	* config/mips/mips.md (one_cmpl[sd]i2): Redefine using :GPR.
	(and[sd]3, ior[sd]i3, xor[sd]i3): Likewise.  Change 32-bit patterns
	to use register_operand rather than uns_arith_operand as the predicate
	for operand 1.  Remove redundant MIPS16 force_reg() for operand 1.
	(*and[sd]i3, *ior[sd]i3, *xor[sd]i3): Name formerly unnamed patterns.
	Redefine using :GPR.  Make same predicate change here.  Extend the
	commutativity of operands 1 and 2 from the SImode version to the
	DImode one.
	(*and[sd]i3_mips16, *ior[sd]i3_mips16, *xor[sd]i3_mips16): Likewise,
	but with no predicate changes.
	(*nor[sd]i3): Redefine using :GPR.

2004-08-23  Zdenek Dvorak  <rakdver@atrey.karlin.mff.cuni.cz>

	* tree-ssa-operands.c (get_call_expr_operands): Add VUSE operands for
	noreturn functions.

2004-08-23  Richard Sandiford  <rsandifo@redhat.com>

	* config/mips/mips.h (ISA_HAS_DCLZ_DCLO): Delete.
	* config/mips/mips.md (abs[sd]i2): Redefine using :GPR.  Only use
	branch-likely insns for absdi2 if GENERATE_BRANCHLIKELY.  Use "%."
	rather than "%z2" (with a fake const0_rtx for operand 2).
	(ffs[sd]i2): Redefine using :GPR.
	(clz[sd]i2): Likewise.  Use ISA_HAS_CLO_CLZ for the 64-bit case.

2004-08-23  Richard Sandiford  <rsandifo@redhat.com>

	* config/mips/mips.md ({,u}divmod[sd]i4): Redefine using :GPR.

2004-08-23  Richard Sandiford  <rsandifo@redhat.com>

	* config/mips/mips.md (any_extend): New code macro.
	(u, su): New code attributes.
	({,u}mulsidi3, {,u}mulsidi3_32bit_internal, {,u}mulsidi3_32bit_r4000)
	({u,s}mulsi3_highpart, {u,s}mulsi3_highpart_internal)
	({u,s}mulsi3_highpart_mulhi_internal, {s,u}muldi3_highpart)
	(*{s,u}mul_acc_di): Redefine using any_extend.
	(*{,u}muls_di, *{s,u}msac_di): Likewise.  Change names of patterns
	to reflect real insn names.
	(*mulsidi3_64bit, *mulsidi3_64bit_parts): Replace use of match_operator
	with an any_extend template.
	({u,s}mulsi3_highpart_neg_mulhi_internal): Redefine using any_extend.
	Add '*' to name.

2004-08-23  Richard Sandiford  <rsandifo@redhat.com>

	* config/mips/mips.h (GENERATE_MULT3_SI): Check TARGET_MAD.
	* config/mips/mips.md (mul[sd]i3, mul[sd]i3_internal)
	(mul[sd]i3_r4000): Redefine using :GPR.
	(mulsi3_mult3): Don't check TARGET_MAD separately.
	(muldi3_mult3): Moved after mulsi_mult3.

2004-08-23  Richard Sandiford  <rsandifo@redhat.com>

	* config.gcc (mips-*-*): Remove definitions of MASK_GAS and
	OBJECT_FORMAT_ELF.  Set MASK_SPLIT_ADDR by default if using GNU ld.
	* config/mips/mips.h (MASK_GAS): Delete.  Shuffle later masks down.
	(TARGET_GAS, TARGET_MIPS_AS): Delete.
	(TARGET_GPWORD): Define to true for n32 on IRIX.
	(TARGET_SWITCHES): Remove -mmips-as.  Turn -mgas into a no-op.
	(MIPS_AS_ASM_SPEC, SUBTARGET_MIPS_AS_ASM_SPEC): Delete.
	(GAS_ASM_SPEC): Delete, folding into ASM_SPEC.
	(ASM_ABI_DEFAULT_SPEC, TARGET_ASM_SPEC): Delete.
	(MDEBUG_ASM_SPEC): Delete, folding into...
	(SUBTARGET_ASM_DEBUGGING_SPEC): ...here.
	(ASM_SPEC): Inline old GAS_ASM_SPEC.  Use GNU names for ABI switches.
	(EXTRA_SPECS): Remove mips_as_asm_spec, gas_asm_spec, target_asm_spec,
	subtarget_mips_as_asm_spec, mdebug_asm_spec.  Use MULTILIB_ABI_DEFAULT
	to define asm_abi_default_spec.
	(ASM_STABS_OP, ASM_STABN_OP, ASM_STABD_OP): Delete.
	(TARGET_ASM_SELECT_SECTION): Delete.
	* config/mips/mips.c (MIPS_MAX_FIRST_STACK_STEP): Define to 0x7ff0
	for non-mips16 code, removing previous workaround for SGI assemblers.
	(TARGET_ASM_INTEGER, mips_assemble_integer): Delete.
	(TARGET_ASM_ALIGNED_DI_OP): Define this instead.
	(override_options): Remove !TARGET_GAS and !have_named_sections code.
	(print_operand): Fold TARGET_GAS conditionals into asm strings.
	(mips_output_filename): Remove !TARGET_GAS code.  Replace use of
	ASM_STABS_OP and ASM_STABN_OP.
	(mips_file_start): Remove TARGET_MIPS_AS/TARGET_GAS checks.
	(mips_output_aligned_decl_common): Remove mention of SGI o32 assembler.
	(mips_output_function_prologue): Remove !TARGET_GAS code.
	(mips_select_rtx_section): Remove !have_named_sections code.
	(mips_select_section): Delete.
	* config/mips/mips.md (trap): Remove !TARGET_GAS check.
	* config/mips/linux.h (TARGET_DEFAULT): Remove use of MASK_GAS.
	* config/mips/sdb.h (PUT_SDB_DEF, PUT_SDB_PLAIN_DEF): Delete.
	(PUT_SDB_BLOCK_START, PUT_SDB_BLOCK_END): Fold TARGET_GAS conditional.
	* config/mips/vxworks.h (ASM_SPEC): As for mips.h.
	* config/mips/windiss.h (ASM_SPEC): Likewise.

2004-08-23  Richard Sandiford  <rsandifo@redhat.com>

	* read-rtl.c (map_value, mapping, macro_group): New structures.
	(BELLWETHER_CODE): New macro.
	(modes, codes, bellwether_codes): New variables.
	(find_mode, uses_mode_macro_p, apply_mode_macro, find_code)
	(uses_code_macro_p, apply_code_macro, apply_macro_to_string)
	(apply_macro_to_rtx, uses_macro_p, add_condition_to_string)
	(add_condition_to_rtx, apply_macro_traverse, add_mapping)
	(add_map_value, initialize_macros): New functions.
	(def_hash, def_hash_eq_p): Generalize to anything that points to,
	or starts with, a char * field.
	(find_macro, read_mapping, check_code_macro): New functions.
	(read_rtx_1): New, split out from read_rtx.  Handle the new
	define_{mode,code}_{macro,attr} constructs.  Use find_macro
	to parse the name of a code or mode.  Use BELLWETHER_CODE to
	extract the format and to choose a suitable code for rtx_alloc.
	Modify recursive invocations to use read_rtx_1.
	(read_rtx): Call initialize_macros.  Apply code and mode macros
	to the rtx returned by read_rtx_1.  Cache everything after the
	first macro expansion for subsequent read_rtx calls.
	* doc/md.texi: Document new .md constructs.
	* config/mips/mips.md (GPR): New mode macro.
	(d, si8_di5): New mode attributes.
	(any_cond): New code macro.
	(add[sd]i3): Redefine using :GPR.
	(*add[sd]i3): Likewise, renaming from add[sd]i3_internal.
	(*add[sd]i3_sp[12], *add<mode>3_mips16): Redefine using :GPR, naming
	previously unnamed MIPS16 patterns.
	(*addsi3_extended): Renamed from addsi3_internal_2.  Fix overly long
	lines.  Don't match (plus (const_int 0) ...).
	(*addsi3_extended_mips16): Name previously unnamed MIPS16 pattern.
	Use a define_split to generate the addition.
	(sub[sd]i3): Redefine using :GPR.  Turn subsi3 into a define_insn.
	(subsi3_internal): Delete.
	(*subsi3_extended): Renamed from subsi3_internal_2.
	(bunordered, bordered, bunlt, bunge, buneq, bltgt, bunle, bungt)
	(beq, bne, bgt, bge, blt, ble, bgtu, bgeu, bltu, bleu): Redefine
	using an any_cond template.

2004-08-23  Richard Sandiford  <rsandifo@redhat.com>

	* read-rtl.c (read_rtx): Tidy use of format_ptr.

2004-08-23  Richard Sandiford  <rsandifo@redhat.com>

	* read-rtl.c (string_obstack): New file-scope variable.
	(read_string, read_quoted_string, read_braced_string)
	(read_escape): Remove obstack parameter and use string_obstack instead.
	(read_rtx): Remove function-local rtl_obstack and initialize
	string_obstack instead.  Update call to read_string.

2004-08-22  Andrew Pinski  <apinski@apple.com>

	PR c/15262
	* c-typeck.c (build_unary_op): Use &a.b if the foldded lowered
	expression is not constant.
	(c_finish_return): Do not go through INDIRECT_REF when looking
	for the inner expression of an ADDR_EXPR for warning about.

2004-08-22  Richard Henderson  <rth@redhat.com>

	PR 17075
	* cfgexpand.c (expand_gimple_tailcall): Detect when we can both
	create new blocks and fall through.
	(expand_gimple_basic_block): Update to match.

2004-08-22  Ulrich Weigand  <uweigand@de.ibm.com>

	* reload.c (find_reloads_address): Make return value tri-state.
	Return -1 if LEGITIMIZE_RELOAD_ADDRESS succeeded.
	(find_reloads): Assume that reloaded addresses match 'o' or
	EXTRA_MEMORY_CONSTRAINT constraints only if find_reloads_address
	returned 1 (not -1).  Omit optional reloads for address operands
	only if find_reloads_address returned 1 (not -1).

	* config/s390/s390.c (legitimize_reload_address): New function.
	* config/s390/s390-protos.h (legitimize_reload_address): Declare.
	* config/s390/s390.h (LEGITIMIZE_RELOAD_ADDRESS): Define.  Call
	legitimize_reload_address.

2004-08-22  Richard Hendersion  <rth@redhat.com>

	* tree.h (SAVE_EXPR_RESOLVED_P): New.
	* gimplify.c (gimplify_save_expr): Use it.
	* expr.c (expand_expr_real_1): Likewise.  Also set DECL_IGNORED_P
	on the temporary variable.

2004-08-22  Andrew Pinski  <pinskia@physics.uc.edu>

	* fold-const.c (rtl_expr_nonnegative_p): Delete.
	* tree.h (rtl_expr_nonnegative_p): Remove.

2004-08-22  Steven Bosscher  <stevenb@suse.de>

	* config/i386/ppro.md (ppro_complex_insn): Add missing check
	for cpu==pentiumpro.

	* combine.c (struct reg_stat): Fix comment typo.

2004-08-22  Joseph S. Myers  <jsm@polyomino.org.uk>

	* c-tree.h (c_sizeof_nowarn): Remove.

2004-08-21  Joseph S. Myers  <jsm@polyomino.org.uk>

	* c-decl.c (set_array_declarator_type): Rename to
	set_array_declarator_inner.
	(build_c_parm, build_attrs_declarator, build_function_declarator):
	New functions.
	(make_pointer_declarator): Call build_attrs_declarator.
	* c-tree.h (set_array_declarator_type): Rename to
	set_array_declarator_inner.
	(build_c_parm, build_attrs_declarator, build_function_declarator):
	New prototypes.
	* c-parse.in (after_type_declarator,
	parm_declarator_starttypename, parm_declarator_nostarttypename,
	notype_declarator, absdcl_maybe_attribute, direct_absdcl1, parm,
	firstparm): Use these functions

2004-08-21  Joseph S. Myers  <jsm@polyomino.org.uk>

	* c-decl.c (build_array_declarator, set_array_declarator_type,
	start_decl, grokdeclarator, grokparms): Change boolean parameters
	to type bool.
	* c-tree.h (build_array_declarator, set_array_declarator_type,
	start_decl): Update prototypes.
	* c-decl.c, c-parse.in: All callers changed.

2004-08-21  Mike Stump  <mrs@apple.com>

	* config/rs6000/darwin.h (SUBTARGET_OPTIONS): Move from here, to...
	(darwin_fix_and_continue): Likewise.
	(darwin_fix_and_continue_switch): Likewise.
	* config/darwin.h (SUBTARGET_OPTIONS): ...here, to fix -mone-byte-bool.
	(darwin_fix_and_continue): Likewise.
	(darwin_fix_and_continue_switch): Likewise.

2004-08-21  Danny Smith  <dannysmith@users.sourceforge.net>

	PR  c++/16030
	* config/i386/winnt/c (gen_stdcall_suffix, gen_fastcall_suffix):
	Remove, merging into ...
	(gen_stdcall_or_fastcall_suffix): New function, returning tree
	rather than const char*, and accepting additional parameter.
	Don't add suffix to '*'-prefixed symbols or variadic functions.
	(i386_pe_encode_section_info): Adjust for call to new function.
	Call change_decl_assembler_name.

2004-08-20  Mike Stump  <mrs@apple.com>

	* config/darwin.c (machopic_indirect_data_reference): Mark
	stubs as defined.
	* config/386/386.c (darwin_local_data_pic): Add.
	(legitimate_constant_p): Reorder so that PLUS handling runs
	before darwin_local_data_pic to match the ordering in
	legitimate_pic_address_disp_p and so that MINUS runs after
	darwin_local_data_pic as otherwise the darwin_local_data_pic
	logic can be skipped, which would be very bad.
	(legitimate_pic_address_disp_p): Move from from here to
	darwin_local_data_pic so it can be reused.

2004-08-21  Alan Modra  <amodra@bigpond.net.au>

	* config/rs6000/linux64.h (DOT_SYMBOLS): Define.
	(CRT_CALL_STATIC_FUNCTION): Define !DOT_SYMBOLS version.
	(ASM_DECLARE_FUNCTION_SIZE): Modify for !DOT_SYMBOLS.
	(ASM_OUTPUT_SOURCE_LINE, DBX_OUTPUT_BRAC, DBX_OUTPUT_NFUN): Likewise.
	(RS6000_ABI_NAME): Define as "linux".
	(SUBSUBTARGET_OVERRIDE_OPTIONS): Set dot_symbols.
	* config/rs6000/sysv4.h (SUBTARGET_OVERRIDE_OPTIONS): Select
	ABI_AIX when rs6000_abi_name is "linux" and TARGET_64BIT.
	* config/rs6000/rs6000-protos.h (rs6000_output_function_entry): Decl.
	* config/rs6000/rs6000.c (dot_symbols): New global var.
	(rs6000_output_function_entry): New function, modified for
	!DOT_SYMBOLS..
	(print_operand <case 'z'>): ..extracted from here.
	(rs6000_assemble_visibility): Modify for !DOT_SYMBOLS.
	(rs6000_output_function_epilogue): Likewise.
	(rs6000_elf_declare_function_name): Likewise.
	* config/rs6000/rs6000.h (DOT_SYMBOLS): Define.
	(ASM_WEAKEN_DECL, ASM_OUTPUT_DEF_FROM_DECLS): Modify for !DOT_SYMBOLS.
	* configure.ac (HAVE_LD_NO_DOT_SYMS): Add new AC_DEFINE.
	* configure: Regenerate.
	* config.in: Regenerate.

2004-08-20  Mark Mitchell  <mark@codesourcery.com>

	* reload.c (find_reloads_address): Fix thinko in previous change.

	* reload.c (find_reloads_address): Reload the sum of a LO_SUM and
	a CONST_INT.

2004-08-20  Jakub Jelinek  <jakub@redhat.com>

	PR rtl-optimization/17099
	* combine.c (force_to_mode): Check if inner_mask has any bits set
	outside of GET_MODE (x) instead of op_mode.

2004-08-20  Mark Mitchell  <mark@codesourcery.com>

	* config.gcc (arm*-*-symbianelf*): Add t-symbian Makefile
	fragment.
	* config/arm/bpabi.h (RENAME_LIBRARY_SET): Fix typo.
	(SUBTARGET_EXTRA_ASM_SPEC): Pass -meabi=3 to the assembler.
	* config/arm/symbian.h (SUBTARGET_CPU_DEFAULT): Assume ARMV5
	architecture.
	(SUBTARGET_ASM_FLOAT_SPEC): Default to -mfpu=vfp for hard-float
	configurations.
	* config/arm/t-symbian: New file.

2004-08-20  Andrew Pinski  <apinski@apple.com>

	* regrename.c (kill_value_regno): ANSIfy.

2004-08-20  Dale Johannesen  <dalej@apple.com>

	* config/rs6000/rs6000.c (rs6000_rtx_costs): Improve DIV/MOD.

2004-08-20  Daniel Jacobowitz  <dan@debian.org>

	* regrename.c (kill_value_one_regno): Renamed from kill_value_regno.
	(kill_value_regno): New function, derived from kill_value.
	(kill_value): Update.
	(copyprop_hardreg_forward_1): Update call to kill_value_regno.

2004-08-20  Daniel Berlin  <dberlin@dberlin.org>

	Fix PR tree-optimization/17111
	* tree-ssa-pre.c (create_value_expr_from): Don't change the types
	of non-value_handles.
	(bitmap_set_contains): All constants are in every set.

2004-08-20  Nathan Sidwell  <nathan@codesourcery.com>

	* fold-const.c (round_up, round_down): Use build_int_cst.
	Optimize common case.

2004-08-20  Zack Weinberg  <zack@codesourcery.com>
	    John David Anglin  <dave.anglin@nrc-cnrc.gc.ca>

	* config/pa/pa-protos.h (readonly_data, one_only_readonly_data_section,
	one_only_data_section): Rename to som_readonly_data_section,
	som_one_only_readonly_data_section and som_one_only_data_section.
	* config/pa/pa.c (ONE_ONLY_TEXT_SECTION_ASM_OP,
	NEW_TEXT_SECTION_ASM_OP, DEFAULT_TEXT_SECTION_ASM_OP): Delete
	conditional defines.
	(som_text_section_asm_op): Replace ONE_ONLY_TEXT_SECTION_ASM_OP,
	NEW_TEXT_SECTION_ASM_OP and DEFAULT_TEXT_SECTION_ASM_OP with actual
	string values.
	(pa_select_section): Use renamed section functions.
	* config/pa/pa.h (EXTRA_SECTIONS, EXTRA_SECTION_FUNCTIONS,
	SOM_READONLY_DATA_SECTION_FUNCTION,
	SOM_ONE_ONLY_READONLY_DATA_SECTION_FUNCTION,
	SOM_ONE_ONLY_DATA_SECTION_FUNCTION, FORGET_SECTION_FUNCTION):
	Define here ...
	* config/pa/som.h: ... not here.
	(DEFAULT_TEXT_SECTION_ASM_OP, NEW_TEXT_SECTION_ASM_OP,
	ONE_ONLY_TEXT_SECTION_ASM_OP, READONLY_DATA_ASM_OP,
	ONE_ONLY_READONLY_DATA_SECTION_ASM_OP,
	ONE_ONLY_DATA_SECTION_ASM_OP): Delete.
	(READONLY_DATA_SECTION): Use som_readonly_data_section.

2004-08-20  Nathan Sidwell  <nathan@codesourcery.com>

	* fold-const.c (int_const_binop): Don't generate non-overflowing
	size-types specially.
	(fold_convert_const): Likewise.

	* stor-layout.c (initialize_sizetypes): Set SIZETYPE earlier,
	clear cache on copied sizetype.

2004-08-20  Ben Elliston  <bje@au.ibm.com>

	* configure.ac: Don't escape apostrophe in --enable-coverage help.
	* configure: Regenerate.

2004-08-20  Danny Smith  <dannysmith@users.sourceforge.net>

	PR 5620
	* gcc.c (struct stat input_stat): Don't define if
	HOST_LACKS_INODE_NUMBERS
	(do_spec_1): If HOST_LACKS_INODE_NUMBERS, use lrealpath rather
	than stat to determine if temp file is same as input file.
	* doc/hostconfig.texi: Document HOST_LACKS_INODE_NUMBERS.
	* config/i386/xm-mingw32.h: Define HOST_LACKS_INODE_NUMBERS

2004-08-20  Richard Sandiford  <rsandifo@redhat.com>

	* configure.ac (mips*-*-*): Print an error if not using GAS.
	* configure: Regenerated.
	* doc/install.texi: Remove irix5 bullet from --with-gnu-as.  Remove
	comments about buggy MIPSpro assemblers.
	* config.gcc (mips-sgi-irix[56]*): Combine stanzas.  Include elfos.h
	before mips.h and iris.h after it.  Use t-iris and t-slibgcc-irix.
	Use iris5.h only for IRIX 5 configs.  Use iris6.h and t-iris6 for
	IRIX 6 configs.  Define IRIX_USING_GNU_LD if using GNU ld.
	* config/mips/iris5.h (TARGET_IRIX, SWITCHES_NEED_SPACES)
	(DEFAULT_SIGNED_CHAR, WORD_SWITCH_TAKES_ARG, SUBTARGET_CC1_SPEC)
	(NO_IMPLICIT_EXTERN_C, MIPS_DEFAULT_GVALUE)
	(TARGET_ASM_EXTERNAL_LIBCALL): Move to iris.h.
	(WCHAR_TYPE, WCHAR_TYPE_SIZE, TARGET_OS_CPP_BUILTINS): Delete in favor
	of more general IRIX 6 definitions.
	(OBJECT_FORMAT_ELF, ASM_OUTPUT_ASCII, ASM_WEAKEN_LABEL)
	(HANDLE_SYSV_PRAGMA): Delete in favor of elfos.h definitions.
	(TARGET_IRIX5, ABICALLS_ASM_OP, BSS_SECTION_ASM_OP, HAS_INIT_SECTION)
	(LD_INIT_SWITCH, LD_FINI_SWITCH, SUBTARGET_ASM_OPTIMIZING_SPEC)
	(ASM_FINAL_SPEC, DBX_DEBUGGING_INFO, MIPS_DEBUGGING_INFO)
	(PREFERRED_DEBUGGING_TYPE, DWARF2_UNWIND_INFO, SET_FILE_NUMBER)
	(LABEL_AFTER_LOC, DOLLARS_IN_IDENTIFIERS, NO_DOLLAR_IN_LABEL)
	(TARGET_ASM_NAMED_SECTION, EXTRA_SECTION_FUNCTIONS)
	(ASM_DECLARE_FUNCTION_SIZE, ASM_OUTPUT_WEAK_ALIAS)
	(SUBTARGET_EXTRA_SPECS): Delete definitions or undefs.
	(LINK_SPEC): Move most of definition to iris.h.
	(SUBTARGET_LINK_SPEC): New macro.
	(IRIX_STARTFILE_SPEC): Fold into...
	(STARTFILE_SPEC): ...here.
	(IRIX_ENDFILE_SPEC): Fold into...
	(ENDFILE_SPEC): ...here.
	* config/mips/iris6.h (TARGET_IRIX5): Remove override.
	(WCHAR_TYPE, WCHAR_TYPE_SIZE, WINT_TYPE, WINT_TYPE_SIZE)
	(DWARF_OFFSET_SIZE, DWARF_INITIAL_LENGTH_SIZE, SET_ASM_OP)
	(LINK_ELIMINATE_DUPLICATE_LDIRECTORIES, ASM_DECLARE_OBJECT_NAME)
	(ASM_FINISH_DECLARE_OBJECT, LOCAL_LABEL_PREFIX): Move to iris.h.
	(TARGET_OS_CPP_BUILTINS): Likewise.  Guard IRIX6-specific bits.
	(DWARF2_UNWIND_INFO, DWARF2_GENERATE_TEXT_SECTION_LABEL)
	(SUBTARGET_CPP_SPEC, DWARF2_DEBUGGING_INFO, MIPS_DEBUGGING_INFO)
	(PREFERRED_DEBUGGING_TYPE, DWARF2_FRAME_INFO, MD_EXEC_PREFIX)
	(ASM_DECLARE_FUNCTION_NAME, ASM_DECLARE_FUNCTION_SIZE)
	(FUNCTION_NAME_ALREADY_DECLARED, SUPPORTS_INIT_PRIORITY)
	(POPSECTION_ASM_OP, SUBTARGET_ASM_SPEC, SUBTARGET_MIPS_AS_ASM_SPEC)
	(SUBTARGET_ASM_DEBUGGING_SPEC, SUBTARGET_ASM_OPTIMIZING_SPEC)
	(BSS_SECTION_ASM_OP*, READONLY_DATA_SECTION_ASM_OP*)
	(EH_FRAME_SECTION_NAME, MUST_USE_SJLJ_EXCEPTIONS, CTORS_SECTION_ASM_OP)
	(DTORS_SECTION_ASM_OP, TARGET_ASM_NAMED_SECTION, EH_FRAME_SECTION_NAME)
	(ASM_OUTPUT_ALIGN, ASM_OUTPUT_FILENAME, ASM_OUTPUT_ALIGNED_LOCAL)
	(ASM_OUTPUT_ALIGNED_BSS): Remove definitions or undefs.
	(TARGET_IRIX6): Define to 1.
	(DRIVER_SELF_SPECS): Define.
	(DWARF2_FRAME_INFO): Define to 1 rather than !TARGET_SGI_O32_AS.
	(SUBTARGET_CC1_SPEC): Remove in favor of DRIVER_SELF_SPECS.
	(SUBTARGET_LINK_SPEC): New macro.
	(IRIX_STARTFILE_SPEC): Fold into...
	(STARTFILE_SPEC): ...here.  Remove !mabi=* case.
	(SUBTARGET_{,DONT_}WARN_UNUSED_SPEC): New macros.
	(LIB_SPEC, LIBGCC_SPEC): Use them.
	(LIB_SPEC): Remove !mabi=* case.
	(IRIX_ENDFILE_SPEC): Fold into...
	(ENDFILE_SPEC): ...here.  Remove !mabi=* case.
	* config/mips/mips-protos.h (irix_output_external_libcall): Delete.
	* config/mips/mips.h (TARGET_IRIX5, TARGET_SGI_O32_AS): Delete.
	(TARGET_IRIX6): New macro.
	(ASM_ABI_DEFAULT_SPEC): Remove !ELF definition.
	(MD_EXEC_PREFIX, MD_STARTFILE_PREFIX, SET_FILE_NUMBER)
	(LABEL_AFTER_LOC): Delete.
	* config/mips/mips.c (TARGET_ASM_FILE_START, TARGET_ASM_FILE_END)
	(TARGET_SECTION_TYPE_FLAGS): Remove TARGET_IRIX versions.
	(mips_build_builtin_va_list): Check TARGET_IRIX6.
	(override_options): Remove TARGET_SGI_O32_AS-related code.
	(irix_output_external_libcall): Make static.
	(mips_output_filename): Avoid use of SET_FILE_NUMBER and
	LABEL_AFTER_LOC.
	(mips_file_start): Tidy guard for ABI sections.  Remove use of
	ABICALLS_ASM_OP; use .abicalls instead.
	(mips_output_aligned_decl_common, mips_declare_object_name)
	(mips_finish_declare_object): Remove use of TARGET_SGI_O32_AS.
	(mips_output_function_prologue): Set TREE_ASM_WRITTEN if emitting
	.globl foo .text directives.
	(irix_asm_named_section_1, irix_asm_named_section)
	(irix_section_align_entry, irix_section_align_htab)
	(irix_orig_asm_out_file, irix_section_align_entry_eq)
	(irix_section_align_entry_hash, irix_asm_output_align)
	(irix_file_start, irix_section_align_1, copy_file_data)
	(irix_file_end, irix_section_type_flags): Delete.
	* config/mips/irix-crti.asm (__gcc_init): Move to .gcc_init section.
	Use standard section syntax.  Remove protective "jr $31".
	(__gcc_fini): Likewise .gcc_fini.
	* config/mips/irix-crtn.asm: Adjust sections accordingly.
	* config/mips/sdb.h (PUT_SDB_SIZE, PUT_SDB_TYPE): Moved from
	iris5gas.h.
	* config/mips/t-iris (irix-crti.o, irix-crtn.o): New rules, moved
	from t-irix-gld.
	(EXTRA_MULTILIB_PARTS): Define.
	* config/mips/t-iris6: Remove bogus comment.
	(EXTRA_MULTILIB_PARTS, CRTSTUFF_T_CFLAGS): Delete.
	* config/mips/iris5gas.h, config/mips/iris5gld.h,
	config/mips/iris6gas.h, config/mips/iris6gld.h,
	config/mips/t-iris5-as, config/mips/t-iris5-gas
	config/mips/t-irix-gld: Delete.
	* config/mips/iris.h: New file.
	* config/mips/t-slibgcc-irix: Renamed from t-iris5-6.

2004-08-20  Richard Earnshaw  <rearnsha@arm.com>

	* postreload.c (reload_cse_move2add): Allow any condjump, but check
	that the implicit set isn't clobbered in the jump insn.

2004-08-19  Mark Mitchell  <mark@codesourcery.com>

	* defaults.h (TARGET_LIBGCC_LIBFUNCS): Remove.
	* optabs.c (init_optabs): Don't check it.
	* config/arm/bpabi.h (TARGET_LIBGCC_LIBFUNCS): Do not define.
	* doc/tm.texi (TARGET_LIBGCC_FUNCS): Remove.

2004-08-18  Andreas Krebbel  <krebbel1@de.ibm.com>

	* config/s390/s390.md (s390_warn_framesize_string)
	(s390_warn_dynamic_string, s390_stack_size_string)
	(s390_stack_guard_string): New global string variables.
	(s390_warn_framesize, s390_warn_dynamicstack_p, s390_stack_size)
	(s390_stack_guard): New global variables.
	(override_options): Added checks for the new options.
	(s390_emit_prologue): Emit stack check and trap code and perform
	compile time stack size checking.

	* config/s390/s390.h (TARGET_OPTIONS): Added new options
	"warn-framesize", "warn-dynamicstack", "stack-size" and
	"stack-guard".

	* doc/invoke.texi: Added documentation for the new options.

2004-08-19  Ulrich Weigand  <uweigand@de.ibm.com>

	* unwind-dw2-fde.c (get_cie_encoding): Cast argument to strlen
	to eliminate warning.
	(linear_search_fdes): Declare p as unsigned.
	(binary_search_mixed_encoding_fdes): Likewise.
	* unwind-dw2.c (get_cie_encoding): Cast argument to strlen
	to eliminate warning.
	* config/s390/linux.h (MD_FALLBACK_FRAME_STATE_FOR): Add missing
	type cast.

2004-08-19  Ulrich Weigand  <uweigand@de.ibm.com>

	* config/s390/s390-protos.h (preferred_la_operand_p): Adapt prototype.
	* config/s390/s390.c (preferred_la_operand_p): Accept two operands
	instead of one.  Check for strictly legitimate address.
	* config/s390/s390.md ("*la_31"/"*la_64" peepholes): Adapt call
	to preferred_la_operand_p, do not call gen_rtx_PLUS in predicate.

2004-08-19  Eric Christopher  <echristo@redhat.com>

	* langhooks-def.h (LANG_HOOKS_UNSAVE_EXPR_NOW): Remove.
	* langhooks.h (unsave_expr_now): Ditto.
	* tree.h (unsave_expr_1): Remove prototype.
	(lhd_unsave_expr_now): Rename to unsave_expr_now.
	* tree-inline.c (unsave_expr_1): Move here
	from tree.c. Make static.
	(unsave_expr_now): Rename from lhd_unsave_expr_now.
	* tree-sra.c: Fix up for rename.
	* tree-ssa-copy.c: Ditto.
	* tree-eh.c: Ditto.
	* tree.c (unsave_expr_1): Move to tree-inline.c.

2004-08-19  Caroline Tice  <ctice@apple.com>

	* config/i386/cygming.h (switch_to_section):  Fix typo (change
	in_unlikely_text_section to in_unlikely_executed_text).

2004-08-19  Daniel Berlin  <dberlin@dberlin.org>

	* vec.h (VEC_lower_bound): New macro.

2004-08-19  Richard Sandiford  <rsandifo@redhat.com>

	PR target/16446
	* config/mips/mips.c (struct mips_arg_info): Delete num_bytes.
	(mips_arg_info): Update accordingly.  Remove common treatment of fpr_p;
	treat each ABI separately.  Deal with n32/n64 complex float arguments.
	(function_arg): Add associated complex handling here.

2004-08-19  Richard Henderson  <rth@redhat.com>

	* config/arm/arm.c (arm_gen_load_multiple): Use
	adjust_automodify_address.  Take base memory and offset instead
	of unchanging/struct/scalar bits.
	(arm_gen_store_multiple): Likewise.
	(arm_gen_movmemqi): Use adjust_automodify_address.
	* config/arm/arm-protos.h: Update decls.
	* config/arm/arm.md (load_multiple): Update arm_gen_load_multiple call.
	(store_multiple): Similarly.

2004-08-19  J"orn Rennecke <joern.rennecke@superh.com>

	* regclass.c (globalize_reg): Update call_really_used_regs.

2004-08-19  Nathan Sidwell  <nathan@codesourcery.com>

	* doc/invoke.texi (integer-share-limit): Document.

	* tree.h (TYPE_CACHED_VALUES_P): New.
	(TYPE_CACHED_VALUES): New.
	(TYPE_ORIG_SIZE_TYPE): Adjust.
	* tree.def (INTEGER_CST): Update documentation.
	* tree.c: Inlcude params.h.
	(build_int_cst): Cache small values.
	(build_type_copy): Do not copy the value cache.
	* c-common.c (c_common_nodes_and_builtins): Add comment, remove
	unneeded zeroing.
	* c-typeck.c (build_c_cast): Add comment about OVERFLOW setting.
	* expmed.c (const_mult_add_overflow_p): Clear type copy's value
	cache.
	* fold-const.c (force_fit_type): Copy value when setting
	overflows.
	(int_const_binop): Likewise.
	* stor-layout.c: Include params.h
	(set_sizetype): Create values cache.
	(fixup_unsigned_type): Set UNSIGNED_P before caching any values.
	* params.def (PARAM_INTEGER_SHARE_LIMIT): New.
	* params.h (INTEGER_SHARE_LIMIT): New.
	* Makefile.in (tree.o, stor-layout.o): Depend on PARAMS_H.

2004-08-19  Paolo Bonzini  <bonzini@gnu.org>

	* gimplify.c (gimplify_minimax_expr): Remove.
	(gimplify_expr) <MIN_EXPR, MAX_EXPR>: Remove special handling.

2004-08-19  Dorit Naishlos  <dorit@il.ibm.com>

	* tree-vectorizer.c (vect_can_force_dr_alignment_p): Replace
	STACK_BOUDARY with PREFERRED_STACK_BOUNDARY.

2004-08-19  Mark Mitchell  <mark@codesourcery.com>

	* bpabi.h (FPUTYPE_DEFAULT): Set it to FPUTYPE_VFP.

2004-08-18  Andrew Pinski  <apinski@apple.com>

	* varasm.c (ecode_reg_name): Do nothing if the asmspec is empty.

2004-08-18  Mark Mitchell  <mark@codesourcery.com>

	* config/arm/bpabi.c (__aeabi_ul2d): Give it default visibility.
	(__aeabi_ul2f): Likewise.

2004-08-18  Richard Henderson  <rth@redhat.com>

	* config/xtensa/xtensa.c (xtensa_expand_block_move): Expand block
	move to rtl completely.
	(struct meminsnbuf, xtensa_emit_block_move): Remove.
	(xtensa_find_mode_for_size): Remove.
	* config/xtensa/xtensa-protos.h (xtensa_emit_block_move): Remove.
	* config/xtensa/xtensa.md (movmemsi_internal): Remove.

2004-08-18  Richard Henderson  <rth@redhat.com>

	* config/mcore/mcore.c (mode_from_align): Remove DImode.
	(block_move_sequence): Rewrite to use adjust_address.
	(mcore_expand_block_move): Cleanup logic.  Accept only operands.
	Return boolean indicating success/failure.
	* config/mcore/mcore-protos.h (mcore_expand_block_move): Update decl.
	* config/mcore/mcore.md (movmemsi): Update to match.

2004-08-18  Mike Stump  <mrs@apple.com>

	* doc/invoke.texi (-mfix-and-continue): Add support for
	fast turn around debugging.
	(-ffix-and-continue): Likewise.
	(-mindirect-data): Likewise.
	(-findirect-data): Likewise.
	* config/darwin.c (TARGET_FIX_AND_CONTINUE): Likewise.
	(indirect_data): Likewise.
	(machopic_data_defined_p): Likewise.
	(machopic_output_indirection): Likewise.
	(darwin_encode_section_info): Likewise.
	(darwin_fix_and_continue): Likewise.
	(darwin_fix_and_continue_switch): Likewise.
	* config/darwin.h (MACHO_SYMBOL_STATIC): Likewise.
	* config/rs6000/darwin.h (SUBTARGET_OVERRIDE_OPTIONS): Likewise.
	(SUBTARGET_OPTION_TRANSLATE_TABLE): Likewise.
	(SUBTARGET_OPTIONS): Likewise.
	(darwin_fix_and_continue): Likewise.
	(darwin_fix_and_continue_switch): Likewise.
	(TARGET_FIX_AND_CONTINUE): Likewise.
	* config/rs6000.c (rs6000_emit_prologue): Likewise.

2004-08-19  Steven Bosscher  <stevenb@suse.de>

	* basic-block.h (struct edge_def): Remove crossing_edge.
	(EDGE_CROSSING): New define.
	(EDGE_ALL_FLAGS): Update.
	* bb-reorder.c (find_traces_1_round, better_edge_p,
	find_rarely_executed_basic_blocks_and_cr, fix_up_fall_thru_edges,
	find_jump_block, fix_crossing_conditional_branches,
	fix_crossing_unconditional_branches, add_reg_crossing_jump_notes):
	Replace all occurences of crossing_edge with an edge flag check
	or set/reset.
	* cfgcleanup.c (try_simplify_condjump, try_forward_edges,
	try_crossjump_bb): Likewise.
	* cfglayout.c (fixup_reorder_chain): Likewise.
	* cfgrtl.c (force_nonfallthru_and_redirect,
	commit_one_edge_insertion): Likewise.

	* Makefile.in (cfganal.o): Depend on TIMEVAR_H.
	* tree-flow.h (compute_dominance_frontiers): Move prototype...
	* basic-block.h:  ...here.
	* tree-cfg.c (compute_dominance_frontiers_1,
	compute_dominance_frontiers): Move from here...
	* cfganal.c: ...to here.  Include timevar.h.

2004-08-18  James E Wilson  <wilson@specifixinc.com>

	* config/mips/mips.h (ASM_SPEC): In comment, change -meabi= to -mabi=.
	* config/mips/sb1.md (ir_sb1_divsf_1pipe): Renamed from ...1pipes.

	* config/mips/mips.md (type): Add frdiv.
	(divsf3+1, divsf3+2): Change type to frdiv.
	* config/mips/sb1.md (ir_sb1_recipsf_2pipes, ir_sb1_recipsf_1pipe,
	ir_sb1_recipdf_2pipes, ir_sb1_recipdf_1pipe): New.

	* config/mips/3000.md (r3k_fdiv_single, r3k_fdiv_double): Add frdiv.
	* config/mips/4300.md (r4300_fdiv_single, r4300_fdiv_double): Likewise.
	* config/mips/4600.md (r4600_fdiv_single, f4600_fdiv_double): Likewise.
	* config/mips/5000.md (r5k_fdiv_single): Likewise.
	* config/mips/5400.md (ir_vr54_fdiv_sf, ir_vr54_fdiv_df): Likewise.
	* config/mips/5500.md (ir_vr55_fdiv_sf, ir_vr55_fdiv_df): Likewise.
	* config/mips/6000.md (r6k_fdiv_single, r6k_fdiv_double): Likewise.
	* config/mips/7000.md (rm7_fp_divsqrt_df, rm7_fp_divsqrt_sf): Likewise.
	* config/mips/9000.md (rm8k_fdivs, rm9k_fdivd): Likewise.
	* config/mips/generic.md (generic_fdiv_single, generic_fdiv_double):
	Likewise.
	* config/mips/sr71k.md (ir_sr70_fdiv_sf, ir_sr70_fdiv_df): Likewise.

2004-08-18  Robert Bowdidge <bowdidge@apple.com>

	* config/rs6000/x-darwin: Remove XCFLAGS -mdynamic-no-pic to
	get regression tester working again.

2004-08-18  Zack Weinberg  <zack@codesourcery.com>

	* insn-notes.def, reg-notes.def: New files.
	* rtl.h: Use them to define enum insn_note and enum reg_note.
	* rtl.c: Use them to define note_insn_name and reg_note_name.
	* Makefile.in (RTL_BASE_H): Update.

	* modulo-sched.c, sched-rgn.c, final.c: NOTE_DISABLE_SCHED_OF_BLOCK
	renamed to NOTE_INSN_DISABLE_SCHED_OF_BLOCK.

2004-08-18  Richard Earnshaw  <rearnsha@arm.com>

	* arm.c (arm_size_rtx_costs): New function.
	(arm_override_options): Use it if optimizing for space.

2004-08-18  Richard Henderson  <rth@redhat.com>

	* emit-rtl.c (gen_const_mem): New.
	* rtl.h (gen_const_mem): Declare.
	* expr.c (do_tablejump): Use it.
	* varasm.c (force_const_mem): Likewise.
	* config/darwin.c (machopic_indirect_data_reference): Likewise.
	(machopic_legitimize_pic_address): Likewise.
	* config/arm/arm.c (legitimize_pic_address): Likewise.
	* config/i386/i386.c (legitimize_pic_address): Likewise.
	(legitimize_tls_address): Likewise.
	* config/ia64/ia64.c (ia64_expand_tls_address): Likewise.
	* config/ia64/ia64.md (load_fptr): Likewise.
	* config/m32r/m32r.c (m32r_legitimize_pic_address): Likewise.
	* config/pa/pa.c (legitimize_pic_address): Likewise.
	* config/rs6000/rs6000.c (rs6000_legitimize_tls_address): Likewise.
	(rs6000_emit_move): Likewise.
	* config/s390/s390.c (legitimize_pic_address): Likewise.
	(legitimize_tls_address): Likewise.
	* config/s390/s390.md (casesi): Likewise.
	* config/sh/sh.c (sh_reorg): Likewise.
	* config/sparc/sparc.c (legitimize_pic_address): Likewise.
	* config/v850/v850.md (casesi): Likewise.

	* config/darwin.c (machopic_indirect_call_target): Set MEM_NOTRAP_P.
	* config/sh/sh.c (prepare_move_operands): Remove incorrect
	use of MEM_READONLY_P.

2004-08-18  Steven Bosscher  <stevenb@suse.de>

	* Makefile.in (OBJS-common): Add postreload-gcse.c.
	Add new postreload-gcse.o.
	* cse.c (SAFE_HASH): Define as wrapper around safe_hash.
	(lookup_as_function, insert, rehash_using_reg, use_related_value,
	equiv_constant): Use SAFE_HASH instead of safe_hash.
	(exp_equiv_p): Export.  Add for_gcse argument when comparing
	for GCSE.
	(lookup, lookup_for_remove, merge_equiv_classes, find_best_addr,
	find_comparison_args, fold_rtx, cse_insn): Update callers.
	(hash_rtx): New function derived from old canon_hash and bits
	from gcse.c hash_expr_1.
	(canon_hash_string): Rename to hash_rtx_string.
	(canon_hash, safe_hash): Make static inline.  Call hash_rtx.
	* cselib.c (hash_rtx): Rename to cselib_hash_rtx.
	(cselib_lookup): Update this caller.
	* gcse.c (modify_mem_list_set, canon_modify_mem_list_set):
	Make static.
	(hash_expr): Call hash_rtx.
	(ldst_entry): Likewise.
	(expr_equiv_p): Call exp_equiv_p.
	(struct unoccr, hash_expr_1, hash_string_1, lookup_expr,
	reg_used_on_edge, reg_set_between_after_reload_p,
	reg_used_between_after_reload_p, get_avail_load_store_reg,
	is_jump_table_basic_block, bb_has_well_behaved_predecessors,
	get_bb_avail_insn, hash_scan_set_after_reload,
	compute_hash_table_after_reload,
	eliminate_partially_redundant_loads, gcse_after_reload,
	get_bb_avail_insn, gcse_after_reload_main): Remove.
	* postreload-gcse.c: New file, reincarnating most of the above.
	* rtl.h (exp_equiv_p, hash_rtx): New prototypes.
	(gcse_after_reload_main): Update prototype.
	* timevar.def (TV_GCSE_AFTER_RELOAD): New timevar.
	* passes.c (rest_of_handle_gcse2): Use it.

2004-08-18  Diego Novillo  <dnovillo@redhat.com>

	* tree-ssa-loop.c (pass_loop_init): Add TODO_dump_func.
	(pass_loop_done): Likewise.

2004-08-18  Andrew Pinski  <apinski@apple.com>

	* config/rs6000/darwin.md: Delete the altivec patterns which are
	handled differently now.
	(load_macho_picbase_di): Make sure that is only happens for TARGET_64BIT
	(macho_correct_pic_di): Likewise.
	(call_indirect_nonlocal_darwin64): Likewise.
	Delete the save world/saveFP/saveVec patterns.

	Revert the reversion of: 2004-08-16  Stan Shebs  <shebs@apple.com>
	* config/darwin.c (macho_indirect_data_reference): Add DImode case.
	* config/rs6000/rs6000.md: Include darwin.md.
	(builtin_setjmp_receiver): Add DImode case.
	* config/rs6000/rs6000.c (rs6000_emit_move): Add DImode case to
	Darwin bits.

2004-08-18  Matt Austern  <austern@apple.com>

	Dead code stripping
	* darwin.h (EH_FRAME_SECTION_ATTR): Mark so it doesn't get stripped.
	* darwin.c (darwin_file_end): Mark file as potentially strippable.

2004-08-18  Richard Henderson  <rth@redhat.com>

	* alias.c (readonly_fields_p): Remove.
	(objects_must_conflict_p): Don't call it.
	* tree.h (readonly_fields_p): Remove.
	* langhooks.h (struct lang_hooks): Remove honor_readonly.
	* langhooks-def.h (LANG_HOOKS_HONOR_READONLY): Remove.

2004-08-18  Diego Novillo  <dnovillo@redhat.com>

	* tree-dfa.c (add_referenced_var): Only global variables are
	call-clobbered.
	* tree-flow.h (struct ptr_info_def): Add field pt_global_mem.
	* tree-ssa-alias.c (compute_points_to_and_addr_escape): Mark
	all pointers dereferenced if the statement dereferences them.
	(create_name_tags): Do not create memory tags for pointers
	that have PT_ANYTHING set.
	Also check if PT_VARS is not empty before creating a name tag.
	(compute_flow_sensitive_aliasing): Don't mark call-clobbered
	variables that share the same alias set with a pointer that
	may point anywhere.
	(add_may_alias): Add FIXME comment to remove clobbering
	aliased variables and tags.
	(replace_may_alias): Likewise.
	(set_pt_anything): Do not clear PT_VARS nor IS_DEREFERENCED.
	(merge_pointed_to_info): If the original variable has not
	points-to information, call set_pt_anything.
	(add_pointed_to_var): Do not prevent adding a pointed-to
	variable if the pointers is PT_ANYTHING.
	If the variable is a global, set PT_GLOBAL_MEM.
	(collect_points_to_info_r): Don't assume that PLUS_EXPRs of
	pointer type only come in PTR+OFFSET flavours.
	Always call merge_pointed_to_info on PHI arguments that are
	SSA_NAMEs.
	(get_nmt_for): Mark call-clobbered tags whose pointer points
	to global memory.
	* tree-ssa-operands.c (opf_kill_def, opf_no_vops): Switch
	values.
	(get_indirect_ref_operands): Always clear OPF_KILL_DEF from
	FLAGS.
	(add_stmt_operand): Abort if the caller tried to add a killing
	definition for a memory tag.
	* tree-ssa.c (verify_flow_sensitive_alias_info): Remove
	unnecessary checks.

2004-08-18  J"orn Rennecke <joern.rennecke@superh.com>

	* sh.h (CONDITIONAL_REGISTER_USAGE): Don't exclude fixed registers
	from call_used_regs.  Update call_really_used_regs.
	(CALL_REALLY_USED_REGISTERS): Define.
	* sh.c (output_stack_adjust, shmedia_target_regs_stack_space):
	Replace call_used_regs with call_really_used_regs.
	(calc_live_regs, sh_media_register_for_return): Likewise.
	(sh5_schedule_saves, sh_expand_prologue, reg_unused_after): Likewise.
	* sh.md (return_media): Likewise.

2004-08-18  Andrew Pinski  <apinski@apple.com>

	* config/darwin.c (machopic_legitimize_pic_address): Only set
	MEM_READONLY_P in the non TARGET_TOC case.

2004-08-18  Zack Weinberg  <zack@codesourcery.com>

	* rtl.def (NIL): Delete.
	* read-rtl.c (read_rtx): Handle (nil) like (define_constants).
	Tighten the syntax a little.

	* cfgloop.h, combine.c, cse.c, loop-iv.c, postreload.c, reload.c
	* config/alpha/alpha.c, config/alpha/alpha.h, config/arc/arc.h
	* config/arm/arm.h, config/frv/frv.h, config/i386/i386.c
	* config/i386/predicates.md, config/m32r/m32r.h
	* config/m68hc11/m68hc11.c, config/mcore/mcore.h, config/mips/mips.c
	* config/mmix/mmix.c, config/pa/pa.h, config/sh/sh.h
	* config/sparc/sparc.h, doc/tm.texi:
	Replace all occurrences of NIL with UNKNOWN.

2004-08-18  Zack Weinberg  <zack@codesourcery.com>

	* dojump.c (do_jump <unordered_bcc>): Do not recursively call
	self with a TRUTH_ORIF_EXPR; generate the appropriate jump
	sequence inline.  Move drop_through_label code into this
	block, being the only place it is used.  Adjust comments.

2004-08-18  Fariborz Jahanian <fjahanian@apple.com>

	* config/rs6000/altivec.md: Add new patterns for calls to
	save_world/rest_world functions.

	* config/rs6000/rs6000-protos.h: (save_world_operation,
	restore_world_operation) new declarations.

	* config/rs6000/rs6000.c: (struct rs6000_stack) new world_save_p
	field added.
	(rs6000_stack_info): Set world_save_p field.
	(save_world_operation): New function.
	(restore_world_operation): New function.
	(compute_save_world_info): New function.
	(rs6000_stack_info): Call compute_save_world_info.
	(rs6000_emit_prologue): Check for world_save_p and generate
	pattern to call save_world for saving all non-volatile and
	special registers.
	(rs6000_emit_epilogue): Check for world_save_p and generate
	pattern to call rest_world to restore saved registers.

	config/rs6000/rs6000.h: macros FIRST_SAVED_ALTIVEC_REGNO,
	FIRST_SAVED_FP_REGNO, FIRST_SAVED_GP_REGNO defined.
	(rs6000_reg_names): New entries added for save_world_operation and
	restore_world_operation.

2004-08-18  Caroline Tice  <ctice@apple.com>

	* Makefile.in (STAGEFEEDBACK_FLAGS_TO_PASS) Add
	"-freorder-blocks-and-partition" to the flags used in second
	stage of profiledbootstrap.
	* bb-reorder.c (push_to_next_round_p): Add new variable,
	next_round_is_last; set and use variable to make sure, when
	partitioning, that the last trace construction round consists
	of all (and only) cold basic blocks.
	(rotate_loop): Don't copy blocks that end in a section
	crossing jump.
	(copy_bb): Correctly initialize "partition" of duplicated bb.
	(add_unlikely_executed_notes): Add a comment.
	(find_rarely_executed_basic_blocks_and_crossing_edges): Modify
	to make sure, if function contains hot blocks, that the
	successors of ENTRY_BLOCK_PTR are hot; also, only look for
	crossing edges if the architecture supports named sections.
	(mark_bb_for_unlikely_executed_section): Modify to always
	insert the NOTE_INSN_UNLIKELY_EXECUTED_CODE immediately after
	the basic block note insn.
	(fix_crossing_unconditional_branches): Remove extra space.
	(fix_edges_for_rarely_executed_code): Modify to only do
	partitioning work if the architecture supports named sections.
	(reorder_basic_blocks): Modify to only add
	NOTE_INSN_UNLIKELY_EXECUTED_CODE notes if the architecture
	supports named sections.
	* c-common.c (handle_section_attribute): Initialize new global
	variable, user_defined_section_attribute, to true if user has
	specified one.
	* cfgcleanup.c (try_forward_edges): Modify to not attempt to
	forward edges that cross section boundaries.
	* cfglayout.c (fixup_reorder_chain): Modify to only fix up
	partitioning information if the architecture supports named
	sections.
	* cfgrtl.c (target.h): Add statement to include this.
	(rtl_split_block): Make sure newly created bb gets correct
	partition.
	(try_redirect_by_replacing_jump): Make sure redirection isn't
	attempting to cross section boundaries.
	(force_nonfallthru_and_redirect): Only do partition fix up if
	architecture supports named sections.
	(rtl_split_edge): Make sure newly created bb ends up in
	correct partition.
	(commit_one_edge_insertion): Remove code that incorrectly
	updated basic block partition; Make sure partition fix up only
	happens if architecture supports named sections and it's not
	already done.
	(rtl_verify_flow_info_1): Fix if-condition on test/error
	condition that fallthru edges are not allowed to cross section
	boundaries.
	* defaults.h (NORMAL_TEXT_SECTION_NAME): Remove this.
	* final.c (final_scan_insn): Remove redundant test from if-statement;
	change calls to text_section into calls to function_section; add code
	to only to partitioning fix up if architecture supports named
	sections.
	* ifcvt.c (find_if_case_1): Make sure newly created bb has correct
	partition.
	(if_convert): Add targetm.have_named_sections to test.
	* output.h (unlikely_section_label): Extern declaration for new global
	variable.
	(unlikely_text_section_name): Likewise.
	* opts.c (decode_options): If both partitioning and DWARF debugging
	are turned on, issue a warning that this doesn't work, and change
	partitiong to basic block reordering (without hot/cold partitions).
	* passes.c (rest_of_handle_final): Re-set new global variable,
	user_defined_section_attribute, to false.
	(rest_of_compilation): Change options for calling partitioning
	function: Don't call if the user defined the section attribute, and
	don't call if DECL_ONE_ONLY is true for the current function.
	* predict.c (choose_function_section): Return immediately if we
	are doing hot/cold partitioning (i.e. let the basic block partitioning
	determine where the function belongs).
	* reg-stack.c (emit_swap_insn): Add condition to step over
	NOTE_INSN_UNLIKELY_EXECUTED_CODE notes.
	* toplev.c (user_defined_section_attribute): New global variable.
	* toplev.h (user_defined_section_attribute): Extern declaration
	for new global variable.
	* varasm.c (unlikely_section_label): New global variable.
	(unlikely_text_section_name): New global variable.
	(unlikely_text_section): Add code to initialize
	unlikely_text_section_name if necessary; modify to use
	unlikely_text_section_name and unlikely_section_label; also to use
	named_section properly.
	(in_unlikely_text_section):  Modify to work correctly with
	named_section and to use unlikely_text_section_name.
	(named_section):  Add code to work properly with cold section.
	(function_section): Clean up if-statement.
	* config/darwin.c (darwin_asm_named_section): Return to original
	code, removing use of SECTION_FORMAT_STRING.
	* config/arm/pe.h (switch_to_section):  Add case for
	in_unlikely_executed_text to switch statement.
	* config/i386/cygming.h (switch_to_section): Likewise.
	* config/i386/darwin.h (NORMAL_TEXT_SECTION_NAME): Remove.
	(SECTION_FORMAT_STRING): Likewise.
	* config/mcore/mcore.h (switch_to_section): Likewise.
	* config/rs6000/darwin.h (NORMAL_TEXT_SECTION_NAME): Remove.
	(SECTION_FORMAT_STRING): Remove.

2004-08-18  Roger Sayle  <roger@eyesopen.com>

	* config/i386/i386.h (FIXED_REGISTERS): Update encoding to be
	-ffixed-reg safe, by preserving the meanings of zero and one.
	(CALL_USED_REGISTERS): Likewise.
	(CONDITIONAL_REGISTER_USAGE): Update to process new encodings.

2004-08-18  Kaz Kojima  <kkojima@gcc.gnu.org>

	* config/sh/sh.c (split_branches): Check the result of
	next_active_insn.
	(sh_output_mi_thunk): Call init_flow if basic_block_info is null.
	Call rtl_register_cfg_hooks.

2004-08-18  Richard Henderson  <rth@redhat.com>

	* rtl.h (MEM_READONLY_P): Replace RTX_UNCHANGING_P.
	* alias.c (true_dependence): Update to match new semantics.
	(canon_true_dependence, write_dependence_p): Likewise.
	(anti_dependence, output_dependence): Update write_dependence_p args.
	(unchanging_anti_dependence): Remove.
	* calls.c (purge_mem_unchanging_flag): Remove.
	(fixup_tail_calls): Don't call it.
	(expand_call): Don't add unchanging memory to function usage.
	* expr.c (emit_block_move_via_libcall): Likewise.
	(clear_storage_via_libcall): Don't clobber RTX_UNCHANGING_P mems.
	(get_subtarget): Don't use RTX_UNCHANGING_P.
	(expand_assignment, store_constructor, expand_expr_real_1): Likewise.
	(do_tablejump): Set MEM_READONLY_P, not RTX_UNCHANGING_P.
	* combine.c (get_last_value_validate): Use MEM_READONLY_P.
	* cse.c (insert): Don't use RTX_UNCHANGING_P.
	(cse_insn, canon_hash): Use MEM_READONLY_P.
	* emit-rtl.c (set_mem_attributes_minus_bitpos): Use MEM_READONLY_P
	instead of RTX_UNCHANGING_P.
	* explow.c (maybe_set_unchanging): Remove.
	* expr.h (maybe_set_unchanging): Remove.
	* flow.c (insn_dead_p, mark_used_regs): Use anti_dependence.
	* function.c (assign_stack_temp_for_type): Don't use RTX_UNCHANGING_P.
	(assign_parm_setup_reg, expand_function_start): Likewise.
	* integrate.c (copy_rtx_and_substitute): Likewise.
	* ra-rewrite.c (emit_colors): Likewise.
	* regmove.c (copy_src_to_dest, regmove_optimize): Likewise.
	(fixup_match_1): Likewise.
	* reload1.c (reload, alter_reg): Likewise.
	* local-alloc.c (validate_equiv_mem): Check MEM_READONLY_P,
	not RTX_UNCHANGING_P.
	(equiv_init_varies_p): Likewise.
	* loop-invariant.c (check_maybe_invariant): Likewise.
	* resource.c (mark_referenced_resources, mark_set_resources): Likewise.
	* loop.c (note_addr_stored): Likewise.
	(prescan_loop): Likewise. Don't check function usage for clobbered
	unchanging memory.
	* rtlanal.c (rtx_unstable_p): Check MEM_READONLY_P,
	not RTX_UNCHANGING_P.
	(rtx_varies_p, modified_between_p, modified_in_p): Likewise.
	* varasm.c (force_const_mem): Likewise.
	* stmt.c (expand_decl): Don't set RTX_UNCHANGING_P.
	* web.c (entry_register): Likewise.
	* tree-gimple.h (get_base_address): Move decl ...
	* tree.h: ... here.
	* doc/rtl.texi (MEM_READONLY_P): Replace RTX_UNCHANGING_P.

	* config/alpha/alpha.c (alpha_set_memflags_1): Rewrite to be
	called via for_each_rtx.  Copy MEM_SCALAR_P, MEM_NOTRAP_P too.
	(alpha_set_memflags): Update to match.

	* config/darwin.c (machopic_indirect_data_reference): Set
	MEM_READONLY_P instead of RTX_UNCHANGING_P.
	(machopic_indirect_call_target): Likewise.
	(machopic_legitimize_pic_address): Likewise.
	* config/arm/arm.c (legitimize_pic_address, arm_gen_load_multiple,
	arm_gen_store_multiple, arm_gen_movmemqi): Likewise.
	* config/arm/arm.md (load_multiple, store_multiple): Likewise.
	* config/frv/frv.md (symGOT2reg): Likewise.
	* config/i386/i386.c (legitimize_pic_address,
	legitimize_tls_address, ix86_split_to_parts): Likewise.
	* config/ia64/ia64.c (ia64_expand_tls_address): Likewise.
	* config/ia64/ia64.md (load_fptr): Likewise.
	* config/m32r/m32r.c (m32r_legitimize_pic_address): Likewise.
	* config/m68k/m68k.c (legitimize_pic_address): Likewise.
	* config/mcore/mcore.c (block_move_sequence): Likewise.
	* config/mn10300/mn10300.md (symGOT2reg): Likewise.
	* config/pa/pa.c (legitimize_pic_address): Likewise.
	* config/rs6000/rs6000.c (rs6000_legitimize_tls_address): Likewise.
	(rs6000_emit_move): Likewise.
	* config/s390/s390.c (legitimize_pic_address): Likewise.
	(legitimize_tls_address): Likewise.
	* config/s390/s390.md (casesi): Likewise.
	* config/sh/sh.c (prepare_move_operands, sh_reorg): Likewise.
	* config/sh/sh.md (symGOT2reg): Likewise.
	* config/sparc/sparc.c (legitimize_pic_address): Likewise.
	* config/v850/v850.md (casesi): Likewise.

	* config/ia64/ia64.c (gen_thread_pointer): Don't set RTX_UNCHANGING_P.
	* config/iq2000/iq2000.c (save_restore_insns): Likewise.
	* config/mips/mips.c (mips_restore_gp): Likewise.
	(mips_save_restore_reg, mips16_gp_pseudo_reg): Likewise.
	* config/sh/sh.c (sh_reorg): Likewise.

2004-08-18  Richard Henderson  <rth@redhat.com>

	* tree.h (struct tree_decl): Add gimple_formal_temp.
	(DECL_GIMPLE_FORMAL_TEMP_P): New.
	* gimplify.c (pop_gimplify_context): Clear it.
	(lookup_tmp_var): Set it, if is_formal.
	(gimplify_init_constructor): Use rhs_predicate_for for COMPLEX.
	Use is_gimple_val for VECTOR.  Simplify return value.
	(gimplify_save_expr): Use and set DECL_GIMPLE_FORMAL_TEMP_P.
	(gimplify_expr): Likewise.
	* tree-gimple.c (is_gimple_formal_tmp_rhs): Rename from
	is_gimple_tmp_rhs for clarity.  Update all callers.
	(is_gimple_reg_rhs): Simplify logic.
	(is_gimple_formal_tmp_var): Rename from is_gimple_tmp_var for
	clarity; use DECL_GIMPLE_FORMAL_TEMP_P.
	(is_gimple_formal_tmp_reg): Similarly.
	* tree-gimple.h: Update decls.
	* tree-ssa-copyrename.c (copy_rename_partition_coalesce): Use
	DECL_IGNORED_P, not DECL_ARTIFICIAL.  Tidy formatting.
	* tree-ssa-live.c (var_union, type_var_init): Likewise.

2004-08-18  Paolo Bonzini  <bonzini@gnu.org>

	* c4x.c (legitimize_operands): Remove calls to
	preserve_subexpressions_p.

2004-08-18  David Edelsohn  <edelsohn@gnu.org>

	* varasm.c (MAX_OFILE_ALIGNMENT): Move ...
	* defaults.h (MAX_OFILE_ALIGNMENT): ... here.

2004-08-18  Ziemowit Laski  <zlaski@apple.com>

	* gcc.c (default_compilers): Add info about ".mm", ".M" and ".mii"
	Objective-C++ extensions.
	* gengtype.c (get_file_basename): Match entire subdirectory name
	('cp', 'objc', 'objcp') rather than just its suffix.
	(get_base_file_bitmap): Allow for files to belong to more than one
	language.
	(get_output_file_with_visibility): Treat objc/objc-act.h as a header
	used by more than one front-end.

2004-08-18  Richard Earnshaw  <rearnsha@arm.com>

	* arm.md (addsi3, subsi3, andsi3, iorsi3, movsi, movhi): Rework to
	avoid use of preserve_subexpressions_p.

2004-08-17  Richard Henderson  <rth@redhat.com>

	PR 17051
	* tree-sra.c (scalarize_use): Mark all v_defs for !is_output too.

2004-08-17  DJ Delorie  <dj@redhat.com>

	* doc/extend.texi: Document new xstormy16 attribute.

	* config/stormy16/stormy16.c (xstormy16_splittable_below100_operand): New.
	(xstormy16_splittable_below100_or_register): New.
	(combine_bnp): New.
	(xstormy16_reorg): New.
	(TARGET_MACHINE_DEPENDENT_REORG): Define.

	* config/stormy16/stormy16.md (movqi_internal): Make name public.
	(movhi_internal): Likewise.
	(cbhranchhi): Likewise.
	(cbhranchhi_neg): Likewise.
	(andhi3): Only allow splittable below100 operands.
	(iorhi3): Likewise.
	(peephole2): New and/zero_extend->and peephole.
	(peephole2): New load/ior/save->set1 peephole.
	(peephole2): New load/and/save->clr1 peephole.
	(bclrx, bclrx2, bclr7, bclr15): New.
	(bsetx, bsetx2, bset7, bset15): New.

	* config/stormy16/stormy16.c (xstormy16_print_operand): Be more
	liberal about acceptable 'B' masks.

	* config/stormy16/stormy16-protos.h
	(xstormy16_asm_output_aligned_common, xstormy16_below100_symbol,
	xstormy16_below100_operand, xstormy16_below100_or_register,
	xstormy16_onebit_set_operand, xstormy16_onebit_clr_operand): New.
	(PREDICATE_CODES): Add new predicates.

	* config/stormy16/stormy16.c
	(xstormy16_asm_output_aligned_common, xstormy16_below100_symbol,
	xstormy16_below100_operand, xstormy16_below100_or_register,
	xstormy16_onebit_set_operand, xstormy16_onebit_clr_operand): New.
	(xstormy16_expand_iorqi3, xstormy16_expand_andqi3): New.
	(xstormy16_legitimate_address_p): Allow below100 symbols.
	(xstormy16_extra_constraint_p): Add 'W' for below100 operands.
	(xstormy16_expand_move): Leave below100 operands as-is.
	(xstormy16_encode_section_info): Encode below100 symbols.
	(xstormy16_strip_name_encoding): New.
	(xstormy16_print_operand): Print 'b' as shift mask.
	(xstormy16_attribute_table): Add below100 attributes.
	(xstormy16_handle_below100_attribute): New.

	* config/stormy16/stormy16.h (EXTRA_SECTIONS): add in_bss100.
	(XSTORMY16_SECTION_FUNCTION): New.
	(EXTRA_SECTION_FUNCTIONS): Define using the above.
	(ASM_OUTPUT_ALIGNED_DECL_COMMON, ASM_OUTPUT_ALIGNED_DECL_LOCAL): New.
	(ASM_OUTPUT_SYMBOL_REF): Handle encoded symbols.
	(ASM_OUTPUT_LABELREF): Define.

	* config/stormy16/stormy16.md (movqi_internal): Add below100 support.
	(movhi_internal): Add below100 support.
	(andhi3): Add below100 support.
	(iorhi3): Add below100 support.
	(iorqi3, iorqi3_internal, andqi3, andqi3_internal): New.

2004-08-17  James E Wilson  <wilson@specifixinc.com>

	* config/mips/mips.c (gen_conditional_move): Use GET_MODE (op0) instead
	of VOIDmode for comparison code mode.
	* config/mips/mips.md: For conditional move patterns, use mode of
	first compare operand for comparison mode, instead of VOIDmode.

	* config/mips/mips.md: Add canonical nmadd and nmsub patterns for both
	normal and -ffast-math code.

2004-08-17  Mark Mitchell  <mark@codesourcery.com>

	PR c++/15871
	* doc/invoke.texi (-fkeep-inline-functions): Update documentation.

2004-08-17  Robert Bowdidge  <bowdidge@apple.com>

	* config/rs6000/x-darwin: Add -mdynamic-no-pic to gcc build flags.

2004-08-17  Andreas Tobler  <a.tobler@schweiz.ch>

	* config/rs6000/darwin.md (*call_nonlocal_darwin64): Add #else clause
	for non Darwin targets.
	(*call_value_nonlocal_darwin64): Likewise.

2004-08-17  Fariborz Jahanian <fjahanian@apple.com>

	* config/rs6000/rs6000.c (rs6000_function_value): Check for
	altivec mode for altivec return register.

2004-08-17  David Edelsohn  <edelsohn@gnu.org>

	Revert 2004-08-16  Stan Shebs  <shebs@apple.com>
	* config/darwin.c (macho_indirect_data_reference): Add DImode case.
	* config/rs6000/rs6000.md: Include darwin.md.
	(builtin_setjmp_receiver): Add DImode case.
	* config/rs6000/rs6000.c (rs6000_emit_move): Add DImode case to
	Darwin bits.

2004-08-17  Dorit Naishlos  <dorit@il.ibm.com>

	* tree-vectorizer.c: New File: loop vectorization on SSAed GIMPLE
	trees.
	* tree-vectorizer.h: New File: Same.
	* Makefile.in (tree-vectorizer.c, tree-vectorizer.h): Add new files.
	* common.opt (ftree-vectorize): New flag to enable vectorization.
	* timevar.def (TV_TREE_VECTORIZATION): New dump file for
	vectorization pass.
	* tree-data-ref.h (init_data_ref): Additional argument.
	(array_base_name_differ_p): Moved to tree-data-ref.c.
	* tree-data-ref.c (array_base_name_differ_p): Revised.
	(initialize_data_dependence_relation): Call array_base_name_differ_p
	with an extra argument.
	(analyze_all_data_dependences): Same.
	(init_data_ref): Additional argument is_read to set DR_IS_READ.
	* tree-ssa-phiopt.c (empty_block_p): Expose for usage out of this
	file.
	* tree-flow.h (vectorize_loops, empty_block_p): Add declaration.
	* tree-optimize.c (pass_vectorize): Schedule the vectorization pass.
	* tree-pass.h (tree_opt_pass pass_vectorize): Declare the new
	vectorization pass.
	* tree-ssa-loop.c (tree_ssa_loop_init): Call scev_initialize.
	(tree_ssa_loop_done): Call scev_finalize.
	(tree_vectorize): Define the new vectorization pass.
	* defaults.h (UNITS_PER_SIMD_WORD): Allow targets to specify the
	size of the vector they support (until support for multiple vector
	sizes is added to the vectorizer).
	* config/i386/i386.h (UNITS_PER_SIMD_WORD): Define.
	* config/rs6000/rs6000.h (UNITS_PER_SIMD_WORD): Define.
	* invoke.texi (fdump-tree-vect, ftree-vectorize): Add
	documentation.

2004-08-17  Nathan Sidwell  <nathan@codesourcery.com>

	* objc/objc-act.c (build_protocol_initializer): Fix build_int_cst
	usage.
	(generate_protocol_list, handle_impent): Likewise.

2004-08-17  Roger Sayle  <roger@eyesopen.com>

	* regclass.c (init_reg_sets_1): Add ENABLE_CHECKING sanity tests to
	ensure that call_used_regs is a superset of both fixed_regs and
	call_really_used_regs.

2004-08-17  Daniel Bornstein  <danfuzz@milk.com>

	PR target/17019
	* arm.md (addsi3_cbranch_scratch): Correct case labels.

2004-08-17  Paolo Bonzini  <bonzini@gnu.org>

	PR middle-end/17036
	* fold-const.c (fold): Check for integer operand when
	folding (A >> N) & 1 ? (1 << N) : 0.  Fix from Andrew
	Pinski  <pinskia@physics.uc.edu>.

2004-08-17  Paolo Bonzini  <bonzini@gnu.org>

	* configure.ac: Trust toplevel's notion of BISON/FLEX/MAKEINFO.
	No need to check if in a cross configuration.
	* configure: Regenerate.

	* calls.c (precompute_register_parameters):
	Inline preserve_subexpressions_p ().
	* expmed.c (expand_mult_const, emit_store_flag): Likewise.
	* optabs.c (expand_binop, expand_twoval_binop, prepare_cmp_insn):
	Likewise.
	* expr.c (get_subtarget): Likewise.
	* rtl.h (preserve_subexpressions_p): Remove.
	* stmt.c (preserve_subexpressions_p): Remove.

	* dojump.c (do_jump) <COND_EXPR, EQ_EXPR, NE_EXPR,
	TRUTH_ANDIF_EXPR, TRUTH_ORIF_EXPR, COMPOUND_EXPR>:
	Abort on gimplified cases.

2004-08-16  James E Wilson  <wilson@specifixinc.com>

	* tree.h (VECTOR_FLOAT_TYPE_P): New.
	(FLOAT_TYPE_P): Use it.
	* c-typeck.c (build_binary_op): After convert calls, check for
	check for ERROR_MARK operands.

2004-08-16  Zack Weinberg  <zack@codesourcery.com>

	* Makefile.in (BUILD_PREFIX, BUILD_PREFIX_1): Delete.
	(BUILD_RTL, BUILD_PRINT, BUILD_ERRORS, BUILD_VARRAY): Update.
	(genobjs): Add build-rtl.o, build-print-rtl.o, build-varray.o.
	(genobjs static pattern rule): Remove %.c dependency.
	($(BUILD_PREFIX_1)rtl.o, print-rtl.o, $(BUILD_PREFIX_1)varray.o):
	Rename rules; delete commands; fix dependencies.
	(mostlyclean): Do not delete temporary source copies.
	* configure.ac: Delete all references to BUILD_PREFIX and
	BUILD_PREFIX_1.
	* configure: Regenerate.

	* print-rtl.c: Include bconfig.h #ifdef GENERATOR_FILE.
	Do not include tree.h, real.h, flags.h, hard-reg-set.h, or
	basic-block.h #ifdef GENERATOR_FILE.  Surround some more code
	with #ifndef GENERATOR_FILE so that nothing from those headers
	is used.

	* rtl.c, varray.c: Include bconfig.h #ifdef GENERATOR_FILE.

2004-08-16  Adam Nemet  <anemet@lnxw.com>

	* Makefile.in (LIBS): Move $(LIBIBERTY) after $(BANSHEELIB).

2004-08-16  Andrew Pinski  <apinski@apple.com>

	* target-def.h (TARGET_EH_RETURN_FILTER_MODE): Remove
	extraneous semicolon.

2004-08-16  Devang Patel  <dpatel@apple.com>

	* c-common.c (handle_used_attribute): Set DECL_PRESERVE_P.
	* print-tree.c (print_node): Print DECL_PRESERVE_P.
	* target-def.h (TARGET_ASM_MARK_DECL_PRESERVED): New #define.
	(TARGET_ASM_OUT): New member, TARGET_ASM_MARK_DECL_PRESERVED
	* target.h (struct gcc_target): New member, mark_decl_preserved.
	* hooks.c (hook_void_charptr): Rename to ...
	(hook_void_constcharptr): ... new name.
	* hooks.h (hook_void_charptr): Rename to ..
	(hook_void_constcharptr): ... new name.
	* tree.h (DECL_PRESERVE_P): New #define.
	(struct tree_decl): New member, preserve_flag.
	* varasm.c (assemble_start_function): Mark decl preserved.
	(assemble_variable): Same.
	* darwin.c (darwin_mark_decl_preserved): New function.
	* darwin.h (TARGET_ASM_MARK_DECL_preserved): New #define.
	* darwin-protos.h (darwin_mark_decl_preserved): New decl.
	* doc/tm.texi (TARGET_ASM_MARK_DECL_PRESERVED): Document.

2004-08-16  Joseph S. Myers  <jsm@polyomino.org.uk>

	* c-decl.c (grokdeclarator): Allow for function definition where
	innermost declarator has attributes.

2004-08-16  Fariborz Jahanian <fjahanian@apple.com>

	* except.c (get_exception_filter, build_post_landing_pads,
	dw2_build_landing_pads): Use target-specific mode for 'filter'.
	* target-def.h (TARGET_EH_RETURN_FILTER_MODE): macro defined and used.
	* target.h (eh_return_filter_mode): New field added.
	* targhooks.c (default_eh_return_filter_mode): Defined.
	* targhooks.h (default_eh_return_filter_mode): Declared.
	* config/rs6000/rs6000.c (rs6000_eh_return_filter_mode): Defined.

2004-08-16  Nathanael Nerode  <neroden@gcc.gnu.org>

	* configure.ac: Replace _GCC_TOPLEV_NONCANONICAL_TARGET with
	ACX_NONCANONICAL_TARGET; remove now-unneeded AC_SUBST.
	* configure: Regenerate.

2004-08-16  Stan Shebs  <shebs@apple.com>

	Basic support for 64-bit Darwin.
	* config/darwin.c (macho_indirect_data_reference): Add DImode case.
	(machopic_legitimize_pic_address): Similarly, plus use Pmode
	instead of SImode.
	* config/rs6000/darwin.h (PTRDIFF_TYPE): Be "long int" if 64-bit.
	(TARGET_OS_CPP_BUILTINS): Add 64-bit preprocessor macro.
	(SUBTARGET_SWITCHES): Add -m32 and -m64 flags.
	(SUBTARGET_OVERRIDE_OPTIONS): Require 64-bit processor if -m64.
	(PROCESSOR_DEFAULT64): Define.
	* config/rs6000/darwin.md: New file, patterns specific to 64-bit
	Darwin.
	* config/rs6000/rs6000.md: Include darwin.md.
	(builtin_setjmp_receiver): Add DImode case.
	* config/rs6000/rs6000.c (TARGET_ASM_UNALIGNED_DI_OP): Define for
	Darwin.
	(TARGET_ASM_ALIGNED_DI_OP): Ditto.
	(rs6000_emit_move): Add DImode case to Darwin bits.
	(machopic_output_stub): Use .quad if 64-bit.
	* invoke.texi: Document -m32 and -m64.

2004-08-16  Janis Johnson  <janis187@us.ibm.com>

	* doc/extend.texi (AltiVec builtins): Document additional differences
	from the Motorola AltiVec PIM.

2004-08-16  Nathan Sidwell  <nathan@codesourcery.com>

	* c-typeck.c (build_c_cast): Only copy overflow from expr nodes.
	* tree.h (IS_NON_TYPE_CODE_CLASS): Simplify.
	(struct tree_common): Update public_flag documentation.

2004-08-16  Nathanael Nerode  <neroden@gcc.gnu.org>

	* tree-ssa-copyrename.c (copy_rename_partition_coalesce):
	Check for artificial variables, not is_gimple_tmp_var.
	* tree-ssa-live.c (var_union): Likewise.

2004-08-16  Nathan Sidwell  <nathan@codesourcery.com>

	* calls.c (load_register_parameters): Remove spurious FIXME token.

2004-08-15  Ziemowit Laski  <zlaski@apple.com>

	* Makefile.in (C_PRETTY_PRINT_H): Add c-pretty-print.h.
	(c-lang.o): Depend on c-objc-common.h.
	(c-objc-common.o): Depend on $(C_PRETTY_PRINT_H) and
	c-objc-common.h; remove duplicate $(C_TREE_H) dependency.
	* c-lang.c: Include c-objc-common.h.
	(LANG_HOOKS_FINISH, LANG_HOOKS_INIT_OPTIONS,
	LANG_HOOKS_INITIALIZE_DIAGNOSTICS, LANG_HOOKS_HANDLE_OPTION,
	LANG_HOOKS_MISSING_ARGUMENT, LANG_HOOKS_POST_OPTIONS,
	LANG_HOOKS_GET_ALIAS_SET, LANG_HOOKS_SAFE_FROM_P,
	LANG_HOOKS_EXPAND_EXPR, LANG_HOOKS_MARK_ADDRESSABLE,
	LANG_HOOKS_PARSE_FILE, LANG_HOOKS_TRUTHVALUE_CONVERSION,
	LANG_HOOKS_FINISH_INCOMPLETE_DECL, LANG_HOOKS_UNSAFE_FOR_REEVAL,
	LANG_HOOKS_STATICP, LANG_HOOKS_SET_DECL_ASSEMBLER_NAME,
	LANG_HOOKS_NO_BODY_BLOCKS, LANG_HOOKS_WARN_UNUSED_GLOBAL_DECL,
	LANG_HOOKS_PRINT_IDENTIFIER, LANG_HOOKS_FUNCTION_ENTER_NESTED,
	LANG_HOOKS_FUNCTION_LEAVE_NESTED, LANG_HOOKS_DUP_LANG_SPECIFIC_DECL,
	LANG_HOOKS_DECL_UNINIT, LANG_HOOKS_RTL_EXPAND_STMT,
	LANG_HOOKS_COMMON_ATTRIBUTE_TABLE, LANG_HOOKS_FORMAT_ATTRIBUTE_TABLE,
	LANG_HOOKS_TREE_INLINING_CANNOT_INLINE_TREE_FN,
	LANG_HOOKS_TREE_INLINING_DISREGARD_INLINE_LIMITS,
	LANG_HOOKS_TREE_INLINING_ANON_AGGR_TYPE_P,
	LANG_HOOKS_TREE_INLINING_CONVERT_PARM_FOR_INLINING,
	LANG_HOOKS_TREE_INLINING_ESTIMATE_NUM_INSNS,
	LANG_HOOKS_TREE_DUMP_DUMP_TREE_FN,
	LANG_HOOKS_CALLGRAPH_EXPAND_FUNCTION, LANG_HOOKS_TYPE_FOR_MODE,
	LANG_HOOKS_TYPE_FOR_SIZE, LANG_HOOKS_SIGNED_TYPE,
	LANG_HOOKS_UNSIGNED_TYPE, LANG_HOOKS_SIGNED_OR_UNSIGNED_TYPE,
	LANG_HOOKS_INCOMPLETE_TYPE_ERROR, LANG_HOOKS_TYPE_PROMOTES_TO,
	LANG_HOOKS_REGISTER_BUILTIN_TYPE, LANG_HOOKS_WRITE_GLOBALS):
	Move to c-objc-common.h.
	* c-objc-common.c: Include c-objc-common.h.
	* c-objc-common.h: New file.

2004-08-15  Andreas Tobler  <a.tobler@schweiz.ch>
	    Andrew Pinski  <pinskia@physics.uc.edu>

	PR target/14931
	* config/rs6000/darwin-tramp.asm (L_abort$stub): Change to new stub
	style.

2004-08-15  Nathan Sidwell  <nathan@codesourcery.com>

	* tree.h (build_int_cst): New.
	(build_int_2): Remove.
	* tree.c (build_int_2): Remove.
	(build_int_cst): New.
	(make_vector_type, build_common_tree_nodes,
	build_common_tree_nodes_2): Use build_int_cst.
	* builtins.c (expand_builtin_prefetch, expand_builtin_strstr,
	expand_builtin_strpbrk, expand_builtin_fputs,
	build_string_literal, expand_builtin_printf,
	expand_builtin_sprintf, fold_builtin_lround, fold_builtin_bitop,
	fold_builtin_bitop, fold_builtin_isascii, fold_builtin_toascii,
	fold_builtin_isdigit, simplify_builtin_strstr,
	simplify_builtin_strpbrk, fold_builtin_fputs,
	simplify_builtin_sprintf): Use build_int_cst.
	* c-common.c (start_fname_decls, fix_string_type,
	c_common_nodes_and_builtins, c_init_attributes,
	shorten_compare): Likewise.
	* c-decl.c (complete_array_type,
	check_bitfield_type_and_width): Likewise.
	* c-lex.c (interpret_integer, lex_charconst): Likewise.
	* c-parse.in (primary): <TYPES_COMPATIBLE_P> Likewise.
	* c-pretty-print.c (pp_c_integer_constant): Likewise.
	* c-typeck.c (really_start_incremental_init, push_init_level,
	set_nonincremental_init_from_string): Likewise.
	* calls.c (load_register_parameters): Likewise.
	* convert.c (convert_to_pointer): Likewise.
	* coverage.c (coverage_counter_alloc, tree_coverage_counter_ref,
	build_fn_info_type, build_ctr_info_value, build_gcov_info):
	Likewise.
	* except.c (init_eh, assign_filter_values, assign_filter_values):
	Likewise.
	* expmed.c (store_fixed_bit_field, extract_bit_field,
	extract_fixed_bit_field, extract_split_bit_field, expand_shift,
	expand_mult_const, expand_mult_highpart_adjust, extract_high_half,
	expand_sdiv_pow2, expand_divmod, make_tree): Likewise.
	* expr.c (convert_move, emit_group_load, emit_group_store,
	expand_assignment, store_constructor, store_field,
	expand_expr_real_1, reduce_to_bit_field_precision): Likewise.
	* fold-const.c (force_fit_type, int_const_binop, fold_convert_const,
	invert_truthvalue, optimize_bit_field_compare,
	decode_field_reference, all_ones_mask_p, constant_boolean_node,
	fold_div_compare, fold, fold_read_from_constant_string,
	fold_negate_const, fold_abs_const, fold_not_const): Likewise.
	* function.c (assign_parm_setup_block): Likewise.
	* stmt.c (shift_return_value, expand_end_case_type,
	estimate_case_costs): Likewise.
	* stor-layout.c (layout_type, initialize_sizetypes,
	set_min_and_max_values_for_integral_type): Likewise.
	* tree-chrec.c (chrec_fold_multiply_poly_poly,
	reset_evolution_in_loop): Likewise.
	* tree-chrec.h (build_polynomial_chrec): Likewise.
	* tree-complex.c (build_replicated_const): Likewise.
	* tree-eh.c (honor_protect_cleanup_actions,
	lower_try_finally_onedest, lower_try_finally_copy,
	lower_try_finally_switch): Likewise.
	* tree-mudflap.c (mf_build_string, mx_register_decls,
	mudflap_register_call, mudflap_enqueue_constant): Likewise.
	* tree-nested.c (get_trampoline_type, get_nl_goto_field): Likewise.
	* tree-pretty-print.c (dump_generic_node): Likewise.
	* tree-ssa-ccp.c (widen_bitfield, maybe_fold_offset_to_array_ref):
	Likewise.
	* tree-ssa-dom.c (simplify_rhs_and_lookup_avail_expr): Likewise.
	* tree-ssa-loop-niter.c (number_of_iterations_cond,
	loop_niter_by_eval, upper_bound_in_type, lower_bound_in_type):
	Likewise.

	* config/alpha/alpha.c (alpha_initialize_trampoline,
	alpha_va_start, alpha_gimplify_va_arg_1): Use build_int_cst.
	* config/arm/arm.c (arm_get_cookie_size): Likewise.
	* config/c4x/c4x.c (c4x_gimplify_va_arg_expr): Likewise.
	* config/i386/i386.c (ix86_va_start, ix86_gimplify_va_arg): Likewise.
	* config/i860/i860.c (i860_va_start): Likewise.
	* config/ia64/ia64.c (ia64_gimplify_va_arg): Likewise.
	* config/mips/mips.c (mips_build_builtin_va_list, mips_va_start,
	mips_gimplify_va_arg_expr): Likewise.
	* config/pa/pa.c (hppa_gimplify_va_arg_expr): Likewise.
	* config/rs6000/rs6000.c (rs6000_va_start, rs6000_gimplify_va_arg,
	add_compiler_branch_island): Likewise.
	* config/s390/s390.c (s390_va_start): Likewise.
	* config/sh/sh.c (sh_va_start): Likewise.
	* config/stormy16/stormy16.c (xstormy16_expand_builtin_va_start):
	Likewise.
	* config/xtensa/xtensa.c (xtensa_va_start,
	xtensa_gimplify_va_arg_expr): Likewise.

	* objc/objc-act.c (build_objc_string_object,
	build_objc_symtab_template, init_def_list, init_objc_symtab,
	init_module_descriptor, generate_static_references,
	build_selector_translation_table, get_proto_encoding,
	build_typed_selector_reference, build_selector_reference,
	build_next_objc_exception_stuff,
	build_method_prototype_list_template, generate_descriptor_table,
	generate_protocols, build_protocol_initializer,
	build_ivar_list_template, build_method_list_template,
	build_ivar_list_initializer, generate_ivars_list,
	generate_dispatch_table, generate_protocol_list,
	build_category_initializer, build_shared_structure_initializer,
	generate_shared_structures, handle_impent,
	generate_objc_image_info): Use build_int_cst.

2004-08-15  Ben Elliston  <bje@au.ibm.com>

	* vec.h: Comment improvements.

2004-08-14  Roger Sayle  <roger@eyesopen.com>

	* c-common.c (shorten_compare, pointer_int_sum,
	c_common_truthvalue_conversion, boolean_increment): Replace calls
	to build with calls to buildN.
	* c-decl.c (complete_array_type, grokdeclarator): Likewise.
	* c-gimplify.c (c_build_bind_expr, gimplify_c_loop,
	gimplify_switch_stmt): Likewise.
	* c-typeck.c (default_function_array_conversion,
	build_component_ref, build_array_ref, build_function_call,
	pointer_diff, build_unary_op, build_conditional_expr,
	build_compound_expr, build_modify_expr, c_finish_goto_label,
	c_finish_goto_ptr, c_finish_return, c_finish_loop,
	c_finish_bc_stmt, c_finish_stmt_expr, c_end_compound_stmt,
	build_binary_op): Likewise.

2004-08-15  Steven Bosscher  <stevenb@suse.de>

	* rtl.c (note_insn_name): Add NOTE_DISABLE_SCHED_OF_BLOCK.

2004-08-14  John David Anglin  <dave.anglin@nrc-cnrc.gc.ca>

	* fixinc/inclhack.def (stdio_va_list): Also fix com_err.h, cps.h,
	curses.h, krb5.h, lc_core.h, pfmt.h, wchar.h and curses_colr/curses.h.
	* fixinc/fixincl.x: Rebuilt.

2004-08-14  Richard Sandiford  <rsandifo@redhat.com>

	* config/mips/mips-protos.h (mips_symbolic_constant_p)
	(mips_atomic_symbolic_constant_p, mips_stack_address_p)
	(mips_small_data_pattern_p): Declare.
	* config/mips/mips.h (CONST_GP_P): Moved from mips.c.
	(PREDICATE_CODES, SPECIAL_MODE_PREDICATES): Delete.
	* config/mips/mips.c (mips_symbolic_constant_p): Make global.
	(mips_atomic_symbolic_constant_p, mips_stack_address_p): New functions.
	(uns_arith_operand, const_arith_operand, arith_operand, sle_operand)
	(sleu_operand, small_int, reg_or_0_operand, const_float_1_operand)
	(reg_or_const_float_1_operand, hilo_operand, extend_operator)
	(macc_msac_operand, equality_op, cmp_op, trap_cmp_op)
	(pc_or_label_operand, call_insn_operand, move_operand)
	(consttable_operand, symbolic_operand, general_symbolic_operand)
	(global_got_operand, local_got_operand, stack_operand)
	(fp_register_operand, lo_operand, fcc_register_operand): Delete.
	(mips_small_data_pattern_1): Renamed from small_data_pattern_1.
	(mips_small_data_pattern_p): Replace previous small_data_pattern
	predicate.  Turn into a bool () (rtx) function.
	* config/mips/predicates.md: New file.
	* config/mips/mips.md: Include it.  Use the target-independent
	comparison_operator instead of cmp_op.  Rename trap_cmp_op to
	trap_comparison_operator and equality_op to equality_operator.
	Replace uses of small_int with the equivalent const_arith_operand.
	Rename reg_or_const_float_1_operand to reg_or_1_operand.  Rename
	const_float_1_operand to const_1_operand.  Rename fcc_register_operand
	to fcc_reload_operand.
	* config/mips/sb1.md: Rename fp_register_operand to fpr_operand.

2004-08-14  John David Anglin  <dave.anglin@nrc-cnrc.gc.ca>

	PR libstdc++/17005 partial fix.
	* pa-hpux11.h (TARGET_OS_CPP_BUILTINS): Define _INCLUDE__STDC_A1_SOURCE
	except when generating ANSI/C89 code.

2004-08-14  Nathan Sidwell  <nathan@codesourcery.com>

	* c-common.c (shorten_compare): Use force_fit_type directly.

2004-08-14  Gerald Pfeifer  <gerald@pfeifer.com>
	    Dimitri Papadopoulos-Orfanos  <papadopo@shfj.cea.fr>
	    Dave Korn  <dk@artimi.com>

	* doc/install.texi (Building): Avoid duplicate reference to GNU
	make requirement.
	(*-*-solaris2*): Do not recommend GNU make any longer.  Simplify.

2004-08-14  Richard Henderson  <rth@redhat.com>

	* config/alpha/alpha.h (PROMOTE_MODE): Don't promote vector types.
	* config/alpha/alpha.c (function_value): Use PROMOTE_MODE.

2004-08-13  Richard Henderson  <rth@redhat.com>

	* config/i386/i386.md (call_1, sibcall_1, call_1_rex64): Use Pmode
	for constant_call_address_operand.
	(call_value_pop_1, call_value_1): Likewise.
	(sibcall_value_1, call_value_1_rex64): Likewise.

2004-08-13  James E Wilson  <wilson@specifixinc.com>

	* config/mips/sb1.md (ir_sb1_divdf_2pipes, ir_sb1_divdf_1pipe):
	Correct mode from SFmode to DFmode.

2004-08-13  Ziemowit Laski  <zlaski@apple.com>

	* config/darwin.h (EXTRA_SECTION_FUNCTIONS): Mark the __sel_fixup,
	__cstring_object and __image_info sections with the no_dead_strip
	attribute.

2004-08-13  Roger Sayle  <roger@eyesopen.com>
	    David Billinghurst  <David.Billinghurst@riotinto.com>

	PR libgfortran/15930
	* fixinc/inclhack.def (irix___generic1, irix___generic2): New.
	* fixinc/fixincl.x: Regenerate.
	* fixinc/tests/base/internal/math_core.h: New file.

2004-08-13  Richard Henderson  <rth@redhat.com>

	* dbxout.c (NO_DBX_FUNCTION_END): Default to zero.
	(dbxout_function_end): Remove ifdefs for it.
	(dbxout_begin_prologue): Protect N_BNSYM with it, and gdb extensions.

2004-08-13  Richard Henderson  <rth@redhat.com>

	* Makefile.in (insn-preds.o): Depend on TREE_H.
	* genpreds.c (write_insn_preds_c): Include tree.h.
	* config/alpha/alpha.c (reg_or_0_operand, reg_or_6bit_operand,
	reg_or_8bit_operand, cint8_operand, add_operand, sext_add_operand,
	const48_operand, and_operand, or_operand, mode_width_operand,
	mode_mask_operand, mul8_operand, const0_operand,
	hard_fp_register_operand, hard_int_register_operand,
	reg_or_cint_operand, some_operand, some_ni_operand, input_operand,
	samegp_function_operand, direct_call_operand, small_symbolic_operand,
	global_symbolic_operand, call_operand, symbolic_operand,
	dtp16_symbolic_operand, dtp32_symbolic_operand,
	gotdtp_symbolic_operand, tp16_symbolic_operand, tp32_symbolic_operand,
	gottp_symbolic_operand, alpha_comparison_operator,
	alpha_zero_comparison_operator, alpha_swapped_comparison_operator,
	signed_comparison_operator, alpha_fp_comparison_operator,
	divmod_operator, fix_operator, aligned_memory_operand,
	unaligned_memory_operand, reg_or_unaligned_mem_operand,
	any_memory_operand, reg_not_elim_operand, normal_memory_operand,
	reg_no_subreg_operand, addition_operation): Move to predicates.md.
	(reg_or_const_int_operand): Remove.  Replace all users with
	reg_or_cint_operand.
	(tls_symbolic_operand_1): Export.  Don't check mode or for CONST.
	(resolve_reload_operand): Split out of aligned_memory_operand.
	* config/alpha/alpha-protos.h: Update for exports.
	* config/alpha/alpha.h (PREDICATE_CODES): Remove.
	* config/alpha/alpha.md: Include predicates.md.
	* config/alpha/predicates.md: New file.

2004-08-13  Richard Sandiford  <rsandifo@redhat.com>

	* genattrtab.c (insn_ent): Replace insn_code, insn_index and lineno
	fields with a pointer to the instruction definition.
	(get_attr_value, fill_attr, make_length_attrs, remove_insn_ent)
	(insert_insn_ent, simplify_test_exp, optimize_attrs, write_attr_get)
	(write_attr_case, write_const_num_delay_slots): Update accordingly.
	(write_attr_case, write_const_num_delay_slots): Write the name of
	an insn next to its case statement.
	* genoutput.c (data): Add a filename field.
	(gen_insn, gen_peephole, gen_expand, gen_split): Set it.
	(output_insn_data): Print the location of each insn definition.
	* genrecog.c (write_action): Print the name of an insn above
	the statement that returns its code.

2004-08-12  Andrew Pinski  <pinskia@physics.uc.edu>

	* config/darwin-c.c (find_subframework_file): Fix spelling of cannot.
	* config/libgloss.h: Likewise.
	* config/arm/arm.c (arm_gen_load_multiple): Likewise.
	* c4x/c4x-modes.def: Likewise.
	* config/c4x/c4x.c (c4x_hard_regno_rename_ok): Likewise.
	(c4x_rptb_nop_p): Likewise.
	(c4x_rptb_valid_p): Likewise.
	(c4x_rptb_insert): Likewise.
	(c4x_address_conflict): Likewise.
	* config/c4x/c4x.md: Likewise.
	* config/frv/frv.md: Likewise.
	* config/i386/athlon.md: Likewise.
	* config/i386/i386.md: Likewise.
	* config/i386/predicates.md: Likewise.
	* config/ia64/ia64.c: Likewise.
	* config/ia64/itanium1.md: Likewise.
	* config/ia64/itanium2.md: Likewise.
	* config/iq2000/iq2000.md: Likewise.
	* config/mcore/mcore.c: Likewise.
	* config/mips/mips.c: Likewise.
	* config/mips/r3900.h: Likewise.
	* config/mips/sb1.md: Likewise.
	* config/pa/milli64.S: Likewise.
	* config/pa/pa.c: Likewise.
	* config/pa/pa.h: Likewise.
	* config/rs6000/8540.md: Likewise.

2004-08-13  Daniel Berlin  <dberlin@dberlin.org>

	* Makefile.in (BOOT_CFLAGS): Remove accidental addition of -dU.

2004-08-13  J"orn Rennecke <joern.rennecke@superh.com>

	* sh.md (cbranch define_delay) Use cond_delay_slot for
	non-anulled condition too.

2004-08-12  David Edelsohn  <edelsohn@gnu.org>

	* config/rs6000/rs6000.c (any_parallel_operand): New predicate.
	* config/rs6000/rs6000.h (PREDICATE_CODES): Add
	any_parallel_operand, lmw_operation, stmw_operation,
	mfcr_operation, mtcrf_operation.  Remove PARALLEL from any_operand.
	* config/rs6000/rs6000.md (save_fpregs_{si,di}): Use
	any_parallel_operand.
	(return_and_restore_fpregs_{si,di}): Same.

2004-08-12  Zack Weinberg  <zack@codesourcery.com>

	* genrecog.c (add_to_sequence): When processing a MATCH_PARALLEL,
	if pred->singleton != PARALLEL, issue a warning and pretend it was.
	Also issue a warning for any predicate we don't know about.

2004-08-12  Richard Henderson  <rth@redhat.com>

	* config/i386/i386.c (internal_label_prefix): Export.
	(internal_label_prefix_len, struct ix86_address,
	ix86_decompose_address, maybe_get_pool_constant,
	ix86_fp_compare_code_to_integer, ix86_fp_comparison_codes,
	memory_address_length): Export.
	(any_fp_register_operand, fp_register_operand,
	register_and_not_any_fp_reg_operand, register_and_not_fp_reg_operand,
	x86_64_general_operand, x86_64_szext_general_operand,
	x86_64_nonmemory_operand, x86_64_movabs_operand,
	x86_64_szext_nonmemory_operand, x86_64_immediate_operand,
	x86_64_zext_immediate_operand, const_int_1_31_operand,
	symbolic_operand, pic_symbolic_operand, local_symbolic_operand,
	tls_symbolic_operand, global_dynamic_symbolic_operand,
	local_dynamic_symbolic_operand, initial_exec_symbolic_operand,
	local_exec_symbolic_operand, call_insn_operand, sibcall_insn_operand,
	constant_call_address_operand, const0_operand, const1_operand,
	const248_operand, const_0_to_3_operand, const_0_to_7_operand,
	const_0_to_15_operand, const_0_to_255_operand, incdec_operand,
	shiftdi_operand, reg_no_sp_operand, mmx_reg_operand,
	general_no_elim_operand, nonmemory_no_elim_operand,
	index_register_operand, q_regs_operand, flags_reg_operand,
	non_q_regs_operand, zero_extended_scalar_load_operand,
	vector_move_operand, no_seg_address_operand, sse_comparison_operator,
	ix86_comparison_operator, ix86_carry_flag_operator,
	fcmov_comparison_operator, promotable_binary_operator,
	cmp_fp_expander_operand, ext_register_operand, binary_fp_operator,
	mult_operator, div_operator, arith_or_logical_operator,
	memory_displacement_operand, cmpsi_operand, long_memory_operand,
	aligned_operand): Move to predicates.md as define_predicates.
	(tls_symbolic_operand_1): Remove.
	(x86_64_sign_extended_value): Merge into x86_64_immediate_operand.
	(x86_64_zero_extended_value): Merge into x86_64_zext_immediate_operand.
	(legitimize_address): Merge tls_symbolic_operand contents.
	(ix86_expand_move): Likewise.
	* config/i386/i386-protos.h: Update for exports.
	* config/i386/i386.h (EXTRA_CONSTRAINT): Update for renames.
	(PREDICATE_CODES, SPECIAL_MODE_PREDICATES): Remove.
	* config/i386/i386.md: Include predicates.md.
	* config/i386/predicates.md: New file.

2004-08-13  Mark Mitchell  <mark@codesourcery.com>

	PR c++/16924
	* config/i386/winnt.c (i386_pe_mark_dllexport): Set
	SYMBOL_REF_DECL.
	(i386_pe_mark_dllimport): Likewise.
	(i386_pe_encode_section_info): Likewise, when overriding
	dllimport attribute.

2004-08-12  Geoffrey Keating  <geoffk@apple.com>

	* configure.ac: When testing for flex, nm, ar, and bison, check
	that they will actually be built.
	* configure: Regenerate.

2004-08-12  Ulrich Weigand  <uweigand@de.ibm.com>

	* config/s390/s390.h (MAX_FIXED_MODE_SIZE): Define.
	(MOVE_MAX_PIECES): Define.

2004-08-12  Devang patel  <dpatel@apple.com>

	* dbxout.c (dbxout_begin_prologue): New function.
	(dbx_debug_hooks): Use new begin prologue hook.
	(dbxout_function_end): Emit N_ENSYM.
	* stab.def (N_BNSYM, N_ENSYM): Define and document these two new stabs.

2004-08-12  Janis Johnson  <janis187@us.ibm.com>

	* config/rs6000/altivec.h (vec_dst): Fix C++ functions whose first
	argument is float*.

	* config/rs6000/rs6000.c (altivec_init_builtins): Fix argument type
	for vec_dss.

	* doc/extend.texi (AltiVec builtins): Fix description for recent
	changes.  Update operation list to match current support.

2004-08-12  Andreas Krebbel  <krebbel1@de.ibm.com>

	* config/s390/s390.c (struct s390_frame_layout): New struct as element
	of struct machine_function.
	(cfun->machine->frame_size): Moved into cfun->machine->frame_layout and
	changed all uses.
	(cfun->machine->save_fprs_p): Replaced by cfun_save_high_fprs and
	changed all uses.
	(cfun_frame_layout, cfun_save_high_fprs_p, cfun_gprs_save_area_size)
	(cfun_set_fpr_bit, cfun_fpr_bit_p): New macros.
	(s390_frame_area, s390_register_info): New functions.
	(s390_optimize_prolog): Renamed to s390_optimize_prologue.  Added check
	for base register.
	(s390_return_addr_rtx, s390_return_address_offset)
	(s390_va_start, s390_gimplify_va_arg)
	(s390_emit_prologue, s390_emit_epilogue): Adjusted for new stack
	layouts.
	(s390_frame_info): Functionality partly moved to s390_register_info.
	Made adaptions for new stack layout.
	(save_gprs, restore_gprs): Changed meaning of second parameter and
	adapted all callers.

	* config/s390/s390.h (s390_backchain_string): New global variable.
	(MASK_BACKCHAIN): Removed definition.
	(TARGET_BACKCHAIN): Changed check.
	(TARGET_KERNEL_BACKCHAIN): New macro.
	(TARGET_SWITCHES): Removed entries of "backchain" and "no-backchain".
	(TARGET_OPTIONS): Added "backchain", "no-backchain" and
	"kernel-backchain".
	(DYNAMIC_CHAIN_ADDRESS): Adjusted for new stack layouts.

	* config/s390/s390.md ("allocate_stack"): Added TARGET_KERNEL_BACKCHAIN
	as condition.  Adjusted for new stack layout.

	* doc/invoke.texi: Added documentation for new option
	"-mkernel-backchain" and adjusted documentation of "-mbackchain" and
	"-mno-backchain".

2004-08-12  Paul Brook  <paul@codesourcery.com>

	* config/arm/lib1funcs.asm (ARM_FUNC_ALIAS): Also alias _L__name.
	(aeabi_uidivmod, aeabi_idivmod): Provide thumb implementation.

2004-08-12  David Daney  <ddaney@avtrex.com>

	* java/gcj.texi:  Add subsection on signal usage.

2004-08-12  David Edelsohn  <edelsohn@gnu.org>

	* expr.c (move_by_pieces): Set alignment for move to minimum of
	MOVE_MAX_PIECES mode alignment and the largest non-slow mode
	alignment, but not less than the original alignment.
	(move_by_pieces_ninsns): Same.
	(can_store_by_pieces): Similar for store with STORE_MAX_PIECES.
	(store_by_pieces_1): Same.

2004-08-12  Diego Novillo  <dnovillo@redhat.com>

	PR tree-optimization/16867
	* tree.c (is_global_var): New function.
	(needs_to_live_in_memory): Check for TREE_ADDRESSABLE.
	Call is_global_var.
	* tree.h (DECL_NEEDS_TO_LIVE_IN_MEMORY_INTERNAL): Remove.
	Update all users.
	(is_global_var): Declare.
	* tree-dfa.c (dump_variable): Display global and addressable
	attributes.
	(add_referenced_var): Clarify documentation when marking
	variables call-clobbered.
	* tree-flow-inline.h (is_call_clobbered): Call is_global_var
	instead of needs_to_live_in_memory.
	(mark_call_clobbered): If the variable is a tag, mark it
	DECL_EXTERNAL.
	* tree-gimple.c (is_gimple_reg): Don't check for
	TREE_ADDRESSABLE.
	(is_gimple_non_addressable): Likewise.
	* tree-ssa-alias.c (get_nmt_for): Always check whether the tag
	needs to be marked call-clobbered.
	(setup_pointers_and_addressables): Call is_global_var instead
	of needs_to_live_in_memory.
	* tree-ssa-dce.c (need_to_preserve_store): Remove.
	Update all users with is_global_var.
	(mark_stmt_if_obviously_necessary): Fix processing of aliased
	stores.  Don't check the virtual definitions.  Rather, check
	whether the store is going into global memory.
	(find_obviously_necessary_stmts): Get the symbol from the PHI
	result.
	* tree-ssa-operands.c (get_call_expr_operands): Do not add
	clobbering may-defs if the call does not have side effects.

2004-08-12  Jakub Jelinek  <jakub@redhat.com>

	PR c++/16276
	* output.h (default_function_rodata_section,
	default_no_function_rodata_section): New prototypes.
	* target.h (struct gcc_target): Add asm_out.function_rodata_section.
	* target-def.h (TARGET_ASM_FUNCTION_RODATA_SECTION): Define.
	(TARGET_ASM_OUT): Add it.
	* varasm.c (default_function_rodata_section,
	default_no_function_rodata_section): New functions.
	* final.c (final_scan_insn): Call
	targetm.asm_out.function_rodata_section instead of
	readonly_data_section.
	* config/darwin.h (TARGET_ASM_FUNCTION_RODATA_SECTION): Define.
	* config/mcore/mcore.c (TARGET_ASM_FUNCTION_RODATA_SECTION): Likewise.
	* config/ip2k/ip2k.c (TARGET_ASM_FUNCTION_RODATA_SECTION): Likewise.
	* config/rs6000/xcoff.h (TARGET_ASM_FUNCTION_RODATA_SECTION):
	Likewise.
	* config/alpha/alpha.c (TARGET_ASM_FUNCTION_RODATA_SECTION): Likewise.
	* config/i386/cygming.h (TARGET_ASM_FUNCTION_RODATA_SECTION):
	Likewise.
	* config/i386/i386-interix.h (TARGET_ASM_FUNCTION_RODATA_SECTION):
	Likewise.
	* config/arm/pe.h (TARGET_ASM_FUNCTION_RODATA_SECTION): Likewise.
	* config/avr/avr.c (TARGET_ASM_FUNCTION_RODATA_SECTION): Likewise.
	* doc/tm.texi (TARGET_ASM_FUNCTION_RODATA_SECTION): Document.

2004-08-12  Paul Brook  <paul@codesourcery.com>

	* dwarf2out.h (dwarf2out_frame_finish): Conditionalize outputting eh
	frame info.
	* doc/tm.texi: Document interaction between TARGET_UNWIND_INFO and
	DWARF2_UNWIND_INFO.

2004-08-12  Ben Elliston  <bje@au.ibm.com>

	PR target/16286
	* config/rs6000/altivec.h: Change vector to __vector throughout.
	(Except for the `vector' macro itself).

2004-08-12  Zack Weinberg  <zack@codesourcery.com>

	* genpreds.c: Add capability to generate predicate bodies as
	well as function prototypes.  Write function prototypes for
	the generic predicates too.
	(process_define_predicate, write_tm_preds_h, write_insn_preds_c)
	(write_predicate_subfunction, mark_mode_tests, add_mode_tests)
	(write_match_code, write_predicate_expr, write_one_predicate_function)
	(parse_option): New functions.
	(output_predicate_decls): Delete.
	(main): Read the machine description, process DEFINE_PREDICATE or
	DEFINE_SPECIAL_PREDICATE patterns, write tm-preds.h or insn-preds.c
	as appropriate.

	* genrecog.c (struct decision_test): Replace index with
	struct pred_data pointer.
	(next_index): Remove, unused.
	(pred_table, preds, special_mode_pred_table): Delete.
	(compute_predicate_codes, process_define_predicate): New functions.
	(validate_pattern, add_to_sequence, write_switch): Update for
	new data structures.
	(main): Handle DEFINE_PREDICATE and DEFINE_SPECIAL_PREDICATE.
	Check both error_count and have_error.

	* gensupport.c (in_fname, first_predicate): New globals.
	(define_pred_queue, define_pred_tail): New RTL-pattern queue.
	(predicate_table, last_predicate, old_pred_table)
	(old_special_pred_table): New statics.
	(hash_struct_pred_data, eq_struct_pred_data, lookup_predicate)
	(add_predicate, init_predicate_table): New functions.
	(process_rtx): Handle DEFINE_PREDICATE and DEFINE_SPECIAL_PREDICATE.
	(init_md_reader_args_cb): Use the global in_fname.  No need to zero
	it or max_include_len.  Call init_predicate_table.
	(read_rtx): Run the predicate queue after the attribute queue
	but before all the others.
	* gensupport.h (in_fname, struct pred_data, first_predicate)
	(lookup_predicate, add_predicate, FOR_ALL_PREDICATES): Declare.
	* rtl.def (MATCH_CODE, MATCH_TEST, DEFINE_PREDICATE)
	(DEFINE_SPECIAL_PREDICATE): New RTL codes.
	* dummy-conditions.c: Don't include bconfig.h, system.h,
	coretypes.h, tm.h, or system.h.  Do include stddef.h.
	Duplicate declaration of struct c_test from gensupport.h.

	* Makefile.in (OBJS-common): Add insn-preds.o.
	(STAGESTUFF, .PRECIOUS): Add insn-preds.c.
	(insn-preds.c, insn-preds.o): New rules.
	(s-preds): Also generate insn-preds.c.
	(dummy-conditions.o, genpreds$(build_exeext), genpreds.o):
	Update dependencies.
	(print-rtl.o, print-rtl1.o): Correct dependencies.

	* recog.h: Delete prototypes of predicate functions.

	* doc/md.texi (Predicates): New section with complete
	documentation of operand/operator predicates.  Remove some
	incomplete documentation of predicates from other places.
	* doc/tm.texi (Misc): Move SPECIAL_MODE_PREDICATES next to
	PREDICATE_CODES; indicate that both are deprecated in favor
	of define_predicate/define_special_predicate.

	* config/ia64/ia64.c: All predicate function definitions moved
	to ia64.md, except
	(small_addr_symbolic_operand, tls_symbolic_operand): Delete.
	(ia64_expand_load_address, ia64_expand_move):
	Check SYMBOL_REF_TLS_MODEL directly, don't use tls_symbolic_operand.

	* config/ia64/ia64.md: All predicates now defined here.
	(symbolic_operand): Is now a special predicate.

	* config/ia64/ia64.h: Declare ia64_section_threshold.
	(PREDICATE_CODES): Delete.

2004-08-12  Richard Henderson  <rth@redhat.com>

	* c-common.h (STATEMENT_LIST_HAS_LABEL): New.
	* c-semantics.c (add_stmt): Set it.
	* c-decl.c (finish_decl): Use it to create a new BIND_EXPR
	before instantiating a variable sized type.

2004-08-12  Richard Henderson  <rth@redhat.com>

	* stor-layout.c (round_up, round_down): Move ...
	* fold-const.c (round_up, round_down): ... here.  Use
	multiple_of_p to avoid any arithmetic at all.

2004-08-12  Richard Henderson  <rth@redhat.com>

	* gimplify.c (struct gimplify_init_ctor_preeval_data): New.
	(gimplify_init_ctor_preeval_1): New.
	(gimplify_init_ctor_preeval): New.
	(gimplify_init_ctor_eval): New.
	(gimplify_init_constructor): Use them.  Always gimplify the LHS
	object first.

2004-08-12  Ziemowit Laski  <zlaski@apple.com>

	(This patch is part of merge of objc-improvements-branch
	into mainline.)

	* doc/frontends.texi: Mention Objective-C++ in addition to
	Objective-C.
	* doc/install.texi: Add 'obj-c++' to list of configurable
	languages.
	* doc/invoke.texi: Rename Objective-C option headings to
	indicate they also apply to Objective-C++.  List file
	extensions for Objective-C++ sources.  Mention that
	ObjC and ObjC++ compilations may also use C and C++ options,
	respectively.  Point users to doc/standards.texi for
	further info on ObjC and ObjC++.
	* doc/sourcebuild.texi: Mention the objcp/ directory and
	the Objective-C++ sources it contains.
	* doc/standards.texi: Update link to Apple ObjC site;
	add link to gcc readings.html WWW doc.

2004-08-12  Alan Modra  <amodra@bigpond.net.au>

	* config/rs6000/rs6000.c (function_arg_padding): Revert 2004-07-28
	and 2004-07-14 changes.

2004-08-12  Paul Brook  <paul@codesourcery.com>

	* doc/invoke.texi: Fix typo.

2004-08-11 Devang Patel  <dpatel@apple.com>

	* config/darwin.h (TARGET_OPTION_TRANSLATE_TABLE): Add -dead_strip
	and -no_dead_strip_inits_and_terms.
	(LINK_SPEC): Same.
	* doc/invoke.texi (Darwin Options): Document -dead_strip and
	-no_dead_strip_inits_and_terms.

2004-08-11  Paul Brook  <paul@codesourcery.com>

	* config/arm/arm-protos.h (arm_finalize_pic) Rename ...
	(arm_load_pic_register): ... to this.
	* config/arm/arm.c (arm_finalize_pic): Rename ...
	(arm_load_pic_register): ... to this.  Always output insns at the
	current location.  Load via low reg in thumb mode.
	(arm_expand_prologue): Call arm_load_pic_register.
	(thumb_expand_prologue): Ditto.
	* config/arm/arm.h (FINALIZE_PIC): Remove.
	* config/arm/arm.md (builtin_setjmp_receiver): Call
	arm_load_pic_register.

2004-08-11  Paul Brook  <paul@codesourcery.com>

	* arm.c (thumb_force_lr_save): Add prototype.
	(thumb_compute_save_reg_mask): New function.
	(thumb_find_work_register): New function.
	(arm_get_frame_offsets): Use thumb_compute_save_reg_mask.
	(thumb_unexpanded_epilogue): Ditto.  Remove redundant code.
	Don't clobber r3 when removing pretend args.
	(thumb_expand_prologue): Use thumb_compute_save_reg_mask.
	(thumb_output_function_prologue): Use new functions.
	(thumb_set_return_address): Use thumb_compute_save_reg_mask.
	* arm.h (THUMB_REG_PUSHED_P): Remove.

2004-08-11  James E Wilson  <wilson@specifixinc.com>

	PR rtl-optimization/16490
	* cfgrtl.c (cfg_layout_split_edge): Set global_live_at_start and
	global_live_at_end for new basic block if already set for other blocks.

2004-08-11 David Edelsohn  <edelsohn@gnu.org>

	* config/rs6000/rs6000.h (MAX_FIXED_MODE_SIZE): Define.

	* config/rs6000/rs6000.md (mfcr rlwinm patterns): Set length to 8.
	(mfcr rlwinm rlwinm patterns): Set length to 12.

2004-08-11  Andrew MacLeod  <amacleod@redhat.com>

	* tree-flow-inline.h (get_def_ops, get_use_ops, get_v_may_def_ops,
	get_vuse_ops,get_v_must_def_ops): Add operand structure reference.
	(get_v_may_def_result_ptr, get_v_may_def_op_ptr): New access struct.
	(start_ssa_stmt_operands): Delete.
	* tree-flow.h (struct stmt_ann_d): Replace operand vectors with new
	struct stmt_operands_d.
	(build_ssa_operands): New extern entry point.
	* tree-ssa-dom.c (record_equivalences_from_stmt): Remove operand
	building code, replace with create_ssa_artficial_load_stmt().
	* tree-ssa-operands.c (struct voperands_d): Delete.
	(allocate_v_may_def_optype): Allocate v_may_def_operand_type_t vector.
	(allocate_v_must_def_optype): Use sizeof (tree), not sizeof (tree *).
	(free_uses, free_defs, free_vuses, free_v_may_defs,
	free_v_must_defs): Remove dealloc parameter.
	(remove_vuses, remove_v_may_def, remove_v_must_defs): Delete.
	(finalize_ssa_defs, finalize_ssa_uses, finalize_ssa_v_may_defs,
	finalize_ssa_vuses, finalize_ssa_v_must_defs): Perform all operand
	vector comparisons, ssa_name reuse, and allocations here.
	(verify_start_operands): Delete.
	(finalize_ssa_stmt_operands): Set new operands by calling finalize
	routines.
	(start_ssa_stmt_operands): Move from tree-flow-inline.h.
	(append_def, append_usei): Simplify to simple accumulation.
	(append_v_may_def, append_vuse, append_v_must_def): Simplify to avoiding
	duplicates and simple accumulation.
	(free_ssa_operands): Free vectors in a stmt_operand structure.
	(build_ssa_operands): New. Create a new stmt_operand structure from
	a stmt and an old set of stmt_operands.
	(get_stmt_operands): Simplify and call build_ssa_operands.
	(get_expr_operands, get_asm_expr_operands, get_indirect_ref_operands,
	get_call_expr_operands, add_stmt_operand, add_call_clobber_ops,
	add_call_read_ops): Don't pass prev_vops around anymore.
	(note_addressable): Return if no stmt annotation.
	(copy_virtual_operands): Access v_may_def operands through a struct.
	(create_ssa_artficial_load_stmt): New.  Create a load stmt for DOM's
	hash tables without treating the stmt as a real stmt.
	* tree-ssa-operands.h (struct v_may_def_operand_type): New.  Access
	v_may_def def and use through a struct instead of 2 array elements.
	(struct v_may_def_optype_d): Use v_may_def_operand_type.
	(struct stmt_operands_d): New.  Struct for storing all operand vectors.

2004-08-11  Nick Clifton  <nickc@redhat.com>

	* config/arm/arm.c (arm_is_longcall_p): Update comment describing
	this funciton's behaviour.  Return true when the current function
	has a section attribute and -mlong-calls is in effect.
	* config/arm/arm.h (ARM_DECLARE_FUNCTION_SIZE): Do not set the
	short-call marker when -mlong-calls is in effect and the function
	has a section attribute.

2004-08-10  Zack Weinberg  <zack@codesourcery.com>

	* stmt.c (expand_return): If asked to return the RESULT_DECL,
	just call expand_value_return on result_rtl.

2004-08-10  Richard Henderson  <rth@redhat.com>

	* builtins.def (BUILT_IN_STACK_ALLOC): Remove.
	* builtins.c (expand_builtin) <BUILT_IN_STACK_ALLOC>: Remove.
	* dwarf2out.c (loc_descriptor): Handle PARALLEL here ...
	(add_location_or_const_value_attribute): ... not here.  Use
	loc_descriptor_from_tree if possible.
	(loc_descriptor_from_tree_1): Rename from loc_descriptor_from_tree.
	Simplify address handling.  Handle DECL_VALUE_EXPR.  Handle register
	values specially.
	(loc_descriptor_from_tree): New.  Update callers.
	* expr.c (expand_var): Ignore DECL_VALUE_EXPR variables.
	* gimplify.c (gimplify_decl_expr): Lower variable sized types to
	pointer plus dereference.  Set DECL_VALUE_EXPR.  Set save_stack.
	(gimplify_call_expr): Do not recognize BUILT_IN_STACK_ALLOC
	and BUILT_IN_STACK_RESTORE.
	(gimplify_expr): Lower DECL_VALUE_EXPR decls.
	* stmt.c (expand_stack_alloc): Remove.
	* tree-mudflap.c (mx_register_decls): Don't look for
	BUILT_IN_STACK_ALLOC.
	* tree-nested.c (convert_local_reference): Likewise.
	* tree.h (DECL_VALUE_EXPR): New.

2004-08-10  Richard Henderson  <rth@redhat.com>

	* stor-layout.c (round_up): Check for 0/1 before dividing.
	(round_down): Likewise.

	* tree-tailcall.c (suitable_for_tail_opt_p): Also check DECL_EXTERNAL.

2004-08-09  Mark Mitchell  <mark@codesourcery.com>

	* config.gcc (arm*-*-eabi*): New target.
	* defaults.h (TARGET_LIBGCC_FUNCS): New macro.
	(TARGET_LIB_INT_CMP_BIASED): Likewise.
	* expmed.c (expand_divmod): Try a two-valued divmod function as a
	last resort.
	* gthr.h: Remove bogus tokens at end of #pragma.
	* optabs.c (expand_twoval_binop_libfunc): New function.
	(prepare_cmp_insn): Handle the !TARGET_LIB_INT_CMP_BIASED case.
	(prepare_float_lib_cmp): Try reversing the condition.
	(debug_optab_libfuncs): New function.
	* optabs.h (expand_twoval_binop_libfunc): Declare.
	* config/arm/arm.c (arm_init_libfuncs): New function.
	(arm_compute_initial_eliminatino_offset): Return HOST_WIDE_INT.
	(TARGET_INIT_LIBFUNCS): Define it.
	* config/arm/arm.h (TARGET_BPABI): New macro.
	* config/arm/arm-protos.h
	(arm_compute_initial_elimination_offset): Return HOST_WIDE_INT.
	* config/arm/bpabi.S: New file.
	* config/arm/bpabi.c: Likewise.
	* config/arm/bpabi.h: Likewise.
	* config/arm/ieee754-df.S (__aeabi_dneg): New function or alias.
	(__aeabi_drsub): Likewise.
	(__aeabi_dsub): Likewise.
	(__aeabi_dadd): Likewise.
	(__aeabi_ui2d): Likewise.
	(__aeabi_i2d): Likewise.
	(__aeabi_f2d): Likewise.
	(__aeabi_dmul): Likewise.
	(__aeabi_ddiv): Likewise.
	(__aeabi_cdrcmple): Likewise.
	(__aeabi_cdcmpeq): Likewise.
	(__aeabi_cdcmple): Likewise.
	(__aeabi_dcmpeq): Likewise.
	(__aeabi_dcmplt): Likewise.
	(__aeabi_dcmple): Likewise.
	(__aeabi_dcmpge): Likewise.
	(__aeabi_dcmpgt): Likewise.
	(__aeabi_dcmpun): Likewise.
	(__aeabi_d2iz): Likewise.
	(__aeabi_d2uiz): Likewise.
	(__aeabi_d2f): Likewise.
	* config/arm/ieee754-sf.S (__aeabi_fneg): New function or alias.
	(__aeabi_frsub): Likewise.
	(__aeabi_fsub): Likewise.
	(__aeabi_fadd): Likewise.
	(__aeabi_ui2f): Likewise.
	(__aeabi_i2f): Likewise.
	(__aeabi_fmul): Likewise.
	(__aeabi_fdiv): Likewise.
	(__aeabi_cfrcmple): Likewise.
	(__aeabi_cfcmpeq): Likewise.
	(__aeabi_cfcmple): Likewise.
	(__aeabi_fcmpeq): Likewise.
	(__aeabi_fcmplt): Likewise.
	(__aeabi_fcmple): Likewise.
	(__aeabi_fcmpge): Likewise.
	(__aeabi_fcmpgt): Likewise.
	(__aeabi_fcmpun): Likewise.
	(__aeabi_f2iz): Likewise.
	(__aeabi_f2uiz): Likewise.
	* config/arm/lib1funcs.asm (ARM_CALL): New macro.
	(__aeabi_uidivmod): New function or alias.
	(__aeabi_idivmod): Likewise.
	(__aeabi_idiv0): Likewise.
	(__aeabi_ldiv0): Likewise.
	(__aeabi_llsr): Likewise.
	(__aeabi_lasr): Likewise.
	(__aeabi_llsl): Likewise.
	(bpabi.S): Include it.
	* config/arm/libgcc-bpabi.ver: New file.
	* config/arm/symbian.h (ARM_DEFAULT_ABI): Remove.
	(LINK_SPEC): Remove.
	* config/arm/t-arm-elf (LIB1ASMFUNCS): Add __aeabi_lcmp and
	__aeabi_ulcmp.
	* config/arm/t-bpabi: New file.
	* doc/tm.texi (TARGET_LIBGCC_FUNCS): New entry.
	(TARGET_LIB_INT_CMP_BIASED): Likewise.

2004-08-10  David Edelsohn  <edelsohn@gnu.org>

	* config/rs6000/rs6000-protos.h (expand_block_clear): Declare.
	* config/rs6000/rs6000.md (clrmemsi): New pattern.
	* config/rs6000/rs6000.c (expand_block_clear): New function.
	(expand_block_move): Convert alignment to bits.  Use SImode and
	HImode for unaligned addresses if not STRICT_ALIGNMENT.

2004-08-10  Caroline Tice  <ctice@apple.com>

	* varasm.c (unlikely_section_label): New global variable.
	(unlikely_text_section_name): New global variable.
	(text_section):  Remove alignment statement.
	(unlikely_text_section): Remove alignment statement; use
	unlikely_section_label rather than hard-coded string.
	(assemble_start_function): Initialize unlikely_section_label and
	unlikely_text_section_name;  make sure cold section is properly
	aligned at start of function; output unlikely_section_label if
	appropriate.

2004-08-10  Ulrich Weigand  <uweigand@de.ibm.com>

	* config/s390/s390-protos.h (s390_canonicalize_comparison): Declare.
	* config/s390/s390.c (s390_canonicalize_comparison): New function.
	* config/s390/s390.h (CANONICALIZE_COMPARISON): Define.
	* config/s390/s390.md ("*tmdi_ext", "*tmsi_ext", "*tmqisi_ext",
	"*tmqidi_ext", "*tmdi_mem", "*tmsi_mem", "*tmhi_mem"): Remove.
	("*tmqi_mem"): Remove SUBREG from pattern.
	("*anddi3_cconly"): Prevent accidentally matching TM pattern.
	("*andsi3_cconly"): Likewise.

2004-08-10  H.J. Lu  <hongjiu.lu@intel.com>

	PR target/16909
	* config/i386/i386.md (*strsetdi_rex_1): Use DI instead of SI.

2004-08-10  Janis Johnson  <janis187@us.ibm.com>

	* doc/sourcebuild.texi (compat testing): Document available test
	framework commands.  Use the preferred spelling of DejaGnu.

2004-08-10  Daniel Berlin <dberlin@dberlin.org>

	* lambda.h: Add matrix type, and prototypes for remainder of
	matrix and vector functions.
	(lambda_vector_mult_const): New function.
	(lambda_vector_negate): Ditto.
	(lambda_vector_add): Ditto.
	(lambda_vector_add_mc): Ditto.
	(lambda_vector_copy): Ditto.
	(lambda_vector_zerop): Ditto.
	(lambda_vector_equal): Ditto.
	(lambda_vector_min_nz): Ditto.
	(lambda_vector_first_nz): Ditto.
	(lambda_vector_matrix_mult): Ditto.
	* lambda-mat.c: New file.
	* Makefile.in (lambda-mat.o): New.

2004-08-10  Andrew MacLeod  <amacleod@redhat.com>

	* tree-cfg.c (bsi_insert_before, bsi_insert_after): Call modify_stmt
	after linking stmt into the program.
	(bsi_remove): Don't call modify_stmt.
	* tree-complex.c (update_complex_assignment,
	expand_complex_comparison): Call modify_stmt after changing the stmt.
	* tree-outof-ssa.c (rewrite_trees): Call modify_stmt only if not
	removing the stmt.
	* tree-ssa-ccp.c (substitute_and_fold): Call modify_stmt after changing
	the stmt, and only if needed.
	* tree-ssa-dom.c (thread_across_edge): Pass no annotation for a dummy
	expression.
	(simplify_rhs_and_lookup_avail_expr): Don't take an annotation param.
	(simplify_cond_and_lookup_avail_expr): Use modify_stmt.
	(simplify_switch_and_lookup_avail_expr): Don't take an annotation param.
	(eliminate_redundant_computations): Don't pass an annotation. Call
	modify_stmt rather than setting the annotation directly.
	(record_equivalences_from_stmt): Remove unused local 'j'.
	(cprop_operand): Take a stmt rather than an annotation as a parameter.
	Call modify_stmt.
	(cprop_into_stmt): Pass stmt rather than annotation.
	(update_rhs_and_lookup_avail_expr): Call modify_stmt.
	* tree-ssa-loop-im.c (schedule_sm): Call get_stmt_ann rather than
	modify_stmt.
	* tree-ssa.c (propagate_into_addr): Dont call modify_stmt.

2004-08-10  Jason Merrill  <jason@redhat.com>

	PR middle-end/16948
	* function.c (expand_function_start): Handle DECL_BY_REFERENCE on
	the RESULT_DECL.

2004-08-10  Geoffrey Keating  <geoffk@apple.com>

	* tree-vn.c (val_expr_pair_expr_eq): Compare vuses, to match the
	hash function.

2004-08-10  Roger Sayle  <roger@eyesopen.com>

	* config/mips/mips.md: New reciprocal square root patterns that
	match sqrt(1.0/x) in addition to the existing 1.0/sqrt(x) insns.

2004-08-10  Paul Brook  <paul@codesourcery.com>

	* config/arm/arm-protos.h (arm_set_return_address,
	thumb_set_return_address): Add prototypes.
	* config/arm/arm.h (ARM_FT_EXCEPTION_HANDLER): Remove.
	* config/arm/arm.c (arm_compute_func_type,
	use_return_insn, arm_compute_save_reg0_reg12_mask,
	arm_compute_save_reg_mask, arm_output_function_prologue,
	arm_output_epilogue): Replace ARM_FT_EXCEPTION_HANDLER with
	current_function_calls_eh_return.
	(thumb_exit, thumb_pushpop, thumb_unexpanded_epilogue): Replace
	old eh code.
	(arm_set_return_address, thumb_set_return_address): New functions.
	* config/arm/arm.h (MUST_USE_SJLJ_EXCEPTIONS, DWARF2_UNWIND_INFO,
	ARM_EH_STACKADJ_REGNUM, EH_RETURN_STACKADJ_RTX): Define.
	* config/arm/arm.md (VUNSPEC_EH_RETURN): Add.
	(epilogue): Use the stackadj register.
	(eh_return, arm_eh_return, thumb_eh_return): New pattern.

2004-08-10  Jakub Jelinek  <jakub@redhat.com>

	PR target/3144
	* expr.c (move_by_pieces_ninsns): Add max_size argument.
	(MOVE_BY_PIECES_P): Pass MOVE_MAX_PIECES + 1 to it.
	(CLEAR_BY_PIECES_P): Pass STORE_MAX_PIECES + 1 to it.
	(STORE_BY_PIECES_P): Define similarly to CLEAR_BY_PIECES_P,
	but using MOVE_RATIO.
	(move_by_pieces): Pass max_size to move_by_pieces_ninsns.
	(can_store_by_pieces): Change max_size type to unsigned int.
	(store_by_pieces_1): Likewise.  Pass max_size to
	move_by_pieces_ninsns.
	* config/s390/s390.h (STORE_BY_PIECES_P): Define.
	* config/sh/sh.c (MOVE_BY_PIECES_P): Pass MOVE_MAX_PIECES + 1
	to move_by_pieces_ninsns.
	(STORE_BY_PIECES_P): Define.
	* config/ns32k/ns32k.h (STORE_BY_PIECES_P): Pass STORE_MAX_PIECES + 1
	to move_by_pieces_ninsns.
	* doc/tm.texi (STORE_BY_PIECES_P): Document changed default.

	* config/i386/i386.h (CLEAR_RATIO): Define.

2004-08-09  Paolo Bonzini  <bonzini@gnu.org>

	* expr.c (expand_expr_real_1): Add back code that was not dead.

2004-08-09  Andrew Pinski  <apinski@apple.com>

	* c-common.c (c_common_get_alias_set): Set the aliasing set of the type
	which is found to be compatible before returning the aliasing set.

2004-08-09  Daniel Jacobowitz  <dan@debian.org>

	* ggc-zone.c (struct alloc_zone): Add statistics counters.
	(always_collect): New flag.
	(ggc_alloc_zone_1): Update statistics support.  Don't include
	overhead in allocated counter.
	(sweep_pages): Update allocated counter for large pages.  Don'y
	include overhead.
	(ggc_collect_1): Always collect.
	(ggc_collect): Honor always_collect flag.  Sum all zones to decide
	whether to collect.
	(SCALE, LABEL): New macros.
	(ggc_print_statistics): Add statistics support.

2004-08-09  Roger Sayle  <roger@eyesopen.com>

	* expmed.c (sdiv_pow2_cheap, smod_pow2_cheap): Change type to bool.
	(init_expmed): Fix potential overrun problem with "all.reg".
	(expand_sdiv2_pow2): Add an alternate implementation for signed
	division, if the target provides a suitable conditional move insn.

2004-08-09  Paul Brook  <paul@codesourcery.com>
	Richard Henderson  <rth@redhat.com>

	* unwind-dw2.c (uw_install_context_1): Update target saved stack
	pointer.

2004-08-09  Geoffrey Keating  <geoffk@apple.com>

	* ggc-common.c (ggc_rlimit_bound): Don't check RSS limit.
	Check DATA limit only if there's no AS limit.  Ignore insanely
	low DATA limits.
	(ggc_min_heapsize_heuristic): Don't divide AS or RSS limits by 8,
	but take care that the AS limit isn't overrun.
	* doc/invoke.texi: Update documentation of min-heapsize parameter.

2004-08-09  Jeff Law  <law@redhat.com>

	* Makefile.in (OBJC-common): Add tree-ssa-threadupdate.c
	(tree-ssa-threadupdate.o): Add dependencies.
	* tree-ssa-threadupdate.c: New file.
	* tree-flow.h (incoming_edge_threaded): New flag in block annotation.
	(rewrite_vars_out_of_ssa): Remove prototype.
	(cleanup_tree_cfg): Returns a bool.
	* tree.h (thread_through_all_blocks): Prototype.
	* tree-outof-ssa.c  (SSANORM_*): Move into here.
	(remove_ssa_form): Now static.
	(rewrite_vars_out_of_ssa): Kill.
	* tree-ssa-live.c (register_ssa_partitions_for_vars): Kill.
	* tree-ssa-live.h (SSANORM_*): Moved into tree-outof-ssa.c.
	(remove_ssa_form, register_partitions_for_vars): Kill declarations.
	* tree-cfg.c (cleanup_tree_cfg): Return a value indicating if
	anything was changed.
	* tree-phinodes.c (add_phi_arg): Get the block for the PHI
	from the PHI's annotation rather than the edge associated with
	the new argument.
	* tree-ssa-dom.c (redirection_edges): Kill.
	(redirect_edges_and_update_ssa_graph): Kill.
	(tree_ssa_dominator_optimize): Do not reset forwardable flag
	for blocks anymore.  Do not initialize redirection_edges.
	Call thread_through_all_blocks.  Simplify code for cleanup
	of the CFG and iterating.  No longer call cleanup_tree_cfg
	outside the iteration loop.
	(thread_across_edge): No longer mess with forwardable blocks.

2004-08-09  Zack Weinberg  <zack@codesourcery.com>

	* explow.c (memory_address): Use memory_address_p.
	* recog.c (general_operand): Likewise.
	* regrename.c: No need to define REG_OK_STRICT.

2004-08-09  Steven Bosscher  <stevenb@suse.de>

	* timevar.def (TV_CPROP1, TV_CPROP2, TV_PRE, TV_HOIST, TV_LSM):
	New timers.
	* gcse.c: Include timevar.h.
	(const_prop_count, copy_prop_count): Rename to global_const_prop_count
	and global_copy_prop_count.
	(local_const_prop_count, local_copy_prop_count): New static globals.
	(gcse_main): Set the right timevar for each pass.
	(cprop_jump): Increment global_const_prop_count when a constant is
	propagated.  Add "GLOBAL" to dump output.
	(cprop_insn): Increment global_const_prop_count when a constant is
	propagated, or global_copy_prop_count when a copy is propagated.
	(do_local_cprop): Likewise for local_const_prop_count and
	local_copy_prop_count.
	(one_cprop_pass): Initialize const/cprop counters to zero.
	Print out results of local and global const/cprop separately.
	(bypass_block): Break over-length line.
	* Makefile.in (gcse.o): Add TIMEVAR_H dependency.  Fix dependencies
	for bb-reorder.o and tracer.o.

2004-08-09  Paolo Bonzini  <bonzini@gnu.org>

	* Makefile.in (GTFILES): Remove stmt.c
	(stmt.o): Do not depend on gt-stmt.h.
	* emit-rtl.c (emit_line_note): Do not call
	set_file_and_line_for_stmt.
	* expr.c (expand_expr_real_1) <SWITCH_EXPR>: Let expand_case
	do everything.
	* function.c (free_after_parsing): Do not free STMT field.
	(allocate_struct_function): Do not call init_stmt_for_function.
	(assign_stack_temp_for_type): Do not accept values of keep
	other than 0 or 1.
	(init_temp_slots): Do not initialize removed variables.
	* function.h (struct function): Remove STMT, X_TARGET_TEMP_SLOT_LEVEL
	and X_VAR_TEMP_SLOT_LEVEL fields.
	* rtl.h (set_file_and_line_for_stmt): Remove.
	* stmt.c (struct nesting, ALLOC_NESTING, POPSTACK,
	struct stmt_status, cond_stack, case_stack, nesting_stack,
	nesting_depth, emit_locus, set_file_and_line_for_stmt,
	same_case_target_p, init_stmt_for_function, emit_nop,
	expand_start_cond, expand_start_elseif, expand_start_else,
	expand_elseif, expand_end_cond): Remove.
	(preserve_subexpressions_p): Remove references to CFUN->STMT.
	(expand_start_case, expand_end_case_type): Remove, merge into...
	(expand_case): ... this one, including other bits from
	expand_expr_real_1.  Inline same_case_target_p.  Turn members
	of CASE_STACK into local variables.
	(emit_case_bit_tests): Inline same_case_target_p.
	(add_case_node): Add HEAD argument, return new head of the list,
	do not handle default label here.
	* tree.h (expand_start_cond, expand_end_cond, expand_start_else,
	expand_start_elseif, current_nesting_level, expand_start_case,
	expand_end_case_type, expand_end_case, add_case_node,
	init_stmt_for_function, expand_elseif): Remove prototypes.
	(expand_case): Add prototype.

2004-08-09  Paolo Bonzini  <bonzini@gnu.org>

	* expr.c (expand_expr_real_1): Use optab_for_tree_code.

2004-08-09  Paolo Bonzini  <bonzini@gnu.org>

	* expr.c (var_rtx): Remove.
	(expand_expr_real_1) <LOOP_EXPR, EXIT_EXPR,
	LABELED_BLOCK_EXPR, EXIT_BLOCK_EXPR, TRUTH_ANDIF_EXPR,
	TRUTH_ORIF_EXPR, COMPOUND_EXPR, CONJ_EXPR, INIT_EXPR>:
	Abort.
	(expand_expr_real_1) <COND_EXPR>: Remove most special cases.
	* optabs.c (emit_clr_insn, emit_0_to_1_insn): Remove.
	* optabs.h (emit_clr_insn, emit_0_to_1_insn): Remove.

2004-08-08  Mostafa Hagog  <mustafa@il.ibm.com>
	Ayal Zaks <zaks@il.ibm.com>

	* common.opt (freschedule-modulo-scheduled-loops): New flag.
	* final.c (final_scan_insn): Handle NOTE_DISABLE_SCHED_OF_BLOCK.
	* modulo-sched.c (sms_schedule): Emit a note to disable scheduling
	when -freschedule-modulo-scheduled-loops flag is not specified.
	(sms_schedule_by_order, ps_insn_advance_column, add_node_to_ps,
	add_node_to_ps, ps_has_conflicts, ps_add_node_check_conflicts):
	More accurate placing of insn in row of partial schedule.
	(ps_insn_find_column): New function.
	* rtl.h (NOTE_DISABLE_SCHED_OF_BLOCK): New note.
	* sched-rgn.c (sched_is_disabled_for_current_region_p): New.
	(schedule_region): Use sched_is_disabled_for_current_region_p.
	* docs/invoke.texi: Document -freschedule-modulo-scheduled-loops.

2004-08-07  H.J. Lu  <hongjiu.lu@intel.com>

	* config/i386/i386.c (ix86_expand_clrmem): Revert the last
	change.

2004-08-07  H.J. Lu  <hongjiu.lu@intel.com>

	* config/i386/i386.c (ix86_expand_clrmem): Properly call
	gen_strset for 64bit target.

2004-08-07  Olivier Hainque  <hainque@act-europe.fr>

	* config/vxworks.h (HANDLE_SYSV_PRAGMA): Remove definition.

2004-08-07  Jason Merrill  <jason@redhat.com>

	Make return in memory explicit.
	* function.c (aggregate_value_p): Check DECL_BY_REFERENCE.
	(assign_parm_find_data_types): Remove code for old front end
	invisible reference handling.
	(assign_parms): Handle DECL_BY_REFERENCE on the RESULT_DECL.
	(expand_function_end): Likewise.
	* gimplify.c (gimplify_return_expr): Handle a dereferenced
	RESULT_DECL.
	* tree-inline.c (copy_body_r): Don't bother looking for &* anymore.
	(declare_return_variable): Handle DECL_BY_REFERENCE.
	* cp/cp-gimplify.c (is_invisiref_parm): Also handle RESULT_DECL.
	(cp_genericize_r): Use convert_from_reference.
	Don't dereference a RESULT_DECL directly inside a RETURN_EXPR.
	(cp_genericize): Handle the RESULT_DECL.  Unset TREE_ADDRESSABLE.

	* c-common.c (c_warn_unused_result): Check TREE_USED before
	warning about a CALL_EXPR with an unused value.

2004-08-06  Mark Mitchell  <mark@codesourcery.com>

	* config/arm/symbian.h (CC1_SPEC): Avoid passing duplicate options
	to the compiler.  Use -fshort-wchar by default.

2004-08-06  Pat Haugen  <pthaugen@us.ibm.com>

	* params.def (PARAM_MIN_CROSSJUMP_INSNS): New.
	* cfgcleanup.c (try_crossjump_to_edge): Add minimum insn match
	threshhold.
	* doc/invoke.texi (param): Document min-crossjump-insns.

2004-08-06  Richard Sandiford  <rsandifo@redhat.com>

	PR c/13282
	* c.opt (Wmissing-field-initializers): New option.
	* c-opts.c (c_common_post_options): Make -Wextra turn it on by default.
	* c-typeck.c (pop_init_level): Guard the missing field warning with
	warn_missing_field_initializers rather than extra_warnings.
	* doc/invoke.texi (-Wmissing-field-initializers): Document, moving
	some of the explanation from...
	(-Wextra): ...here.  Say that the missing field warning can be
	seperately controlled by -Wmissing-field-initializers.

2004-08-06  Paolo Bonzini  <bonzini@gnu.org>

	* expr.c (expand_expr_real_1) <ENTRY_VALUE_EXPR>: Remove.
	* tree-inline.c (estimate_num_insns_1) <ENTRY_VALUE_EXPR>: Remove.
	* tree-pretty-print.c (dump_generic_node) <ENTRY_VALUE_EXPR>: Remove.
	* tree.def (ENTRY_VALUE_EXPR): Remove.

2004-08-06  Jakub Jelinek  <jakub@redhat.com>

	* config/i386/i386.c (ix86_expand_clrmem): Move gen_cld down to
	the places where it is actually needed.  Don't use repz; stosb
	for -Os with sufficiently small constant sizes.
	For sufficiently small repz; stos{l,q} repeat counts use a sequence
	of stos{l,q} instructions instead.

2004-08-06  Zdenek Dvorak  <rakdver@atrey.karlin.mff.cuni.cz>

	PR tree-optimization/16807
	* loop-iv.c (dump_iv_info): Dump invariants correctly.
	(iv_subreg, iv_extend): Express value of invariant purely in
	base field.

2004-08-06  Mark Mitchell  <mark@codesourcery.com>

	* config/arm/symbian.h (CC1_SPEC): Add -fno-short-enums.
	(CC1PLUS_SPEC): Define it to be the same as CC1_SPEC.

2004-08-06  Roman Zippel  <zippel@linux-m68k.org>

	* config/m68k/m68k.c (post_inc_operand,pre_dec_operand): New.
	* config/m68k/m68k.h (PREDICATE_CODES): add post_inc_operand,
	pre_dec_operand.
	* config/m68k/m68k.md (zero_extend*2): delay the splitting of the
	pattern until reload is finished to allow better code generation
	and split them completely into separate instrunctions.
	(*andsi3_split): New pattern.

2004-08-05  Mark Mitchell  <mark@codesourcery.com>

	* tree.c (handle_dll_attribute): Move here from i383/winnt.c.
	Replace use of DECL_INLINE with DECL_DECLARED_INLINE_P.  Set
	DECL_VISIBLITY.  Test TARGET_DLLIMPORT_DECL_ATTRIBUTES with #if.
	* tree.h (handle_dll_attribute): Declare.  Test
	TARGET_DLLIMPORT_DECL_ATTRIBUTES with #if.
	* c-common.h (c_determine_visibility): Declare.
	* c-common.c (c_determine_visibility): New function.
	* c-decl.c (finish_decl): Use it.
	(finish_function): Likewise.
	* defaults.h (TARGET_DLLIMPORT_DECL_ATTRIBUTES): Define it to
	zero, by default.  Use #if, not	#ifdef, to test it.
	* config/arm/arm.c (arm_attribute_table): Use
	handle_dll_attribute.  Test TARGET_DLLIMPORT_DECL_ATTRIBUTES with
	#if.
	* config/arm/pe.h (TARGET_DLLIMPORT_DECL_ATTRIBUTES): Define to 1.
	* config/i386/cygming.h (TARGET_DLLIMPORT_DECL_ATTRIBUTES): Define
	to 1.
	* config/i386/i386-protos.h (ix86_handle_dll_attribute): Remove.
	* config/i386/i386.c (ix86_attribute_table): Use
	handle_dll_attribute for dllimport/dllexport.  Test
	TARGET_DLLIMPORT_DECL_ATTRIBUTES with #if.
	* config/i386/winnt.c (ix86_handle_dll_attribute): Remove.
	* config/mcore/mcore.h (TARGET_DLLIMPORT_DECL_ATTRIBUTES): Define
	it to 1.
	* config/mcore/mcore.c (TARGET_DLLIMPORT_DECL_ATTRIBUTES): Test it
	with #if.
	* config/sh/symbian-pre.h (TARGET_DLLIMPORT_DECL_ATTRIBUTES): Define
	it to 1.
	* doc/extend.texi (dllexport): Clarify and correct documentation.
	(dllimport): Likewise.
	* doc/tm.texi (TARGET_DLLIMPORT_DECL_ATTRIBUTES): Mention
	handle_dll_attribute.

2004-08-05  Zdenek Dvorak  <rakdver@atrey.karlin.mff.cuni.cz>

	* tree-ssa-loop-manip.c: New file.
	* Makefile.in (tree-ssa-loop-manip.o): Add.
	* tree-flow.h (rewrite_into_loop_closed_ssa, verify_loop_closed_ssa):
	Declare.
	* tree-ssa-loop.c (tree_loop_optimizer_init): Create loop closed ssa
	form.
	(tree_ssa_loop_done): Verify loop closed ssa form.
	* tree-ssa-loop-im.c (move_computations): Update loop closed ssa form.

2004-08-05  John David Anglin  <dave.anglin@nrc-cnrc.gc.ca>

	* pa.c (pa_asm_output_aligned_bss, pa_asm_output_aligned_common,
	pa_asm_output_aligned_local): New functions.
	* pa-protos.h: Add prototypes for pa_asm_output_aligned_bss,
	pa_asm_output_aligned_common and pa_asm_output_aligned_local.
	* pa-pro-end.h (ASM_OUTPUT_ALIGNED_COMMON): Use
	pa_asm_output_aligned_common.
	(ASM_OUTPUT_ALIGNED_LOCAL): Use pa_asm_output_aligned_local.
	* pa.h (ASM_OUTPUT_ALIGNED_BSS): New macro.
	(ASM_OUTPUT_ALIGNED_COMMON): Use pa_asm_output_aligned_common.
	(ASM_OUTPUT_ALIGNED_LOCAL): Use pa_asm_output_aligned_local.
	* pa64-hpux.h (MAX_OFILE_ALIGNMENT): New macro.
	(ASM_OUTPUT_ALIGNED_COMMON): Use pa_asm_output_aligned_common.
	(ASM_OUTPUT_ALIGNED_LOCAL): Use pa_asm_output_aligned_local.
	* som.h (MAX_OFILE_ALIGNMENT): Provide maximum alignment of global
	common data.

2004-08-05  Andrew Pinski  <apinski@apple.com>

	* objc/objc-act.c (build_objc_string_object): Mark the address
	expression as constant.

2004-08-05  David Edelsohn  <edelsohn@gnu.org>

	* config/rs6000/rs6000.c (rs6000_rtx_costs): Fix mask_operand
	and mask64_operand thinkos.  Handle ZERO_EXTRACT.  Handle
	SIGN_EXTEND / ZERO_EXTEND of MEM.  Handle rlwinm patterns.

2004-08-05  Joseph S. Myers  <jsm@polyomino.org.uk>

	* config/linux.h, config/i386/linux.h, config/sparc/linux.h:
	Remove definitions conditioned on USE_GNULIBC_1 or conditioned
	out, and associated obsolete comments.

2004-08-05  Nathan Sidwell  <nathan@codesourcery.com>

	* tree.h (force_fit_type): Return a tree, take three flags.
	* fold-const.c (force_fit_type): Set TREE_OVERFLOW and
	TREE_CONSTANT_OVERFLOW here.
	(int_const_binop, const_binop): Adjust.
	(size_int_type): Do sign extension here.
	(fold_convert_const, optimize_bit_field_compare,
	decode_field_reference, all_ones_mask_p, fold_div_compare, fold,
	fold_negate_const, fold_abs_const, fold_not_const): Adjust.
	* tree.c (size_in_bytes, int_fits_type_p): Adjust.

2004-08-05  Zdenek Dvorak  <rakdver@atrey.karlin.mff.cuni.cz>

	PR tree-optimization/16864
	* tree-tailcall.c (eliminate_tail_call): Do not create phi nodes
	for ssa names without default_def.

2004-08-05  Richard Sandiford  <rsandifo@redhat.com>

	* config/i386/i386.c (ix86_expand_prologue): If the function uses a
	frame pointer, restore eax with an ebp-relative address.

2004-08-04  Geoffrey Keating  <geoffk@apple.com>

	PR 14516
	* c-common.c (c_expand_decl): Don't special-case static VAR_DECLs.
	* c-common.h (make_rtl_for_local_static): Delete.
	* c-decl.c (shadow_tag_warned): Clean up comment.
	(finish_decl): Clean up spacing.  Use set_user_assembler_name when
	appropriate.  Don't pass asmspec to rest_of_decl_compilation.
	* c-semantics.c (make_rtl_for_local_static): Delete.
	* expr.c (init_block_move_fn): Use set_user_assembler_name.
	(init_block_clear_fn): Likewise.
	* passes.c (rest_of_decl_compilation): Remove asmspec parameter,
	expect it to be in DECL_ASSEMBLER_NAME.  Update callers in many files.
	* toplev.h (rest_of_decl_compilation): Remove asmspec parameter.
	* tree.h (make_decl_rtl): Remove second parameter.
	(set_user_assembler_name): New.
	* varasm.c (set_user_assembler_name): New.
	(make_decl_rtl): Remove second parameter.  Update callers in many
	files.

2004-08-05  Adam Nemet  <anemet@lnxw.com>

	* config.gcc (case i[34567]86-*-lynxos*): Update to LynxOS 4.0.
	(case rs6000-*-lynxos*): Rename it to powerpc-*-lynxos*.  Update
	to LynxOS 4.0.
	* gthr-lynx.h: New file.
	* config/lynx-ng.h: Remove file.
	* config/lynx.h: Update to LynxOS 4.0.
	* config/t-lynx: New file.
	* config/i386/lynx-ng.h: Remove file.
	* config/i386/lynx.h: Update to LynxOS 4.0.
	* config/rs6000/lynxbase.h: Remove file.
	* config/rs6000/lynx.h: Update to LynxOS 4.0.
	* config/rs6000/t-lynx: New file.
	* doc/install.texi (Options specification): Remove reference to
	LynxOS from systems where --with-gnu-as makes a difference.

2004-08-05  Joseph S. Myers  <jsm@polyomino.org.uk>

	* c-common.c (c_stddef_cpp_builtins): Define __INTMAX_TYPE__ and
	__UINTMAX_TYPE__.
	* c-cppbuiltin.c (builtin_define_stdint_macros): New.  Define
	__INTMAX_MAX__.
	(c_cpp_builtins): Call it.
	* doc/cpp.texi: Update.

2004-08-04  David Edelsohn  <edelsohn@gnu.org>

	* config/rs6000/rs6000.c (rs6000_rtx_costs): LABEL_REFs are zero
	cost.

2004-08-04  Jan Hubicka  <jh@suse.cz>

	* basic-block.h (profile_staus): New global variable.
	* cfg.c (profile_status): Declare.
	(check_bb_profile): Break out from ....; use profile_status
	(dump_flow_info): ... here.
	* cfgbuild.c (find_basic_blocks): Set profile_status.
	* cfgexpand.c (tree_expand_cfg): Likewise.
	* predict.c (estimate_probability): Likewise.
	* profile.c (branch_prob): Likewise.
	* tree-cfg.c (build_tree_cfg): Likewise.
	(dump_function_to_file): Use check_bb_profile.
	* tree-pretty-print (dump_bb_header): Likewise.
	* tree-profile.c (do_tree_profiling): Cleanup.

2004-08-04  Zack Weinberg  <zack@codesourcery.com>

	* Makefile.in (RTL_BASE_H, RTL_H): Correct.
	(BUILD_RTL): Remove $(BUILD_PREFIX) from ggc-none.o.
	(genobjs): Add errors.o, ggc-none.o, and min-insn-modes.o.
	(read-rtl.o, gensupport.o, genconfig.o, genflags.o, gencodes.o)
	(genconstants.o, genemit.o, genopinit.o, genrecog.o, genextract.o)
	(genpeep.o, genattr.o, genattrtab.o, genautomata.o, genoutput.o)
	(genconditions.o): Depend on $(RTL_BASE_H) not $(RTL_H).
	(ggc-none.o, errors.o): Move rule to generators section;
	correct dependencies.
	(min-insn-modes.o): Move rule to generators section; remove
	unnecessary explicit command; correct dependencies.
	(print-rtl.o, print-rtl1.o): Correct dependencies.
	($(BUILD_PREFIX_1)errors.o. $(BUILD_PREFIX_1)ggc-none.o): Delete rule.
	(mostlyclean): Update.

	* errors.c: Include bconfig.h not config.h.  Correct comment.
	* gengtype.c, genpreds.c: Don't define NO_GENRTL_H.
	* ggc-none.c: Include bconfig.h; not config.h or tm.h.
	* print-rtl.c: Don't include tm_p.h.

	* rtl.h: Move forward-decl of struct function down where it's
	needed.  Include genrtl.h #ifndef GENERATOR_FILE, not
	#ifndef NO_GENRTL_H.  Remove unnecessary #ifdef BUFSIZ statements.

2004-08-04  Zdenek Dvorak  <rakdver@atrey.karlin.mff.cuni.cz>
	    Jeff Law  <law@redhat.com>

	* tree-cfg.c (tree_duplicate_bb): Mark duplicated definitions.
	* tree-flow.h (rewrite_ssa_into_ssa): Declaration changed.
	* tree-into-ssa.c (rewrite_ssa_into_ssa): Use new interface to
	manipulate the duplicated ssa names.
	* tree-ssanames.c (ssa_names_to_rewrite): New variable.
	(marked_for_rewrite_p, any_marked_for_rewrite_p, mark_for_rewrite,
	unmark_all_for_rewrite, marked_ssa_names, release_ssa_name_force):
	New functions.
	(release_ssa_name): Do not release ssa names that may have multiple
	definitions.
	* tree.h (release_ssa_name_force, mark_for_rewrite,
	unmark_all_for_rewrite, marked_for_rewrite_p, any_marked_for_rewrite_p,
	marked_ssa_names): Declare.
	* tree-ssa-loop-ch.c (mark_defs_for_rewrite): Remove.
	(duplicate_blocks): Remove call to mark_defs_for_rewrite.
	Update call to rewrite_ssa_into_ssa.

2004-08-04  Mark Mitchell  <mark@codesourcery.com>

	* defaults.h (TARGET_DECLSPEC): New macro.
	* c-cppbuiltin.c (c_cpp_builtins): Handle TARGET_DECLSPEC.
	* config/arm/pe.h (SUBTARGET_CPP_SPEC): Remove __declspec support.
	* config/arm/symbian.h (TARGET_DLLIMPORT_DECL_ATTRIBUTES): Define.
	* config/i386/beof-elf.h (TARGET_OS_CPP_BUILTINS): Remove
	__declspec support.
	(TARGET_DECLSPEC): Define.
	* config/i386/cygming.h (TARGET_OS_CPP_BUILTINS): Remove
	__declspec support.
	* config/i386/i386-interix.h (TARGET_OS_CPP_BUILTINS): Remove
	__declspec support.
	(TARGET_DECLSPEC): Define.
	* config/mcore/mcore.h (TARGET_CPU_CPP_BUILTINS): Remove
	__declspec support.
	* config/sh/symbian-pre.h (SUBTARGET_CPP_SPEC): Remove __declspec
	support.
	* doc/tm.texi (TARGET_DECLSPEC): Document.

	* doc/extend.texi: Fix typo in comment.

2004-08-04  Paul Brook  <paul@codesourcery.com>

	* target-def.h (TARGET_CXX_CDTOR_RETURNS_THIS): Define.
	(TARGET_CXX): Use it.
	* target.h (struct gcc_target): Add cdtor_returns_this.
	* config/arm/arm.c (arm_cxx_cdtor_returns_this): New function.
	(TARGET_CXX_CDTOR_RETURNS_THIS): Define.
	* doc/tm.texi: Document TARGET_CXX_CDTOR_RETURNS_THIS.

2004-08-03  Nathan Sidwell  <nathan@codesourcery.com>

	* c-lex.c (narrowest_unsigned_type, narrowest_signed_type): Take
	low/high pair. Do range checking directly.
	(interpret_integer): Adjust.

2004-08-04  Nick Clifton  <nickc@redhat.com>

	* config/sh/sh.h (TARGET_SWITCHES): Add no-renesas to select the
	GCC ABI.
	* doc/invoke.texi: Document this new switch and also the -mrenesas
	switch.

2004-08-04  Nathan Sidwell  <nathan@codesourcery.com>

	* cfglayout.c (insn_locators_initialize): Update the current
	location before initializing a location.

2004-08-03  Zack Weinberg  <zack@codesourcery.com>

	* dbxout.c (dbxout_function_decl): Always call dbxout_function_end.
	(dbxout_function_end): Return after emitting the "Lscope" symbol
	under the same conditions that this function formerly wasn't called.
	Add explanatory comments.

	PR 14860
	* c-decl.c (record_builtin_type): Call debug_hooks->type_decl
	on the new decl.

	PR 13956
	* dbxout.c (dbx_output_lbrac, dbx_output_rbrac): New
	functions, broken out of dbxout_block.
	(dbxout_block): The block at depth 0 should get LBRAC/RBRAC
	stabs too, if it contains symbols.  Use the begin_label and
	the Lscope label (emitted by dbxout_function_end) for the
	range of this block.

2004-08-03  Nathanael Nerode  <neroden@gcc.gnu.org>

	* doc/install.texi: Update autoconf version requirements.

2004-08-03  Zack Weinberg  <zack@codesourcery.com>

	* defaults.h (LEGITIMATE_PIC_OPERAND_P): Provide default definition.
	* recog.c (general_operand, immediate_operand, nonmemory_operand)
	(asm_operand_ok): Remove #ifdefs on LEGITIMATE_PICOPERAND_P.
	* regclass.c (record_reg_classes): Likewise.
	* reload.c (find_reloads): Likewise.
	* reload1.c (reload): Likewise.

2004-08-03  Zack Weinberg  <zack@codesourcery.com>

	* gensupport.c (init_md_reader_args_cb): Renamed from
	init_md_reader_args.  Add third option, callback function for
	parsing program-specific options.  Add diagnosis of incorrect
	number of input files.
	(init_md_reader): Fold into init_md_reader_args_cb.
	(init_md_reader_args): Now a thin wrapper around
	init_md_reader_args_cb.
	* gensupport.h: Update prototypes.

	* genattr.c, genattrtab.c, gencodes.c, genconfig.c, genemit.c
	* genextract.c, genflags.c, genopinit.c, genoutput.c, genpeep.c
	* genrecog.c: No need to diagnose lack of an input file;
	init_md_reader_args will handle it.
	* genconditions.c: Likewise, and use init_md_reader_args.
	* genconstants.c: Likewise, and no need to call read_md_rtx.

2004-08-03  Joseph S. Myers  <jsm@polyomino.org.uk>

	* c-decl.c (implicitly_declare): Diagnose incompatible implicit
	declarations.

2004-08-03  Mike Stump  <mrs@apple.com>

	* config/darwin-c.c: Don't search in "/Local/Library/Frameworks"
	for frameworks.
	* doc/invoke.texi (Darwin Options): Update to reflect above.

2004-08-03  Roger Sayle  <roger@eyesopen.com>

	PR middle-end/16790
	* fold-const.c (extract_muldiv_1) <NOP_EXPR>: Disallow local
	truncations, not just global truncations.

2004-08-03  Andrew Pinski  <apinski@apple.com>

	PR bootstrap/16865
	* loop-iv.c (simplify_using_assignment): Initialize lhs.

2004-08-03  Paul Brook  <paul@codesourcery.com>

	* gcc/doc/install.texi: Document MPFR requirement.

2004-08-03  Maciej W. Rozycki  <macro@linux-mips.org>

	* aclocal.m4 (gcc_AC_FUNC_MMAP_BLACKLIST): Check for <sys/mman.h>
	and mmap() explicitly instead of relying on preset autoconf cache
	variables.
	* configure: Regenerate.

2004-08-03  H.J. Lu  <hongjiu.lu@intel.com>

	PR target/16570
	* config.gcc (i[34567]86-*-* | x86_64-*-*): Add i386/t-gmm_malloc
	to tmake_file.
	(i[34567]86-*-linux*aout* | i[34567]86-*-linux*libc1): Likewise.
	(i[34567]86-*-linux* | x86_64-*-linux*): Add i386/t-pmm_malloc
	to tmake_file.

	* config/i386/t-gmm_malloc: New file.
	* config/i386/t-pmm_malloc: Likewise.

	* config/i386/xmmintrin.h: Include <mm_malloc.h>.

2004-08-03  H.J. Lu  <hongjiu.lu@intel.com>
	    Tanguy Fautr  <tfautre@pandora.be>

	* config/i386/pmm_malloc.h: New file.

2004-08-03  Danny Smith  <dannysmith@users.sourceforge.net>

	* config/i386/gmm_malloc.h: New file.

2004-08-03  Dale Johannesen  <dalej@apple.com>

	* config/rs6000/rs6000.c (machopic_output_stub):  Align Darwin stubs.
	* c-common.c: Include opts.h.
	(c_common_get_alias_set): Fix check for a single input file.
	* toplev.c: Remove current_file_decl.
	* tree.h: Ditto.

2004-08-03  Mark Mitchell  <mark@codesourcery.com>

	* config.gcc (arm*-*-symbianelf*): New target.
	* config/arm/symbian.h: New file.

	* gthr-gnat.c: Add visibility #pragmas.
	* gthr-gnat.h : Likewise.
	* gthr.h: Likewise.
	* libgcc2.c (__ffsSI2): Move prototype to libgcc2.h.
	(__ffsDI2): Likewise.
	(__clzSI2): Likewise.
	(__ctzSI2): Likewise.
	(__ctzDI2): Likewise.
	(__popcountSI2): Likewise.
	(__popcountDI2): Likewise.
	(__paritySI2): Likewise.
	(__parityDI2): Likewise.
	* libgcc2.h: Add visibility #pragmas.
	(__clzDI2): Add prototype.
	(__clzSI2): Likewise.
	(__ctzSI2): Likewise.
	(__ffsDI2): Likewise.
	(__ffsSI2): Likewise.
	(__ctzDI2): Likewise.
	(__popcountSI2): Likewise.
	(__popcountDI2): Likewise.
	(__paritySI2): Likewise.
	(__parityDI2): Likewise.
	* unwind-dw2-fde.h: Add visibility #pragmas.
	* unwind.h: Likewise.

2004-08-03  David Edelsohn  <edelsohn@gnu.org>
	    Dale Johannesen  <dalej@apple.com>
	    Roger Sayle  <roger@eyesopen.com>

	* config/rs6000/rs6000.c (rs6000_rtx_costs): Calculate cost of
	constants more accurately.  Adjust costs for FMA instructions.
	Add cases for most logical and float operations.  Recurse into
	most operands.

2004-08-03  Richard Earnshaw  <rearnsha@arm.com>

	* config.gcc (strongarm-*, xscale-*): Add t-arm to tmake_files.

2004-08-03  Pat Haugen  <pthaugen@us.ibm.com>

	* ra-build.c (conflicts_between_webs): For webs that cross a call add
	conflicts to regs_invalidated_by_call.

2004-08-03  Paul Brook  <paul@codesourcery.com>

	* config/arm/arm.c (emit_sfm): Only emit a single frame adjustment.

2004-08-03  Jan Hubicka  <jh@suse.cz>

	* coverage.c (tree_coverage_counter_ref): Fix computation of the new
	ARRAY_REF argument.

2004-08-03  Richard Earnshaw  <rearnsha@arm.com>

	* arm-cores.def: Sort by architecture.  Add arm946es, arm966es,
	arm968es, arm10e, arm1020e, arm1022e.
	* invoke.texi: Update list of ARM cores.
	* arm-tune.md: Regenerate.

2004-08-03  Richard Earnshaw <rearnsha@arm.com>

	* arm/gentune.sh: New file.
	* arm/t-arm: New file.
	* arm/arm-tune.md: New file (autogenerated).
	* config.gcc (arm*-*-*): Add t-arm to tmake_file for all variants.
	* arm.md (attribute tune): Delete.  Include arm-tune.md.

2004-08-03  Paolo Bonzini <bonzini@gnu.org>

	* gcc.c (add_prefix, add_sysrooted_prefix): Remove
	penultimate parameter.  All callers adjusted.
	(struct prefix_list): Remove used_flag_ptr.
	(find_a_file): Do not set *pl->used_flag_ptr.
	(warn_B, warn_std_ptr): Remove.

2004-08-03  Yossi Markovich <yossim@il.ibm.com>
	    Mostafa Hagog <mustafa@il.ibm.com>

	* config/rs6000/altivec.md (altivec_vnmsubfp): Fix wrong pattern.

2004-08-02  Geoffrey Keating  <geoffk@apple.com>

	* dwarf2out.c (output_call_frame_info): Don't change data format
	due to TARGET_USES_WEAK_UNWIND_INFO.  Always refer to the local
	label.  Use 'true' not '1'.
	* doc/install.texi (powerpc-*-darwin*): Mention cctools version
	required.

2004-08-02  Gabriel Dos Reis  <gdr@integrable-solutions.net>

	* gdbinit.in: Reflect previous changes to rtunion_def.

2004-08-02  Roger Sayle  <roger@eyesopen.com>

	* fold-const.c (fold) <TRUNC_MOD_EXPR>: The transformation "X % -Y"
	-> "X % Y" is only valid for TRUNC_MOD_EXPR.

2004-08-02  Gabriel Dos Reis  <gdr@integrable-solutions.net>

	* vec.h (DEF_VEC_P): Add proper cast to uses of vec_o_reserve and
	vec_p_reserve.
	* langhooks.h (lang_hooks::builtin_function): Rename parameter
	from "class" to "bt_class".

2004-08-02  Paul Brook  <paul@codesourcery.com>

	PR rtl-optimization/15068
	* flow.c (init_propagate_block_info): Check condition is reversible.

2004-08-02  Gabriel Dos Reis  <gdr@integrable-solutions.net>

	* gengtype.h (options::info): Change type to const char *.
	(enum gc_used_enum): Move out of struct type scope.
	* gengtype.c (create_option): Convert initializer for option::info to
	appropiate type.
	(adjust_field_type, walk_type, write_func_for_structure,
	write_root, write_roots): Remove pointless cast.

2004-08-02  J"orn Rennecke <joern.rennecke@superh.com>

	* genopinit.c (gen_insn): Check for MODE_COMPLEX_FLOAT patterns for $F.

2004-08-02  Gabriel Dos Reis  <gdr@integrable-solutions.net>

	* rtl.h (union rtunion_def): Have all members  start with the
	prefix "rt_".
	(XINT, XSTR, XEXP, XVEC, XMODE, XBITMAP, XTREE, XBBDEF, XTMPL,
	X0INT, X0UINT, X0STR, X0EXP, X0VEC, X0MODE, X0BITMAP, X0TREE,
	X0MEMATTR, X0BBDEF, X0REGATTR, XCINT, XCUINT, XCSTR, XCEXP,
	XCVEC, XCMODE, XCBITMAP, XCTREE, XCBBDEF, XC2EXP): Adjust members
	access.
	* gengtype.c (adjust_field_rtx_def): Likewise.
	* rtlanal.c (loc_mentioned_in_p): Likewise.

2004-08-02  Richard Sandiford  <rsandifo@redhat.com>

	* config.gcc (mips*-*-elf*, mips*-*-rtems*): Add elfos.h to tm_file.
	Replace uses of mips/elf64.h with mips/elf.h
	* config/mips/elf.h (MAX_OFILE_ALIGNMENT, TARGET_ASM_NAMED_SECTION)
	(TYPE_OPERAND_FMT, TYPE_ASM_OP, SIZE_ASM_OP, BSS_SECTION_ASM_OP)
	(ASM_OUTPUT_ALIGNED_BSS, ASM_WEAKEN_LABEL, ASM_OUTPUT_WEAK_ALIAS)
	(MAKE_DECL_ONE_ONLY, INIT_SECTION_ASM_OP, FINI_SECTION_ASM_OP)
	(HANDLE_SYSV_PRAGMA): Delete.
	(ASM_OUTPUT_DEF): Fix formatting.
	* config/mips/elf64.h: Delete.

2004-08-01  Zack Weinberg  <zack@codesourcery.com>

	* config/ia64/ia64.c (got_symbolic_operand): Do require a
	symbol+offset operand to have its offset be zero mod 0x3fff
	when GOT entries are in use.  Clarify logic in SYMBOL_REF
	case.  Clarify comments.
	(ia64_expand_load_address): Split a symbol+offset load when
	the offset is nonzero mod 0x3fff, not 0x1fff.

2004-08-01  Geoffrey Keating  <geoffk@apple.com>

	* config/rs6000/rs6000.c (rs6000_split_multireg_move): Just abort
	if trying to *store* to a non-offsettable address.
	* config/rs6000/rs6000.md (movtf_internal): Don't move GPRs to
	a nonoffsettable address.
	(movdi_internal32): Don't move GPRs to a nonoffsettable address.
	Clean up.
	(movti_string): Don't move GPRs to a nonoffsettable address.
	(movti_ppc64): Don't move GPRs to a nonoffsettable address.  Clean up.

2004-08-02  Ben Elliston  <bje@au.ibm.com>

	PR target/16155
	* config/rs6000/altivec.h: Replace typeof with __typeof__.

2004-08-01  Richard Henderson  <rth@redhat.com>

	* expr.c (expand_expr_real_1) <normal_inner_ref>: Fix crash with
	variable sized types.

2004-08-01  Richard Sandiford  <rsandifo@redhat.com>

	* doc/invoke.texi: In the MIPS options section, remove the passage
	saying that -mexplicit-relocs is usually disabled for -mabicalls
	-fno-unit-at-a-time.
	* config/mips/mips.c (override_options): Remove the code that enforced
	this rule.

2004-08-01  Richard Sandiford  <rsandifo@redhat.com>

	* config/mips/mips.md (cprestore): Provide two alternatives, one for
	an in-range offset and one for an out-of-range offset.  Wrap the latter
	in .set macro/.set nomacro if it's inside a .set nomacro block.

2004-08-01  Richard Sandiford  <rsandifo@redhat.com>

	* config/mips/mips-protos.h (mips_gp_save_slot): Remove.
	(mips_restore_gp): Declare.
	* config/mips/mips.c (mips_add_offset): Add a scratch register
	argument.  Reimplement in rtl only, reusing MIPS16 logic from
	mips_output_mi_thunk.
	(mips_legitimize_address, mips_legitimize_const_move): Adjust calls
	to mips_add_offset.
	(mips_gp_save_slot): Delete.
	(mips_restore_gp): New function.
	(mips_set_return_address, mips_output_mi_thunk): Use mips_add_offset.
	* config/mips/mips.md (exception_receiver): Turn into a
	define_insn_and_split.  Use mips_restore_gp to do the split.
	(call_internal, call_value_internal, call_value_multiple_internal): Use
	mips_restore_gp to restore $gp.

2004-07-31  Andrew Pinski  <apinski@apple.com>

	PR other/16842
	* mkheaders.in (libsubdir): s/gcc-lib/gcc/.

2004-07-31  Joseph S. Myers  <jsm@polyomino.org.uk>

	* c-decl.c (diagnose_mismatched_decls): Give error for external
	redeclaration of identifier declared with no linkage, not just
	warning with -Wtraditional.  Do not check DECL_CONTEXT to give
	error for redeclaration with no linkage.

2004-07-30  Geoffrey Keating  <geoffk@apple.com>
	    Fariborz Jahanian <fjahanian@apple.com>

	* config/rs6000/rs6000.c (legitimate_lo_sum_address_p): Permit
	non-offsettable addresses even for DImode.
	(rs6000_split_multireg_move): Cope with non-offsettable addresses
	being moved into multiple GPRs.

	* config/rs6000/rs6000.c (RS6000_DEFAULT_LONG_DOUBLE_SIZE): Default
	to 64.
	(rs6000_override_options): Use RS6000_DEFAULT_LONG_DOUBLE_SIZE.
	* config/rs6000/darwin.h (RS6000_DEFAULT_LONG_DOUBLE_SIZE): Define
	to 128.
	* config/rs6000/darwin-ldouble.c (isless): New macro.
	(inf): New macro.
	(nonfinite): New macro.
	(FPKINF): Delete.
	(_xlqadd): Completely rewrite.
	(_xlqmul): Correct overflow handling.
	(_xlqdiv): Correct overflow handling.
	* config/rs6000/darwin-ldouble-format: New file.

2004-07-30  Roger Sayle  <roger@eyesopen.com>
	    Richard Henderson  <rth@redhat.com>

	* config/i386/i386.md: New peephole2's to convert imul by 3, 5 or
	9 into the equivalent lea instruction.

2004-07-30  Richard Henderson  <rth@redhat.com>

	* gimplify.c (gimplify_expr) <case CONST_DECL>: Don't replace
	with DECL_INITIAL if fb_lvalue.
	* tree-gimple.c (is_gimple_id): Add CONST_DECL.
	* tree-pretty-print.c (dump_decl_name): Dump unnamed CONST_DECL
	with <Cxxx>.
	* tree-ssa-ccp.c (maybe_fold_stmt_indirect): Fold CONST_DECL.

2004-07-30  Diego Novillo  <dnovillo@redhat.com>

	* tree-ssa-alias.c (compute_points_to_and_addr_escape): If a
	pointer escapes through a function call, assume that the
	callee will dereference it.
	(add_pointed_to_var): Assume that VALUE is always an
	ADDR_EXPR.
	(collect_points_to_info_r): Only call add_pointed_to_var if
	the value is an ADDR_EXPR.

2004-07-30  Diego Novillo  <dnovillo@redhat.com>

	* tree-ssa-alias.c (create_alias_map_for): Do not get the
	alias set of the inner type of ARRAY_TYPEs.

2004-07-29  Diego Novillo  <dnovillo@redhat.com>

	* tree-ssa-ccp.c (visit_assignment): Move code to prevent
	setting a non-register to UNDEFINED right before the call to
	set_lattice_value.

2004-07-29  Kaz Kojima  <kkojima@gcc.gnu.org>

	* config/sh/lib1funcs.asm: Make aliases movstr* for movmem*.

2004-07-29  Diego Novillo  <dnovillo@redhat.com>

	* tree-ssa.c (verify_flow_sensitive_alias_info): When
	comparing points-to sets of different pointers, make sure the
	second pointer is actually referenced in the code.

2004-07-29  Zack Weinberg  <zack@codesourcery.com>

	* config/ia64/ia64.c (setjmp_operand): Delete, unused.
	(got_symbolic_operand): Remove unreachable code.
	* config/ia64/ia64.h (PREDICATE_CODES): Remove entry for
	setjmp_operand; add entry for tls_symbolic_operand.
	* config/ia64/ia64-protos.h: Remove all prototypes of
	predicate functions.

2004-07-29  Mark Mitchell  <mark@codesourcery.com>

	* c-common.h (lang_post_pch_load): New variable.
	* c-pch.c (lang_post_pch_load): Define it.
	(c_common_read_pch): Use it.
	* cgraphunit.c (record_call_1): Give the front end a chance to
	record additional needed entities when a variable is marked as
	needed.
	* tlink.c (recompile_files): Robustify.
	(scan_linker_output): If a symbol is assigned to a file,
	but after recompilation is not present there, issue an error
	message.

2004-07-29  Zdenek Dvorak  <rakdver@atrey.karlin.mff.cuni.cz>

	* tree-ssa-loop-im.c (force_move_till_expr, force_move_till):
	Take orig_loop argument and pass it to set_level.
	(schedule_sm): Pass the correct orig_loop to force_move_till.

2004-07-29  Zdenek Dvorak  <rakdver@atrey.karlin.mff.cuni.cz>

	* cfgloop.c (update_latch_info): Update dominator of the new block.
	(canonicalize_loop_headers, flow_loops_find): Do not free dominance
	info.
	* dominance.c (verify_dominators): Check that the dominance tree is
	connected.
	(recount_dominator): Ignore unreachable blocks.
	(iterate_fix_dominators): Cleanup old dominance information before
	recomputing it.

2004-07-29  Diego Novillo  <dnovillo@redhat.com>

	* tree-ssa-operands.c (get_expr_operands): Revert changes
	to ADDR_EXPR processing introduced by:
	    2004-06-21  Richard Kenner  <kenner@vlsi1.ultra.nyu.edu>
	    * tree-ssa-operands.c (get_expr_operands): Minor rearrangements.

2004-07-29  Joseph S. Myers  <jsm@polyomino.org.uk>

	* doc/implement-c.texi: Add C90 subclause references.  Point to
	preprocessor documentation instead of duplicating it.  Add points
	only present in C90.  Fill in documentation for all points.

2004-07-29  John David Anglin  <dave.anglin@nrc-cnrc.gc.ca>

	* pa.c (output_movb): Correct typo.

2004-07-29  Pat Haugen  <pthaugen@us.ibm.com>

	* ra.h (single_reg_in_regclass): Declare.
	* ra.c (single_reg_in_regclass): Define.
	(first_hard_reg): New.
	(init_ra): Initialize single_reg_in_regclass.
	* ra-colorize.c (ok_class): New.
	(coalesce, aggressive_coalesce, extended_coalesce_2): Use it.

2004-07-29  Nathan Sidwell  <nathan@codesourcery.com>

	* gcov-io.h: Allow zero tag as EOF indicator.
	(gcov_is_eof): Remove.
	(gcov_truncate): Remove.
	* gcov-io.c (gcov_seek): Always SEEK_SET.
	* libgcov.c (gcov_exit): Don't use gcov_truncate.  Write explicit
	EOF tag.
	* coverage.c (read_counts_file): Don't use gcov_is_eof.
	* gcov-dump.c (dump_file): Likewise.
	* gcov.c (read_graph_file, read_count_file): Likewise.

	* c-decl.c (complete_array_type): Don't gratuitously copy
	maxindex.  Check it always has a type.

2004-07-29  Steven Bosscher  <stevenb@suse.de>

	* rtl.c (currently_expanding_to_rtl): New.
	* rtl.h (currently_expanding_to_rtl): Export it.
	* cfgexpand.c (tree_cfg_expand): Set/clear it at entry/exit.

	* config/alpha/alpha.c (alpha_expand_mov): Remove old RTL
	inliner hack.
	* config/sh/sh.c: Replace rtx_equal_function_value_matters
	with currently_expanding_to_rtl.
	* config/sh/sh.md: Likewise.
	* config/ia64/ia64.c (got_symbolic_operand): Likewise.

2004-07-29  Alexandre Oliva  <aoliva@redhat.com>

	Introduce sh2a support.
	2004-07-29  Alexandre Oliva  <aoliva@redhat.com>
	* config.gcc: Build multilibs for sh2a and sh2a-single by
	default.
	* config/sh/sh.h (SUPPORT_SH2A, SUPPORT_SH2A_SINGLE): Define by
	default.  Split their tests out of the corresponding SH4
	multilibs.
	* config/sh/t-sh (MULTILIB_MATCHES): Don't ever use SH4 or SH4a
	multilibs for SH2a.
	2004-07-28  Alexandre Oliva  <aoliva@redhat.com>
	* config.gcc: Handle sh2a multilibs and cpu selection.
	* config/sh/sh.h: Likewise.  Handle sh2a command line flags.
	* config/sh/t-mlib-sh2a: New.
	* config/sh/t-mlib-sh2a-nofpu: New.
	* config/sh/t-mlib-sh2a-single: New.
	* config/sh/t-mlib-sh2a-single-only: New.
	2004-07-09  Nick Clifton  <nickc@redhat.com>
	Issue 43400
	* config/sh/sh.h (DRIVER_SELF_SPECS): Issue an error message if
	-ml and -m2a are used together.
	2004-03-23  DJ Delorie  <dj@redhat.com>
	* config/sh/sh.c (sh_builtin_saveregs): Use the double code only
	when we have a double-sized FPU.
	2004-02-24  Corinna Vinschen <vinschen@redhat.com>
	* config/sh/lib1funcs.asm (set_fpscr): Don't build if __SH2A_NOFPU__
	is set.
	* config/sh/elf.h (SUBTARGET_ASM_ISA_SPEC): Add cases for -msh2a-nofpu,
	-msh2a-single and -msh2a-single-only
	2004-02-24  Corinna Vinschen <vinschen@redhat.com>
	* config/sh/crt1.asm: Don't generate FPU instructions if __SH2A_NOFPU__
	is set.
	2004-02-20  DJ Delorie  <dj@delorie.com>
	* config/sh/sh.md (movsf_i, movsf_ie, movsf, ble, bge): Disable for sh2a-nofpu.
	2004-02-20  Fred Fish <fnf@redhat.com>,
	Corinna Vinschen <vinschen@redhat.com>
	* config/sh/t-sh (MULTILIB_OPTIONS): Add 2a-nofpu.
	(MULTILIB_EXCEPTIONS): Don't build littel-endian on sh2a.
	2004-02-18  DJ Delorie  <dj@redhat.com>
	* config/sh/sh.c (broken_move): Add support for movi20.
	* config/sh/sh.h: Likewise.
	(SHIFT_COUNT_TRUNCATED): Set for sh2a.
	* config/sh/sh.md (udivsi3_sh2a): New.
	(udivsi3): Call it.
	(divsi3_sh2a): New.
	(divsi3): Call it.
	(mul_r): New.
	(ashlsi3_sh2a): New.
	(ashrsi3_sh2a): New.
	(lshrsi3_sh2a): New.
	(movsi_i): Disable for sh2a.
	(movsi_ie): Add movi20.
	(movsf_i, movsf_ie, movsf, ble, untyped_call): Explicitly enable
	sh2a, for -m2a-nofpu mode.
	2004-02-13  DJ Delorie  <dj@redhat.com>
	* config/sh/lib1funcs.asm: Handle double vs single better.
	* config/sh/sh.h: Likewise.
	2004-02-09  DJ Delorie  <dj@redhat.com>
	* config/sh/crt1.asm: Add support for sh2a.
	* config/sh/elf.h: Likewise.
	* config/sh/lib1funcs.asm: Likewise.
	* config/sh/sh.c: Likewise.
	* config/sh/sh.md: Likewise.
	* config/sh/sh.h: Likewise.
	* config/sh/t-sh: Likewise.

2004-07-28  Alexandre Oliva  <aoliva@redhat.com>

	* config/frv/frv.md (movqi_internal, movhi_internal,
	movsi_internal): Add backup alternatives for memory inputs.

2004-07-28  Matt Austern  <austern@apple.com>

	* config/darwin.c (darwin_one_byte_bool): New global variable.
	* config/darwin.h (darwin_one_byte_bool): Declare.
	(SUBTARGET_OPTIONS): Define macro.  (for -mone-byte-bool flag.)
	* config/rs6000/darwin.h (BOOL_TYPE_SIZE): Conditionalize on
	value of darwin_one_byte_bool.
	* doc/invoke.texi: Document -mone-byte-bool flag.

2004-07-28  Eric Christopher  <echristo@redhat.com>

	* c-common.c (c_common_unsafe_for_reeval): Delete.
	* c-lang.c (LANG_HOOKS_UNSAFE_FOR_REEVAL): Delete use.
	* c-pretty-print.c (pp_c_expression): Delete UNSAVE_EXPR case.
	* calls.c (fix_unsafe_tree): Delete.
	(expand_call): Delete code which used above.
	* dojump.c (do_jump): Delete UNSAVE_EXPR case.
	* expr.c (expand_expr_real_1): Ditto.
	* fold-const.c (non_lvalue): Ditto.
	* langhooks-def.h (LANG_HOOKS_UNSAFE_FOR_REEVAL): Delete.
	(lhd_unsafe_for_reeval): Ditto.
	* langhooks.c (lhd_unsafe_for_reeval): Ditto.
	* langhooks.h (unsafe_for_reeval): Ditto.
	(unsave_expr_now): Adjust comment.
	* tree-inline.c (copy_body_r): Delete UNSAVE_EXPR bits.
	(estimate_num_insns_1): Ditto.
	* tree-pretty-print.c (dump_generic_node): Ditto.
	* tree.c (expr_align): Ditto.
	(unsave_expr): Delete.
	(unsafe_for_reeval): Ditto.
	* tree.h (unsafe_for_reeval, unsave_expr): Ditto.
	* tree.def (UNSAVE_EXPR): Delete.
	* objc/objc-lang.c (LANG_HOOKS_UNSAFE_FOR_REEVAL): Delete.

2004-07-28  Zack Weinberg  <zack@codesourcery.com>

	* tree.h (enum tls_model): Move ...
	* coretypes.h: ... here.

2004-07-28  Richard Sandiford <rsandifo@redhat.com>

	* config/frv/frv.h (EPILOGUE_USES): New.  Use LR.

2004-07-28  Richard Sandiford  <rsandifo@redhat.com>

	* cse.c (validate_canon_reg): New function, split out from...
	(canon_reg): ...here.  Use validate_canon_reg for both 'e' and 'E'.

2004-07-28  Diego Novillo  <dnovillo@redhat.com>

	* tree-ssa-alias.c (maybe_create_global_var): Don't just
	return if .GLOBAL_VAR has been created.

2004-07-28  Diego Novillo  <dnovillo@redhat.com>

	* tree-ssa.c (verify_flow_insensitive_alias_info): Process
	every variable that may have aliases, not just tags.

2004-07-28  Aldy Hernandez  <aldyh@redhat.com>

	* config/rs6000/rs6000.md ("move_from_CR_gt_bit"): Rename to
	move_from_CR_eq_bit.
	Rename UNSPEC_MV_CR_GT to UNSPEC_MV_CR_EQ.


	* config/rs6000/spe.md ("e500_flip_gt_bit"): Rename to
	e500_flip_eq_bit.

	* config/rs6000/rs6000-protos.h: Rename output_e500_flip_gt_bit to
	output_e500_flip_eq_bit.

	* config/rs6000/rs6000.c (output_e500_flip_gt_bit): Rename to
	output_e500_flip_eq_bit.
	(rs6000_emit_sCOND): Rename call to output_e500_flip_gt_bit to
	output_e500_flip_eq_bit.
	Rename gen_move_from_CR_gt_bit to gen_move_from_CR_eq_bit.
	(print_operand): case D.  Get to EQ bit.

2004-07-28  Richard Sandiford  <rsandifo@redhat.com>

	* gcov.c (function_summary): Add missing \n.

2004-07-28  Alexandre Oliva  <aoliva@redhat.com>

	Introduce sh4a support.
	* config.gcc: Handle sh4a multilibs and cpu selection.
	* config/sh/sh.h: Likewise.  Handle sh4a command line flags.
	* config/sh/t-mlib-sh4a: New.
	* config/sh/t-mlib-sh4al: New.
	* config/sh/t-mlib-sh4a-nofpu: New.
	* config/sh/t-mlib-sh4a-single: New.
	* config/sh/t-mlib-sh4a-single-only: New.
	2004-02-20  DJ Delorie  <dj@redhat.com>
	* config/sh/sh.md ("movua"): Change constraint from "m" to "Sua".
	* config/sh/sh.h (EXTRA_CONSTRAINT_S): Add "Sua" support.
	2003-08-22  Eric Christopher  <echristo@redhat.com>
	* config/sh/sh4a.md: Update for chip errata.
	2003-08-07  Eric Christopher  <echristo@redhat.com>
	* config/sh/sh4a.md: New file. sh4a processor description.
	2003-07-08  Alexandre Oliva  <aoliva@redhat.com>
	* config/sh/sh.h (TARGET_SWITCHES): Added 4al.  Adjust description
	of -m4a-nofpu.
	(SH_ASM_SPEC): Pass -dsp for -m4al, not -m4a-nofpu.
	* config/sh/t-sh (MULTILIB_MATCHES): Map -m4al to -m4a-nofpu.
	* doc/invoke.texi (SH Options): Document -m4al.
	2003-07-03  Alexandre Oliva  <aoliva@redhat.com>
	* config/sh/sh.c (expand_block_move): Remove commented-out code
	checked in by mistake.
	(sh_cannot_change_mode_class): Enable SUBREGs to be used to select
	single elements from SFmode vectors.
	* config/sh/sh.md (fsca): Use VEC_CONCAT to initialize the output
	register.
	(sinsf2, cossf2, sindf2, cosdf2): Don't emit CLOBBER.
	2003-07-01  Alexandre Oliva  <aoliva@redhat.com>
	* config/sh/sh.h (sh_fsca_sf2int, sh_fsca_df2int,
	sh_fsca_int2sf): Remove variable declarations.
	* config/sh/sh.c (sh_fsca_sf2int, sh_fsca_df2int,
	sh_fsca_int2sf): New functions.
	(sh_fsca_sf2int_rtx, sh_fsca_df2int_rtx,
	sh_fsca_int2sf_rtx): New static variables.
	* config/sh/sh-protos.h (sh_fsca_sf2int, sh_fsca_df2int,
	sh_fsca_int2sf): Declare.
	* config/sh/sh.md: Adjust.
	* doc/invoke.texi (SH Options): Document new options.
	* config/sh/lib1funcs.asm (ic_invalidate): Remove SH4a forward
	compatibility from SH4 code.
	2003-06-27  Alexandre Oliva  <aoliva@redhat.com>
	* config/sh/sh.c (expand_block_move): Don't emit POST_INC too
	early.
	(memory_movsrc_operand): Renamed to...
	(unaligned_load_operand): ... this.  Simplified.
	* config/sh/sh.h (PREDICATE_CODES): Adjust.
	* config/sh/sh.md (movua, extv, extzv): Likewise.  Change movua's
	input operand to SImode, and adjust the others.  Introduce
	post-increment by peephole.
	* config/sh/sh.c (expand_block_move): Give the target address the
	same mode as the temp reg.
	* config/sh/sh.c (expand_block_move): Use a temp reg for unaligned
	copying.
	2003-06-26  Alexandre Oliva  <aoliva@redhat.com>
	Introduce support for SH4a.
	* config/sh/lib1funcs.asm (ic_invalidate): Use icbi if
	__SH4A__.  Emit 4 4kb blocks and touch all of them otherwise.
	* config/sh/sh.c (sh_fsca_sf2int, sh_fsca_df2int,
	sh_fsca_int2sf): New.
	(sh_init_builtins): Initialize them.
	(print_operand): Support `d'.
	(expand_block_move): Use movua if src is misaligned.
	(memory_movsrc_operand): New.
	* config/sh/sh.h (TARGET_CPU_CPP_BUILTINS): Define __SH4A__
	and one of the SH4 macros.
	(SH4A_BIT, TARGET_SH4A_ARCH, TARGET_SH4A_FP,
	SELECT_SH4A_NOFPU, SELECT_SH4A_SINGLE_ONLY, SELECT_SH4A,
	SELECT_SH4A_SINGLE): New.
	(TARGET_NONE): Add SH4A_BIT.
	(TARGET_SWITCHES): Add 4a-single-only, 4a-single, 4a-nofpu and 4a.
	(SH_ASM_SPEC): Pass -dsp if -m4a-nofpu.
	(sh_fsca_sf2int, sh_fsca_df2int, sh_fsca_int2sf): Declare.
	(OVERRIDE_OPTIONS): Set cpu to CPU_SH4A when appropriate.
	(enum processor_type): Added PROCESSOR_SH4A.
	(PREDICATE_CODES): Add memory_movsrc_operand.
	* config/sh/sh.md: Removed unused variables.
	(attr cpu): Add sh4a.
	(attr type): Add movua, fsrra and fsca.
	(prefetch): New, for SH4.
	(ic_invalidate_line, ic_invalidate_line_sh4a): Use icbi.
	(toggle_sz): Set type to fp.
	(toggle_pr, rsqrtsf2, fsca, sinsf2, cossf2, sindf2, cosdf2): New.
	(movua, extv, extzv): New.
	* config/sh/t-sh: Add multilibs for 4a, 4a-nofpu, 4a-single
	and 4a-single-only.

2004-07-28  Diego Novillo  <dnovillo@redhat.com>

	* tree-optimize.c (init_tree_optimization_passes): Schedule
	pass_may_alias right after the program is renamed into SSA.
	* tree-pass.h (PROP_alias): Define.
	* tree-outof-ssa.c (pass_del_ssa): Require PROP_alias.
	* tree-sra.c (pass_sra): Likewise.
	* tree-ssa-ccp.c (pass_ccp): Likewise.
	* tree-ssa-copyrename.c (pass_rename_ssa_ccp): Likewise.
	* tree-ssa-dce.c (pass_dce): Likewise.
	* tree-ssa-dom.c (pass_dominator): Likewise.
	* tree-ssa-dse.c (pass_dse): Likewise.
	* tree-ssa-forwprop.c (pass_forwprop): Likewise.
	* tree-ssa-loop-ch.c (pass_ch): Likewise.
	* tree-ssa-phiopt.c (pass_phiopt): Likewise.
	* tree-ssa-pre.c (pass_pre): Likewise.
	* tree-tailcall.c (pass_tail_recursion): Likewise.
	* tree-ssa.c (pass_redundant_phi): Likewise.
	* tree-ssa-alias.c (aliases_computed_p): Remove.
	Update all users.
	(init_alias_info): Do not mark all type tags for renaming
	unconditionally.
	Clear may_aliases from every symbol.
	(setup_pointers_and_addressables): If a pointer has not been
	dereferenced and it had a type tag, clear it and mark the old
	tag for renaming.

2004-07-28  Diego Novillo  <dnovillo@redhat.com>

	PR tree-optimization/16705
	* tree-ssa-alias.c (create_global_var): Set DECL_EXTERNAL on
	.GLOBAL_VAR.

2004-07-27  Richard Kenner  <kenner@vlsi1.ultra.nyu.edu>

	* expr.c (expand_expr_real_1, case PARM_DECL): Remove obsolete error
	check.

	* gimplify.c (maybe_with_size_expr): If already have WITH_SIZE_EXPR,
	don't make another one.

	PR optimization/15077
	* function.h (struct function): Add field saved_static_chain_decl.
	Fix comment for static_chain_decl.
	* tree-inline.c (save_body): Add new arg and handle static_chain_decl.
	* tree-inline.h (save_body): Add new arg.
	* tree-optimize.c (tree_rest_of_compilation): Handle saving
	static_chain_decl.

2004-07-27  Richard Henderson  <rth@redhat.com>

	* gimplify.c (is_gimple_addr_expr_arg_or_indirect): Remove.
	(gimplify_modify_expr, gimplify_addr_expr, gimplify_expr): Use
	is_gimple_addressable.
	* tree-gimple.c (is_gimple_addressable): Rename from
	is_gimple_addr_expr_arg; accept INDIRECT_REF.
	(is_gimple_lvalue): Don't test INDIRECT_REF directly.
	* tree-gimple.h, tree-sra.c, tree-ssa-loop-im.c: Update for
	rename to is_gimple_addressable.

2004-07-28  Alan Modra  <amodra@bigpond.net.au>

	* config/rs6000/rs6000.c (function_arg_padding): Pad SFmode upwards.

2004-07-27  Richard Henderson  <rth@redhat.com>

	* function.c (assign_stack_local_1): Widen alignment to HOST_WIDE_INT
	before rounding.

2004-07-27  Zack Weinberg  <zack@codesourcery.com>

	* libgcc2.c: Change all conditionals testing
	LIBGCC2_LONG_DOUBLE_TYPE_SIZE == 96 to == 80.
	* libgcc2.h: Likewise.
	* config/i386/i386.c (ix86_init_mmx_sse_builtins): Set
	TYPE_PRECISION of float80_type to 80.
	* config/ia64/ia64.c (ia64_init_builtins): Set TYPE_PRECISION
	of fpreg_type and float80_type to 80.
	* config/i386/i386.h, config/ia64/ia64.h, config/m68k/m68k.h
	* config/m68k/netbsd-elf.h:
	Change LONG_DOUBLE_TYPE_SIZE and possibly LIBGCC2_LONG_DOUBLE_TYPE_SIZE
	to evaluate to 80 whenever they would formerly have evaluated to 96.
	* config/i386/sco5.h: Remove unnecessary redefinition of
	LONG_DOUBLE_TYPE_SIZE.
	* doc/rtl.texi: Clarify uses of XFmode and TFmode.
	* config/i386/i386-modes.def: Use FRACTIONAL_FLOAT_MODE for
	XFmode, with a bitsize of 80.  Update commentary.
	* config/ia64/ia64-modes.def: Likewise.
	* config/m68k/m68k-modes.def: Likewise.

2004-07-27  Steven Bosscher  <stevenb@suse.de>

	* cfgexpand.c (tree_expand_cfg): Fix comment.

	* calls.c (expand_call): Ignore rtx_equal_function_value_matters.
	* function.c (purge_single_hard_subreg_set, purge_hard_subreg_sets):
	Remove.
	(prepare_function_start): Don't set rtx_equal_function_value_matters.
	* integrate.c (copy_rtx_and_substitute): Don't test for it.
	* passes.c (rest_of_compilation): Don't call purge_hard_subreg_sets.
	Don't set rtx_equal_function_value_matters.  Don't register RTL hooks
	here again.  Update leading comment.
	* rtl.c (rtx_equal_function_value_matters): Remove.
	(rtx_equal_p): Don't test for it.
	* simplify-rtx.c (simplify_binary_operation, simplify_subreg):
	Likewise.

	* rtl.h (enum insn_note): Remove NOTE_INSN_LOOP_END_TOP_COND.
	* rtl.c (note_insn_name): Likewise.
	* emit-rtl.c (remove_unnecessary_notes): Don't handle it.
	* final.c (final_scan_insn): Likewise.

	* except.c (finish_eh_generation): Don't call cfg_cleanup from here.
	* passes.c (rest_of_handle_eh): Do it here.

	* stmt.c (struct nesting): Remove struct nesting block member.
	(struct stmt_status): Remove x_block_start_count field.
	(current_block_start_count): Remove.

2004-07-27  Brian Booth  <bbooth@redhat.com>

	* tree-optimize.c (register_one_dump_file): Update condition that uses
	static_pass_number.
	(dup_pass_1): Replace with...
	(next_pass_1): This.
	(NEXT_PASS): Call next_pass_1.
	(DUP_PASS): Remove.
	(init_tree_optimization_passes): Remove uses of DUP_PASS.
	(execute_one_pass): Update condition that uses
	static_pass_number.
	* tree-pass.h (tree_opt_pass): Declare static_pass_number as a signed
	integer.

2004-07-27  Nick Clifton  <nickc@redhat.com>

	* config/m32r/m32r.c: Include integrate.h in order to get the
	prototype for get_hard_reg_initial_val().

	* config/m32r/m32r.md (m32rpipeline): Remove unused value "m32r"
	and tidy up indentation.
	(final_presence_set): Use absence_set instead, so that if there is
	nothing in the "o" pipe the "s" pipe can be scheduled.

2004-07-27  Diego Novillo  <dnovillo@redhat.com>

	* tree-ssa-alias.c (create_name_tags): Ignore pointers that
	don't have PT_VARS nor PT_MALLOC set.
	Clear name tag from pointers that have not been dereferenced.
	(set_pt_anything, set_pt_malloc): Forward declare.
	* tree-ssa-copy.c (may_propagate_copy): Compare alias sets,
	not type compatibility when determining if a pointer can be
	copy propagated.

2004-07-27  Richard Sandiford  <rsandifo@redhat.com>

	* expr.h (canonicalize_condition, get_condition): Add an int argument.
	* gcse.c (fis_get_condition): Reimplement using get_condition, leaving
	it to check whether the condition is still valid at the jump insn.
	* ifcvt.c (noce_get_condition): Likewise.
	(noce_get_alt_condition): Update call to canonicalize_condition.
	* loop-iv.c (simplify_using_initial_values): Update call to
	get_condition.  Remove FIXME.
	(check_simple_exit): Update call to get_condition.
	* loop-unswitch.c (may_unswitch_on): Likewise.
	* loop.c (check_dbra_loop): Likewise.
	(canonicalize_condition, get_condition): Add an argument to say whether
	the condition must still be valid at INSN.
	(get_condition_for_loop): Update call to get_condition.  Require that
	the condition be valid at INSN.
	* predict.c (estimate_probability): Update call to get_condition.
	Remove unused earliest parameter.
	(expected_value_to_br_prob): Update call to canonicalize_condition.

2004-07-26  Eric Christopher  <echristo@redhat.com>

	* tree-dfa.c (add_referenced_var): Register initializers of global
	variables.

2004-07-26  Paolo Bonzini  <bonzini@gnu.org>

	* config/i386/i386.c (function_arg): Always treat 8-
	and 16-byte wide vectors the same, even if MMX/SSE
	are disabled.
	(contains_128bit_aligned_vector_p): Add comment.

2004-07-26  J"orn Rennecke <joern.rennecke@superh.com>

	* ra.h (enum node_type): Rename to:
	(enum ra_node_type).
	* ra-colorize.c: Likewise.

2004-07-26  Richard Sandiford  <rsandifo@redhat.com>

	* cfgcleanup.c (try_simplify_condjump): Call update_forwarder_flag
	after simplifying the jump.

2004-06-26  Richard Henderson  <rth@redhat.com>

	* calls.c (combine_pending_stack_adjustment_and_call): Make
	preferred_unit_stack_boundary argument unsigned.  Make
	unadjusted_alignment unsigned.
	(expand_call): Make preferred_stack_boundary and
	preferred_unit_stack_boundary variables unsigned.
	* function.c (assign_stack_local_1): Make alignment unsigned.
	* function.h (struct function): Make stack_alignment_needed,
	preferred_stack_boundary unsigned.
	* config/i386/i386.c (ix86_preferred_stack_boundary): Make unsigned.
	(ix86_compute_frame_layout): Make stack_alignment_needed,
	preferred_alignment variables unsigned.
	* config/i386/i386.h (ix86_preferred_stack_boundary): Make unsigned.

2004-07-26  Tom Tromey  <tromey@redhat.com>

	* tree.h: Fix typo in comment.

2004-07-26  Daniel Jacobowitz  <dan@debian.org>

	PR bootstrap/12804
	* ggc-zone.c (struct alloc_chunk): Remove attribute packed.
	(MAX_FREE_BIN_SIZE): Increase on 64-bit targets.
	(ggc_free): Remove incorrect freeing.
	(sweep_pages): Advance PP for large pages.  Fix indentation.

2004-07-26  Richard Sandiford  <rsandifo@redhat.com>

	PR rtl-optimization/16643
	* cfglayout.h (cfg_layout_initialize): Add a flags parameter.
	* cfglayout.c (cfg_layout_initialize): Pass it to cleanup_cfg.
	* basic-block.h (reorder_basic_blocks): Add a flags parameter.
	* cfglayout.c (reorder_basic_blocks): Pass it to cfg_layout_initialize.
	(partition_hot_cold_basic_blocks): Pass 0 to cfg_layout_initialize.
	* function.c (thread_prologue_and_epilogue_insns): Likewise.
	* rtl.h (tracer): Add a flags parameter.
	* tracer.c (tracer): Pass it to cfg_layout_initialise.
	* passes.c (rest_of_handle_stack_regs): Pass 0 to reorder_basic_blocks.
	(rest_of_handle_reorder_blocks): Update calls to tracer and
	reorder_basic_blocks, passing CLEANUP_UPDATE_LIFE if appropriate.
	(rest_of_handle_tracer): Pass 0 to tracer.
	(rest_of_handle_loop2): Pass 0 to cfg_layout_initialize.

2004-07-25  David Edelsohn  <edelsohn@gnu.org>

	PR target/16239
	* config/rs6000/rs6000.md (movdi_internal64): Further disparage
	f->f.

2004-07-24  Nathan Sidwell  <nathan@codesourcery.com>

	* tree.h (BINFO_BASE_ACCESSES): Accesses are a VEC(tree).
	(BINFO_BASE_ACCESS): Adjust.
	(BINFO_BASE_ACCESS_APPEND): New.
	(struct tree_binfo): Make base_accesses a VEC(tree) pointer.
	* dbxout.c (dbxout_type): Adjust binfo access accessing.
	* dwarf2out.c (gen_member_die): Likewise.
	* tree-dump.c (deque_and_dump): Likewise.

2004-07-26  Falk Hueffner  <falk@debian.org>

	* config/alpha/alpha.c (alpha_rtx_cost_data): Tweak int_div
	costs.

2004-07-25  Roger Sayle  <roger@eyesopen.com>

	* config/i386/i386.c (output_fp_compare): Use ffreep to pop top
	value off of the stack if TARGET_USE_FFREEP.

2004-07-26  Bernardo Innocenti  <bernie@develer.com>

	* gengtype.c (oprintf): Replace xrealloc () with XRESIZEVEC ().
	* gengtype-yacc.y: Likewise.  Replace free() with XDELETE ().
	* c-typeck.c (PUSH_SPELLING): Remove redundant NULL-pointer
	check on invocation of XRESIZEVEC ().

2004-07-26  Bernardo Innocenti  <bernie@develer.com>

	* c-common.c (disable_builtin_function): Rename variable n to
	new_disabled_builtin.
	* c-decl.c (duplicate_decls): Rename parameter decl to new_decl.
	Rename local variable old to old_decl.
	* gensupport.c (shift_output_template): Rename parameter old to src.
	* simplify-rtx.c (simplify_replace_rtx): Rename parameter oldx to
	old_rtx and newx to new_rtx.

2004-07-26  Bernardo Innocenti  <bernie@develer.com>

	* Makefile.in (C_PRAGMA_H): New variable to track dependencies
	of c-pragma.h.
	* c-pragma.h (c_lex, c_lex_with_flags): Change returntype to
	enum cpp_ttype.
	* c-lex.c: Likewise.

2004-07-25  Roger Sayle  <roger@eyesopen.com>

	* fold-const.c (constant_boolean_node): Make extern.
	(make_range): Wrap long lines.
	(fold_cond_expr_with_comparison): Remove unnecessary call to
	pedantic_non_lvalue.  Add missing calls to fold_convert.
	(fold_truthop): Add missing calls to fold_convert.
	(fold): Likewise.
	* tree.h (constant_boolean_node): Add prototype here.
	* builtins.c (expand_builtin_strncmp): Add missing calls to
	fold_convert.
	* tree-ssa-dom.c (record_equivalences_from_incoming_edge):
	Call fold_convert and constant_boolean_node to correct types.
	* tree-ssa-forwprop.c (substitute_single_use_vars): Add
	missing call to fold_convert to correct types.

2004-07-26  Niall Douglas  <s_fsfeurope2@nedprod.com>
	    Brian Ryner  <bryner@brianryner.com>

	PR c++/9283
	PR c++/15000
	* c-common.c (c_common_attribute_table): Allow
	handle_visibility_attribute to be called for types.
	(handle_visibility_attribute) When given a type, set the visibility
	bits on the TYPE_NAME.  When given a decl, don't set no_add_attrs
	so that we can check later whether the attribute was present. Added
	warning if attribute applied to non class type.
	* c-decl.c (diagnose_mismatched_decls): Updated rules for merging
	decls and checking that they are consistent.
	* common.opt: Added -fvisibility.
	* c.opt, c-opts.c: Added -fvisibility-inlines-hidden.
	* c-pragma.h, c-pragma.c: Added handle_pragma_visibility().
	* flags.h, tree.h: Added assorted support defines for overall patch
	* opts.c: Added parsing support for -fvisibility.
	* tree.c (build_decl): Set visibility for all decls to be whatever
	is in force at that time.
	* varasm.c (default_binds_local_p_1): Reworked logic determining
	when to make a symbol locally bound.
	* doc/invoke.texi: Added documentation for -fvisibility and
	-fvisibility-inlines-hidden.

2004-07-25  Bernardo Innocenti  <bernie@develer.com>

	* basic-block.h (reorder_block_def): Rename to reorder_block_def_p.
	* c-common.c: Add missing casts from void * to other types.
	* c-decl.c: Likewise.
	* c-format.c: Likewise.
	* c-lex.c: Likewise.
	* c-pragma.c: Likewise.
	* c-typeck.c: Likewise.
	* defaults.h: Likewise.
	* genconstants.c: Likewise.
	* gengtype-lex.l: Likewise.
	* genmodes.c: Likewise.
	* read-rtl.c: Likewise.
	* rtl.c: Likewise.

2004-07-25  Bernardo Innocenti  <bernie@develer.com>

	* bitmap.c: Use type-safe memory allocation macros from libiberty.
	* c-common.c: Likewise.
	* c-decl.c: Likewise.
	* c-lang.c: Likewise.
	* c-lex.c: Likewise.
	* c-opts.c: Likewise.
	* c-parse.in: Likewise.
	* c-typeck.c: Likewise.
	* genconditions.c: Likewise.
	* gengtype-lex.l: Likewise.
	* gengtype-yacc.y: Likewise.
	* gengtype.c: Likewise.
	* genmodes.c: Likewise.
	* gensupport.c: Likewise.
	* read-rtl.c: Likewise.
	* read-rtl.c (read_constants): Use INSERT instead of TRUE in call to
	htab_find_slot().

2004-07-25  Bernardo Innocenti  <bernie@develer.com>

	* c-decl.c (groktypename, groktypename_in_param_context): Rename
	variable typename to type_name.
	* c-lex.c (interpret_float): Likewise.

2004-07-25  Roger Sayle  <roger@eyesopen.com>

	* convert.c (convert_to_real, convert_to_integer,
	convert_to_complex): Replace calls to build with calls to buildN.
	* coverage.c (tree_coverage_counter_ref): Likewise.
	* dojump.c (do_jump): Likewise.
	* dwarf2out.c (loc_descriptor_from_tree): Likewise.
	* emit-rtl.c (component_ref_for_mem_expr,
	set_mem_attributes_minus_bitpos): Likewise.
	* explow.c (update_nonlocal_goto_save_area): Likewise.
	* expmed.c (expand_shift, make_tree, const_mult_add_overflow_p,
	expand_mult_add): Likewise.
	* expr.c (emit_block_move_via_libcall, clear_storage_via_libcall,
	store_constructor, get_inner_reference, expand_expr_real_1,
	try_casesi, try_tablejump): Likewise.
	* function.c (expand_function_start): Likewise.
	* stmt.c (emit_case_bit_tests, expand_end_case_type,
	node_has_low_bound, node_has_high_bound, emit_case_nodes): Likewise.
	* stor-layout.c (place_union_field, layout_type): Likewise.
	* tree.c (substitute_in_expr, tree_fold_gcd): Likewise.
	* varasm.c (copy_constant): Likewise.

2004-07-25  Bernardo Innocenti  <bernie@develer.com>

	* c-common.c: Rename all identifiers named `new'.
	* c-decl.c: Likewise.
	* gensupport.c: Likewise.
	* simplify-rtx.c: Likewise.
	* c-common.c (disable_builtin_function): Replace a call to xmalloc()
	with XNEW().
	* gensupport.c (alter_output_for_insn): Replace two calls to xmalloc()
	with XNEWVEC().

2004-07-25  Joseph S. Myers  <jsm@polyomino.org.uk>

	PR c/15360
	* c-decl.c (start_decl): Do not set DECL_EXTERNAL for initialized
	declarations until after calling pushdecl.
	(grokdeclarator): Set DECL_EXTERNAL for variables based on use of
	"extern" and not on whether the declaration is initialized.

2004-07-25  Daniel Jacobowitz  <dan@debian.org>

	* config.gcc (i[34567]86-*-solaris2*, sparc64-*-solaris2*)
	(sparc-*-solaris2*): Include sol2.o and sol2-protos.h.
	* config/sol2-c.c: Include "tm.h", "tm_p.h", "toplev.h",
	"cpplib.h", "c-pragma.h", "c-common.h".
	(solaris_pragma_align, solaris_pragma_init, solaris_pragma_fini)
	(solaris_register_pragmas): New functions.
	* config/sol2-protos.h: New file.
	* config/sol2.c: New file.
	* config/sol2.h (SOLARIS_ATTRIBUTE_TABLE, ASM_DECLARE_FUNCTION_SIZE)
	(REGISTER_TARGET_PRAGMAS): New macros.
	(solaris_pending_aligns, solaris_pending_inits)
	(solaris_pending_finis): New variables.
	* config/t-sol2 (sol2-c.o): Update dependencies.
	(sol2.o): New rule.
	* config/i386/i386.c (TARGET_INSERT_ATTRIBUTES): Define in terms of
	SUBTARGET_INSERT_ATTRIBUTES.
	(ix86_attribute_table): Include SUBTARGET_ATTRIBUTE_TABLE.
	* config/i386/sol2.h (SUBTARGET_INSERT_ATTRIBUTES)
	(SUBTARGET_ATTRIBUTE_TABLE, ASM_OUTPUT_CALL): Define.
	* config/sparc/elf.h (ASM_DECLARE_FUNCTION_SIZE): Redefine.
	* config/sparc/sp64-elf.h (ASM_DECLARE_FUNCTION_SIZE): Redefine.
	* config/sparc/sol2.h (SUBTARGET_INSERT_ATTRIBUTES)
	(SUBTARGET_ATTRIBUTE_TABLE, ASM_OUTPUT_CALL): Define.
	* config/sparc/sparc.c (sparc_attribute_table): New.
	(TARGET_INSERT_ATTRIBUTES): Define in terms of
	SUBTARGET_INSERT_ATTRIBUTES.
	(TARGET_ATTRIBUTE_TABLE): Define if SUBTARGET_ATTRIBUTE_TABLE
	is defined.
	* doc/extend.texi (Solaris Pragmas): New section.

2004-07-25  Bernardo Innocenti  <bernie@develer.com>

	* c-common.c: Rename all identifiers named `class' to `cl'.
	* c-common.h: Likewise.
	* c-parse.in: Likewise.
	* c-typeck.c: Likewise.
	* genmodes.c: Likewise.
	* real.c: Likewise.
	* real.h: Likewise.
	* recog.c: Likewise.
	* recog.h: Likewise.
	* regrename.c: Likewise.
	* tree.h: Likewise.
	* c-common.c (builtin_function_2): Change type of 5th parameter from
	int to enum built_in_function. Change type of 8th parameter from int
	to bool.
	* c-decl (builtin_function): Replace call to ggc_alloc_cleared ()
	with GGC_CNEW().
	* c-typeck.c (convert_arguments): Change type of formal_prec from
	int to unsigned int.
	* genmodes.c (blank_mode): Make a few negative constants unsigned.
	(complete_all_modes, calc_wider_mode, emit_insn_modes_h,
	emit_mode_name, emit_mode_class, emit_mode_precision, emit_mode_size,
	emit_mode_nunits, emit_mode_wider, emit_mode_mask, emit_mode_inner,
	emit_mode_base_align, emit_class_narrowest_mode): Pass an integer
	iterator to for_all_modes () instead of an enum because enums can't
	be incremented in C++.


2004-07-25  Daniel Jacobowitz  <dan@debian.org>

	* regmove.c (optimize_reg_copy_1): Don't try to replace call-used
	hard registers.

2004-07-25  Richard Kenner  <kenner@vlsi1.ultra.nyu.edu>

	* tree-ssa-operands.c (get_stmt_operands, get_expr_operands):
	Handle ARRAY_RANGE_REF like ARRAY_REF.

2004-07-25  Joseph S. Myers  <jsm@polyomino.org.uk>

	* c-typeck.c (digest_init): Don't allow arrays of signed or
	unsigned variants of wchar_t to be initialized by wide string
	constants.  Do allow arrays of enumerated types compatible with
	wchar_t to be initialized by wide string constants.  Refine tests
	distinguishing wide and narrow strings and arrays.  Give specific
	error for arrays of other integer types initialized by string
	constants.
	(output_init_element, process_init_element): Check for
	INTEGRAL_TYPE_P rather than just for INTEGER_TYPE when
	initializing with string constants.

2004-07-25  Richard Henderson  <rth@redhat.com>

	* c-decl.c (start_function): Set DECL_ARTIFICIAL and DECL_IGNORED_P
	on the RESULT_DECL.
	* cgraphunit.c (cgraph_build_static_cdtor): Likewise.
	* integrate.c (copy_decl_for_inlining): Copy DECL_ARTIFICIAL and
	DECL_IGNORED_P to new decl.

2004-07-24  Zack Weinberg  <zack@codesourcery.com>

	* config/ia64/ia64.c (general_xfmode_operand)
	(destination_xfmode_operand): Delete.
	* config/ia64/ia64.h (PREDICATE_CODES): Remove them.
	* config/ia64/ia64.md (*movxf_internal): Use general_operand
	and destination_operand.

2004-07-24  Alexander Kabaev  <kan@freebsd.org>

	* config/ia64/ia64.h (SUBTARGET_EXTRA_SPECS): Default to nothing.
	(EXTRA_SPECS): Use SUBTARGET_EXTRA_SPECS.

2004-07-24  Alexander Kabaev  <kan@freebsd.org>
	    Zack Weinberg  <zack@codesourcery.com

	PR 16684
	* c-decl.c (diagnose_mismatched_decls): Don't issue a
	redundant-declaration warning the first time a builtin is
	declared explicitly.

2004-07-25  Bernardo Innocenti  <bernie@develer.com>

	* tree.h (staticp): Change return type to bool.

2004-07-25  Bernardo Innocenti  <bernie@develer.com>

	* c-common.c (c_staticp): Last episode of the staticp saga.

2004-07-25  Bernardo Innocenti  <bernie@develer.com>

	* c-common.h (c_staticp): Change return type from int to bool.
	* tree.c (staticp): Likewise.
	* langhooks.h (staticp): Likewise.

2004-07-25  Bernardo Innocenti  <bernie@develer.com>

	* langhooks-def.h (lhd_staticp): Change return type from int to
	bool in prototype to match definition.

2004-07-25  Bernardo Innocenti  <bernie@develer.com>

	* system.h (bool, true, false): Don't redefine as preprocessor macros
	in C++.

2004-07-24  Roger Sayle  <roger@eyesopen.com>

	* expmed.c (init_expmed): A signed modulus by a power of two is
	considered cheap if its less than or equal to four instructions.

2004-07-25  Bernardo Innocenti  <bernie@develer.com>

	* ggc.h (GGC_NEW, GGC_CNEW, GGC_NEWVEC, GGC_CNEWVEC, GGC_NEWVAR,
	GGC_CNEWVAR): New macros.

2004-07-25  Bernardo Innocenti  <bernie@develer.com>

	* c-common.c: Convert ATTRIBUTE_UNUSED to ARG_UNUSED in parameter
	lists.
	* c-decl.c: Likewise.
	* c-format.c: Likewise.
	* c-lex.c: Likewise.
	* c-opts.c: Likewise.
	* c-pragma.c: Likewise.
	* c-typeck.c: Likewise.
	* gencheck.c: Likewise.
	* genconditions.c: Likewise.
	* genconfig.c: Likewise.
	* genflags.c: Likewise.
	* gengtype.c: Likewise.
	* gensupport.c: Likewise.
	* ggc-none.c: Likewise.
	* langhooks.c: Likewise.
	* statistics.h: Likewise.
	* stub-objc.c: Likewise.
	* java/decl.c: Likewise.

2004-07-24  Roman Zippel  <zippel@linux-m68k.org>

	* config/m68k/m68k.c (output_scc_di): Fix coding style.
	(symbolic_operand): Fix prototype.
	* config/m68k/m68k.h (PREDICATE_CODES): Add symbolic_operand.
	* config/m68k/m68k.md: Add constants for registers a0 and sp and
	use them, change from the "{...}" syntax to the simpler {...}
	syntax.
	(*cfv4_extendqisi2): Fix destination predicate.
	* config/m68k/m68k-protos.h: Remove various declarations also
	generated via PREDICATE_CODES.

2004-07-23  Mike Stump  <mrs@apple.com>

	* c-typeck.c (convert_for_assignment): Tightened up pointer
	converstions that differ in signedness.

2004-07-23  Zack Weinberg  <zack@codesourcery.com>

	* genmodes.c (make_vector_modes): Mark with ATTRIBUTE_UNUSED.

2004-07-23  Richard Kenner  <kenner@vlsi1.ultra.nyu.edu>

	* tree.def (VIEW_CONVERT_EXPR): Change to class 'r'.
	* tree-ssa-operands.c (get_expr_operands, case VIEW_CONVERT_EXPR): New.

	* gimplify.c (gimplify_compound_lval): Check for no handled
	operations, rather than checking for explicit list of nodes.
	(is_gimple_addr_expr_arg_or_indirect): New function.
	(gimplify_addr_expr): Call it and handle INDIRECT_REF; remove
	redundant setting of TREE_INVARIANT.
	(gimplify_expr, case VIEW_CONVERT_EXPR): Call gimplify_compound_lval.
	* tree-gimple.c (is_gimple_addr_expr_arg): Call handled_component_p.

2004-07-23  Diego Novillo  <dnovillo@redhat.com>

	PR tree-optimization/16688
	PR tree-optimization/16689
	* tree-ssa-alias.c (setup_pointers_and_addressables): Remove
	unnecessary initialization of 'tag'.
	(get_tmt_for): Check that the new type tag has the same alias
	set as the pointed-to type.
	(group_aliases): Only regular variables need to be removed
	from the alias set of a name tag.
	* tree-ssa-copy.c (may_propagate_copy): Do not allow copy
	propagation if the two types are not compatible.
	(merge_alias_info): Rename from replace_ssa_names_ann.
	Add more checking.
	(replace_exp_1): If both arguments are SSA_NAMEs, check that
	the propagation can be done.
	Only call merge_alias_info on pointers.
	(propagate_value): Likewise.
	* tree-ssa-copyrename.c: Include langhooks.h.
	(copy_rename_partition_coalesce): Call replace_ssa_name_symbol
	to do the merging.
	Do not coalesce variables with incompatible types.
	(rename_ssa_copies): Call replace_ssa_name_symbol.
	* tree-ssa.c (verify_ssa_name): Verify that the SSA_NAME has
	the same type as the underlying _DECL.
	* tree-ssanames.c (replace_ssa_name_symbol): New function.
	* tree.h (replace_ssa_name_symbol): Declare.

2004-07-23  Richard Henderson  <rth@redhat.com>

	PR c++/16277
	* gimplify.c (gimplify_cond_expr): Gimplify TARGET to a min_lval;
	unshare it properly.
	(gimplify_modify_expr_rhs): Push assignment from a conditional into
	the conditional for all non-register types.

2004-07-23  Richard Henderson  <rth@redhat.com>

	* expr.c (expand_expr_real_1): Don't handle non-local variables.
	* expr.h (fix_lexical_addr): Remove.
	* function.c (NEED_SEPARATE_AP): Remove.
	(fix_lexical_addr): Remove.
	* tree-alias-common.c (get_alias_var_decl): Check TREE_STATIC,
	not null decl_function_context.
	(create_alias_vars): Likewise.
	* tree-cfg.c (make_ctrl_stmt_edges): Don't check for non-local labels.
	(simple_goto_p): Likewise.
	* tree-dfa.c (add_referenced_var): Don't check for non-local variables.
	* tree-ssa-ccp.c (get_default_value): Likewise.
	* tree-tailcall.c (suitable_for_tail_opt_p): Likewise.
	* tree.c (needs_to_live_in_memory): Likewise.
	* tree-flow-inline.h (may_be_aliased): Move...
	* tree-ssa-alias.c (may_be_aliased): ... here.  Enhance check for
	when TREE_STATIC variables may be addressable.

2004-07-24  Jakub Jelinek  <jakub@redhat.com>

	* Makefile.in (site.exp): Add HOSTCC and HOSTCFLAGS to site.exp.

2004-07-23  Zack Weinberg  <zack@codesourcery.com>

	* print-rtl.c (print_rtx <case 'b'>): Don't attempt to print
	bitmap contents if GENERATOR_FILE is defined.
	* Makefile.in (BUILD_RTL): Remove $(BUILD_PREFIX)bitmap.o.
	($(BUILD_PREFIX_1)bitmap.o): Delete rule.

2004-07-23  Joseph S. Myers  <jsm@polyomino.org.uk>

	* c-decl.c (start_function): Form composite type of function types
	rather than copying type from previous prototype declaration.

2004-07-23  Janis Johnson  <janis187@us.ibm.com>

	* config/rs6000/altivec.h (vec_lvewx, vec_lvehx, vec_lvwbx): Remove
	the const qualifier for the second argument in the C++ functions.

	* config/rs6000/altivec.h (vec_stvewx, vec_stvehx, vec_stvebx): Use
	specific pointer types.

	* config/rs6000/altivec.h (vec_vadduwm): (vec_vadduwm, vec_vadduhm,
	vec_vaddubm, vec_vsubuwm, vec_vsubuhm, vec_vsububm): Fix types used
	for vector bool and/or vector pixel, add C++ and C missing support.
	(vec_vaddsws, vec_vaddshs, vec_vaddsbs, vec_vmaxsw, vec_vmaxsh,
	vec_vmaxsb, vec_vmrghw, vec_vmrghh, vec_vmrghb, vec_vmrglw, vec_vmrglh,
	vec_vmrglb, vec_vminsw, vec_vminsh, vec_vminsb, vec_vpkuwum,
	vec_vpkuhum, vec_vspltw, vec_vsplth, vec_vspltb, vec_vsubsws,
	vec_vsubshs, vec_vsubsbs, vec_vupklsh, vec_vupkhsh, vec_vupklsb): Add
	missing C++ and C support for vector bool and/or vector pixel.
	(vec_vadduws, vec_vadduhs, vec_vaddubs, vec_vcmpeqfp, vec_vcmpequw,
	vec_vcmpequh, vec_vcmpequb, vec_vcmpgtfp, vec_vcmpgtsw, vec_vcmpgtuw,
	vec_vcmpgtsh, vec_vcmpgtuh, vec_vcmpgtsb, vec_vcmpgtub, vec_vmaxuw,
	vec_vmaxuh, vec_vmaxub, vec_vminuw, vec_vminuh, vec_vminub,
	vec_vsubuws, vec_vsubuhs, vec_vsububs, vec_vupkhpx, vec_vupklpx): Fix
	C++ and C types used for vector bool and/or vector pixel.
	(vec_st, vec_stl): Add C++ support for vector pixel.
	(vec_unpackh, vec_unpackl, vec_any_ge): Fix C++ support for vector bool.
	(vec_all_ne): Add C++ support for vector pixel.

	* config/rs6000/altivec.h (vec_vcmpgtsh): Fix C++ function name.
	(vec_vmulesb): Add missing C++ function.
	(vec_perm): Fix type of third argument in C++ function.
	(vec_vsum4shs): Fix C++ function name.
	(vec_any_ge): Remove C++ functions for unsupported arg combinations.
	(vec_vcmpgtsw, vec_vcmpgtuw, vec_minsb, vec_vmsummbm): Fix the
	argument passed to the error handler in C macro.
	(vec_nmsub): Remove extra parens around argument names in C macro.
	(vec_packpx): Add missing parens in C macro.

2004-07-22  Paolo Bonzini  <bonzini@gnu.org>

	* machmode.def: Remove vector modes.
	* config/alpha/alpha-modes.def: Add supported vector modes.
	* config/arm/arm-modes.def: Likewise.
	* config/frv/frv-modes.def: Likewise.
	* config/i386/i386-modes.def: Likewise.
	* config/rs6000/rs6000-modes.def: Likewise.
	* config/sh/sh-modes.def: Likewise.

2004-07-23  Matthias Klose  <doko@debian.org>

	* intl.c (gcc_init_libintl): Use PACKAGE for the text domain.
	* configure.ac: Add AC_DEFINE_UNQUOTED for PACKAGE.
	* config.h: Regenerate.
	* configure: Likewise.

2004-07-22  Mark Mitchell  <mark@codesourcery.com>

	* dwarf2out.c (output_call_frame_info): Set SYMBOL_FLAG_LOCAL on
	generated SYMBOL_REFs for labels.
	* config/darwin-protos.h (machopic_validate_stub_or_non_lazy_ptr):
	Change prototype.
	(machopic_stub_name): Remove.
	(machopic_indirection_name): New function.
	(machopic_mcount_stub_name): Likewise.
	(machopic_classify_name): Remove.
	(machopic_function_base_sym): New function.
	(machpoic_classify_symbol): Likewise.
	(machopic_classify_ident): Remove.
	(machopic_define_ident): Likewise.
	(machopic_define_name): Likewise.
	(machopic_name_defined_p): Likewise.
	(machopic_ident_defined_p): Likewise.
	(darwin_strip_name_encoding): Likewise.
	(machopic_define_symbol): New function.
	* config/darwin.c (hashtab.h): Include.
	(machopic_defined_list): Remove.
	(machopic_classify_ident): Likewise.
	(machopic_classify_name): Likewise.
	(machopic_ident_defined_p): Likewise.
	(machopic_define_ident): Likewise.
	(machopic_define_name): Likewise.
	(machopic_symbol_defined_p): New function.
	(machopic_classify_symbol): Likewise.
	(machopic_data_defined_p): Use machopic_classify_symbol.
	(machopic_define_symbol): New function.
	(machopic_function_base_sym): New function.
	(machopic_non_lazy_pointers): Remove.
	(machopic_non_lazy_ptr_name): Likewise.
	(machopic_stubs): Likewise.
	(machopic_stub_name): Likewise.
	(NON_LAZY_POINTER_SUFFIX): New macro.
	(STUB_SUFFIX): Likewise.
	(machopic_indirection): New structure.
	(machopic_indirections): New variable.
	(machopic_indirection_hash): New function.
	(machopic_indirection_eq): Likewise.
	(machopic_indirection_name): Likewise.
	(machopic_mcount_stub_name): New function.
	(machopic_validate_stub_or_non_lazy_pointer): Reimplement to use
	hash table.
	(machopic_indirect_data_reference): Rework to use new functions.
	(machopic_indirect_call_target): Likewise.
	(machopic_legitimize_pic_address): Likewise.
	(machopic_output_indirection): New function.
	(machopic_finish): Use it.
	(machopic_operand_p): Rework to use new functions.
	(darwin_encode_seciton_info): Use SYMBOL_REF_FLAGS.
	(darwin_strip_name_encoding): Remove.
	(update_non_lazy_ptrs): Remove.
	(update_stubs): Likewise.
	(darwin_non_lazy_pcrel): Use new functions.
	* config/darwin.h (ASM_DECLARE_OBJECT_NAME): Likewise.
	(ASM_OUTPUT_LABELREF): Likewise.
	(ASM_OUTPUT_ALIGNED_DECL_LOCAL): Likewise.
	(MACHO_SYMBOL_FLAG_VARIABLE): New macro.
	(MACHO_SYMBOL_FLAG_DEFINED): Likewise.
	(TARGET_STRIP_NAME_ENCODING): Do not use
	darwin_strip_name_encoding.
	(GEN_LAZY_PTR_NAME_FOR_SYMBOL): Do not use
	darwin_strip_name_encoding.
	* config/i386/darwin.h (FUNCTION_PROFILER): Use
	machopic_mcount_stub_name.
	* config/i386/i386.c (x86_output_mi_thunk): Use
	machopic_indirection_name, not machopic_stub_name.
	* config/rs6000/rs6000.c (rs6000_legitimize_reload_address): Use
	machopic_function_base_sym.
	(print_operand): Use machopic_classify_symbol.
	(rs6000_emit_prologue): Use machopic_function_base_sym.
	(output_profile_hook): Do not use machopic_stub_name.
	(macho_branch_isalnds): Do not use darwin_strip_name_encoding.

2004-07-22  Joseph S. Myers  <jsm@polyomino.org.uk>

	PR c/7284
	* fold-const.c (extract_muldiv_1): Do not treat signed left shift
	as multiplication.

2004-07-22  Joseph S. Myers  <jsm@polyomino.org.uk>

	* doc/implement-c.texi: New file.
	* doc/extend.texi (C Implementation): Move to there.
	* doc/gcc.texi: Include implement-c.texi.
	* Makefile.in (TEXI_GCC_FILES): Add implement-c.texi.

2004-07-22  Jason Merrill  <jason@redhat.com>

	* integrate.c (copy_decl_for_inlining): Remove invisible reference
	handling.
	* tree-inline.c (setup_one_parameter): Likewise.

2004-07-22  Brian Booth  <bbooth@redhat.com>

	* tree-ssa-ccp.c (latticevalue): Add UNKNOWN_VAL.
	(substitute_and_fold): Propigate into VUSE operands when possible.
	(visit_phi_node): Handle UNKNOWN_VAL latticevalue.
	(cp_lattice_meet): Handle merging of latticevalues when
	UNKNOWN_VAL is present.
	(visit_stmt): Visit assignments with V_MUST_DEFs.
	(visit_assignment): Gather ccp information for V_MUST_DEF operands.
	(ccp_fold): Deal with RHS' that are constant and virtual.
	(evaluate_stmt): Handle UNKNOWN_VAL likely values.
	(dump_lattice_value): Dump UNKNOWN_VAL latticevalues.
	(initialize): Mark statements with V_MUST_DEFs as VARYING only if the
	V_MUST_DEF operand is VARYING. Fix comment and include VOPS when
	computing immediate uses.
	(set_lattice_value): Disallow a UNKNOWN_VAL->UNDEFINED state
	transition.
	(replace_vuse_in): New function.
	(likely_value): Add check of vuse operands.
	(get_default_value): Set the default value of virtually defined
	variables to UKNOWN_VAL instead of VARYING.

2004-07-22  Richard Henderson  <rth@redhat.com>

	* expr.c (emit_push_insn): Don't use set_mem_attributes.

2004-07-22  Richard Henderson  <rth@redhat.com>

	* tree-ssa-live.c (create_ssa_var_map): Avoid defined-but-not-used
	variables due to conditional compilation.

2004-07-22  Diego Novillo  <dnovillo@redhat.com>

	* tree-into-ssa.c (set_livein_block): Fix typo in comment.
	(rewrite_ssa_into_ssa): Start iterating over SSA names at 1.
	Release SSA names that have been re-renamed.
	* tree-phinodes.c (make_phi_node): Set same TREE_TYPE as the
	variable.
	* tree-ssa-alias.c (init_alias_info): If aliases have been
	computed before, clear existing alias information.
	(create_name_tags): Do no fixup PT_ANYTHING pointers.
	If the new name tag for a pointer is different than the one it
	had before, mark the old tag for renaming.
	(replace_may_alias): New function.
	(group_aliases): Call it.
	(setup_pointers_and_addressables): Always call get_tmt_for.
	(maybe_create_global_var): Don't create .GLOBAL_VAR more than
	once.
	(set_pt_anything): New local function.
	(set_pt_malloc): New local function.
	(merge_pointed_to_info): Don't merge pointed-to variables from
	the original pointer if the destination is pointing to an
	unknown location.
	(add_pointed_to_expr): Call set_pt_anything and set_pt_malloc.
	(add_pointed_to_var): Do not add a variable to the points-to
	set if the pointer is already pointing to anywhere.
	(collect_points_to_info_r): If the defining statement is a PHI
	node, only merge pointed-to information if the argument has
	already been visited.
	(get_tmt_for): Only create a new tag if the pointer didn't
	have one already.
	(dump_alias_info): Emit more information.
	(dump_points_to_info_for): Likewise.
	* tree-ssa-dom.c (redirect_edges_and_update_ssa_graph): Don't
	try to get the annotation of an SSA_NAME.
	* tree-ssa-operands.c (add_stmt_operand): Only check for empty
	alias sets when checking is enabled.
	* tree-ssa-pre.c (need_eh_cleanup): New local variable.
	(eliminate): Mark basic blocks that will need
	EH information cleaned up.
	(init_pre): Split ENTRY_BLOCK->0 if block 0 has more than one
	predecessor.
	Initialize need_eh_cleanup.
	(fini_pre): Call tree_purge_all_dead_eh_edges and
	cleanup_tree_cfg if needed.
	Free need_eh_cleanup.
	* tree-ssa.c (verify_ssa_name): New function.
	(verify_def): Call it.
	Re-arrange to avoid printing too many error messages.
	(verify_use): Likewise.
	(verify_phi_args): Likewise.
	(verify_flow_insensitive_alias_info): New function.
	(verify_flow_sensitive_alias_info): New function.
	(verify_alias_info): New function.
	(verify_ssa): Call verify_alias_info.
	Clear TREE_VISITED on all the SSA_NAMEs before scanning the
	program.
	Re-arrange to avoid printing too many error messages.
	* tree-ssanames.c (make_ssa_name): Clear
	SSA_NAME_IN_FREE_LIST.
	(release_ssa_name): Never release a default definition.
	(release_defs): New function.
	* tree.h: Declare it.
	* tree-ssa-dce.c (remove_dead_stmt): Call it.

2004-07-22  Diego Novillo  <dnovillo@redhat.com>

	* tree-ssa.c (walk_use_def_chains_1): Add new argument IS_DFS.
	If true, do a depth-first search.  Do a breadht-first search,
	otherwise.
	(walk_use_def_chains): Add new argument IS_DFS.
	Update all users.
	* tree-flow.h (walk_use_def_chains): Update prototype.

2004-07-22  Hans-Peter Nilsson  <hp@axis.com>

	* config/cris/cris.md: Tweak formatting.
	(asrandb, asrandw, lsrandb, lsrandw, moversideqi, movemsideqi)
	(mover2side, moverside, movemside, movei, op3, andu): Replace
	live define_peephole:s with define_peephole2 near-equivalents.
	Delete the rest.
	("*mov_sidesisf_biap"): Rename from "*mov_sidesi_biap".  Match all
	word-size modes.
	("*mov_sidesisf", "*mov_sidesisf_biap_mem", "*mov_sidesisf_mem"):
	Similar for "*mov_sidesi", "*mov_sidesi_biap_mem" and
	"*mov_sidesi_mem" respectively.

2004-07-22  Paolo Bonzini  <bonzini@gnu.org>

	* tree-cfg.c (gimplify_val): Move from tree-complex.c.
	(gimplify_build1): Move from tree-complex.c do_unop.
	(gimplify_build2): Move from tree-complex.c do_binop.
	(gimplify_build3): New.
	* tree-complex.c (gimplify_val, do_unop, do_binop): Remove.
	Adjust throughout to call the functions above.
	* tree-flow.h: Declare the functions above.
	* tree-nested.c (gimplify_val): Rename to...
	(tsi_gimplify_val): ... this.

	* Makefile.in (tree_complex.o): Update dependencies.
	(stor-layout.o): Depend on regs.h.
	* c-common.c (handle_vector_size_attribute): Update for
	vector types without corresponding vector modes.
	* expr.c (expand_expr): Treat VECTOR_CST's like CONSTRUCTORS if
	a corresponding vector mode is not available.
	* print-tree.c (print_node): Print nunits for vector types
	* regclass.c (have_regs_of_mode): New.
	(init_reg_sets_1): Initialize it and use it instead
	of allocatable_regs_of_mode.
	* regs.h (have_regs_of_mode): Declare it.
	* stor-layout.c (layout_type): Pick a mode for vector types.
	* tree-complex.c (build_word_mode_vector_type, tree_vec_extract,
	build_replicated_const, do_unop, do_binop, do_plus_minus,
	do_negate, expand_vector_piecewise, expand_vector_parallel,
	expand_vector_addition, expand_vector_operations_1,
	expand_vector_operations, tree_lower_operations,
	pass_lower_vector_ssa, pass_pre_expand): New.
	(expand_complex_operations, pass_lower_complex): Remove.
	* tree-optimize.c (init_tree_optimization_passes): Adjust
	pass ordering for changes in tree-complex.c.
	* tree-pass.h: Declare new passes.
	* tree.c (finish_vector_type): Remove.
	(make_vector_type): New.
	(build_vector_type_for_mode, build_vector_type): Rewritten.
	* tree.def (VECTOR_TYPE): Document where the number of
	subparts is stored.
	* tree.h (TYPE_VECTOR_SUBPARTS): Use TYPE_PRECISION field.
	(make_vector): Remove declaration.

2004-07-21  Richard Henderson  <rth@redhat.com>

	* gimple-low.c (expand_var_p): Don't look at TREE_ADDRESSABLE,
	TREE_THIS_VOLATILE, may_aliases, or optimization level.
	(remove_useless_vars): Dump debugging info.
	(expand_used_vars): Move ...
	* cfgexpand.c (expand_used_vars): ... here.  Make static.
	* tree-flow-inline.h (set_is_used): New.
	(set_default_def): Use get_var_ann.
	* tree-flow.h: Update decls.
	* tree-ssa-live.c (mark_all_vars_used_1, mark_all_vars_used): New.
	(create_ssa_var_map): Use it.
	* tree-ssa.c (set_is_used): Remove.

2004-07-22  Ben Elliston  <bje@au.ibm.com>

	* gdbinit.in: Set a breakpoint on internal_error.

2004-07-21  Richard Henderson  <rth@redhat.com>

	* cfgexpand.c (expand_gimple_tailcall): Fix case where we need
	to create a new basic block.

2004-07-22  Joseph S. Myers  <jsm@polyomino.org.uk>

	PR c/15052
	* c-decl.c (grokdeclarator): Only pedwarn for qualified void
	return type on function definitions.  Move other warnings for
	qualified return type to -Wreturn-type.  Do not condition any such
	warnings on -pedantic.  Update comments.
	(start_function): Only copy function type from previous prototype
	declaration if return types are compatible.
	* c-typeck.c (function_types_compatible_p): Don't condition
	warning for incompatibility of volatile qualifiers on the return
	type on -pedantic.  Update comment.
	* doc/invoke.texi (-Wreturn-type, -Wextra): Update.

2004-07-22  Joseph S. Myers  <jsm@polyomino.org.uk>

	* c-typeck.c (set_init_index): Require designator to be of integer
	type.

2004-07-22  Joseph S. Myers  <jsm@polyomino.org.uk>

	PR c/11250
	* c-parse.in (init): Change to exprtype.
	(primary): Set original_code for STRING to STRING_CST.
	Call maybe_warn_string_init for compound literals.
	(initdcl, notype_initdcl): Call maybe_warn_string_init.
	(initval): Update.
	* c-tree.h (maybe_warn_string_init): New.
	(pop_init_level, process_init_element): Use struct c_expr.
	(struct c_expr): Update comment.
	* c-typeck.c (maybe_warn_string_init): New function.
	(digest_init): Call it.  Additional parameter strict_string.  All
	callers changed.
	(output_init_element): Likewise.
	(struct constructor_stack): Use struct c_expr for
	replacement_value.
	(really_start_incremental_init, push_init_level): Update.
	(pop_init_level): Update.  Return struct c_expr.
	(process_init_level): Update.  Take struct c_expr argument.

2004-07-21  David S. Miller  <davem@nuts.davemloft.net>

	* config/sparc/sparc.c (sparc_rtx_costs): Fix typo in previous
	commit.

2004-07-21  Eric Christopher  <echristo@redhat.com>

	* builtins.c (expand_builtin_setjmp_receiver): Fix comment for code
	removal.
	* c-decl.c (pop_scope): Ditto.
	* calls.c (expand_call): Remove call to current_nesting_level,
	update comment accordingly. Remove calls to expand_start_target_temps
	and expand_end_target_temps.
	* cfgexpand.c (construct_init_block): Remove call to
	expand_start_bindings_and_block.
	(construct_exit_block): Remove call to expand_end_bindings.
	* expr.c (safe_from_p): Remove BIND_EXPR handling.
	(expand_expr_real_1): Ditto. Fix formatting.
	(expand_vars): Delete.
	* stmt.c (POPSTACK): Remove block_stack.
	(stmt_status): Remove x_block_stack.
	(block_stack): Delete.
	(expand_start_bindings_and_block): Ditto.
	(expand_start_target_temps): Ditto.
	(expand_end_target_temps): Ditto.
	(current_nesting_level): Ditto.
	(warn_about_unused_variables): Ditto.
	(expand_end_bindings): Ditto.
	* tree.h: Remove declarations for above.

2004-07-21  Steven Bosscher  <stevenb@suse.de>

	* rtl.h (insn_note): Remove NOTE_INSN_PREDICTION.
	* rtl.c (note_insn_name): Likewise.
	* print-rtl.c (print_rtx): Don't print it.
	* cfgrtl.h (can_delete_note_p): Don't handle it.
	(rtl_delete_block): Likewise.
	* passes.c (rest_of_handle_guess_branch_prob): Remove.
	(rest_of_compilation): Don't call it.
	* predict.c (process_note_predictions, process_note_prediction,
	note_prediction_to_br_prob): Remove.
	* basic-block.c (note_prediction_to_br_prob): Remove prototype.
	* stmt.c (return_prediction): Remove.
	(expand_value_return): Don't call it.  Don't add prediction
	notes for return statements.

2004-07-21  Josef Zlomek  <zlomekj@suse.cz>

	* var-tracking.c (vt_find_locations): Set the in_pending bitmap at
	once.

2004-07-21  Paolo Bonzini  <bonzini@gnu.org>

	* c-common.c (vector_types_convertible_p): Use vector types'
	TYPE_SIZE and TREE_TYPE instead of their mode.
	* convert.c (convert_to_integer): Likewise.
	(convert_to_vector): Likewise.
	* fold-const.c (fold_convert): Likewise.
	* varasm.c (output_constant): Likewise.
	* expr.c (store_constructor): Split ARRAY_TYPE and VECTOR_TYPE.
	Allow a VECTOR_TYPE initializer to be made of several vectors.
	For ARRAY_TYPEs and VECTOR_TYPES, simplify a bit the handling
	of cleared and need_to_clear, and use fold_convert.
	* c-typeck.c (build_binary_op): Do not use RDIV_EXPR for
	integer vectors.

2004-07-20  Richard Henderson  <rth@redhat.com>

	* cfgexpand.c (expand_gimple_cond_expr, expand_gimple_tailcall): Split,
	(expand_gimple_basic_block): out from here.  Renamed from expand_block.

2004-07-20  David S. Miller  <davem@nuts.davemloft.net>

	* config/sparc/sparc.c (sparc_rtx_costs case MULT): Emit
	enormous cost if not TARGET_HARD_MUL.

2004-07-20  Andrew Pinski  <apinski@apple.com>

	PR target/16557
	* config/i386/darwin.h (CC1_SPEC): Move the -g SPECs from ...
	(ASM_SPEC): here.

2004-07-21  Paul brook  <paul@codesourcery.com>

	* config/arm/arm.c (thumb_expand_prologue): Remove bogus GEN_INT.

2004-07-20  Richard Kenner  <kenner@vlsi1.ultra.nyu.edu>

	* fold-const.c (operand_equal_p): Temporarily support NULL args.
	(operand_equal_p, case ARRAY_REF): Compare args 2 and 3.
	(operand_equal_p, case COMPONENT_REF): Likewise, for arg 2.

2004-07-20  Zack Weinberg  <zack@codesourcery.com>

	* rtl.h (plus_constant): Delete.
	(plus_constant_wide): Rename to plus_constant.
	(plus_constant_for_output_wide): Delete vestigial prototype.
	(GEN_INT): Remove unnecessary cast.
	* tree.h (build_int_2, size_int_type): Delete.
	(build_int_2_wide): Rename to build_int_2.
	(size_int_wide): Rename to size_int_kind.
	(size_int_type_wide): Rename to size_int_type.
	(size_int, ssize_int, bitsize_int, sbitsize_int): Use size_int_kind.
	Remove unnecessary cast.
	* tree.c (build_int_2_wide): Rename build_int_2; update comment.
	* explow.c (plus_constant_wide): Rename plus_constant; update comment.
	* fold-const.c (size_int_wide): Rename size_int_kind. Use size_int_type.
	(size_int_type_wide): Rename size_int_type.
	(int_const_binop): Use size_int_type.
	* c-lex.c (interpret_integer): Use build_int_2.
	* final.c (split_double): Remove unnecessary casts.
	* tree-ssa-ccp.c (maybe_fold_offset_to_array_ref): Use build_int_2.

2004-07-20  Richard Henderson  <rth@redhat.com>

	* gimplify.c (is_gimple_tmp_var): Move to tree-gimple.c.
	(gimplify_compound_lval): Use is_gimple_tmp_reg.
	* tree-gimple.c (is_gimple_tmp_var): Move from gimplify.c.
	(is_gimple_tmp_reg): New.
	* tree-gimple.h (is_gimple_tmp_reg): Declare.

2004-07-20  Richard Henderson  <rth@redhat.com>

	* tree-pretty-print.c (dump_generic_node): Dump
	CALL_EXPR_HAS_RETURN_SLOT_ADDR.

2004-07-20  Frank Ch. Eigler  <fche@redhat.com>

	* tree-mudflap.c (mf_set_options_fndecl): New tree.
	(mudflap_init): Set it.
	(mudflap_register_call): Remove __mf_init call.
	(mudflap_finish_file): Emit call to __mf_init here.  Emit a call to
	to pass "-ignore-reads" option to libmudflap if needed.

2004-07-20  John David Anglin  <dava.anglin@nrc-cnrc.gc.ca>

	PR c++/14607
	* config/pa/pa-hpux10.h (SUPPORTS_ONE_ONLY): Define.
	(MAKE_DECL_ONE_ONLY): Undefine.
	* pa-protos.h (som_text_section_asm_op, one_only_readonly_data_section,
	readonly_data, one_only_data_section, forget_section): New prototypes.
	* pa.c (pa_init_machine_status, som_text_section_asm_op): New
	functions.
	(pa_select_section): Add one-only (COMDAT) support.
	* pa.h (struct machine_function): Define.
	* som.h (ASM_OUTPUT_FUNCTION_PREFIX): Delete.
	(TEXT_SECTION_ASM_OP): Call som_text_section_asm_op.
	(DEFAULT_TEXT_SECTION_ASM_OP, NEW_TEXT_SECTION_ASM_OP,
	ONE_ONLY_TEXT_SECTION_ASM_OP, ONE_ONLY_READONLY_DATA_SECTION_ASM_OP,
	ONE_ONLY_DATA_SECTION_ASM_OP): New defines.
	(EXTRA_SECTIONS): Add in_one_only_readonly_data and in_one_only_data.
	(EXTRA_SECTION_FUNCTIONS): Rework to use individual function macros.
	(READONLY_DATA_FUNCTION, ONE_ONLY_READONLY_DATA_SECTION_FUNCTION,
	ONE_ONLY_DATA_SECTION_FUNCTION, FORGET_SECTION_FUNCTION): New defines
	for EXTRA_SECTION_FUNCTIONS.
	* doc/install.texi: Update binutils requirements.

2004-07-20  Nathan Sidwell  <nathan@codesourcery.com>

	* vec.h (VEC_T_length, VEC_T_index, VEC_T_iterate, VEC_T_truncate,
	VEC_T_replace, VEC_T_quick_insert, VEC_T_safe_insert,
	VEC_T_ordered_remove, VEC_T_unordered_remove): Use unsigned, not
	size_t.
	(struct VEC): Use unsigned for num and alloc.
	* vec.c (struct vec_prefix): Likewise.
	(vec_o_reserve): Adjust.

	* dbxout.c (dbxout_type): Fix printf format.

	* tree.h (binfo_member): Remove.
	* tree.c (binfo_member): Remove.

2004-07-20  Nathan Sidwell  <nathan@codesourcery.com>

	* tree.h: Include vec.h
	(DEF_VEC_P(tree)): New type.
	(BINFO_BASE_BINFOS, BINFO_N_BASE_BINFOS, BINFO_BASE_BINFO): Adjust.
	(BINFO_BASE_APPEND, BINFO_BASE_ITERATE): New.
	(BINFO_LANG_SLOT): Remove.
	(BINFO_SUBVTT_INDEX, BINFO_VPTR_INDEX, BINFO_PRIMARY_BASE_OF): New.
	(struct tree_binfo): Turn base_binfos into a trailing
	VEC(tree). Add vtt_subvtt, vtt_vptr, primary fields.
	(binfo_lang_slots): Remove.
	* tree.c (binfo_lang_slots): Remove.
	(make_tree_binfo_stat): Take a base binfo count, not a
	lang slot count.  Adjust.
	* Makefile.in (TREE_H): Add vec.h
	* alias.c (record_component_aliases): Adjust BINFO access.
	* dbxout.c (dbxout_type): Likewise.
	* dwarf2out.c (gen_member_die): Likewise.
	* sdbout.c (sdbout_one_type): Likewise.
	* tree-dump.c (deque_and_dump): Likewise.
	* config/i386/i386.c (classify_argument,
	contains_128bit_aligned_vector_p): Likewise.
	* config/sh/symbian.c (symbian_export_vtable_and_rtti_p): Likewise.
	* doc/c-tree.texi (Classes): Update BINFO documentation.

2004-07-20  Steven Bosscher  <stevenb@suse.de>

	* c-common.h (check_case_value): Remove prototype.
	(c_add_case_label): Adjust prototype.
	* c-common.c (check_case_value): Make static.
	(check_case_bounds): New function.
	(c_add_case_label): Use it.  Take new argument orig_type.
	* c-typeck.c (struct c_switch): New orig_type field.
	(c_start_case): Set it.
	(do_case): Pass it to c_add_case_label.
	* expr.c (expand_expr_real_1): Don't warn for out-of-bounds
	cases from here.  Add the labels in reverse order.
	* stmt.c (struct case_node): Adjust comment.  Remove balance field.
	(add_case_node): Return nothing, don't check for duplicate cases.
	Insert new case nodes in a list, not in an AVL tree.
	(expand_end_case_type): Don't turn a case tree into a case list.
	(case_tree2list): Remove.
	* tree.h (add_case_node): Adjust prototype.

2004-07-19  Paolo Bonzini  <bonzini@gnu.org>

	* genattr.c (struct range, struct function_unit,
	write_units, extend_range, init_range): Remove them.
	(main): Remove code dealing with DEFINE_FUNCTION_UNIT.
	Output "#define INSN_SCHEDULING" here.
	* genattrtab.c (struct range, struct function_unit_op,
	struct function_unit, struct dimension, enum operator,
	operate_exp, expand_units, simplify_knowing,
	encode_units_mask, simplify_by_exploding,
	find_and_mark_used_attributes, unmark_used_attributes,
	add_values_to_cover, increment_current_value,
	test_for_current_value, simplify_with_current_value,
	simplify_with_current_value_aux, gen_unit,
	write_unit_name, write_function_unit_info,
	write_complex_function, write_toplevel_expr,
	find_single_value, extend_range): Remove.
	(write_attr_get): Do not handle common_av->value
	being an FFS.
	(struct attr_desc): Remove func_units_p and blockage_p.
	(write_attr_valueq): Do not handle them.
	(find_attr): Do not clear them.
	(make_internal_attr): Do not initialize them.
	(main): Remove code dealing with DEFINE_FUNCTION_UNIT.
	* sched-vis.c (init_target_units, insn_print_units,
	init_block_visualization, print_block_visualization,
	visualize_scheduled_insns, visualize_no_unit,
	visualize_stall_cycles, visualize_alloc,
	visualize_free, target_units, get_visual_tbl_length,
	MAX_VISUAL_LINES, INSN_LEN, n_visual_lines,
	visual_tbl_line_length, visual_tbl, n_vis_no_unit,
	MAX_VISUAL_NO_UNIT, vis_no_unit): Remove.
	* haifa-sched.c (blockage_range, clear_units,
	schedule_unit, actual_hazard, potential_hazard,
	insn_unit, unit_last_insn, unit_tick,
	actual_hazard_this_instance, potential_hazard,
	schedule_unit, max_insn_queue_index_value): Remove.
	(MAX_INSN_QUEUE_INDEX): Removed, renamed throughout to
	max_insn_queue_index.
	* rtl.def (DEFINE_FUNCTION_UNIT): Remove.
	* doc/md.texi (Processor pipeline description): Remove
	references to old pipeline descriptions.
	(Automaton pipeline description): Merge with the above.
	(Old pipeline description, Comparison of the two descriptions):
	Remove.

	* bt-load.c (migrate_btr_def): Remove references to
	use_pipeline_interface.
	* haifa-sched.c (insn_cost, schedule_insn,
	schedule_block, advance_one_cycle, sched_init,
	queue_to_ready, sched_finish): Likewise.
	* modulo-sched.c (sms_schedule, advance_one_cycle,
	ps_has_conflicts): Likewise.
	* sched-rgn.c (init_ready): Likewise.
	(debug_dependencies): Likewise, and remove an "if (1)".
	* target.h (use_dfa_pipeline_interface): Remove.
	* config/alpha/alpha.c (TARGET_USE_DFA_PIPELINE_INTERFACE): Remove.
	* config/arc/arc.c (TARGET_USE_DFA_PIPELINE_INTERFACE): Remove.
	* config/arm/arm.c (TARGET_USE_DFA_PIPELINE_INTERFACE): Remove.
	* config/c4x/c4x.c (TARGET_USE_DFA_PIPELINE_INTERFACE): Remove.
	* config/frv/frv.c (TARGET_USE_DFA_PIPELINE_INTERFACE): Remove.
	* config/i386/i386.c (TARGET_USE_DFA_PIPELINE_INTERFACE): Remove.
	* config/ia64/ia64.c (TARGET_USE_DFA_PIPELINE_INTERFACE): Remove.
	* config/iq2000/iq2000.c (TARGET_USE_DFA_PIPELINE_INTERFACE): Remove.
	* config/m32r/m32r.c (TARGET_USE_DFA_PIPELINE_INTERFACE): Remove.
	* config/mcore/mcore.c (TARGET_USE_DFA_PIPELINE_INTERFACE): Remove.
	* config/mips/mips.c (TARGET_USE_DFA_PIPELINE_INTERFACE): Remove.
	* config/pa/pa.c (TARGET_USE_DFA_PIPELINE_INTERFACE): Remove.
	* config/rs6000/rs6000.c (TARGET_USE_DFA_PIPELINE_INTERFACE): Remove.
	* config/s390/s390.c (TARGET_USE_DFA_PIPELINE_INTERFACE): Remove.
	* config/sh/sh.c (TARGET_USE_DFA_PIPELINE_INTERFACE): Remove.
	* config/sparc/sparc.c (TARGET_USE_DFA_PIPELINE_INTERFACE): Remove.
	* config/v850/v850.c (TARGET_USE_DFA_PIPELINE_INTERFACE): Remove.
	* config/xtensa/xtensa.c (TARGET_USE_DFA_PIPELINE_INTERFACE): Remove.
	* doc/tm.texi (TARGET_USE_DFA_PIPELINE_INTERFACE): Remove.

2004-07-19  Roger Sayle  <roger@eyesopen.com>

	* rtlanal.c (reg_set_p): Add check for regs_invalidated_by_call.

2004-07-19  Jeff Law  <law@redhat.com>

	* tree-ssa-dom.c (single_incoming_edge_ignoring_loop_edges): New.
	(get_eq_expr_value): Use it.  Simplify slightly.

2004-07-19  Maciej W. Rozycki  <macro@linux-mips.org>

	* config/mips/mips.md (mulsidi3_32bit_r4000): Fix the clobber list.
	(umulsidi3_32bit_r4000): Likewise.

2004-07-19  Nathan Sidwell  <nathan@codesourcery.com>

	* vec.h: Propagate location information properly.
	(VEC_T_iterate): Add result pointer parameter.
	(VEC_T_space): New.
	(VEC_T_reserve): Use it.

2004-07-19  Daniel Jacobowitz  <dan@debian.org>

	* Makefile.in (c-format.o): Depend on c-format.h.
	* c-format.h: New file.
	(struct format_char_info): Add CHAIN member.
	* c-format.c: Move some types and constants to c-format.h.
	(format_type_error): Set to -1.
	(struct function_format_info): Use an int for format_type.
	(decode_format_type): Return an int.  Return format_type_error
	on error.
	(print_char_table, asm_fprintf_char_table, gcc_diag_char_table)
	(gcc_diag_char_table, gcc_cdiag_char_table, gcc_cxxdiag_char_table)
	(scan_char_table, time_char_table, monetary_char_table): Initialize
	CHAIN to NULL.
	(n_format_types): New variable.
	(check_format_info_main): Handle CHAIN in format_char_info.
	(handle_format_attribute): Handle TARGET_FORMAT_TYPES and
	TARGET_N_FORMAT_TYPES.
	* config.gcc (i[34567]86-*-solaris2*, sparc64-*-solaris2*)
	(sparc-*-solaris2*): Include config/t-sol2 and config/sol2-c.c.
	* config/sol2-c.c: New file.
	* config/t-sol2: New file.
	* config/sol2.h (TARGET_N_FORMAT_TYPES, TARGET_FORMAT_TYPES): Define.
	* config/sparc/elf.h, config/sparc/sp64-elf.h: Undefine
	TARGET_N_FORMAT_TYPES and TARGET_FORMAT_TYPES.

	* doc/extend.texi (Target Format Checks): New section.
	(Function Attributes): Mention it.
	* doc/invoke.texi: Mention target format checks.
	* doc/sourcebuild.texi: Mention target format checks.
	* dc/tm.texi (Misc): Document TARGET_N_FORMAT_TYPES and
	TARGET_FORMAT_TYPES.

2004-07-19  Andreas Krebbel  <krebbel1@de.ibm.com>

	* config/s390/s390-protos.h (s390_return_address_offset): Prototype
	added.
	* config/s390/s390.c (regclass_map initializer): Register 35 added to
	ADDR_REGS.
	(load_multiple_operation, store_multiple_operation): Removed
	pointless sanity check.
	(s390_decompose_address): Added check for return_address_pointer_rtx.
	(s390_return_addr_rtx): Use return_address_pointer_rtx for count == 0.
	(s390_return_address_offset): New function.
	* config/s390/s390.h (FIRST_PSEUDO_REGISTER): Increased to 36.
	(FRAME_REGNO_P): Added check for register 35.
	(FIXED_REGISTERS, CALL_USED_REGISTERS, CALL_REALLY_USED_REGISTERS,
	REG_ALLOC_ORDER): Appended entry for register 35.
	(REG_CLASS_CONTENTS): Adjusted class masks for register 35.
	(EH_RETURN_HANDLER_RTX): Use return_address_pointer_rtx.
	(RETURN_ADDRESS_POINTER_REGNUM): New macro.
	(ELIMINABLE_REGS, INITIAL_ELIMINATION_OFFSET): Return address pointer
	is eliminable using stack pointer or hard frame pointer.
	(REGISTER_NAMES): Added name for register 35.
	* config/s390/s390.md ("load_multiple", "store_multiple"): Removed
	pointless sanity check.

2004-07-19  Roger Sayle  <roger@eyesopen.com>

	* fold-const.c (tree_expr_nonzero_p): Add function prototype.
	(fold) <EQ_EXPR>: Move tree_expr_nonzero_p optimization from
	fold_relational_const to here, i.e. "(x | 5) == 0" -> false.
	(fold) (UNEQ_EXPR>: Add optimizations for unordered comparisons
	of the form "x op x" where op is UNLE, UNGE, UNEQ or LTGT.
	(fold_relational_const): Tidy up handling of floating point
	comparisons by calling real_compare.  Remove tree_expr_nonzero_p
	transformation; fold_relational_const assumes constant operands.

2004-07-19  Gabriel Dos Reis  <gdr@integrable-solution.net>

	* doc/sourcebuild.texi: Add libcpp, now that CPP has its own
	directory.

2004-07-19  Joseph S. Myers  <jsm@polyomino.org.uk>

	* c-tree.h (struct c_expr): Define.
	(C_SET_EXP_ORIGINAL_CODE): Remove.
	(parser_build_binary_op, build_compound_expr): Update prototypes.
	* c-parse.in (%union): Add exprtype.
	(FUNC_NAME): Mark as ttype.
	(expr, expr_no_commas, cast_expr, unary_expr, primary): Change to
	exprtype.
	(expr): Update.  Define directly in terms of expr_no_commas
	instead of using nonnull_exprlist.
	(nonnull_exprlist, unary_expr, cast_expr, expr_no_commas, primary,
	offsetof_member_designator, typespec_nonreserved_nonattr, init,
	initval, designator, component_declarator,
	component_notype_declarator, enumerator, array_declarator,
	condition, exexpr, switch_statement, stmt_nocomp, stmt,
	nonnull_asm_operands, ivar_declarator, receiver): Update.  Don't
	set C_EXP_ORIGINAL_CODE.  Use TREE_NO_WARNING for assignments
	where appropriate.
	* c-common.h (C_EXP_ORIGINAL_CODE): Remove.
	* c-common.c (c_common_truthvalue_conversion): Don't check
	C_EXP_ORIGINAL_CODE.
	* c-typeck.c (parser_build_binary_op): Use c_expr structures.
	Don't use C_EXP_ORIGINAL_CODE.
	(default_conversion, default_function_array_conversion): Don't use
	C_EXP_ORIGINAL_CODE.  Preserve TREE_NO_WARNING.
	(internal_build_compound_expr): Merge into build_compound_expr.
	(build_compound_expr): Take two operands instead of a TREE_LIST.
	* objc/objc-act.c (get_super_receiver): Update calls to
	build_compound_expr.

2004-07-18  Paolo Bonzini  <bonzini@gnu.org>

	* config/sh/sh.c (sh_use_dfa_interface): Remove.
	(TARGET_SCHED_USE_DFA_PIPELINE_INTERFACE): Set to
	hook_int_void_1.
	* config/sh/sh.md: Extract pipeline descriptions
	into separate files.
	* config/sh/sh1.md: New file, extracted from sh.md.
	* config/sh/sh4.md: New file, extracted from sh.md.
	* config/sh/shmedia.md: New file, extracted from sh.md
	and rewritten using new-style pipeline description.

2004-07-18  Zack Weinberg  <zack@codesourcery.com>

	* config/pa/pa.md: Delete the two remaining define_peephole
	patterns.

2004-07-18  Steven Bosscher  <stevenb@suse.de>
	    Joseph S. Myers  <jsm@polyomino.org.uk>

	* c-common.c (c_common_truthvalue_conversion): Don't warn if
	TREE_NO_WARNING is set.

2004-07-18  Roger Sayle  <roger@eyesopen.com>

	* builtins.c (simplify_builtin_memcmp, simplify_builtin_strcmp,
	simplify_builtin_strncmp): Delete.
	(fold_builtin_memcmp, fold_builtin_strcmp, fold_builtin_strncmp):
	Change argument to accept an arglist instead of an "exp".  Assume
	that the return type is always integer_type_node.  Copy missing
	transformations from their now obsolete simplify_builtin_*
	equivalents.
	(fold_builtin_1): Pass arglist instead of exp to fold_builtin_memcmp,
	fold_builtin_strcmp and fold_builtin_strncmp.
	(simplify_builtin): Call fold_builtin_memcmp, fold_builtin_strcmp
	and fold_builtin_strncmp instead of simplify_builtin_memcmp,
	simplify_builtin_strcmp and simplify_builtin_strncmp respectively.

2004-07-18  Daniel Jacobowitz  <dan@debian.org>

	* Makefile.in (tree-alias-common.o): Update dependencies.

2004-07-17  Sebastian Pop  <pop@cri.ensmp.fr>

	* cfgloop.c (flow_loop_nested_p): Fix comment.

2004-07-17  Jason Merrill  <jason@redhat.com>

	PR c++/16115
	* stor-layout.c (relayout_decl): New fn.
	* tree.h: Declare it.
	(DECL_BY_REFERENCE): New macro.

2004-07-17  Eric Botcazou  <ebotcazou@act-europe.fr>

	* libgcc2.c (__enable_execute_stack): New symbol.
	* libgcc-std.ver (GCC_3.4.2): New version.  Inherit from GCC_3.4
	and declare __enable_execute_stack.
	* mklibgcc.in (lib2funcs): Add _enable_execute_stack.
	* config/netbsd.h (NETBSD_ENABLE_EXECUTE_STACK): ANSIfy.
	* config/sol2.h (TRANSFER_FROM_TRAMPOLINE): Rename into
	ENABLE_EXECUTE_STACK.
	* config/alpha/alpha.c (alpha_initialize_trampoline): Conditionalize
	on ENABLE_EXECUTE_STACK instead of TRANSFER_FROM_TRAMPOLINE.
	* config/alpha/netbsd.h (TRANSFER_FROM_TRAMPOLINE): Rename into
	ENABLE_EXECUTE_STACK.
	* config/alpha/osf.h (TRANSFER_FROM_TRAMPOLINE): Likewise.
	* config/i386/i386.c (x86_initialize_trampoline): Conditionalize
	on ENABLE_EXECUTE_STACK instead of TRANSFER_FROM_TRAMPOLINE.
	* config/i386/netbsd-elf.h (TRANSFER_FROM_TRAMPOLINE): Rename into
	ENABLE_EXECUTE_STACK.
	* config/i386/netbsd.h (TRANSFER_FROM_TRAMPOLINE): Likewise.
	* config/i386/netbsd64.h (TRANSFER_FROM_TRAMPOLINE): Likewise.
	* config/sparc/freebsd.h (TRANSFER_FROM_TRAMPOLINE): Likewise.
	* config/sparc/netbsd-elf.h (TRANSFER_FROM_TRAMPOLINE): Likewise.
	* config/sparc/sparc.c (sparc_initialize_trampoline): Conditionalize
	on ENABLE_EXECUTE_STACK instead of TRANSFER_FROM_TRAMPOLINE.
	(sparc64_initialize_trampoline): Likewise.
	* doc/tm.texi (trampolines): Add ENABLE_EXECUTE_STACK macro.

2004-07-17  Joseph S. Myers  <jsm@polyomino.org.uk>

	* langhooks.h (builtin_function): New langhook.
	* langhooks-def.h (LANG_HOOKS_BUILTIN_FUNCTION): New.
	(LANG_HOOKS_INITIALIZER): Update.
	* tree.h (builtin_function): Remove.
	* doc/tm.texi: Update.
	* c-tree.h (builtin_function): Declare.
	* c-common.c, config/alpha/alpha.c, config/arm/arm.c,
	config/c4x/c4x.c, config/frv/frv.c, config/i386/i386.c,
	config/ia64/ia64.c, config/iq2000/iq2000.c,
	config/rs6000/rs6000.c, config/s390/s390.c, config/sh/sh.c,
	config/stormy16/stormy16.c: All callers of builtin_function
	changed.

2004-07-17  Andrew Pinski  <pinskia@physics.uc.edu>

	PR target/16556
	* config/i386/darwin.h (UNLIKELY_EXECUTED_TEXT_SECTION_NAME):
	Remove white space after the backslash.

2004-07-17  Eric Botcazou  <ebotcazou@libertysurf.fr>

	PR rtl-optimization/16294
	* resource.c (return_insn_p): New predicate.
	(mark_target_live_regs): Use it.  Special-case return insns.
	(init_resource_info): Use it.  Don't scan the epilogue past
	a return.

2004-07-17  Zdenek Dvorak  <rakdver@atrey.karlin.mff.cuni.cz>

	* loop-init.c (loop_optimizer_init, loop_optimizer_finalize): Do not
	destroy dominance information.
	* passes.c (rest_of_handle_loop2):  Free dominance information.
	* tree-cfg.c (cleanup_tree_cfg): Remove unreachable blocks before
	jump threading.
	(thread_jumps): Update dominance information and remove unreachable
	blocks.
	* tree-ssa-phiopt.c (replace_phi_with_stmt):  Update dominance
	information and remove the unreachable block.

2004-07-17  Graham Stott  <graham.stott@btinternet.com>

	* emit-rtl.c (reorder_insns): Don't set BB for a BARRIER insn.

2004-07-17  Toon Moene  <toon@moene.indiv.nluug.nl>

	* doc/sourcebuild.texi: Remove libf2c entry.

2004-07-17  Paolo Bonzini  <bonzini@gnu.org>

	* config/i386/i386.md (movv16qi_internal): Fix typo.

2004-07-17  Steven Bosscher  <stevenb@suse.de>

	* final.c (final_scan_insn): Fix broken commit from previous
	patch.

2004-07-17  Joseph S. Myers  <jsm@polyomino.org.uk>

	* c-typeck.c (parser_build_binary_op): Condition warnings for
	X<=Y<=Z on -Wparentheses instead of -Wextra.
	* doc/invoke.texi: Update.  Document that most of -Wparentheses is
	supported for C only.

2004-07-17  Steven Bosscher  <stevenb@suse.de>

	* cfgcleanup.c (try_simplify_condjump): Don't remove line
	notes to avoid unreachable code warnings.
	* toplev.c (backend_init): Don't emit line notes for
	unreachable code warnings.

	* combine.c (distribute_notes): Don't distribute a
	REG_VTABLE_REF note.
	* final.c (final_scan_insn): Don't handle it.
	* rtl.c (reg_note_name): Remove it.
	* rtl.h (enum reg_node): Dito.

	* emit-rtl.c (force_line_numbers, restore_line_number_status):
	Remove.
	* rtl.h (force_line_numbers, restore_line_number_status):
	Remove prototypes.

	* stmt.c (using_eh_for_cleanups_p, using_eh_for_cleanups): Move...
	* tree-eh.c (using_eh_for_cleanups_p): ...here.  Make static.
	(using_eh_for_cleanups): Also moved here.

	* expr.c (expand_expr_real_1) <CASE_LABEL_EXPR>: Die if we see one.
	<SWITCH_EXPR>: Die if we have a non-NULL SWITCH_BODY.  Update calls
	to expand_start_case and add_case_node.
	* stmt.c (struct nesting): Cleanup unused fields condition_code,
	last_unconditional_cleanup, nominal_type, printname, and
	line_number_status.
	(struct fixup_goto): Remove.
	(struct stmt_status): Remove x_goto_fixup_chain field.
	(goto_fixup_chain): Remove.
	(strip_default_case_nodes, group_case_nodes, emit_jump_if_reachable,
	pushcase, pushcase_range): Remove.
	(expand_start_bindings_and_block): Don't set unused fields in
	the nesting stack.
	(expand_start_case, add_case_node): Cleanup unused formal arguments.
	(expand_end_case_type): Don't simplify the case-list.  Use emit_jump
	instead of emit_jump_if_reachable.
	(emit_case_nodes): Likewise.
	* tree-cfg.c (group_case_labels, cleanup_dead_labels): No longer
	static.
	(update_eh_label): Work around left-over exception handing regions.
	* tree-flow.h (group_case_labels, cleanup_dead_labels): Add protos.
	* tree-optimize.c (execute_cleanup_cfg_post_optimizing): New function.
	(pass_cleanup_cfg_post_optimizing): New pass.
	(init_tree_optimization_passes): Run the new pass after all
	optimizations.
	* tree.h (pushcase, pushcase_range): Remove prototypes.
	(expand_start_case, add_case_node): Update prototypes.

2004-07-16  Krister Walfridsson  <cato@df.lth.se>

	* tree-inline.c (estimate_num_insns_1): Correct increase of count.

2004-07-16  Richard Henderson  <rth@redhat.com>

	* builtins.c (std_expand_builtin_va_arg): Remove.
	(expand_builtin_va_arg): Remove.
	* expr.h: Don't declare them.
	* gimplify.c (mark_decls_volatile_r): Remove.
	(copy_if_shared_r): Don't call it.
	* target-def.h: Don't test EXPAND_BUILTIN_VA_ARG.
	* expr.c (expand_expr_real_1): Don't handle VA_ARG_EXPR.
	* gimple-low.c (lower_stmt): Likewise.
	* tree-cfg.c (cfg_remove_useless_stmts_bb): Likewise.
	* tree-gimple.c (is_gimple_tmp_rhs, is_gimple_stmt): Likewise.
	* tree-ssa-operands.c (get_expr_operands): Likewise.
	* doc/tm.texi (TARGET_GIMPLIFY_VA_ARG_EXPR): Don't mention
	EXPAND_BUILTIN_VA_ARG.
	* system.h (EXPAND_BUILTIN_VA_ARG): Poison.
	* config/alpha/alpha.h, config/alpha/unicosmk.h, config/i386/i386.h,
	config/ia64/ia64.h, config/rs6000/rs6000.h, config/s390/s390.h,
	config/sparc/sparc.h (EXPAND_BUILTIN_VA_ARG): Remove.

2004-07-16  Daniel Berlin  <dberlin@dberlin.org>

	* tree-ssa-pre.c (insert_aux): Break out if we hit
	a critical edge.

2004-07-16  Richard Henderson  <rth@redhat.com>

	* basic-block.h (remove_fake_exit_edges): Declare.
	* cfganal.c (remove_fake_predecessors): Rename from
	remove_fake_successors; iterate over predecessors.
	(remove_fake_exit_edges): New.
	* cfgcleanup.c (try_optimize_cfg): Use it.
	* gcse.c (one_pre_gcse_pass, store_motion): Likewise.
	* predict.c (estimate_probability): Likewise.
	(tree_estimate_probability, note_prediction_to_br_prob): Likewise.
	* tree-cfg.c (make_edges): Likewise.
	* tree-ssa-pre.c (fini_pre): Likewise.
	* profile.c (instrument_edges): Don't remove_fake_edges.
	(branch_prob): Do it earlier here.

2004-07-16  Richard Henderson  <rth@redhat.com>

	* tree-ssa-operands.c (get_expr_operands): Fix 2004-07-15
	switchification wrt CONSTRUCTOR.  Document the reason.

2004-07-16  Frank Ch. Eigler  <fche@redhat.com>

	* tree-mudflap.c (mf_file_function_line_tree): Correct typo
	that prevented descriptive __mf_check source location strings.

2004-07-16  Richard Henderson  <rth@redhat.com>

	* tree-def (WITH_SIZE_EXPR): New.
	* explow.c (expr_size, int_expr_size): Handle WITH_SIZE_EXPR.
	* expr.c (expand_expr_real_1): Likewise.
	* gimplify.c (maybe_with_size_expr): New.
	(gimplify_arg, gimplify_modify_expr): Use it.
	(gimplify_modify_expr_to_memcpy): Take size parameter.
	(gimplify_modify_expr_to_memset): Likewise.
	(gimplify_expr): Handle WITH_SIZE_EXPR.
	* tree-alias-common.c (find_func_aliases): Likewise.
	* tree-eh.c (tree_could_trap_p): Likewise.
	(tree_could_throw_p): Likewise.
	* tree-gimple.c (is_gimple_lvalue): Likewise.
	(get_call_expr_in): Likewise.
	* tree-inline.c (estimate_num_insns_1): Likewise.
	(expand_calls_inline): Likewise.
	* tree-nested.c (convert_call_expr): Likewise.
	* tree-pretty-print.c (dump_generic_node): Likewise.
	* tree-sra.c (sra_walk_expr): Likewise.
	* tree-ssa-alias.c (add_pointed_to_expr): Likewise.
	* tree-ssa-ccp.c (get_rhs, set_rhs): Likewise.
	* tree-ssa-operands.c (get_expr_operands): Likewise.
	* tree-tailcall.c (find_tail_calls): Likewise.

	* calls.c (expand_call): Reset old_stack_allocated after
	calling emit_stack_restore.

2004-07-16  Richard Henderson  <rth@redhat.com>

	* langhooks-def.h (LANG_HOOKS_TREE_INLINING_COPY_RES_DECL_FOR_INLINING,
	lhd_tree_inlining_copy_res_decl_for_inlining): Remove.
	* langhooks.c (lhd_tree_inlining_copy_res_decl_for_inlining): Remove.
	* langhooks.h (struct lang_hooks_for_tree_inlining): Remove
	copy_res_decl_for_inlining.

	* tree-inline.c (declare_return_variable): New modify_dest argument.
	Use it as the return value, when possible or manditory.  Handle
	TREE_ADDRESSABLE types.
	(expand_call_inline): Extract MODIFY_EXPR lhs for call.  Simplify
	replacement of CALL_EXPR.

2004-07-16  Richard Henderson  <rth@redhat.com>

	* tree-flow.h (struct var_ann_d): Remove has_hidden_use.
	* gimple-low.c (expand_var_p): Don't check it.
	* tree-ssa-alias.c (setup_pointers_and_addressables): Likewise.
	* tree-ssa-copyrename.c (rename_ssa_copies): Likewise.
	* tree-ssa-operands.c (add_stmt_operand): Likewise.
	* tree-dfa.c (find_hidden_use_vars, find_hidden_use_vars_r): Kill.
	(find_referenced_vars): Don't call them.
	* tree-flow-inline.h (has_hidden_use, set_has_hidden_use): Kill.

2004-07-16  Richard Henderson  <rth@redhat.com>

	* function.c (pass_by_reference): True for all variable sized types.

2004-07-16  Sebastian Pop  <pop@cri.ensmp.fr>

	* Makefile.in (tree-pretty-print.o): Depend on tree-chrec.h.
	* tree-pretty-print.c: Include tree-chrec.h.
	(dump_generic_node): Pretty print SCEV_KNOWN, SCEV_NOT_KNOWN
	and POLYNOMIAL_CHREC nodes.

2004-07-16  Steve Ellcey  <sje@cup.hp.com>

	* builtins.c (expand_builtin_stpcpy): Do not create temporary
	reg with VOIDmode.

2004-07-16  Segher Boessenkool  <segher@kernel.crashing.org>

	* config/rs6000/eabi.asm (__eabi_convert): Fix typo (cmpi vs. cmpwi).

2004-07-16  Andreas Krebbel  <krebbel1@de.ibm.com>

	* config/s390/s390.md: Changed every occurence of BASE_REGISTER
	to BASE_REGNUM.
	* config/s390/s390.c: Likewise.
	* config/s390/s390.h: Likewise.

2004-07-16  Richard Sandiford  <rsandifo@redhat.com>

	* config/mips/mips.md (addsi3, adddi3): Remove special handling
	of $sp adds.  Remove REGNO checks from mips16 patterns.

2004-07-16  Richard Sandiford  <rsandifo@redhat.com>

	* config/mips/mips.md: Delete outdated comment.

2004-07-16  Richard Sandiford  <rsandifo@redhat.com>

	* config/mips/mips.c (get_float_compare_codes): Delete.
	(mips_emit_compare): New function, mostly extracted from
	get_float_compare_codes and gen_conditional_branch.
	(gen_conditional_branch, gen_conditional_move): Use it.

2004-07-16  Segher Boessenkool  <segher@kernel.crashing.org>

	* genautomata.c (add_vect): Speedup by using integers as
	bit-vectors for walking through the comb_vect and finding
	a match.

2004-07-16  Richard Sandiford  <rsandifo@redhat.com>

	* config/mips/mips.c (mips_zero_if_equal): Only use XORs if the second
	operand is an uns_arith_operand; use subtraction otherwise.
	* config/mips/mips.md (cmpsi, cmpdi): Allow any nonmemory_operand,
	not just arith_operands.

2004-07-16  Richard Sandiford  <rsandifo@redhat.com>

	* config/mips/mips-protos.h (gen_int_relational): Delete.
	(mips_emit_scc): Declare.
	* config/mips/mips.c (internal_test): Delete.
	(sle_operand, sleu_operand): New functions.
	(map_test_to_internal_test, gen_int_relational): Delete.
	(mips_emit_binary, mips_relational_operand_ok_p)
	(mips_emit_int_relational, mips_zero_if_equal)
	(mips_emit_scc): New functions.
	(gen_conditional_branch): Rework to use mips_emit_int_relational.
	* config/mips/mips.h (PREDICATE_CODES): Add sle_operand and
	sleu_operand.
	* config/mips/mips.md (seq, sne, sgt, sge, slt, sle, sgtu, sgeu)
	(sltu, sleu): Use mips_emit_scc.
	(*sge_[sd]i, *sgeu_[sd]i): New patterns.
	(*sle_[sd]i, *sle_[sd]i_mips16): Use sle_operand.
	(*sleu_[sd]i, *sleu_[sd]i_mips16): Use sleu_operand.

2004-07-16  Richard Sandiford  <rsandifo@redhat.com>

	* config/mips/mips.md (*sgt_di_mips16): Fix destination constraint.

2004-07-16  Richard Sandiford  <rsandifo@redhat.com>

	* config/mips/mips.md (*seq_[sd]i): Renamed from seq_[sd]i_zero.
	(*sne_[sd]i): Likewise sne_[sd]i_zero.
	(*sgt_[sd]i): ...and sgt_[sd]i.
	(*slt_[sd]i): ...and slt_[sd]i.
	(*sgtu_[sd]i): ...and sgtu_[sd]i.
	(*sltu_[sd]i): ...and sltu_[sd]i.
	(*sleu_[sd]i): ...and sleu_[sd]i_const.
	Name previously unnamed mips16 patterns.  Formatting fixes.

2004-07-16  Richard Sandiford  <rsandifo@redhat.com>

	* config/mips/mips.c (cmp_operands): Renamed from branch_cmp.
	(branch_type): Delete.
	(gen_conditional_branch, gen_conditional_move)
	(mips_gen_conditional_trap): Update after name change.  Get the
	comparison mode from cmp_operands[0].
	* config/mips/mips.h (cmp_type, branch_type): Delete.
	(cmp_operands): Renamed from branch_cmp.
	* config/mips/mips.md (cmpsi, cmpdi, cmpsf, cmpdf): Update after
	name change.  Don't set branch_type.
	(seq, sne, sgt, sge, slt, sle, sgtu, sgeu, sltu, sleu): Check the
	mode class of cmp_operands[0] rather than branch_type.  Update after
	name change.

2004-07-16  Richard Sandiford  <rsandifo@redhat.com>

	* config/mips/mips.c (mips_rtx_costs): In mips16 code, set the cost
	of 0...255 to 0 when inside a SET.

2004-07-16  Richard Sandiford  <rsandifo@redhat.com>

	* config/mips/mips.md: Remove mips16 define_peepholes.

2004-07-16  Daniel Berlin  <dberlin@dberlin.org>

	* tree-ssa-pre.c (init_pre): Connect infinite loops to exit.
	(fini_pre): Remove fake edges.

2004-07-15  Richard Henderson  <rth@redhat.com>

	* tree-ssa-operands.c (get_expr_operands): Use a switch.  Split out...
	(get_indirect_ref_operands, get_call_expr_operands): ... these.

2004-07-15  Nathan Sidwell  <nathan@codesourcery.com>

	* vec.h (VEC_address): New function.

2004-07-14  Jason Merrill  <jason@redhat.com>

	PR middle-end/15885
	* gimplify.c (gimplify_arg): New fn, split out from...
	(gimplify_call_expr): Here.  Special-case BUILT_IN_VA_START.

2004-07-15  Roman Zippel  <zippel@linux-m68k.org>

	* config/m68k/m68k.c (output_move_qimode): Abort on an attempt to
	generate code which is generated by pushqi1 now
	* config/m68k/m68k.h (MOVE_BY_PIECES_P): Remove.

2004-07-15  Roman Zippel  <zippel@linux-m68k.org>

	* combine.c (simplify_set): match the mode of the constant 0 with
	the tested operand to match the compare behaviour and the
	simplify_relational_operation() expectation.

2004-07-15  Aldy Hernandez  <aldyh@redhat.com>

	* config/rs6000/rs6000.md ("bunordered"): Disable for e500.
	("bordered"): Same.

2004-07-15  Aldy Hernandez  <aldyh@redhat.com>

	* config/rs6000/rs6000.md ("*cceq_ior_compare"): Allow
	unconditionally.
	* config/rs6000/spe.md ("e500_cceq_ior_compare"): Remove.

2004-07-15  Richard Sandiford  <rsandifo@redhat.com>

	* config/mips/mips.c (mips_adjust_insn_length): Fix handling of
	calls in mips16 code.

2004-07-15  Richard Sandiford  <rsandifo@redhat.com>

	* config/mips/mips.md: In the mips16 li/neg splitter, use SImode for
	the destination of the li as well as for the neg.

2004-07-15  Frank Ch. Eigler  <fche@redhat.com>

	g++/15861
	* cgraphunit.c (cgraph_build_static_cdtor): Add priority argument.
	* cgraph.h: Update declaration.
	* c-decl.c (build_cdtor): Update call with default priority.
	* coverage.c (create_coverage): Ditto.
	* tree-mudflap.c (mf_init_fndecl): New tree.
	(mudflap_init): Set it.
	(mudflap_register_call): Arrange to call __mf_init before the first
	__mf_register call.
	(mudflap_finish_file): Mark the mudflap static initializer as extra
	high priority, to beat all C++ static constructors.

2004-07-15  Jeff Law  <law@redhat.com>

	* loop.c (check_insn_for_givs): Restore check for code labels that was
	accidentally deleted by a recent checkin.

2004-07-15  Nathan Sidwell  <nathan@codesourcery.com>

	* vec.h (VEC_T_truncate): Allow truncation of an empty vector.
	(VEC_T_quick_insert, VEC_T_ordered_remove): Fix sizeof(T) thinko.

2004-07-14  Richard Henderson  <rth@redhat.com>

	* print-tree.c (print_node): Fix casts last change.

2004-07-15  Paul Brook	<paul@codesourcery.com>

	* dwarf2out.c (dwarf2out_begin_prologue): Rename IA64_UNWIND_INFO
	to TARGET_UNWIND_INFO.
	* except.c (output_function_exception_table): Ditto.
	* except.h: Ditto.
	* opts.c (decode_options): Ditto.
	* passes.c (rest_of_handle_final): Ditto.
	* final.c (final_start_function): Ditto.
	(final_scan_insn, final_scan_insn): Replace IA64_UNWIND_EMIT with
	target hook.
	* targhooks.h (default_unwind_emit): Declare.
	* targhooks.c (default_unwind_emit): New function.
	* target-def.h: Define and use TARGET_UNWIND_EMIT.
	* target.h (struct gcc_target): Add unwind_emit.
	* config/ia64/ia64.c (TARGET_UNWIND_EMIT): Define.
	* config/ia64/ia64.h: Rename IA64_UNWIND_INFO to TARGET_UNWIND_INFO.
	Remove IA64_UNWIND_EMIT.
	* doc/tm.texi: Document TARGET_UNWIND_EMIT and TARGET_UNWIND_INFO.

2004-07-14  Richard Henderson  <rth@redhat.com>

	* print-tree.c (print_node): Handle SSA_NAME.

2004-07-14  James E Wilson  <wilson@specifixinc.com>

	PR target/16325
	* config/mips/mips.h (STARTING_FRAME_OFFSET): When flag_profile_value
	and ! TARGET_64BIT, include REG_PARM_STACK_SPACE.

2004-07-15  Jakub Jelinek  <jakub@redhat.com>

	* expr.c (expand_assignment): Reenable bitfield += optimizations.
	Use alias set 0 for memory, do proper mode calculations and adjust
	address for memories.

2004-07-14  Per Bothner	 <per@bothner.com>

	* input.h:  If USE_MAPPED_LOCATION, define separate expanded_location
	structure with extra column field.
	* tree.c (expand_location):  Also fill in column field.
	* gengtype-lex.l:  Ignore expanded_location typedef, sinze gengtype
	gets confused by the two conditionally-compiled definitions.

2004-07-14  Eric Christopher  <echristo@redhat.com>

	* calls.c (expand_call): Fix typo in comment.

2004-07-14  Steve Ellcey  <sje@cup.hp.com>

	* config/ia64/ia64.c (ia64_expand_compare): Allow ORDERED
	comparision of TFmode.

2004-07-14  Richard Henderson  <rth@redhat.com>

	* config/alpha/alpha.c (alpha_gimplify_va_arg_1): Move indirect ...
	(alpha_gimplify_va_arg): ... handling here.  Use pass_by_reference.
	* config/c4x/c4x.c (c4x_gimplify_va_arg_expr): Use pass_by_reference.
	* config/i386/i386.c (ix86_gimplify_va_arg): Likewise.
	* config/i860/i860.c (i860_gimplify_va_arg_expr): Likewise.
	* config/ia64/ia64.c (ia64_gimplify_va_arg): Likewise.
	* config/rs6000/rs6000.c (rs6000_gimplify_va_arg): Likewise.
	* config/sh/sh.c (sh_gimplify_va_arg_expr): Likewise.
	* config/xtensa/xtensa.c (xtensa_gimplify_va_arg_expr): Likewise.

2004-07-14  Mike Stump	<mrs@apple.com>

	* config/darwin.h (WINT_TYPE): Define to be int to match
	system header files.

2004-07-14  Bob Wilson  <bob.wilson@acm.org>

	* config/xtensa/xtensa.c (function_arg_advance): Check for args
	that must be passed in the stack.
	(xtensa_gimplify_va_arg_expr): Skip special-case padding for small
	arguments if the size is not a constant.

2004-07-14  Per Bothner  <per@bothner.com>

	* c-typeck.c (emit_side_effect_warnings):  Use EXPR_HAS_LOCATION
	instead of EXPR_LOCUS in a boolean context, which is always true
	if --enable-mapped-location.
	* stmt.c (warn_if_unused_value):  Likewise.  Also use EXPR_LOCATION.

2004-07-14  Richard Henderson  <rth@redhat.com>

	* dominance.c (struct dom_info): Add fake_exit_edge.
	(init_dom_info): Allocate it.
	(free_dom_info): Free it.
	(calc_dfs_tree): Set it.  Handle noreturn and infinite loops
	in two passes.
	(calc_idoms): Honor fake_exit_edge.

2004-07-13  Jason Merrill  <jason@redhat.com>

	* tree-gimple.c (is_gimple_reg_rhs, is_gimple_mem_rhs): New fns.
	(rhs_test_for): New fn.
	(is_gimple_tmp_rhs): Rename from is_gimple_rhs.
	* tree-gimple.h: Declare them.
	* gimplify.c (gimplify_modify_expr): Use the new fns.

2004-07-14  Richard Henderson  <rth@redhat.com>

	* config/arm/arm-protos.h (arm_va_arg): Remove.
	* config/arm/arm.c (arm_va_arg): Remove.
	(arm_init_expanders): Fix alignment of arg_pointer_rtx.
	* config/arm/arm.h (EXPAND_BUILTIN_VA_ARG): Remove.

2004-07-14  John David Anglin  <dave.anglin@nrc-cnrc.gc.ca>

	* pa.c (fix_range): New function to mark a range(s) of registers as
	fixed registers.
	(override_options): Call fix_range if the -mfixed-range option string
	is not empty.
	* pa.h (TARGET_OPTIONS): Add -mfixed-range option.
	* doc/invoke.texi (-mfixed-range): Document new option.

2004-07-14  David Edelsohn  <edelsohn@gnu.org>

	* config/rs6000/rs6000.c (function_arg_padding): Do not pad SFmode
	for TARGET_64BIT.
	(rs6000_gimplify_va_arg): Use size_int instead of build_int_2.

2004-07-14  Roger Sayle  <roger@eyesopen.com>

	* expmed.c (expand_sdiv_pow2): New function to expand signed division
	by a positive power of two, split out from expand_divmod.  Provide
	an alternate implementation when shifts are expensive.  Lower the
	threshold for using a branchless implementation to BRANCH_COST >= 2.
	(expand_divmod): Call expand_sdiv_pow2 for suitable divisions.

2004-07-14  Paolo Bonzini  <bonzini@gnu.org>

	* tree-dfa.c (make_rename_temp): *Really* work just
	like create_tmp_var if called while outside SSA form.

2004-07-14  Ulrich Weigand  <uweigand@de.ibm.com>

	* config/s390/s390.md ("udivsi3"): Ensure trap is generated
	for division by zero.
	("umodsi3"): Likewise.

2004-07-14  Richard Sandiford  <rsandifo@redhat.com>

	* config/mips/mips.c (mips_output_move): When generating mips16 code,
	force loads of negative constants to be split.
	* config/mips/mips.md (*movhi_mips16, *movqi_mips16): Likewise.
	Generalize SImode li/neg splitter to cope with other modes.

2004-07-14  Paolo Bonzini  <bonzini@gnu.org>

	* expmed.c: Remove more references to QUEUED in the comments.
	* expr.c: Likewise.

2004-07-14  Richard Sandiford  <rsandifo@redhat.com>

	Revert:
	2004-07-13  Richard Henderson  <rth@redhat.com>
	* config/mips/mips.c (mips_pass_by_reference): Handle mode sizes
	correctly.

2004-07-14  Paolo Bonzini  <bonzini@gnu.org>

	* tree-dfa.c (make_rename_temp): Work just like
	create_tmp_var if called while outside SSA form.

2004-07-14  Paolo Bonzini  <bonzini@gnu.org>

	* expr.c (enqueue_insn, finish_expr_for_function,
	protect_from_queue, queued_subexp_p, mark_queue,
	emit_insns_enqueued_after_mark, emit_queue,
	expand_increment): Remove.
	(store_constructor): Expand increment as an assignment.
	(expand_expr_real_1 <case PREINCREMENT_EXPR,
	case PREDECREMENT_EXPR, case POSTINCREMENT_EXPR,
	case POSTDECREMENT_EXPR>): Abort.
	* expr.h (QUEUED_VAR, QUEUED_INSN, QUEUED_COPY,
	QUEUED_BODY, QUEUED_NEXT, finish_expr_for_function,
	protect_from_queue, emit_queue, queued_subexp_p): Remove.
	* function.h (pending_chain, x_pending_chain): Remove.
	* rtl.def (QUEUED): Remove.

	* emit-rtl.c (copy_insn_1, copy_most_rtx,
	set_used_flags, verify_rtx_sharing): Remove references to QUEUED.
	* genattrtab.c (attr_copy_rtx, clear_struct_flag,
	encode_units_mask): Likewise.
	* local-alloc.c (equiv_init_varies_p): Likewise.
	* rtl.c (copy_rtx): Likewise.
	* rtlanal.c (rtx_unstable_p, rtx_varies_p): Likewise.
	* simplify-rtx.c (simplify_gen_subreg): Likewise.
	* config/mn10300/mn10300.c (legitimate_pic_operand_p): Likewise.

	* builtins.c (expand_builtin, expand_builtin_apply,
	expand_builtin_mathfn, expand_builtin_mathfn_2,
	expand_builtin_mathfn_3, expand_builtin_setjmp_setup):
	Remove calls to emit_queue and protect_from_queue.
	* calls.c (expand_call, precompute_arguments,
	precompute_register_parameters, rtx_for_function_call,
	store_one_arg): Likewise.
	* dojump.c (do_compare_and_jump, do_jump): Likewise.
	* explow.c (memory_address): Likewise.
	* expmed.c (clear_by_pieces_1, clear_storage,
	clear_storage_via_libcall, emit_group_load,
	emit_group_store, emit_store_flag,
	expand_expr_real_1, store_by_pieces,
	store_constructor, store_expr, try_casesi,
	try_tablejump): Likewise.
	* function.c (expand_pending_sizes): Likewise.
	* optabs.c (emit_cmp_and_jump_insns,
	emit_conditional_add, emit_conditional_move,
	expand_fix, expand_float, prepare_cmp_insn): Likewise.
	* stmt.c (emit_case_bit_tests,
	expand_asm_expr, expand_computed_goto,
	expand_decl_init, expand_end_case_type,
	expand_end_stmt_expr, expand_expr_stmt_value,
	expand_return, expand_start_case,
	optimize_tail_recursion): Likewise.
	* config/c4x/c4x.c (c4x_expand_builtin): Likewise.
	* config/s390/s390.c (s390_expand_cmpmem): Likewise.

2004-07-14  Ben Elliston  <bje@au.ibm.com>

	* vec.h: Comment fix.

2004-07-13  Richard Henderson  <rth@redhat.com>

	* target.h (struct gcc_target): Add calls.pass_by_reference.
	* target-def.h (TARGET_PASS_BY_REFERENCE): New.
	* function.c (pass_by_reference): Use the hook.
	* system.h (FUNCTION_ARG_PASS_BY_REFERENCE): Poison.
	* targhooks.c, targhooks.h (hook_pass_by_reference_false): New.
	(hook_pass_by_reference_must_pass_in_stack): New.
	* config/alpha/alpha.c (function_arg): Don't query pass-by-ref.
	(alpha_pass_by_reference): New.
	(TARGET_PASS_BY_REFERENCE): New.
	* config/alpha/alpha.h (FUNCTION_ARG_PASS_BY_REFERENCE): Remove.
	* config/arc/arc.c (arc_pass_by_reference): New.
	(TARGET_PASS_BY_REFERENCE): New.
	* config/arc/arc.h (FUNCTION_ARG_PASS_BY_REFERENCE): Remove.
	(FUNCTION_ARG_CALLEE_COPIES): True.
	* config/arm/arm-protos.h (arm_function_arg_pass_by_reference): Remove.
	* config/arm/arm.c (TARGET_PASS_BY_REFERENCE): New.
	(arm_pass_by_reference): Rename from arm_function_arg_pass_by_reference.
	* config/arm/arm.h (FUNCTION_ARG_PASS_BY_REFERENCE): Remove.
	* config/c4x/c4x.h (FUNCTION_ARG_PASS_BY_REFERENCE): Remove.
	* config/cris/cris.c (cris_pass_by_reference): New.
	(TARGET_PASS_BY_REFERENCE): New.
	* config/cris/cris.h (FUNCTION_ARG): Don't query pass-by-ref.
	(FUNCTION_INCOMING_ARG, FUNCTION_ARG_ADVANCE): Likewise.
	(FUNCTION_ARG_PASS_BY_REFERENCE): Remove.
	* config/fr30/fr30.c (TARGET_PASS_BY_REFERENCE): New.
	* config/fr30/fr30.h (FUNCTION_ARG_PASS_BY_REFERENCE): Remove.
	* config/frv/frv-protos.h (frv_function_arg_pass_by_reference): Kill.
	* config/frv/frv.c (TARGET_PASS_BY_REFERENCE): New.
	(frv_function_arg_pass_by_reference): Remove.
	* config/frv/frv.h (FUNCTION_ARG_PASS_BY_REFERENCE): Remove.
	* config/i386/i386-protos.h (function_arg_pass_by_reference): Remove.
	* config/i386/i386.c (TARGET_PASS_BY_REFERENCE): New.
	(ix86_pass_by_reference): Rename from function_arg_pass_by_reference.
	* config/i386/i386.h (FUNCTION_ARG_PASS_BY_REFERENCE): Remove.
	* config/ia64/ia64-protos.h (ia64_function_arg_pass_by_reference): Kill.
	* config/ia64/ia64.c (TARGET_PASS_BY_REFERENCE): New.
	(ia64_pass_by_reference): Rename from
	ia64_function_arg_pass_by_reference.
	* config/ia64/ia64.h (FUNCTION_ARG_PASS_BY_REFERENCE): Remove.
	* config/ip2k/ip2k.h (FUNCTION_ARG_PASS_BY_REFERENCE): Remove.
	* config/iq2000/iq2000-protos.h (function_arg_pass_by_reference): Kill.
	* config/iq2000/iq2000.c (TARGET_PASS_BY_REFERENCE): New.
	(iq2000_pass_by_reference): Rename from function_arg_pass_by_reference.
	* config/iq2000/iq2000.h (FUNCTION_ARG_PASS_BY_REFERENCE): Remove.
	(FUNCTION_ARG_CALLEE_COPIES): Don't reference pass-by-ref.
	* config/m32r/m32r-protos.h (m32r_pass_by_reference): Remove.
	* config/m32r/m32r.c (TARGET_PASS_BY_REFERENCE): New.
	(m32r_pass_by_reference): Adjust prototype.  Make static.
	Handle mode sizes correctly.
	* config/m32r/m32r.h (FUNCTION_ARG_PASS_BY_REFERENCE): Remove.
	* config/m68hc11/m68hc11-protos.h, config/m68hc11/m68hc11.c
	(m68hc11_function_arg_pass_by_reference): Remove.
	* config/m68hc11/m68hc11.h (FUNCTION_ARG_PASS_BY_REFERENCE): Remove.
	(FUNCTION_ARG_CALLEE_COPIES): Don't reference pass-by-ref.
	* config/mcore/mcore.c (TARGET_PASS_BY_REFERENCE): New.
	* config/mcore/mcore.h (FUNCTION_ARG_PASS_BY_REFERENCE): Remove.
	* config/mips/mips-protos.h (function_arg_pass_by_reference): Remove.
	* config/mips/mips.c (TARGET_PASS_BY_REFERENCE): New.
	(mips_va_arg): Use pass_by_reference.
	(mips_pass_by_reference): Rename from function_arg_pass_by_reference.
	Handle mode sizes correctly.
	* config/mips/mips.h (FUNCTION_ARG_PASS_BY_REFERENCE): Remove.
	(FUNCTION_ARG_CALLEE_COPIES): Don't reference pass-by-ref.
	* config/mmix/mmix-protos.h (mmix_function_arg_pass_by_reference): Kill.
	* config/mmix/mmix.c (TARGET_PASS_BY_REFERENCE): New.
	(mmix_pass_by_reference): Rename from
	mmix_function_arg_pass_by_reference.
	* config/mmix/mmix.h (FUNCTION_ARG_PASS_BY_REFERENCE): Remove.
	(FUNCTION_ARG_CALLEE_COPIES): True.
	* config/mn10300/mn10300.c (TARGET_PASS_BY_REFERENCE): New.
	(mn10300_pass_by_reference): New.
	* config/mn10300/mn10300.h (FUNCTION_ARG_PASS_BY_REFERENCE): Remove.
	(FUNCTION_ARG_CALLEE_COPIES): True.
	* config/pa/pa.c (pa_pass_by_reference): New.
	(TARGET_PASS_BY_REFERENCE): New.
	* config/pa/pa.h (FUNCTION_ARG_PASS_BY_REFERENCE): Remove.
	(FUNCTION_ARG_CALLEE_COPIES): True.
	* config/rs6000/rs6000-protos.h (function_arg_pass_by_reference): Kill.
	* config/rs6000/rs6000.c (TARGET_PASS_BY_REFERENCE): New.
	(rs6000_pass_by_reference): Rename from function_arg_pass_by_reference.
	* config/rs6000/rs6000.h (FUNCTION_ARG_PASS_BY_REFERENCE): Remove.
	* config/s390/s390-protos.h (s390_function_arg_pass_by_reference): Kill.
	* config/s390/s390.c (TARGET_PASS_BY_REFERENCE): New.
	(s390_pass_by_reference): Rename from
	s390_function_arg_pass_by_reference.
	(s390_function_arg_advance): Don't query pass-by-ref.
	(s390_function_arg): Likewise.
	(s390_gimplify_va_arg): Use pass_by_reference.
	(s390_call_saved_register_used): Likewise.
	* config/s390/s390.h (FUNCTION_ARG_PASS_BY_REFERENCE): Remove.
	* config/sh/sh.c (TARGET_PASS_BY_REFERENCE): New.
	(shcompact_byref, sh_pass_by_reference): New.
	* config/sh/sh.h (FUNCTION_ARG_PASS_BY_REFERENCE): Remove.
	(SHCOMPACT_BYREF): Remove.
	* config/sparc/sparc-protos.h (function_arg_pass_by_reference): Kill.
	* config/sparc/sparc.c (TARGET_PASS_BY_REFERENCE): New.
	(sparc_pass_by_reference): Rename from function_arg_pass_by_reference.
	(sparc_gimplify_va_arg): Use pass_by_reference.
	* config/sparc/sparc.h (FUNCTION_ARG_PASS_BY_REFERENCE): Remove.
	* config/stormy16/stormy16.h (FUNCTION_ARG_PASS_BY_REFERENCE): Remove.
	* config/v850/v850.c (TARGET_PASS_BY_REFERENCE): New.
	(v850_pass_by_reference): New.
	* config/v850/v850.h (FUNCTION_ARG_PASS_BY_REFERENCE): Remove.
	(FUNCTION_ARG_CALLEE_COPIES): True.
	* doc/tm.texi (TARGET_PASS_BY_REFERENCE): Update from
	FUNCTION_ARG_PASS_BY_REFERENCE docs.

2004-07-14  Richard Henderson  <rth@redhat.com>
	    Richard Sandiford  <rsandifo@redhat.com>

	* config/mips/mips-protos.h (mips_va_arg): Delete.
	* config/mips/mips.h (EXPAND_BUILTIN_VA_ARG): Delete.
	* config/mips/mips.c: Include tree-gimple.h.
	(TARGET_GIMPLIFY_VA_ARG_EXPR): Define.
	(mips_arg_info): Remove special handling of must_pass_in_stck args.
	(mips_gimplify_va_arg_expr): Rewritten from mips_va_arg.
	(function_arg_pass_by_reference): Return true if must_pass_in_stack.

2004-07-13  Bob Wilson  <bob.wilson@acm.org>

	* config/xtensa/xtensa.c (xtensa_gimplify_va_arg_expr): Swap
	arguments for COND_EXPR in big-endian adjustment code.

2004-07-13  John David Anglin  <dave.anglin@nrc-cnrc.gc.ca>

	* pa-64.h (ARG_POINTER_REGNUM, STATIC_CHAIN_REGNUM): Delete.
	* pa.h (ARG_POINTER_REGNUM, STATIC_CHAIN_REGNUM): Modify for hppa64.
	* pa32-regs.h (REG_ALLOC_ORDER): Reorder caller-saved registers.
	* pa64-regs.h (REG_ALLOC_ORDER): Likewise.

2004-07-13  Diego Novillo  <dnovillo@redhat.com>

	PR tree-optimization/16443
	* tree-ssa-alias.c: Add more description for
	CALL_CLOBBERED_VARS and ADDRESSABLE_VARS.
	* tree-ssa-operands.c (get_asm_expr_operands): Re-order the
	clobbering of call-clobbered and addressable variables.  If
	there are any before aliases have been computed, add them.

2004-07-13  Diego Novillo  <dnovillo@redhat.com>

	* tree-optimize.c (execute_todo): Flush DUMP_FILE before
	verification.

2004-07-13  Ulrich Weigand  <uweigand@de.ibm.com>

	* config/s390/s390.c (s390_gimplify_va_arg): Use size_int instead
	of build_int_2.  Convert both operands of PLUS_EXPR and MULT_EXPR
	to the same type.

2004-07-13  Per Bothner  <per@bothner.com>

	* collect2.c (main):  Handle --no-demangle and --demangle flags.

2004-07-13  Sebastian Pop  <pop@cri.ensmp.fr>

	* Makefile.in (OBJS-common): Add tree-data-ref.o.
	(tree-scalar-evolution.o): Add missing dependences on tree-pass.h flags.h.
	(tree-data-ref.o): New rule.
	* lambda.h: New file.
	* tree-data-ref.c: New file.
	* tree-data-ref.h: New file.
	* tree.c (int_cst_value, tree_fold_gcd): New functions.
	* tree.h (int_cst_value, tree_fold_gcd): Declared here.

2004-07-13  Eric Botcazou  <ebotcazou@libertysurf.fr>

	PR target/13926
	* config/sparc/sparc-protos.h (output_ubranch): New prototype.
	* config/sparc/sparc.c (output_ubranch): New function.
	* config/sparc/sparc.md (jump pattern): Use it.

2004-07-13  Eric Botcazou  <ebotcazou@libertysurf.fr>

	PR target/16494
	* config/sparc/sparc.c (output_cbranch): Properly guard
	the code handling far branches with TARGET_V9.
	* config/sparc/sparc.md (length attribute): Document the
	side-effect of having a length greater or equal to 3.

2004-07-13  Eric Botcazou  <ebotcazou@libertysurf.fr>
	    Lloyd Parkes  <lloyd@must-have-coffee.gen.nz>

	PR target/15186
	* config/sparc/sol2-bi.h (LINK_ARCH64_SPEC_BASE): Pass
	/usr/ucblib/sparcv9 as -R path when -compat-bsd is specified.

2004-07-13  Eric Botcazou  <ebotcazou@libertysurf.fr>
	    Martin Sebor  <sebor@roguewave.com>

	PR target/12602
	* doc/invoke.texi (SPARC options): Document -threads
	and -pthreads on Solaris.

2004-07-13  Richard Henderson  <rth@redhat.com>

	* builtins.c (std_gimplify_va_arg_expr): Handle types passed
	by reference.
	(ind_gimplify_va_arg_expr): Remove.
	* tree.h (ind_gimplify_va_arg_expr): Remove.
	* config/pa/pa.c (hppa_gimplify_va_arg_expr): Don't use it.
	* config/mmix/mmix.c (mmix_function_arg_pass_by_reference): Allow
	argsp to be null.

	* config/arc/arc.c (arc_gimplify_va_arg_expr): Remove.
	(TARGET_GIMPLIFY_VA_ARG_EXPR): Remove.
	* config/cris/cris.c, config/fr30/fr30.c, config/frv/frv.c,
	config/iq2000/iq2000.c, config/m32r/m32r.c, config/mmix/mmix.c,
	config/mn10300/mn10300.c, config/v850/v850.c: Similarly.

2004-07-13  Richard Henderson  <rth@redhat.com>

	* function.c (pass_by_reference): New.
	(assign_parm_find_data_types): Use it.
	* calls.c (initialize_argument_information): Likewise.
	(emit_library_call_value_1): Likewise.
	* expr.h (FUNCTION_ARG_PASS_BY_REFERENCE): Remove.
	* function.h (pass_by_reference): Declare.

2004-07-13  Richard Henderson  <rth@redhat.com>

	* target-def.h (TARGET_MUST_PASS_IN_STACK): New.
	* target.h (struct gcc_target): Add calls.must_pass_in_stack.
	* expr.h (MUST_PASS_IN_STACK): Remove.
	* system.h (MUST_PASS_IN_STACK): Poison.
	* tree.h (must_pass_in_stack_var_size): Declare.
	(must_pass_in_stack_var_size_or_pad): Declare.
	* calls.c (must_pass_in_stack_var_size): New.
	(must_pass_in_stack_var_size_or_pad): Rename from
	default_must_pass_in_stack.
	* config/alpha/alpha.c (unicosmk_must_pass_in_stack): New.
	(TARGET_MUST_PASS_IN_STACK): New.
	* config/alpha/unicosmk.h (MUST_PASS_IN_STACK): Remove.
	* config/fr30/fr30.c (fr30_must_pass_in_stack): New.
	(TARGET_MUST_PASS_IN_STACK): New.
	* config/fr30/fr30.h (MUST_PASS_IN_STACK): Remove.
	* config/frv/frv.c (frv_must_pass_in_stack): New.
	(TARGET_MUST_PASS_IN_STACK): New.
	* config/frv/frv.h (MUST_PASS_IN_STACK): Remove.
	* config/i386/i386-protos.h (ix86_must_pass_in_stack): Remove.
	* config/i386/i386.c (TARGET_MUST_PASS_IN_STACK): New.
	(ix86_must_pass_in_stack): Make static.
	* config/i386/i386.h (MUST_PASS_IN_STACK): Remove.
	* config/ia64/ia64.c (TARGET_MUST_PASS_IN_STACK): New.
	* config/ia64/ia64.h (MUST_PASS_IN_STACK): Remove.
	* config/m32r/m32r.c (TARGET_MUST_PASS_IN_STACK): New.
	* config/m32r/m32r.h (MUST_PASS_IN_STACK): Remove.
	* config/mcore/mcore-protos.h (mcore_must_pass_on_stack): Remove.
	* config/mcore/mcore.c (TARGET_MUST_PASS_IN_STACK): New.
	(mcore_must_pass_on_stack): Remove.
	* config/mcore/mcore.h (MUST_PASS_IN_STACK): Remove.
	* config/mips/mips.c (TARGET_MUST_PASS_IN_STACK): New.
	* config/mips/mips.h (MUST_PASS_IN_STACK): Remove.
	* config/pa/pa.c (TARGET_MUST_PASS_IN_STACK): New.
	* config/pa/pa.h (MUST_PASS_IN_STACK): Remove.
	* config/rs6000/aix.h (MUST_PASS_IN_STACK): Remove.
	* config/rs6000/linux64.h (MUST_PASS_IN_STACK): Remove.
	* config/rs6000/rs6000.c (rs6000_must_pass_in_stack): New.
	(TARGET_MUST_PASS_IN_STACK): New.
	* config/sh/sh.c (TARGET_MUST_PASS_IN_STACK): New.
	* config/sh/sh.h (MUST_PASS_IN_STACK): Remove.
	* config/sparc/sparc.c (TARGET_MUST_PASS_IN_STACK): New.
	* config/sparc/sparc.h (MUST_PASS_IN_STACK): Remove.
	* config/xtensa/xtensa.c (TARGET_MUST_PASS_IN_STACK): New.
	* config/xtensa/xtensa.h (MUST_PASS_IN_STACK): Remove.
	* doc/tm.texi (TARGET_MUST_PASS_IN_STACK): Update from
	MUST_PASS_IN_STACK.

	* calls.c, function.c, config/alpha/alpha.c, config/alpha/alpha.h,
	config/alpha/unicosmk.h, config/alpha/vms.h, config/c4x/c4x.c,
	config/cris/cris.h, config/fr30/fr30.c, config/fr30/fr30.h,
	config/frv/frv.c, config/i386/i386.c, config/iq2000/iq2000.c,
	config/mcore/mcore.c, config/mcore/mcore.h, config/mips/mips.c,
	config/mmix/mmix.c, config/mmix/mmix.h, config/rs6000/rs6000.c,
	config/sh/sh.c, config/sh/sh.h, config/stormy16/stormy16.c,
	config/xtensa/xtensa.c: Use target hook.

2004-07-13  Anthony Heading  <aheading@jpmorgan.com>

	* configure.ac (gcc_cv_as_offsetable_lo10): Fix a typo.
	* configure: Rebuilt.

2004-07-13  Richard Sandiford  <rsandifo@redhat.com>

	* doc/invoke.texi: Remove documentation for MIPS -mrnames option.
	* config/mips/mips.h (mips_reg_names): Don't declare.
	(MASK_NAME_REGS): Delete.  Shuffle other MASK_* values down.
	(TARGET_NAME_REGS): Delete.
	(TARGET_SWITCHES): Remove -mrnames.
	(REGISTER_NAMES): Initialise with the old contents of mips_reg_names[].
	(ADDITIONAL_REGISTER_NAMES): Remove entries for names mentioned
	in REGISTER_NAMES.
	* config/mips/mips.c (mips_reg_names, mips_sw_reg_names): Delete.
	(override_options): Remove handling of TARGET_NAME_REGS.

2004-07-13  Richard Sandiford  <rsandifo@redhat.com>

	* config/mips/mips.h (TARGET_*): Boolify.

2004-07-12  Nick Clifton  <nickc@redhat.com>

	* config.gcc: Add sh-*-symbianelf target.
	* config/sh/sh.c: Add new target macros:
	TARGET_ENCODE_SECTION_INFO, TARGET_STRIP_NAME_ENCODING,
	TARGET_CXX_IMPORT_EXPORT_CLASS.
	(sh_file_start): Create a definition of the .directive section.
	(sh_attribute): Add dllimport and dllexport attributes.
	* config/sh/symbian-pre.h: New file.
	* config/sh/symbian-post.h: New file.
	* config/sh/symbian.c: New file. Contains Symbian specific
	functions.
	* config/sh/sh-protos.h: Add prototypes for new functions
	provided by symbian.c.
	* config/sh/t-symbian: New file.
	* doc/extend.texi: Document support for dllimport and dllexport
	attributes by the sh-symbianelf target.

2004-07-12  James E Wilson  <wilson@specifixinc.com>

	* Makefile.in (AR): Use @AR@ not ar.
	(NM): New.
	(AR_FOR_TARGET): Use $(AR) not ar for native.
	(NM_FOR_TARGET): Use $(NM) not nm for native.
	* configure.ac: Add AC_CHECK_PROG calls for NM and AR.
	* configure: Regenerate.

2004-07-12  David S. Miller  <davem@nuts.davemloft.net>

	* config/sparc/sparc.md (ashlsi3): Eliminate const 1
	special case.
	(ashldi3_sp64): Likewise.

2004-07-12  John David Anglin  <dave.anglin@nrc-cnrc.gc.ca>

	PR target/16477
	* pa.c (function_arg): Update comment.
	* pa.h (BLOCK_REG_PADDING): Define.

2004-07-12  Zdenek Dvorak  <rakdver@atrey.karlin.mff.cuni.cz>

	PR tree-optimization/16461
	* tree-tailcall.c (independent_of_stmt_p): Handle non-SSA name
	arguments of phi nodes.

2004-07-12  Devang Patel  <dpatel@apple.com>

	* doc/invoke.texi (Darwin Options): Document -gused and -gfull.

2004-07-12  Steve Ellcey  <sje@cup.hp.com>

	* function.c (expand_function_start): Ensure r_save is in Pmode.
	* calls.c (prepare_call_address): Ensure static_chain_value is
	in Pmode.
	* builtins.c (expand_builtin_nonlocal_goto): Ensure r_label and
	r_save_area are in Pmode.
	* config/ia64/ia64.c (ia64_initialize_trampoline): Ensure addr,
	fnaddr, and static_chain are in Pmode.

2004-07-12  Vladimir Makarov  <vmakarov@redhat.com>

	PR target/16445
	* config/ia64/ia64.c (bundling): Don't count ignored insns.

2004-07-12  Richard Henderson  <rth@redhat.com>

	* target.h (struct gcc_target): Move gimplify_va_arg_expr
	next to build_builtin_va_list.
	* target-def.h (TARGET_GIMPLIFY_VA_ARG_EXPR): Update to match.
	* builtins.c (gimplify_va_arg_expr): Likewise.
	* gimplify.c (copy_if_shared_r): Likewise.

2004-07-12  Alexandre Oliva  <aoliva@redhat.com>

	* passes.c (rest_of_decl_compilation): Don't defer call of
	assemble_variable if its DECL_RTL is already set.

2004-07-12  Sebastian Pop  <pop@cri.ensmp.fr>

	* cfgloop.h (struct loop): Add nb_iterations field.
	(current_loops): Declare.
	* tree-chrec.c (chrec_not_analyzed_yet,
	chrec_dont_know, chrec_known, count_ev_in_wider_type,
	chrec_contains_symbols_defined_in_loop): Remove the temporary
	hooks.
	* tree-flow-inline.h (loop_containing_stmt): New function.
	* tree-scalar-evolution.c: Add implementation.
	* tree-scalar-evolution.h: Add declarations.

2004-07-12 Vladimir Makarov <vmakarov@redhat.com>

	PR rtl-optimization/15921
	* Makefile.in (global.o): Add recog.h.

	* global.c (recog.h): Add the include-clause.
	(bb_info): New member earlyclobber.
	(allocate_bb_info, free_bb_info): Initialize/finish the new
	member.
	(earlyclobber_regclass, earlyclobber_regclass_length): The new
	global variables.
	(check_earlyclobber, regclass_intersect,
	mark_reg_use_for_earlyclobber, mark_reg_use_for_earlyclobber_1):
	New functions.
	(calculate_local_reg_bb_info): Calculate value of earlyclobber.
	(make_accurate_live_analysis): Modify pavin.

2004-07-12  Diego Novillo  <dnovillo@redhat.com>

	* tree-cfg.c (find_taken_edge): Statically compute the truth
	value of a predicate comparing an SSA_NAME to itself.

2004-07-12  Roger Sayle  <roger@eyesopen.com>

	* config/rs6000/rs6000.c (rs6000_rtx_costs): Indicate that the
	rs6000 doesn't have shift-and-add or shift-and-sub instructions
	by returning the cost of a multiplication plus an addition.

2004-07-12  Paolo Bonzini  <bonzini@gnu.org>

	PR tree-optimization/14107
	* gimplify.c (gimplify_return_expr): Accept a
	RETURN_EXPR with an error argument.
	* tree-optimize.c (init_tree_optimization_passes):
	Run pass_warn_function_return at -O0.

2004-07-12  Roger Sayle  <roger@eyesopen.com>

	* doc/invoke.texi: Correct -fasynchronous-unwind-tables option
	index entry.

2004-07-12  Richard Sandiford  <rsandifo@redhat.com>

	* config/mips/mips.c (mips_use_dfa_pipeline_interface): Delete.
	(TARGET_SCHED_USE_DFA_PIPELINE_INTERFACE): Define to hook_int_void_1.
	* config/mips/3000.md: Add copyright notice.  Remove automota and
	function units; use generic ones instead.  Only define reservations
	for things that are different from generic.md.  Extend each clause
	to include r3900.
	* config/mips/{4000,4100,4300,4600,5000,6000,generic}.md: New files.
	* config/mips/mips.md: Include them. Remove define_function_units.
	(alu, imuldiv): New automata and units.

2004-07-12  Ben Elliston  <bje@au.ibm.com>

	* doc/invoke.texi (Optimize Options): Document -frename-registers
	not being enabled by default at -O3.

2004-07-11  Roger Sayle  <roger@eyesopen.com>

	* fold-const.c (fold) <PLUS_EXPR>: Canonicalize X + -C as X - C for
	floating point additions, to keep real immediate constant positive.
	<MINUS_EXPR>:  For floating point subtractions, only transform X - -C
	into X + C, and leave positive real constants as X - C.

2004-07-11  John David Anglin  <dave.anglin@nrc-cnrc.gc.ca>

	* pa.c (hppa_gimplify_va_arg_expr): Remove comment.

2004-07-11  Zdenek Dvorak  <rakdver@atrey.karlin.mff.cuni.cz>

	PR tree-optimization/15654
	* tree-tailcall.c (eliminate_tail_call): Remove unreachable code.

2004-07-11  Roger Sayle  <roger@eyesopen.com>

	* builtins.c (fold_builtin_fputs): Don't bother converting the
	return type to integer_type_node, as we've already checked that
	the result will be ignored.

	* tree-eh.c (tree_could_trap_p): Add support for -ftrapv such
	that signed addition, subtraction, multiplication, division,
	remainder, negation and absolute value may potentially trap.

	* fold-const.c (fold_ignored_result): New function to strip
	non-side-effecting tree nodes from an expression whose result
	is ignored.
	(fold_convert): Call fold_ignored_result when casting a value
	to VOID_TYPE.
	(omit_one_operand):  Call fold_ignored_result on the "omitted"
	operand when building a COMPOUND_EXPR.
	(pedantic_omit_one_operand): Likewise.
	* tree.h (fold_ignored_result): Prototype here.
	* tree-ssa-ccp.c (ccp_fold_builtin): Call fold_ignored_result
	when we're going to ignore the result.

2004-07-11  Richard Henderson  <rth@redhat.com>

	PR tree-opt/16383
	* tree-ssa-ccp.c (fold_stmt_r): Split out...
	* tree.c (fields_compatible_p, find_compatible_field): ... new.
	* tree.h (fields_compatible_p, find_compatible_field): Declare.
	* tree-sra.c (sra_hash_tree): Hash fields by offset.
	(sra_elt_eq): Use fields_compatible_p.
	(generate_one_element_ref): Use find_compatible_field.

2004-07-11  Richard Henderson  <rth@redhat.com>

	PR tree-opt/16422
	* tree-sra.c (generate_one_element_init): New.
	(generate_element_init): Use it.
	(scalarize_init): Push/pop gimplify context around it.
	(find_new_referenced_vars_1, find_new_referenced_vars): New.
	* gimplify.c (gimplify_expr): Allow SSA_NAME.

2004-07-11  Roger Sayle  <roger@eyesopen.com>

	* rtlanal.c (insn_rtx_cost): New function, moved and renamed from
	combine.c's combine_insn_cost.
	* rtl.h (insn_rtx_cost): Prototype here.
	* combine.c (combine_insn_cost): Delete function.
	(combine_validate_cost): Update callers of combine_insn_cost to
	call insn_rtx_cost instead.
	(combine_instructions): Likewise.  Use NONJUMP_INSN_P to avoid
	requesting the rtx_cost of call and/or jump instructions.

	* ifcvt.c (total_bb_rtx_cost): Use insn_rtx_cost instead of calling
	rtx_cost directly.  Don't request/use the cost of call or jump
	instructions.  Return -1 if the cost of any instruction can't be
	determined (or the BB contains a function call).
	(find_if_case_1): Abort transformation if total_bb_rtx_cost returns
	-1 (i.e. can't determine the cost of any instruction or the basic
	block contains a subroutine call).
	(find_if_case_2): Likewise.

2004-07-11  Roger Sayle  <roger@eyesopen.com>

	* rs6000.c (struct processor_costs): Change semantics of fields to
	include the COST_N_INSNS scaling, and update all initializers.
	(rs6000_rtx_costs): Don't use COSTS_N_INSNS on rs6000_cost fields.
	Use COSTS_N_INSNS(1) for NOT, SIGN_EXTEND, ZERO_EXTEND and COMPARE.
	Use rs6000_cost->fp for both FLOAT_TRUNCATE and UNSPEC_FRSP.  When
	optimizing for size, use COSTS_N_INSNS(1) for CALL and IF_THEN_ELSE.

2004-07-11  Joseph S. Myers  <jsm@polyomino.org.uk>

	* LANGUAGES: Remove obsolete information.

2004-07-11  Ulrich Weigand  <uweigand@de.ibm.com>

	* config/s390/linux.h (MD_FALLBACK_FRAME_STATE_FOR): For SIGSEGV and
	SIGBUS signal frames, the PSW address points *to* the faulting
	instruction, not after it.

2004-07-11  Ulrich Weigand  <uweigand@de.ibm.com>

	* config/s390/s390.c (legitimize_tls_address): Handle constant offsets
	added to TLS symbol addresses.

2004-07-11  Richard Henderson  <rth@redhat.com>

	* expmed.c (init_expmed): Use stack-local structures for
	temporary rtl.  Don't recognize shifts.

2004-07-11  Richard Henderson  <rth@redhat.com>

	* expr.c (store_expr): Don't fiddle subreg promotion for types
	with precision smaller than the mode.

2004-07-11  Joseph S. Myers  <jsm@polyomino.org.uk>

	* tree.h (all_types_permanent): Remove.

2004-07-11  Joseph S. Myers  <jsm@polyomino.org.uk>

	* langhooks.h (estimate_num_insns, pushlevel, poplevel, set_block,
	maybe_build_cleanup, update_decl_after_saving): Remove hooks.
	* langhooks.c (lhd_clear_binding_stack): Remove.
	* langhooks-def.h (lhd_clear_binding_stack,
	LANG_HOOKS_MAYBE_BUILD_CLEANUP,
	LANG_HOOKS_UPDATE_DECL_AFTER_SAVING,
	LANG_HOOKS_TREE_INLINING_ESTIMATE_NUM_INSNS, LANG_HOOKS_PUSHLEVEL,
	LANG_HOOKS_POPLEVEL, LANG_HOOKS_SET_BLOCK): Remove.
	(LANG_HOOKS_CLEAR_BINDING_STACK): Define to lhd_do_nothing.
	* system.h (LANG_HOOKS_TREE_INLINING_ESTIMATE_NUM_INSNS,
	LANG_HOOKS_PUSHLEVEL, LANG_HOOKS_SET_BLOCK,
	LANG_HOOKS_MAYBE_BUILD_CLEANUP,
	LANG_HOOKS_UPDATE_DECL_AFTER_SAVING, LANG_HOOKS_POPLEVEL): Poison.
	* tree.h (poplevel): Don't declare.
	* c-lang.c (LANG_HOOKS_CLEAR_BINDING_STACK, LANG_HOOKS_PUSHLEVEL,
	LANG_HOOKS_POPLEVEL, LANG_HOOKS_SET_BLOCK): Remove.
	* objc/objc-lang.c (LANG_HOOKS_CLEAR_BINDING_STACK,
	LANG_HOOKS_PUSHLEVEL, LANG_HOOKS_POPLEVEL, LANG_HOOKS_SET_BLOCK):
	Remove.

2004-07-11  Joseph S. Myers  <jsm@polyomino.org.uk>

	PR tree-optimization/16437
	* c-common.c (shorten_compare): Don't mark result of conversion to
	narrower signed type as overflowing.
	* fold-const.c (decode_field_reference): Determine whether
	signedness comes from outer type using precision rather than size.

2004-07-11  Phil Edwards  <phil@codesourcery.com>

	* configure.ac:  Alphabetize --enable-checking list, add
	missing valgrind entry.
	* configure:  Regenerate.

2004-07-11  Phil Edwards  <phil@codesourcery.com>

	* doc/install.texi (Testing):  Fix syntax in "make check" example.

2004-07-10  James E Wilson  <wilson@specifixinc.com>

	* config/gofast.h (gofast_maybe_init_libfuncs): Use SImode for litodp.

2004-07-10  Zdenek Dvorak  <rakdver@atrey.karlin.mff.cuni.cz>

	PR rtl-optimization/16001
	* loop-iv.c (iv_number_of_iterations): Prevent copy propagation in
	niter_expr.

2004-07-10  Geoffrey Keating  <geoffk@apple.com>

	* config/darwin.h (LINK_COMMAND_SPEC): Don't call c++filt.

2004-07-10  Steve Kargl  <sgk@troutmask.apl.washington.edu>
	    James Morrison  <phython@gcc.gnu.org>

	* doc/contrib.texi (Contributors): Add gfortran contributors and
	fix a couple of typos.

2004-07-10  Zdenek Dvorak  <rakdver@atrey.karlin.mff.cuni.cz>

	PR rtl-optimization/15387
	* calls.c (check_sibcall_argument_overlap_1): Handle pointers
	to incoming args space correctly.

2004-07-10  John David Anglin  <dave.anglin@nrc-cnrc.gc.ca>

	* pa.c (output_indirect_call): Only use %r2 as the link register in
	indirect calls with the long PA 2.0 pc-relative branch.

2004-07-10  Daniel Jacobowitz  <dan@debian.org>

	* config/i386/i386.c (override_options): Pick a 64-bit CPU
	for the default tuning if TARGET_64BIT.

2004-07-10  Richard Henderson  <rth@redhat.com>

	* builtins.c (std_gimplify_va_arg_expr): Widen align/boundary
	to HOST_WIDE_INT.  Fold pad-args-down arithmetic.

2004-07-10  Jakub Jelinek  <jakub@redhat.com>

	* expr.h (store_bit_field, extract_bit_field): Remove last argument.
	* expmed.c (store_bit_field, extract_bit_field): Remove last
	argument.
	* builtins.c (expand_builtin_signbit): Adjust callers.
	* optabs.c (expand_vector_binop, expand_vector_unop): Likewise.
	* calls.c (store_unaligned_arguments_into_pseudos): Likewise.
	* ifcvt.c (noce_emit_move_insn): Likewise.
	* stmt.c (expand_return): Likewise.
	* expr.c (emit_group_load, emit_group_store, copy_blkmode_from_reg,
	store_field, expand_expr_real_1): Likewise.

2004-07-10  Richard Henderson  <rth@redhat.com>

	* builtins.c (std_gimplify_va_arg_expr): Fix borked BIT_AND_EXPR.

2004-07-09  Mike Stump  <mrs@apple.com>

	* config/darwin.c (no_dead_strip): Add.
	(HAVE_DEAD_STRIP): Add.
	(darwin_emit_unwind_label): Ensure that we don't dead code strip
	the .eh label.

2004-07-09  Zdenek Dvorak  <rakdver@atrey.karlin.mff.cuni.cz>

	* tree-ssa-loop-im.c: New file.
	* Makefile.in (tree-ssa-loop-im.o): Add.
	* cfgloop.c (superloop_at_depth): New function.
	* cfgloop.h (superloop_at_depth): Declare.
	* common.opt (ftree-lim): New flag.
	* expr.c (array_ref_up_bound): New function.
	* params.def (PARAM_LIM_EXPENSIVE): New parameter.
	* timevar.def (TV_LIM): New timevar.
	* tree-dfa.c (compute_immediate_uses): Respect TDFA_USE flags when
	computing immediate uses of a phi node.
	* tree-flow.h (struct tree_ann_common_d): Add aux field.
	(loop_commit_inserts, for_each_index, tree_ssa_lim): Declare.
	* tree-optimize.c (init_tree_optimization_passes): Add pass_lim.
	* tree-pass.h (pass_lim): Declare.
	* tree-ssa-loop.c (tree_ssa_loop_im, gate_tree_ssa_loop_im): New
	functions.
	(pass_lim): New pass structure.
	* tree-eh.c (tree_could_trap_p): Handle ARRAY_REFs correctly.
	* tree.c (in_array_bounds_p): New function.
	* tree.h (TREE_THIS_NOTRAP): Define also for ARRAY_REFs.
	(in_array_bounds_p, array_ref_up_bound): Declare.
	* doc/invoke.texi (-ftree-lim, --param lim-expensive): Document.
	* doc/passes.texi (tree-ssa-loop-im.c): Document.

2004-07-09  Richard Henderson  <rth@redhat.com>

	* builtins.c (expand_builtin_stpcpy): Don't modify len.

	* tree-ssa-ccp.c (ccp_fold_builtin): Strip conversion exprs
	with prejudice.

2004-07-10  Kelley Cook  <kcook@gcc.gnu.org>

	* flags.h: Delete redundant prototypes that are being generated
	in options.h from common.opt.
	* common.opt: Add in the expository comments formerly in flags.h.

2004-07-09  Jan Beulich  <jbeulich@novell.com>

	* config/i386/i386.c (init_cumulative_args): Set mmx/sse registers
	available for use only when TARGET_MMX/_SSE is set, and check for
	variable argument function if any register count is non-zero.
	(function_arg): Correctly suppress repeated warnings for passing SSE
	vectors are arguments without SSE enabled.
	(ix86_function_arg_boundary): Without SSE enabled, the use of what
	would be SSE register modes does no longer influence the alignment.

2004-07-09  Richard Henderson  <rth@redhat.com>

	* builtins.c (std_gimplify_va_arg_expr): Deny ARGS_GROW_DOWNWARD.
	Always align upward to arg boundary.  Use size_in_bytes/round_up.
	Maintain type-correctness of constants.
	* stor-layout.c (round_up, round_down): Special-case powers of 2.

2004-07-09  David S. Miller  <davem@nuts.davemloft.net>

	* config/sparc/sparc.c (*_costs): Scale instruction costs
	by COSTS_N_INSNS.
	(sparc_rtx_costs): Adjust as appropriate.

2004-07-09  Jan Beulich  <jbeulich@novell.com>

	* config/i386/mm3dnow.h: New.
	* config.gcc: Add mm3dnow.h to extra_headers for i?86 and x86-64.

2004-07-09  Richard Henderson  <rth@redhat.com>

	* simplify-rtx.c (simplify_const_relational_operation): Only
	look at bounds of scalar integers.

2004-07-09  Jan Beulich  <jbeulich@novell.com>

	* config/i386/i386.md (sse2_clflush): Use correct operand for clflush.

2004-07-09  Andrew Pinski  <apinski@apple.com>

	* objc/objc-act.c (build_module_descriptor): Mark UOBJC_MODULES_decl as
	always referenced.
	(synth_forward_declarations): Likewise for UOBJC_CLASS_decl and
	UOBJC_METACLASS_decl.

2004-07-09  James E Wilson  <wilson@specifixinc.com>

	PR target/16364
	* config/ia64/ia64.c (ia64_function_arg): For a single element HFA,
	do return a parallel if hfa_mode == XFmode and mode == TImode.

2004-07-09  Jan Beulich  <jbeulich@novell.com>

	* c-typeck.c (build_unary_op): include VECTOR_TYPE in set of codes
	permissible for unary plus.

2004-07-09  Jan Beulich  <jbeulich@novell.com>

	* builtin-types.def (BT_UINT): Rename from BT_UNSIGNED.
	(BT_FN_UINT): Rename from BT_FN_UNSIGNED.
	(BT_FN_PTR_UINT): Rename from BT_FN_PTR_UNSIGNED.
	(BT_ULONG, BT_ULONGLONG, BT_UINTMAX, BT_FN_INT_UINT, BT_FN_INT_ULONG,
	BT_FN_INT_ULONGLONG, BT_FN_INT_INTMAX, BT_FN_INT_UINTMAX): New.
	* builtins.def (BUILTIN_CLZxxx, BUILTIN_CTXxxx, BUILTIN_PARITYxxx,
	BUILTIN_POPCOUNTxxx): Arguments are unsigned.
	(BUILTIN_xxxIMAX): New.
	* builtins.c (expand_builtin): Handle BUILT_IN_FFSIMAX,
	BUILT_IN_CLZIMAX, BUILT_IN_CTZIMAX, BUILT_IN_POPCOUNIMAX, and
	BUILT_IN_PARITYIMAX.

2004-07-09  David S. Miller  <davem@nuts.davemloft.net>

	* config/sparc/sparc.h (processor_costs): Define.
	(sparc_costs): Declare.
	* config/sparc/sparc.c (cypress_costs, supersparc_costs,
	hypersparc_costs, sparclet_costs, ultrasparc_costs,
	ultrasparc3_costs): New.
	(sparc_override_options): Set sparc_costs as appropriate.
	(sparc_rtx_costs): Use sparc_costs instead of messy
	conditionals.

2004-07-09  Steven Bosscher  <stevenb@suse.de>

	* doc/md.texi (Processor pipeline description): Mention that
	the old pipeline description is deprecated.

	* config/rs6000/7450.md (automaton ppc7450): Split up, move
	mciu_7450 function unit to...
	(automaton ppc7450mciu): ...new automaton.

	* haifa-sched.c (insert_schedule_bubbles_p): Remove.
	(schedule_block): Don't consider inserting bubbles.
	(sched_init): Don't initialize DFA bubbles.
	* target-def.h (TARGET_SCHED_INIT_DFA_BUBBLES,
	TARGET_SCHED_DFA_BUBBLE): Remove.
	* target.h (init_dfa_bubbles, dfa_bubble): Remove hooks.
	* doc/tm.texi (TARGET_SCHED_INIT_DFA_BUBBLES,
	TARGET_SCHED_DFA_BUBBLE): Remove documentation.

	* stmt.c (conditional_context): Remove prototype.
	* tree.h (conditional_context): Remove.
	* tree-cfg.c (pre_insert_on_edge): Remove.

	* c-common.h (c_expand_asm_operands): Remove prototype.
	* c-typeck.c (c_expand_asm_operands): Remove.

2004-07-09  Jan Beulich  <jbeulich@novell.com>

	* config/i386/i386.c (classify_argument): Treat V1xx modes the same as
	their base modes. CTImode, TCmode, and XCmode must be passed in memory.
	TFmode (__float128) must be is an SSE/SSEUP pair. V2SImode, V4HImode,
	and V8QI are class SSE. All sufficiently small remaining vector modes
	must be passed in one or two integer registers.
	(ix86_libcall_value): TFmode must be returned in xmm0, XCmode must be
	returned in memory.
	(bdesc_2arg, ix86_init_mmx_sse_builtins): __builtin_ia32_pmuludq and
	__builtin_ia32_pmuludq128 have non-uniform argument and return types
	and must thus be handled explicitly.
	* config/i386/i386.md (*movdi_1_rex64): Add cases for moving between
	MMX and XMM regs.
	(movv8qi_internal, movv4hi_internal, movv2si_internal,
	movv2sf_internal): Permit moving between MMX and XMM registers (since
	MMX areguments and return values are passed in XMM registers).
	(sse2_umulsidi3): Correct type and mode.

2004-07-09  Richard Henderson  <rth@redhat.com>

	* tree-cfg.c (dump_cfg_stats): Fix 64-bit format mismatch errors.

2004-07-09  Eric Christopher  <echristo@redhat.com>

	* config/rs6000/40x.md: Split into two automatons.

2004-07-09  Zack Weinberg  <zack@codesourcery.com>
	    Andrew Pinski  <apinski@apple.com>

	* c-opts.c (c_common_post_options): Force unit-at-a-time mode
	on when we have more than one input file.
	(c_common_parse_file): Restore loop over all input files.
	Clarify diagnostic for -dy when YYDEBUG wasn't defined.

	* c-decl.c (set_type_context): New function.
	(pop_scope): Use it to set context of types.  When we
	encounter a TYPE_DECL, set the context of the attached type too.
	(pop_file_scope): Don't call cpp_undef_all here.
	(diagnose_mismatched_decls): Do not complain about a second
	definition of an 'extern inline' function if it's not in the
	same translation unit.  Do not complain about inline
	declaration after use if the use was in a different
	translation unit.
	(merge_decls): Don't clobber olddecl's DECL_CONTEXT.
	(pushdecl): Do not put DECL_EXTERNAL, !TREE_PUBLIC decls in
	the external scope.
	(pushdecl_top_level): Likewise.
	(grokdeclarator): Clarify what is going on with setting
	DECL_EXTERNAL on function types, a little.
	(c_write_global_declarations): Don't do anything if
	-fsyntax-only or errors have been encountered.

2004-07-09  Zack Weinberg  <zack@codesourcery.com>

	* vec.c, vec.h (vec_assert_fail): Use unsigned int for LINE argument.

2004-07-09  John David Anglin  <dave.anglin@nrc-cnrc.gc.ca>

	PR target/16459
	* pa.c (output_indirect_call): Use %r2 as the link register when
	calling $$dyncall with a pc-relative branch.

2004-07-08  Gerald Pfeifer  <gerald@pfeifer.com>

	* doc/install.texi (Binaries): Mention OpenPKG.

2004-07-09  Diego Novillo  <dnovillo@redhat.com>

	Fix PR tree-optimization/15555
	* tree-dfa.c (dump_variable): If the variable is a pointer
	SSA_NAME, also dump its points-to information.
	* tree-flow.h (struct ptr_info_def): Add field
	is_dereferenced.
	(dump_points_to_info_for): Declare.
	(debug_points_to_info_for): Declare.
	* tree-optimize.c (init_tree_optimization_passes): Add a
	second alias analysis pass after DOM2.
	Move pass_del_pta to a later spot.
	* tree-ssa-alias.c (compute_points_to_and_addr_escape): Do not
	create a name tags when we find a dereferenced pointer.  Just
	mark the pointer dereferenced.
	(collect_points_to_info_for): Move code to clear points-to
	information to create_name_tags.
	(create_name_tags): New function.
	(compute_flow_sensitive_aliasing): Call it.
	(setup_pointers_and_addressables): Mark type tags for renaming
	here instead of ...
	(create_memory_tag): ... here.
	(merge_pointed_to_info): Do not merge PT_MALLOC attributes.
	(dump_points_to_info_for): Declare extern.
	(debug_points_to_info_for): New function.

2004-07-09  Paolo Bonzini  <bonzini@gnu.org>

	* config/arc/arc.md: Switch to DFA-based scheduler description.
	* config/arc/arc.c: Switch to DFA-based scheduler description.

2004-07-09  Richard Earnshaw  <rearnsha@arm.com>

	* arm/unknown-elf.h (TARGET_DEFAULT): Don't require an APCS frame
	pointer.

2004-07-09  Richard Henderson  <rth@redhat.com>

	* config/xtensa/xtensa-protos.h (xtensa_va_arg): Remove.
	* config/xtensa/xtensa.c (TARGET_GIMPLIFY_VA_ARG_EXPR): New.
	(xtensa_gimplify_va_arg_expr): Rewrite from xtensa_va_arg.
	* config/xtensa/xtensa.h (EXPAND_BUILTIN_VA_ARG): Remove.

	* config/v850/v850-protos.h (v850_va_arg): Remove.
	* config/v850/v850.c (TARGET_GIMPLIFY_VA_ARG_EXPR): New.
	(v850_gimplify_va_arg_expr): Rewrite from v850_va_arg.
	* config/v850/v850.h (EXPAND_BUILTIN_VA_ARG): Remove.
	(FUNCTION_ARG_PASS_BY_REFERENCE): Handle variable size types.
	(FUNCTION_ARG_CALLEE_COPIES): Use FUNCTION_ARG_PASS_BY_REFERENCE.

2004-07-09  Richard Earnshaw  <rearnsha@arm.com>

	PR target/12133
	* arm.c (arm_legitimate_index_p) Allow DFmode for soft-float
	and DImode to use +/-4k offset.

2004-07-09  Richard Henderson  <rth@redhat.com>

	* config/stormy16/stormy16-protos.h (xstormy16_expand_builtin_va_arg):
	Remove.
	* config/stormy16/stormy16.c (TARGET_GIMPLIFY_VA_ARG_EXPR): New.
	(xstormy16_gimplify_va_arg_expr): Rewrite from
	xstormy16_expand_builtin_va_arg.
	* config/stormy16/stormy16.h (EXPAND_BUILTIN_VA_ARG): Remove.

	* config/sparc/sparc-protos.h (sparc_va_arg): Remove.
	* config/sparc/sparc.c (sparc_gimplify_va_arg): Mark static.

	* config/sh/sh-protos.h (sh_va_arg): Remove.
	* config/sh/sh.c (TARGET_GIMPLIFY_VA_ARG_EXPR): New.
	(sh_gimplify_va_arg_expr): Rewrite from sh_va_arg.
	* config/sh/sh.h (EXPAND_BUILTIN_VA_ARG): Remove.

	* config/pa/pa-protos.h (hppa_va_arg): Remove.
	* config/pa/pa.c (TARGET_GIMPLIFY_VA_ARG_EXPR): New.
	(hppa_gimplify_va_arg_expr): Rewrite from hppa_va_arg.
	* config/pa/pa.h (EXPAND_BUILTIN_VA_ARG): Remove.

	* config/mn10300/mn10300-protos.h (mn10300_va_arg): Remove.
	* config/mn10300/mn10300.c (TARGET_GIMPLIFY_VA_ARG_EXPR): New.
	(mn10300_gimplify_va_arg_expr): Rewrite from mn10300_va_arg.
	* config/mn10300/mn10300.h (EXPAND_BUILTIN_VA_ARG): Remove.

2004-07-09  Eric Botcazou  <ebotcazou@libertysurf.fr>

	* config/sparc/sparc.md (return): Rewrite length formula.
	* config/sparc/sparc.c (output_return): Pass 1 as 5th
	argument to final_scan_insn when in a delay slot.
	(output_sibcall): Likewise.

2004-07-09  Richard Earnshaw  <rearnsha@arm.com>

	* arm.c (arm_cpp_interwork): New variable.
	(arm_override_options): Set it if TARGET_INTERWORK was on the command
	line.
	* arm.h (arm_cpp_interwork): Declare it.
	(TARGET_CPU_CPP_BUILTINS): Use it to control definition of
	__THUMB_INTERWORK__ in the preprocessor.

2004-07-09  Nathan Sidwell  <nathan@codesourcery.com>

	* vec.h (VEC_T_alloc): Fix MEM_STAT_DECL pasto.

2004-07-09  Eric Botcazou  <ebotcazou@libertysurf.fr>

	PR target/16416
	* config/sparc/sol2-bi.h (OPTION_DEFAULT_SPECS): New macro.
	Override default settings to account for -m32 and -m64.

2004-07-08  Randolph Chung  <tausq@debian.org>

	* pa32-linux.h (MD_FALLBACK_FRAME_STATE_FOR): Define.

2004-07-09  Alexandre Oliva  <aoliva@redhat.com>

	* builtins.c (fold_builtin_strncpy): Make sure len is a constant
	before comparing it as such.

2004-07-08  Richard Henderson  <rth@redhat.com>

	* builtins.c (std_gimplify_va_arg_expr): Hoist valist into a
	temporary.  Use bit arithmetic to align.

2004-07-08  Jerry Quinn  <jlquinn@optonline.net>

	* alias.c (nonlocal_mentioned_p, nonlocal_referenced_p,
	nonlocal_set_p, init_alias_analysis): Use, LABEL_P, JUMP_P, CALL_P,
	NONJUMP_INSN_P, INSN_P, NOTE_P, BARRIER_P.
	* bb-reorder.c (mark_bb_for_unlikely_executed_section,
	add_labels_and_missing_jumps, find_jump_block,
	fix_crossing_unconditional_branches, add_reg_crossing_jump_notes):
	Likewise.
	* bt-load.c (btr_referenced_p, compute_defs_uses_and_gen,
	link_btr_uses, move_btr_def): Likewise.
	* builtins.c (expand_builtin_longjmp, expand_builtin_nonlocal_goto,
	expand_builtin_expect_jump): Likewise.
	* caller-save.c (save_call_clobbered_regs, insert_one_insn): Likewise.
	* calls.c (expand_call, emit_library_call_value_1): Likewise.
	* cfganal.c (forwarder_block_p): Likewise.
	* cfgbuild.c (inside_basic_block_p, count_basic_blocks,
	make_label_edge, rtl_make_eh_edge, make_edges, find_basic_blocks_1,
	find_bb_boundaries): Likewise.
	* cfgcleanup.c (try_simplify_condjump, try_forward_edges,
	merge_blocks_move_predecessor_nojumps,
	merge_blocks_move_successor_nojumps, insns_match_p,
	flow_find_cross_jump, outgoing_edges_match, try_crossjump_to_edge,
	try_optimize_cfg): Likewise.
	* cfgexpand.c (expand_block, construct_exit_block): Likewise.
	* cfglayout.c (skip_insns_after_block, label_for_bb,
	record_effective_endpoints, insn_locators_initialize,
	fixup_reorder_chain, update_unlikely_executed_notes): Likewise.
	* cfgmainloop.c (create_loop_notes): Likewise.
	* cfgrtl.c (delete_insn, delete_insn_chain,
	create_basic_block_structure, rtl_delete_block, free_bb_for_insn,
	update_bb_for_insn, rtl_merge_blocks, rtl_can_merge_blocks,
	block_label, try_redirect_by_replacing_jump, last_loop_beg_note,
	redirect_branch_edge, force_nonfallthru_and_redirect,
	rtl_tidy_fallthru_edge, back_edge_of_syntactic_loop_p,
	rtl_split_edge, commit_one_edge_insertion, print_rtl_with_bb,
	update_br_prob_note, rtl_verify_flow_info_1, rtl_verify_flow_info,
	purge_dead_edges, cfg_layout_redirect_edge_and_branch,
	cfg_layout_delete_block, cfg_layout_can_merge_blocks_p,
	cfg_layout_merge_blocks, rtl_block_ends_with_call_p,
	need_fake_edge_p, rtl_flow_call_edges_add): Likewise.
	* combine.c (combine_instructions, can_combine_p, try_combine,
	find_split_point, record_dead_and_set_regs, reg_dead_at_p,
	distribute_notes, distribute_links, insn_cuid): Likewise.
	* cse.c (fold_rtx, cse_insn, cse_around_loop,
	invalidate_skipped_block, cse_set_around_loop,
	cse_end_of_basic_block, cse_main, cse_basic_block,
	cse_condition_code_reg): Likewise.
	* cselib.c (cselib_process_insn): Likewise.
	* ddg.c (create_ddg): Likewise.
	* df.c (df_insn_refs_record, df_bb_rd_local_compute, df_insns_modify):
	Likewise.
	* dwarf2out.c (dwarf2out_stack_adjust, dwarf2out_frame_debug,
	gen_label_die, dwarf2out_var_location): Likewise.
	* emit-rtl.c (get_first_nonnote_insn, get_last_nonnote_insn,
	next_insn, previous_insn, next_nonnote_insn, prev_nonnote_insn,
	last_call_insn, active_insn_p, next_label, prev_label,
	link_cc0_insns, next_cc0_user, try_split, add_insn_after,
	add_insn_before, remove_insn, add_function_usage_to,
	reorder_insns, find_line_note, remove_unnecessary_notes,
	emit_insn_after_1, classify_insn): Likewise.
	* except.c (convert_from_eh_region_ranges_1, emit_to_new_bb_before,
	connect_post_landing_pads, sjlj_mark_call_sites,
	sjlj_emit_function_enter, sjlj_emit_function_exit, reachable_handlers,
	can_throw_internal, can_throw_external, set_nothrow_function_flags,
	convert_to_eh_region_ranges): Likewise.
	* explow.c (optimize_save_area_alloca): Likewise.
	* expr.c (expand_expr_real): Likewise.
	* final.c (insn_current_reference_address, compute_alignments,
	shorten_branches, final, scan_ahead_for_unlikely_executed_note,
	final_scan_insn, output_asm_label, leaf_function_p): Likewise.
	* flow.c (first_insn_after_basic_block_note, delete_dead_jumptables,
	propagate_block_delete_insn, propagate_one_insn,
	init_propagate_block_info, propagate_block, libcall_dead_p,
	mark_set_1, attempt_auto_inc, find_auto_inc, try_pre_increment):
	Likewise.
	* function.c (instantiate_virtual_regs,	reorder_blocks_1,
	expand_function_start, expand_function_end, contains,
	thread_prologue_and_epilogue_insns,
	reposition_prologue_and_epilogue_notes): Likewise.
	* gcse.c (constprop_register, bypass_conditional_jumps,
	insert_insn_end_bb, gcse_after_reload): Likewise.
	* genemit.c (gen_expand, gen_split): Likewise.
	* genpeep.c (gen_peephole, main): Likewise.
	* global.c (build_insn_chain): Likewise.
	* graph.c (node_data, print_rtl_graph_with_bb): Likewise.
	* haifa-sched.c (unlink_other_notes, unlink_line_notes,
	get_block_head_tail, no_real_insns_p, rm_line_notes, save_line_notes,
	restore_line_notes, rm_redundant_line_notes, rm_other_notes,
	ok_for_early_queue_removal, set_priorities, sched_init): Likewise.
	* ifcvt.c (count_bb_insns, first_active_insn, last_active_insn,
	cond_exec_process_insns, end_ifcvt_sequence, noce_process_if_block,
	merge_if_block, block_jumps_and_fallthru_p, find_if_block,
	dead_or_predicable): Likewise.
	* integrate.c (try_constants): Likewise.
	* jump.c (rebuild_jump_labels, cleanup_barriers,
	purge_line_number_notes, init_label_info, mark_all_labels,
	squeeze_notes, get_label_before, get_label_after,
	reversed_comparison_code_parts, simplejump_p, pc_set,
	returnjump_p, onlyjump_p, follow_jumps, mark_jump_label,
	delete_barrier, delete_prior_computation, delete_computation,
	delete_related_insns, delete_for_peephole, redirect_jump):
	Likewise.
	* lcm.c (optimize_mode_switching): Likewise.
	* local-alloc.c (validate_equiv_mem, update_equiv_regs, block_alloc):
	Likewise.
	* loop-doloop.c (doloop_valid_p, doloop_optimize): Likewise.
	* loop-invariant.c (find_exits, find_invariants_bb): Likewise.
	* loop-iv.c (simplify_using_assignment): Likewise.
	* loop.c (compute_luids, loop_optimize, scan_loop, libcall_other_reg,
	libcall_benefit, skip_consec_insns, move_movables, prescan_loop,
	find_and_verify_loops, labels_in_range_p, for_each_insn_in_loop,
	loop_bivs_init_find, strength_reduce, check_insn_for_bivs,
	check_insn_for_givs, check_final_value, update_giv_derive,
	basic_induction_var, product_cheap_p, check_dbra_loop,
	loop_insn_first_p, last_use_this_basic_block,
	canonicalize_condition, get_condition, loop_regs_scan, load_mems,
	try_copy_prop, LOOP_BLOCK_NUM, loop_dump_aux): Likewise.
	* modulo-sched.c (doloop_register_get, find_line_note, sms_schedule,
	sms_schedule_by_order): Likewise.
	* optabs.c (emit_no_conflict_block, emit_libcall_block): Likewise.
	* postreload.c (reload_cse_simplify_operands, reload_combine,
	reload_cse_move2add): Likewise.
	* predict.c (can_predict_insn_p, estimate_probability,
	expected_value_to_br_prob, process_note_predictions): Likewise.
	* print-rtl.c (print_rtx, print_rtl, print_rtl_single): Likewise.
	* profile.c (branch_prob): Likewise.
	* ra-build.c (live_out_1, livethrough_conflicts_bb,
	detect_webs_set_in_cond_jump): Likewise.
	* ra-debug.c (ra_print_rtx_object, ra_debug_insns,
	ra_print_rtl_with_bb): Likewise.
	* ra-rewrite.c (insert_stores, rewrite_program2): Likewise.
	* recog.c (next_insn_tests_no_inequality, find_single_use,
	split_all_insns, peephole2_optimize, if_test_bypass_p): Likewise.
	* reg-stack.c (next_flags_user, record_label_references,
	emit_swap_insn, swap_rtx_condition, subst_stack_regs,
	compensate_edge, convert_regs_1): Likewise.
	* regclass.c (scan_one_insn): Likewise.
	* regmove.c (optimize_reg_copy_1, optimize_reg_copy_2, fixup_match_2,
	regmove_optimize, fixup_match_1, single_set_for_csa,
	combine_stack_adjustments_for_block): Likewise.
	* regrename.c (build_def_use, copyprop_hardreg_forward_1): Likewise.
	* reload.c (find_reloads, find_reloads_address_1, subst_reloads,
	find_equiv_reg): Likewise.
	* reload1.c (reload, calculate_needs_all_insns, set_label_offsets,
	reload_as_needed, emit_input_reload_insns, do_output_reload,
	delete_output_reload, delete_address_reloads_1, fixup_abnormal_edges):
	Likewise.
	* reorg.c (find_end_label, emit_delay_sequence,
	delete_from_delay_slot, delete_scheduled_jump, optimize_skip,
	get_jump_flags, rare_destination, mostly_true_jump,
	try_merge_delay_insns, redundant_insn, own_thread_p,
	fill_simple_delay_slots, fill_slots_from_thread,
	fill_eager_delay_slots, relax_delay_slots, make_return_insns,
	dbr_schedule): Likewise.
	* resource.c (find_basic_block, next_insn_no_annul,
	find_dead_or_set_registers, mark_target_live_regs): Likewise.
	* rtl.h (RTX_PREV): Likewise.
	* rtlanal.c (global_reg_mentioned_p, no_labels_between_p,
	no_jumps_between_p, reg_used_between_p, reg_referenced_between_p,
	reg_set_p, find_last_value, dead_or_set_regno_p, find_reg_fusage,
	find_regno_fusage, pure_call_p, replace_label, rtx_referenced_p_1,
	tablejump_p, computed_jump_p, insns_safe_to_move_p,
	find_first_parameter_load, can_hoist_insn_p): Likewise.
	* sched-deps.c (get_condition, add_dependence, sched_analyze_2,
	sched_analyze_insn, sched_analyze, add_forward_dependence): Likewise.
	* sched-ebb.c (fix_basic_block_boundaries, add_deps_for_risky_insns,
	schedule_ebbs): Likewise.
	* sched-rgn.c (is_cfg_nonregular, find_conditional_protection,
	is_conditionally_protected, can_schedule_ready_p,
	add_branch_dependences, debug_dependencies): Likewise.
	* stmt.c (emit_nop, expand_start_case, emit_jump_if_reachable):
	Likewise.
	* unroll.c (unroll_loop, copy_loop_body, back_branch_in_range_p,
	reg_dead_after_loop, loop_find_equiv_value, loop_iterations,
	set_dominates_use, ujump_to_loop_cont): Likewise.
	* var-tracking.c (prologue_stack_adjust, vt_initialize): Likewise.
	* varasm.c (output_constant_pool_1): Likewise.

2004-07-08  Zdenek Dvorak  <rakdver@atrey.karlin.mff.cuni.cz>

	* tree-scalar-evolution.c: New file.
	* tree-scalar-evolution.h: New file.
	* tree-ssa-loop-niter.c: New file.
	* Makefile.in (SCEV_H): New.
	(tree-scalar-evolution.o, tree-ssa-loop-niter.o): Add new files.
	* cfgloop.h (struct loop): Add bounds field.
	* tree-flow.h (struct tree_niter_desc): New type.
	(number_of_iterations_cond, number_of_iterations_exit,
	loop_niter_by_eval, find_loop_niter_by_eval,
	estimate_numbers_of_iterations, can_count_iv_in_wider_type,
	free_numbers_of_iterations_estimates): Declare.
	* tree.h (lower_bound_in_type, upper_bound_in_type): Declare.
	* params.def (PARAM_MAX_ITERATIONS_TO_TRACK): New parameter.
	* doc/invoke.texi (max-iterations-to-track): Document.

2004-07-08  Kaz Kojima  <kkojima@gcc.gnu.org>

	* config/sh/sh.c (sh_va_arg): Initinalize lab_over.
	* config/sh/sh.h (CONST_OK_FOR_J16): Use parentheses.
	(MODE_AFTER): Add cast appropriately.
	* config/sh/sh.md (movdi splitter): Likewise.
	(casesi_worker_2): Add const qualifier appropriately.
	(eh_return): Remove unused variable.
	(insv): Initialize v;

2004-07-08  Richard Henderson  <rth@redhat.com>

	* config/mmix/mmix-protos.h (mmix_expand_builtin_va_arg): Remove.
	* config/mmix/mmix.c (TARGET_GIMPLIFY_VA_ARG_EXPR): New.
	(mmix_gimplify_va_arg_expr): Rewrite from mmix_expand_builtin_va_arg.
	* config/mmix/mmix.h (EXPAND_BUILTIN_VA_ARG): Remove.
	(FRAME_POINTER_REQUIRED): Use current_function_has_nonlocal_label.

	* config/m32r/m32r-protos.h (m32r_va_arg): Remove.
	* config/m32r/m32r.c (TARGET_GIMPLIFY_VA_ARG_EXPR): New.
	(m32r_gimplify_va_arg_expr): Rewrite from m32r_va_arg.
	* config/m32r/m32r.h (EXPAND_BUILTIN_VA_ARG): Remove.

	* config/iq2000/iq2000-protos.h (iq2000_va_arg): Remove.
	* config/iq2000/iq2000.c (TARGET_GIMPLIFY_VA_ARG_EXPR): New.
	(iq2000_gimplify_va_arg_expr): Rewrite from iq2000_va_arg.
	* config/iq2000/iq2000.h (EXPAND_BUILTIN_VA_ARG): Remove.

	* config/frv/frv-protos.h (frv_expand_builtin_va_arg): Remove.
	* config/frv/frv.c (TARGET_GIMPLIFY_VA_ARG_EXPR): New.
	(frv_gimplify_va_arg_expr): Rewrite from frv_expand_builtin_va_arg.
	* config/frv/frv.h (EXPAND_BUILTIN_VA_ARG): Remove.

	* config/i860/i860-protos.h (i860_va_arg): Remove.
	* config/i860/i860.c (TARGET_GIMPLIFY_VA_ARG_EXPR): New.
	(i860_gimplify_va_arg_expr): Rewrite from i860_va_arg.
	* config/i860/i860.h (EXPAND_BUILTIN_VA_ARG): Remove.

2004-05-31  Aaron W. LaFramboise <aaronraolete36@aaronwl.com>

	* system.h: Prototype getpagesize if missing.
	* configure.ac: Add getpagesize to gcc_AC_CHECK_DECLS.
	* configure: Regenerate.
	* config.in: Regenerate.

2004-07-08  Richard Henderson  <rth@redhat.com>

	* config/fr30/fr30-protos.h (fr30_va_arg): Remove.
	* config/fr30/fr30.c (TARGET_GIMPLIFY_VA_ARG_EXPR): New.
	(fr30_gimplify_va_arg_expr): New.
	(fr30_pass_by_reference, fr30_pass_by_value, fr30_va_arg): Remove.
	* config/fr30/fr30.h (EXPAND_BUILTIN_VA_ARG): Remove.

2004-07-08  Vladimir Makarov  <vmakarov@redhat.com>

	PR target/16414
	* config/ia64/ia64.c (ia64_dfa_new_cycle): Fix typo in comparison
	of asm_noperands result.

2004-07-08  Richard Henderson  <rth@redhat.com>

	* config/cris/cris-protos.h (cris_expand_builtin_va_arg): Remove.
	* config/cris/cris.c (TARGET_GIMPLIFY_VA_ARG_EXPR): New.
	(cris_gimplify_va_arg_expr): Rewrite from cris_expand_builtin_va_arg.
	* config/cris/cris.h (EXPAND_BUILTIN_VA_ARG): Remove.

2004-07-08  Richard Henderson  <rth@redhat.com>

	* builtins.c (ind_gimplify_va_arg_expr): New.
	* tree.h (ind_gimplify_va_arg_expr): Declare.
	* config/arc/arc.c (arc_gimplify_va_arg_expr): Use it.

2004-07-08  Jan Beulich  <jbeulich@novell.com>

	* expmed.c (extract_bit_field): Correct condition to use vec_extract
	patterns also on vector elements other than the first one.
	* config/i386/i386.md (vec_extractv2df, vec_extractv4sf): Add missing
	break statements.

2004-07-08  Geoffrey Keating  <geoffk@apple.com>

	* config/rs6000/darwin-ldouble.c: Correct reference
	to the Linnainmaa paper.

2004-07-08  Richard Henderson  <rth@redhat.com>

	* config/arc/arc-protos.h (arc_va_arg): Remove.
	* config/arc/arc.c (TARGET_GIMPLIFY_VA_ARG_EXPR): New.
	(arc_gimplify_va_arg_expr): Rewrite from arc_va_arg.
	* config/arc/arc.h (EXPAND_BUILTIN_VA_ARG): Remove.

	* config/c4x/c4x-protos.h (c4x_va_arg): Remove.
	* config/c4x/c4x.c (TARGET_GIMPLIFY_VA_ARG_EXPR): New.
	(c4x_gimplify_va_arg_expr): Rewrite from c4x_va_arg.
	* config/c4x/c4x.h (EXPAND_BUILTIN_VA_ARG): Remove.

2004-07-08  John David Anglin  <dave.anglin@nrc-cnrc.gc.ca>

	* pa.md (prefetch_32, prefetch_64): Simplify constraint checks.

2004-07-08  Zack Weinberg  <zack@codesourcery.com>

	* c-decl.c (static_ctors, static_dtors): Make static.
	(pop_file_scope): Call c_common_write_pch and
	cgraph_finalize_compilation_unit here.
	(build_cdtor): Moved here from c-objc-common.c; simplify.
	(c_write_global_declarations_1): Clarify comment.
	(c_write_global_declarations): Close the external scope before
	doing anything else.  Call build_cdtor, cgraph_optimize, and
	mudflap_finish_file here.
	* c-lang.c (finish_file): Don't call c_objc_common_finish_file.
	Clarify comment.
	* c-objc-common.c: No need to include cgraph.h.
	(build_cdtor): Moved to c-decl.c.
	(c_objc_common_finish_file): Delete.
	* c-tree.h: Update to match.
	* objc/objc-act.c (finish_file): Don't call c_objc_common_finish_file.
	(generate_static_references): Set TREE_USED before calling finish_decl.
	Eliminate unnecessary dummy declaration.  Call rest_of_decl_compilation
	on the static_instances_decl.

2004-07-08  Zack Weinberg  <zack@codesourcery.com>

	* c-decl.c (pop_scope): Do not set DECL_CONTEXT on file-scope
	decls when there is only one input translation unit.
	* langhooks.c (lhd_set_decl_assembler_name): Partially revert
	change of 2004-07-05; do not treat declarations with
	DECL_CONTEXT a TRANSLATION_UNIT_DECL specially.
	* opts.c (cur_in_fname): Delete.
	* opts.h: Likewise.
	* tree.c: Revert changes of 2004-07-05; no special treatment
	for TRANSLATION_UNIT_DECLs.
	* Makefile.in (tree.o): Update dependencies.

2004-07-08  Roger Sayle  <roger@eyesopen.com>

	* builtins.c (fold_builtin_strcpy): Merge functionality from
	simplify_builtin_strcpy.  Add additional len argument.  No longer
	static.  Remove function prototype.
	(fold_builtin_strncpy): Likewise integrate functionality from
	simplify_builtin_strncpy.  Add additional slen argument.  No
	longer static.  Remove function prototype.
	(simplify_builtin_strcy, simplify_builtin_strncpy): Delete.
	(simplify_builtin_fputs): Rename to fold_builtin_fputs.  Change
	types of "ignore" and "unlocked" parameters to bool.
	(fold_builtin_1):  Add additional ignore argument.  Call renamed
	fold_builtin_fputs to simplify GCC "fputs" and "fputs_unlocked"
	builtins.  Update arguments to fold_builtin_strncpy and
	fold_builtin_strcpy.  Add function prototype.
	(fold_builtin): Add additional Boolean ignore argument to pass
	to fold_builtin_1.
	(simplify_builtin): Call fold_builtin_fputs, fold_builtin_strcpy
	and fold_builtin_strncpy instead of simplify_builtin_fputs,
	simplify_builtin_strcpy and simplify_builtin_strncpy respectively.

	* expr.h (simplify_builtin_fputs, simplify_builtin_strcpy,
	simplify_builtin_strncpy): Delete function prototypes.
	* tree.h (fold_builtin_fputs, fold_builtin_strcpy,
	fold_builtin_strncpy): Add function prototypes here.
	(fold_builtin): Update function prototype with new "bool ignore".

	* tree-ssa-ccp.c (ccp_fold): Update call to fold_builtin.
	(ccp_fold_builtin):  Update call to fold_builtin.  Call
	fold_builtin_fputs, fold_builtin_strcpy and fold_builtin_strncpy
	instead of simplify_builtin_fputs, simplify_builtin_strcpy and
	simplify_builtin_strncpy respectively.
	* fold-const.c (fold): Update call to fold_builtin.

2004-07-08  Alexandre Oliva  <aoliva@redhat.com>

	* builtins.c (expand_builtin_stpcpy): Un-simplify decay of stpcpy
	to strcpy.

	* expr.h (FUNCTION_ARG_PARTIAL_NREGS): Default to 0.
	(FUNCTION_ARG_PASS_BY_REFERENCE): Likewise.
	(FUNCTION_ARG_CALLEE_COPIES): Likewise.
	* calls.c: Remove ifdefs of macros above.
	* functions.c: Likewise.
	* expr.c: Likewise.

2004-07-08  Eric Botcazou  <ebotcazou@libertysurf.fr>

	* config/sparc/sparc.md (UNSPECV_GOTO_V9): Delete.
	(arch attribute): Delete.
	(current_function_calls_alloca attribute): Rename into calls_alloca.
	(calls_eh_return): New attribute.
	(leaf_function): Likewise.
	(length attribute): Fix formula for sibcalls.
	(return insn): Correctly compute the 'length' attribute.
	(do_builtin_setjmp_setup): Adjust use of current_function_calls_alloca.

2004-07-08  Richard Henderson  <rth@redhat.com>

	* tree-cfg.c (make_exit_edges): Use get_call_expr_in.
	(remove_useless_stmts_1, is_ctrl_altering_stmt): Likewise.
	(tree_block_ends_with_call_p, need_fake_edge_p): Likewise.
	* tree-eh.c (lower_eh_constructs_1): Likewise.
	* tree-sra.c (sra_walk_modify_expr): Likewise.
	* tree-ssa-dce.c (mark_stmt_if_obviously_necessary): Likewise.
	(eliminate_unnecessary_stmts): Likewise.
	* tree-ssa-dse.c (dse_optimize_stmt): Likewise.
	* tree-tailcall.c (optimize_tail_call): Likewise.
	* tree-ssa-ccp.c (get_rhs, set_rhs): Reorg to use switch.

2004-07-08  Paolo Bonzini  <bonzini@gnu.org>
	    Jakub Jelinek  <jakub@redhat.com>

	* config/i386/i386.c (override_options): Enable
	SSE prefetches with -mtune, as long as we are
	compiling for i686 or higher.  All i686 processors
	accept SSE prefetches as NOPS, some i586's don't.

2004-07-08  Eric Botcazou  <ebotcazou@libertysurf.fr>

	PR target/10567
	* config/sparc/sparc.md (update_return): Honor flag_delayed_branch.

2004-07-08  Diego Novillo  <dnovillo@redhat.com>

	* tree-ssa-operands.c (get_asm_expr_operands): Fix thinkos in
	the handling of clobbering ASM_EXPRs.

2004-07-08  Eric Botcazou  <ebotcazou@libertysurf.fr>

	PR target/16430
	* config/sparc/sparc.c (function_value): In 64-bit mode,
	return the aggregates larger than 16 bytes like unions.

2004-07-08  Eric Botcazou  <ebotcazou@libertysurf.fr>

	PR target/16199
	* config/sparc/sparc.c (sparc_emit_set_symbolic_const64): When
	'temp' is zero, generate new pseudos as needed and emit the
	sequence of insns in single-assignment form.  Resync comments
	with code.
	(sparc_emit_set_const64): Pass zero as 'temp' argument to above
	function before reload.

2004-07-08  Nathan Sidwell  <nathan@codesourcery.com>

	* vec.c (vec_assert_fail): Remove duplicate 'function'.

	* vec.c (vec_p_reserve, vec_o_reserve): Allocation is signed.

	* vec.h (VEC_alloc, VEC_embedded_size, VEC_embedded_init):
	Allocation is signed.
	(VEC_reserve): Return flag, allocation is signed.

2004-07-08  Richard Henderson  <rth@redhat.com>

	* tree-ssa-ccp.c (fold_stmt): Get type directly from
	OBJ_TYPE_REF_OBJECT.

2004-07-08  Joseph S. Myers  <jsm@polyomino.org.uk>
	    Neil Booth  <neil@daikokuya.co.uk>

	PR c/2511
	PR c/3325
	* c-decl.c (finish_struct): Ensure bit-fields are given the
	correct type.
	* c-common.c (c_common_signed_or_unsigned_type): For C, require
	the precision to match as well as the mode.
	* expr.c (reduce_to_bit_field_precision): New function.
	(expand_expr_real_1): Reduce expressions of bit-field type to
	proper precision.
	* langhooks.h (reduce_bit_field_operations): New hook.
	* langhooks-def.h (LANG_HOOKS_REDUCE_BIT_FIELD_OPERATIONS):
	Define.
	* c-lang.c, objc/objc-lang.c
	(LANG_HOOKS_REDUCE_BIT_FIELD_OPERATIONS): Define.
	* objc/objc-act.c (check_ivars): Convert types to bit-field types
	before checking.
	* tree.c (build_nonstandard_integer_type): New function.
	* tree.h (build_nonstandard_integer_type): New prototype.
	* tree-ssa.c (tree_ssa_useless_type_conversion_1): Don't treat
	conversions between integer and boolean types as useless.

2004-07-08  Paolo Bonzini  <bonzini@gnu.org>

	* c-common.c (c_common_nodes_and_builtins): Do not
	create __builtin_ptrdiff_t and __builtin_size_t.

2004-07-08  Andrew Pinski  <apinski@apple.com>

	* Makefile.in (libbackend.o): Add -combine to the gcc
	command line.

2004-07-08  Nick Clifton  <nickc@redhat.com>

	* config/stormy16/t-stormy16 (TARGET_LIBGCC2_CFLAGS): Define.
	Set to -Os.

2004-07-08  Richard Henderson  <rth@redhat.com>

	* except.c (expand_eh_region_start, expand_eh_region_end,
	expand_eh_handler, expand_eh_region_end_cleanup,
	expand_start_all_catch, expand_start_catch, expand_end_catch,
	expand_end_all_catch, expand_eh_region_end_allowed,
	expand_eh_region_end_must_not_throw, expand_eh_region_end_throw,
	expand_eh_region_end_fixup): Remove.
	* stmt.c (struct nesting): Remove stack_level, innermost_stack_block,
	cleanups, outer_cleanups, label_chain, exception_region.
	(struct goto_fixup): Remove stack_level, cleanup_list_list.
	(struct label_chain): Remove.
	(struct stmt_status): Remove x_stack_block_stack.
	(stack_block_stack, expand_goto_internal, expand_fixup, expand_fixups,
	fixup_gotos, save_stack_pointer, expand_decl_cleanup,
	expand_decl_cleanup_eh, expand_cleanups, start_cleanup_deferral,
	end_cleanup_deferral, last_cleanup_this_contour,
	containing_blocks_have_cleanups_or_stack_level,
	any_pending_cleanups): Remove.
	(expand_null_return_1): Take no arguments.
	(expand_label, expand_naked_return, expand_return,
	expand_start_bindings_and_block, expand_end_bindings, expand_decl,
	expand_anon_union_decl, expand_start_case, pushcase, pushcase_range,
	expand_end_case_type): Don't use any of them.
	* calls.c (expand_call): Likewise.
	* dojump.c (do_jump): Likewise.
	* function.c (expand_function_end): Likewise.
	* expr.c (store_expr, expand_expr_real_1): Likewise.
	(safe_from_p): Don't handle WITH_CLEANUP_EXPR, CLEANUP_POINT_EXPR.
	(expand_expr_real_1): Don't handle WITH_CLEANUP_EXPR,
	CLEANUP_POINT_EXPR, TARGET_EXPR, TRY_CATCH_EXPR, CATCH_EXPR,
	EH_FILTER_EXPR, TRY_FINALLY_EXPR, GOTO_SUBROUTINE_EXPR.
	* fold-const.c (fold_checksum_tree): Use first_rtl_op.
	* gengtype.c (adjust_field_tree_exp): Remove rtl op handling.
	* gimplify.c (gimplify_cleanup_point_expr): Renumber operands
	for WITH_CLEANUP_EXPR.
	(gimple_push_cleanup): Likewise.
	* integrate.c (copy_decl_for_inlining): Don't DECL_TOO_LATE.
	* print-tree.c (print_node): Likewise.
	* tree-pretty-print.c (dump_generic_node): Remove GOTO_SUBROUTINE_EXPR.
	* tree.c (first_rtl_op): Always just TREE_CODE_LENGTH.
	(has_cleanups): Remove GOTO_SUBROUTINE_EXPR.
	* tree.def (WITH_CLEANUP_EXPR): Remove op1 and op2.
	(GOTO_SUBROUTINE_EXPR): Remove.
	* tree.h (WITH_CLEANUP_EXPR_RTL): Remove.
	(DECL_TOO_LATE): Remove.
	* except.h, tree.h: Update decls.

2004-07-08  Paolo Bonzini  <bonzini@gnu.org>

	* explow.c (optimize_save_area_alloca): Do not accept parameters.
	* passes.c (rest_of_handle_final): Handle symout.
	(rest_of_handle_new_regalloc, rest_of_handle_old_regalloc):
	Push timevar here.
	(rest_of_handle_sched): Break out SMS.  Remove ifs for
	flag_schedule_insns and flag_modulo_sched.
	(rest_of_handle_addressof, rest_of_handle_cse2): Garbage
	collect at the end.
	(rest_of_handle_gcse2): Put under timevar TV_RELOAD_CSE_REGS.
	(rest_of_handle_partition_blocks, rest_of_handle_sms,
	rest_of_handle_if_after_reload, rest_of_handle_peephole2,
	rest_of_handle_mode_switching, rest_of_handle_jump,
	rest_of_handle_guess_branch_prob, rest_of_handle_eh,
	rest_of_handle_jump2, rest_of_handle_postreload,
	rest_of_handle_flow2, rest_of_clean_state,
	rest_of_handle_shorten_branches,
	rest_of_handle_prologue_epilogue,
	rest_of_handle_branch_target_load_optimize): New.
	(rest_of_compilation): Call the above.  Remove ggc_collect
	calls moved to rest_of_handle_*.
	* rtl.h (optimize_save_area_alloca): Do not accept parameters.

	* dwarf2out.c (dwarf2out_begin_prologue): Use TREE_NOTHROW.
	* except.c (set_nothrow_function_flags): Set TREE_NOTHROW.
	* except.h (set_nothrow_function_flags): Update comment.
	* function.c (current_function_nothrow): Remove.
	* output.h (current_function_nothrow): Remove.
	* passes.c (rest_of_compilation): Do not set TREE_NOTHROW.
	* config/arm/arm.c (arm_compute_func_type): Use TREE_NOTHROW.

2004-07-08  Eric Botcazou  <ebotcazou@libertysurf.fr>

	PR bootstrap/16326
	* reorg.c: Revert 2004-06-30 change.
	(find_end_label): If HAVE_epilogue and !HAVE_return,
	return 0 instead of creating a label at the end of the insn chain.
	(optimize_skip): Account for the failure mode of find_end_label.
	(fill_simple_delay_slots): Likewise.
	(fill_slots_from_thread): Likewise.
	(relax_delay_slots): Likewise.

2004-07-08  Diego Novillo  <dnovillo@redhat.com>

	* tree-flow.h (addressable_vars): Declare.
	* tree-ssa-alias.c (addressable_vars): Define.
	(setup_pointers_and_addressables): Add addressable variables
	to addressable_vars.
	* tree-ssa-operands.c (get_stmt_operands): Move
	handling of ASM_EXPRs ...
	(get_asm_expr_operands): ... here.
	When the ASM_EXPR clobbers memory, also clobber addressable
	variables.
	* tree-ssa.c (init_tree_ssa): Initialize addressable_vars.
	(delete_tree_ssa): Reset addressable_vars.

2004-07-07  Jan Beulich  <jbeulich@novell.com>
	    Richard Henderson  <rth@redhat.com>

	* varasm.c (assemble_variable): Use assemble_zeros for
	zero-initialized variables.
	(categorize_decl_for_section): Honor flag_zero_initialized_in_bss
	for SECCAT_BSS and SECCAT_TBSS.

2004-07-07  Jan Beulich  <jbeulich@novell.com>

	* varasm.c (asm_output_bss): Don't declare unless BSS_SECTION_ASM_OP.

	* expmed.c (emit_store_flag): Also special-case double-word
	(in-)equality comparison against -1.

	* config/i386/i386.c (ix86_gimplify_va_arg): Don't need temporary for
	passing arguments the containers for which are registers.

	* calls.c (emit_library_call_value_1): Use mode of function parameter
	rather than that of argument since constants have none.

2004-07-08  Alexandre Oliva  <aoliva@redhat.com>

	Introduce H8SX support.
	* expr.c (expand_strcpy): Renamed and moved to...
	* builtins.c (expand_movstr): ... here.  Tweak.
	(expand_builtin_strcpy): Adjust.  Use movstr if len can't be
	computed or has side effects.
	(expand_builtin_stpcpy): Likewise.  Use strcpy if return value is
	unused, or if mempcpy fails.  Adjust the return value in the
	latter case.  Use movstr if everything else fails.
	* doc/md.texi (movstr): Document.
	(movmemM, clrmemM): Fix explanation of memory block operands.
	* config/h8300/h8300.md (stpcpy): Renamed to...
	(movstr): ... this.  Adjust.
	2004-07-07  Alexandre Oliva  <aoliva@redhat.com>
	* config/h8300/h8300.md: Rename movstr*, except for movstrict*, to
	movmem* and clrstr* to clrmem*.
	2004-06-27  Alexandre Oliva  <aoliva@redhat.com>
	* config/h8300/h8300.c (h8300_reg_class_from_letter): Map 'D' to
	GENERAL_REGS, always.
	(h8300_swap_into_er6, h8300_swap_into_er6): Handle the case of
	getting the stack pointer as addr.
	* config/h8300/h8300.h (PREDICATE_CODES): Remove constant rtxes
	from general_operand_dst.
	* config/h8300/h8300.md (movmd_internal_normal): New, normal-mode
	variant of...
	(movmd_internal): ... this.  Add modes to operands.  Disparage `D'
	instead of requiring it to match only before reload.
	(stpcpy_internal_normal): New, normal-mode variant of...
	(stpcpy_internal): ... this.  Add modes to operands.  Disparage
	`D' instead of requiring it to match only before reload.
	* config/h8300/h8300-protos.h (h8300_legitimate_address_p): Add
	mode argument.
	* config/h8300/h8300.h (GO_IF_LEGITIMATE_ADDRESS): Pass it to...
	* config/h8300/h8300.c (h8300_legitimate_address_p): Pass it to
	h8300_get_index.
	* config/h8300/h8300.md (attr type): Add call.
	(attr can_delay): If type is call, set it no.
	(call, call_value): Set type to call.
	2004-06-21  Alexandre Oliva  <aoliva@redhat.com>
	* config/h8300/h8300.md (logicalhi3_sn, logicalsi3_sn): New.
	2004-06-16  Alexandre Oliva  <aoliva@redhat.com>
	* tree.c (get_narrower): Don't narrow integral types into
	non-integral types.
	* config/h8300/h8300.c (h8300_expand_epilogue): Initialize
	frame_size *before* the first use.
	* config/h8300/h8300.md (movstrictqi): Reintroduce post-increment
	on input.
	(peephole2): Don't widen instructions that push SP.  Move
	decrement of SP to the end of all stm-generating peepholes.
	2003-07-24  Richard Sandiford  <rsandifo@redhat.com>
	* config/h8300/h8300.md (insv): Prefer to use AND to clear a bitfield
	and OR to set it to all ones.
	2003-07-24  Richard Sandiford  <rsandifo@redhat.com>
	* config/h8300/h8300.md (can_delay): Default to "no" for bit branches.
	(call, call_value): Set can_delay to "no".
	2003-07-22  Richard Sandiford  <rsandifo@redhat.com>
	* config/h8300/h8300.md (extzv): Make subreg check more robust.
	2003-07-21  Richard Sandiford  <rsandifo@redhat.com>
	* config/h8300/h8300.md (*brabit): Remove.
	* config/h8300/h8300.md (*brabc, *brabs): Remove mode from
	zero_extract.  Use bit_memory_operand as the predicate for
	operand 1 and 'WU' as the constraint.  Check the difference
	between the base length and the final one when deciding which
	type of branch to use.
	2003-07-21  Richard Sandiford  <rsandifo@redhat.com>
	* config/h8300/h8300.md (extzv): Remove mode from operands 0 and 1.
	Use convert_move to extend the result for TARGET_H8300SX.  Check
	for QImode memory references.  Optimize the case where the
	destination is a paradoxical subreg.
	2003-07-21  Richard Sandiford  <rsandifo@redhat.com>
	* config/h8300/h8300.md (*movsf_h8sx): Add an r <- G alternative.
	* config/h8300/h8300.md (andqi): Remove bclr from h8sx version.
	2003-07-21  Richard Sandiford  <rsandifo@redhat.com>
	* config/h8300/h8300.md: Include mova.md
	(length_table): Add mova and mova_zero.
	* config/h8300/h8300.c (print_operand): Handle '%o'.  Print a length
	after all constant addresses for '%R', '%X', '%T' and '%S'.
	(h8300_mova_length): New function.
	(h8300_insn_length_from_table): Use it to handle mova and mova_zero.
	* config/h8300/t-h8300 (mova.md): Generate from genmova.sh.  Add to
	dependencies for s-config, etc.
	* config/h8300/gemova.sh: New file.
	* config/h8300/mova.md: Generated.
	2003-07-20  Alexandre Oliva  <aoliva@redhat.com>
	* config/h8300/h8300.c (h8300_bitfield_length): New.
	(nibble_operand): Adjust.
	(h8300_binary_length): Handle conditional binary op.
	(h8300_insn_length_from_table): Handle bitfield and bitbranch.
	* config/h8300/h8300.h: Change constraints W# and Y# to P#>X and
	P#<X, respectively.  The original P is now IP4>X.  Introduced P#>0
	and P#<0, unused so far.  W and Y are now prefixes to multi-letter
	constraints.  WU is introduced as a variant of U that requires a
	mem, and is therefore considered an EXTRA_MEMORY_CONSTRAINT.
	* config/h8300/h8300.md (attr type): Added bitbranch.
	(attr length_table): Added bitfield and bitbranch.
	(attr length): Compute bitbranch length.
	(andqi): Separate pattern for H8300SX.  Use bfld for loading the
	least-significant bit of a byte.
	(brabit, brabc, brabs): New.
	(insv, extzv): Emit bfst and bfld on H8300SX.
	(bfld, bfst, seq, sne): New.
	(bstzhireg, cmpstz, bstz, bistz): New.
	(cmpcondbset, condbset, cmpcondbclr, condbclr): New.
	(cmpcondbsetreg, condbsetreg, cmpcondbclrreg, condbclrreg): New.
	2003-07-11  Richard Sandiford  <rsandifo@redhat.com>
	* config/h8300/h8300.c (h8sx_binary_memory_operator): New function.
	(h8sx_unary_memory_operator): New function.
	* config/h8300/h8300.h (EXTRA_MEMORY_CONSTRAINT): Disable.
	(PREDICATE_CODES): Add h8sx_{unary,binary}_memory_operator.
	* config/h8300/h8300.md: Add peepholes to combine reloads and
	arithmetic insns.
	2003-07-10  Richard Sandiford  <rsandifo@redhat.com>
	* config/h8300/h830.md (cmpqi): Use 'i' rather than 'n' in constraints.
	(*cmphi_h8300hs, *addqi3, *addhi3_h8sx, subhi3): Likewise.
	(and?i, ior?i, xor?i): Likewise.
	2003-07-10  Richard Sandiford  <rsandifo@redhat.com>
	* config/h8300/h8300.c: Move enums and prototypes to head of file.
	Various whitespace fixes.
	(h8300_constant_length): New function, split out from...
	(h8300_displacement_size): ...here.  Rename h8300_displacement_length.
	(h8300_classify_operand): Use IN_RANGE.
	(h8300_classify_operand): Use h8300_constant_length.
	(h8300_short_move_mem_p): Tighten size check.
	(h8sx_mergeable_memrefs_p): Tighten equality check.
	2003-06-30  Richard Sandiford  <rsandifo@redhat.com>
	* config/h8300/h8300.h (TARGET_CPU_CPP_BUILTINS): Define __H8300SX__
	for -msx.
	* config/h8300/crti.asm: Use .h8300sx or .h8300sxn for -msx code.
	* config/h8300/crtn.asm: Likewise.
	* config/h8300/lib1funcs.asm: Likewise.  Use 32-bit pointers
	if __H8300SX__ is defined.
	2003-06-27  Richard Sandiford  <rsandifo@redhat.com>
	* config/h8300/h8300-protos.h (h8300_get_index): Add mode parameter.
	* config/h8300/h8300.h (GO_IF_LEGITIMATE_ADDRESS): Update accordingly.
	(GO_IF_MODE_DEPENDENT_ADDRESS): Treat POST_DEC, PRE_INC and indexed
	addresses as mode-dependent.
	* config/h8300/h8300.c (print_operand_address): Update call to
	h8300_get_index.
	(h8300_get_index): Take a mode argument.  Rework to fix an
	earlier misunderstanding.
	2003-06-26  Richard Sandiford  <rsandifo@redhat.com>
	* config/h8300/h8300.c (zero_extendqisi2): Force the source operand
	into a register if TARGET_H8300SX.
	(*zero_extendqisi2_h8300hs, *extendqisi2_h8300): Disable for
	TARGET_H8300SX.  Also disable related define_splits.
	(*zero_extendqisi2_h8sx, *extendqisi2_h8sx): New patterns.
	2003-06-23  Richard Sandiford  <rsandifo@redhat.com>
	* config/h8300/h8300.c (h8300_rtx_costs): Add h8sx handling.
	2003-06-20  Richard Sandiford  <rsandifo@redhat.com>
	* config/h8300/h8300.h (OK_FOR_Z): New macro.
	(EXTRA_CONSTRAINT_STR): Check it.
	* config/h8300/h8300.c (h8300_classify_operand): Accept null
	class arguments.
	(h8300_insn_length_from_table): Handle LENGTH_TABLE_MOV_IMM4.
	* config/h8300/h8300.md (length_table): Add mov_imm4.
	(movqi, movhi): Add Z <- W4 alternatives to h8sx patterns.
	2003-06-20  Richard Sandiford  <rsandifo@redhat.com>
	* genattrtab.c (write_eligible_delay): Allow candidate_insn to
	be a label.
	* config/h8300/h8300.h (DELAY_SLOT_LENGTH): New macro.
	* config/h8300/h8300.c (h8300_reorg): New function.
	(TARGET_MACHINE_DEPENDENT_REORG): Define.
	* config/h8300/h8300.md (length): Subtract the length of the
	delay slot from (pc) when checking the range of forward branches.
	(delay_slot, can_delay): New attributes.
	(define_delay): Add bra/s handling.
	(movmd_internal, return_h8sx, *return_1): Set can_delay to no.
	(jump): Add delayed-branch handling.
	2003-06-17  Richard Sandiford  <rsandifo@redhat.com>
	* expr.c (expand_strcpy): New function.
	* builtins.c (expand_builtin_strcpy): Fall back on expand_strcpy.
	(expand_builtin_stpcpy): Likewise.
	* config/h8300/h8300-protos.h (h8sx_split_movmd): Remove.
	(h8300_swap_into_er6, h8300_swap_out_of_er6): Declare.
	* config/h8300/h8300.c (h8300_reg_class_from_letter): Tweak 'd'
	handling to improve register allocation for -fno-omit-frame-pointer.
	(h8sx_split_movmd): Delete, moving er6 handling into...
	(h8300_swap_into_er6, h8300_swap_out_of_er6): ...these new functions.
	* config/h8300/h8300.md (UNSPEC_STPCPY): New unspec constant.
	(movmd): Add calls to copy_rtx.
	(movmd_internal): In the second alternative, allow the initial and
	final destination registers to be different .  Update the splitter
	accordingly.  Call h8300_swap_into_er6 and h8300_swap_out_of_er6
	instead of h8sx_split_movmd.
	(stpcpy, movsd): New expanders.
	(movsd_internal): New define_insn.
	2003-06-13  Richard Sandiford  <rsandifo@redhat.com>
	* config/h8300/h8300-protos.h (h8300_reg_class_from_letter): Declare.
	(h8sx_emit_movmd, h8sx_split_movmd): Declare.
	* config/h8300/h8300.h (reg_class): Add COUNTER_REGS, SOURCE_REGS
	and DESTINATION_REGS.
	(REG_CLASS_NAMES, REG_CLASS_CONTENTS): Update accordingly.
	(REGNO_REG_CLASS): Map er4, er5 and er6 to the new classes.
	(REG_CLASS_FROM_LETTER): Use h8300_reg_class_from_letter.
	(h8300_move_ratio): Declare.
	(MOVE_RATIO): Use it.
	* config/h8300/h8300.c (h8300_move_ratio): New variable.
	(h8300_init_once): Initialize it.
	(h8300_reg_class_from_letter): New function.
	(print_operand): Add an 'm' prefix for printing ".b", ".w" or ".l".
	(h8sx_emit_movmd, h8sx_split_movmd): New functions.
	* config/h8300/h8300.md (UNSPEC_MOVMD): New unspec constant.
	(COUNTER_REG, SOURCE_REG, DESTINATION_REG): New register constants.
	(movstrsi, movmd): New expanders.
	(movmd_internal): New insn.
	2003-06-06  Richard Sandiford  <rsandifo@redhat.com>
	* config/h8300/h8300.h (EXTRA_MEMORY_CONSTRAINT): Define.
	2003-06-04  Richard Sandiford  <rsandifo@redhat.com>
	* config/h8300/elf.h (LINK_SPEC): Use -m h8300sxnelf for -msx -mn.
	* config/h8300/h8300.c (asm_file_start): Use .h8300sxn likewise.
	2003-06-03  Richard Sandiford  <rsandifo@redhat.com>
	* config/h8300/h8300.c (nibble_operand): Fix warning.
	* config/h8300/h8300.md (movstricthi): Set adjust_length to no.
	(movsi_h8sx): Likewise here and the normal h8sx movhi pattern.
	(movsf_h8300h): Disable for TARGET_H8300SX.
	2003-06-03  Richard Sandiford  <rsandifo@redhat.com>
	* config/h8300/h8300.h (PREDICATE_CODES): Add h8300_ldm_parallel,
	h8300_stm_parallel and h8300_return_parallel.
	* config/h8300/h8300.c (h8300_push_pop, h8300_stack_offset_p,
	h8300_ldm_stm_regno, h8300_ldm_stm_parallel, h8300_ldm_parallel,
	h8300_stm_parallel, h8300_return_parallel): New functions.
	(h8300_expand_prologue): Don't enforce ldm/stm register alignment
	if TARGET_H8300SX.  Use h8300_push_pop.
	(h8300_expand_epilogue): Likewise.  Try to merge the return insn
	and final pop when generating h8sx code.  Always emit some form
	of return insn.
	* config/h8300/h8300.md: Don't enforce register alignment in
	stm peepholes if TARGET_H8300SX.
	(ldm_h8300s, stm_h8300s, return_h8sx): New patterns.
	(ldm_h8300s_[234], stm_h8300_[234]): Disable.
	(epilogue): Expect h8300_expand_epilogue to emit a return insn.
	2003-06-03  Richard Sandiford  <rsandifo@redhat.com>
	* config/h8300/t-h8300 (MULTILIB_OPTIONS): Add a -msx multilib.
	(MULTILIB_DIRNAMES): Add a directory for it.
	(MULTILIB_MATCHES): Delete.
	2003-05-28  Richard Sandiford  <rsandifo@redhat.com>
	* final.c (walk_alter_subreg): Handle addresses with subregs
	inside a ZERO_EXTEND or AND.
	* config/h8300/h8300-protos.h (h8300_get_index): Declare.
	* config/h8300/h8300.h (INDEX_REG_CLASS): Set to GENERAL_REGS
	if TARGET_H8300SX.
	(GO_IF_LEGITIMATE_ADDRESS): Use h8300_get_index.
	* config/h8300/h8300.c (print_operand_address): Handle @(dd,RnL.b),
	@(dd,Rn.w) and @(dd,ERn.L).
	(h8300_displacement_size): Take the whole address as argument.
	(h8300_classify_operand, h8300_short_move_mem_p): Adjust accordingly.
	2003-05-28  Richard Sandiford  <rsandifo@redhat.com>
	* config/mips/mips-protos.h (h8300_operands_match_p): Declare.
	(h8sx_mergeable_memrefs_p): Declare.
	* config/h8300/h8300.h (HAVE_POST_DECREMENT): Define to TARGET_H8300SX.
	(HAVE_PRE_INCREMENT): Likewise.
	(GO_IF_LEGITIMATE_ADDRESS): Accept pre/post increment/decrement
	addresses for TARGET_H8300SX,
	* config/h8300/h8300.c (print_operand_address): Deal with PRE_INC
	and POST_DEC.
	(movb_length_table, movl_length_table): New tables.
	(movw_length_table): Define to movb_length_table.
	(h8300_displacement_size): New, split out from...
	(h8300_classify_address): ...here.  Handle pre/post inc/dec.
	(h8300_short_immediate_length): Allow H8OP_MEM_COMPLEX operands.
	(h8300_insn_length_from_table): Add cases for movb, movw and movl.
	(h8sx_mergeable_memrefs_p, h8300_operands_match_p): New functions.
	(output_plussi): Use add.l #xx:3,Rn and sub.l #xx:3,Rn for h8sx.
	(compute_plussi_length, compute_plussi_cc): Update accordingly.
	(h8sx_unary_shift_operator): Get the mode from the operator.
	(binary_shift_operator): Likewise.
	* config/h8300/h8300.md: If a peephole2 applies gen_lowpart to
	a memory reference, check whether the reference is offsettable.
	(length_table): Add movb, movw and movl.
	(movqi): Add new h8sx pattern.  Don't force one operand to be a
	register when generating h8sx code.
	(movhi, movsi, movsf): Likewise.
	(movstrictqi): Use the length_table attribute.
	(movstricthi): Likewise.  Add h8sx alternative for mov.w #xx:3,Rn.
	(addqi3): Split into a define_expand and define_insn.  Don't accept
	memory operands in the expander.  Use h8300_operands_match_p to
	check for matching operands in the define_insn.
	(subqi3, negqi2, one_cmplqi2): Likewise.
	(add[hs]i3): Don't accept memory operands in the expander.  Likewise
	in any patterns that are unused in h8sx code.  In the h8sx patterns,
	use h8300_operands_match_p to check whether operands match.
	(sub[hs]i3, and[hi]3, ior[hs]i3, xor[hs]i3, neg[hsi]3,
	one_cmpl[hs]i3): Likewise.
	(andqi3, iorqi3, xorqi3): Likewise.  Don't call fix_bit_operand
	in the expander.
	2003-05-23  Richard Sandiford  <rsandifo@redhat.com>
	* config/h8300/h8300-protos.h (expand_a_shift): Return a bool.
	(h8300_insn_length_from_table): Add a second parameter.
	(output_h8sx_shift): Declare.
	* config/h8300/h8300.h (OK_FOR_W, OK_FOR_Y): New macros.
	(EXTRA_CONSTRAINT): Replace with...
	(EXTRA_CONSTRAINT_STR): ...this.  Use OK_FOR_W and OK_FOR_Y.
	(CONSTRAINT_LEN): Define, returning 2 for 'W' and 'Y'.
	(PREDICATE_CODES): Add entries for h8sx_unary_shift_operator
	and h8sx_binary_shift_operator.
	* config/h8300/h8300.c (two_insn_adds_subs_operand): Return false
	for TARGET_H8300SX.
	(bit_operand): Replace use of EXTRA_CONSTRAINT with OK_FOR_U.
	(bit_memory_operand, fix_bit_operand): Likewise.
	(h8300_length_table_for_insn): Remove.
	(h8300_classify_operand): Fix check for 16-bit operands in 32-bit
	instructions.
	(h8300_short_immediate_length, h8300_binary_length): New functions.
	(h8300_insn_length_from_table): Add an opcodes parameter.  Rework.
	(output_plussi): Use sub to add negative constants.
	(compute_plussi_length): Adjust accordingly.
	(h8sx_single_shift_type): New enum.
	(h8sx_single_shift, h8sx_unary_shift_operator,
	h8sx_binary_shift_operator, output_h8sx_shift): New functions.
	(expand_a_shift, expand_a_rotate): Emit nothing if the shift is a
	single h8sx instruction.  Return false in this case.
	* config/h8300/h8300.md (length_table): Add short_immediate.
	(length): Pass the operand array to h8300_insn_length_from_table.
	(adjust_length): Assume "no" for insns with a length_table attribute.
	(*cmphi_h8300hs, cmpsi): Add alternatives for #xx:3.
	(*addhi3_h8300hs): Don't use for h8sx.
	(*addhi3_h8sx): New pattern, with alternatives for add.w #xx:3
	and sub.w #xx:3.
	(ashl[qhs]i3, lshr[qhs]i3, ashr[qhs]i3, rotl[qhs]i3): Change operand
	1's predicate to nonimmediate_operand.  Only skip default expansion
	if expand_a_shift or expand_a_rotate returns true.  Add new patterns
	for single h8sx shift instructions.
	2003-05-22  Alexandre Oliva  <aoliva@redhat.com>
	* config/h8300/h8300.c (nibble_operand): Split out of...
	(reg_or_nibble_operand): ... this.
	* config/h8300/h8300.h (PREDICATE_CODES): Added nibble_operand.
	* config/h8300/h8300.md: (mulqihi3, mulhisi3, umulqihi3,
	umulhisi3): Introduce expand, and introduce separate insns for
	sign- or zero-extended REG and already-extended CONST_INT.
	2003-05-20  Richard Sandiford  <rsandifo@redhat.com>
	* config/h8300/h8300.c (h8300_unary_length): Fix miscounting.
	* config/h8300/h8300.md (subqi3): Generalize for h8sx.
	(subhi3): Likewise.  Don't accept immediates for operand 1.
	Remove the early clobber from second alternative of the h8300s pattern.
	(subsi3): Generalize for h8sx.  Force operand 2 into a register
	on plain h8300 targets.
	(subsi3_h8300): Use h8300_dst_operand for consistency with expander.
	(subsi3_h8300h): Generalize for h8sx.
	(one_cmplqi2, one_cmplhi2, one_cmplsi2): Likewise.
	2003-05-19  Alexandre Oliva  <aoliva@redhat.com>
	* config/h8300/h8300.c (reg_or_nibble_operand): New.
	* config/h8300/h8300.h (PREDICATE_CODES): Adjust.
	(TARGET_H8300SXMUL): New.
	(CONST_OK_FOR_P): New.
	(CONST_OK_FOR_LETTER_P): Adjust.
	* config/h8300/h8300.md (mulqihi3, mulhisi3, umulqihi3,
	umulhisi3): Accept 4-bit immediate on H8SX.
	(mulhi3, mulsi3, smulsi3_highpart, umulsi3_highpart): New.
	(udivsi3, divhi3, udivsi3, divsi3): New.
	2003-05-19  Richard Sandiford  <rsandifo@redhat.com>
	* config/h8300/h8300-protos.h (h8300_insn_length_from_table): Declare.
	* config/h8300/h8300.h (OK_FOR_Q): New macro.
	(EXTRA_CONSTRAINT): Use it to check the 'Q' constraint.
	(PREDICATE_CODES): Add h8300_src_operand and h8300_dst_operand.
	Add ADDRESSOF to the bit_operand entry.
	* config/h8300/h8300.c (h8300_dst_operand): New predicate.
	(h8300_src_operand): Likewise.
	(bit_operand): Check nonimmediate_operand rather than general_operand.
	Accept any nonimmediate_operand in h8sx code.
	(h8300_and_costs): Initialize operands[1].
	(h8300_rtx_costs) <AND>: Return false if the operands aren't valid.
	(h8300_operand_class): New enum.
	(h8300_length_table): New typedef.
	(addb_length_table, addw_length_table, addl_length_table,
	logicl_length_table): New tables.
	(logicb_length_table, logicw_length_table): New macros.
	(h8300_classify_operand, h8300_length_from_table,
	h8300_length_table_for_insn, h8300_unary_length,
	h8300_insn_length_from_table): New functions.
	(output_plussi): Only use adds and subs for register destinations.
	Disable redundant clause.
	(compute_plussi_cc): Likewise.
	(compute_plussi_length): Likewise.  Use h8300_length_from_table
	to work out the length of an insn.
	(output_logical_op): Only use narrower immediate instructions
	if the destination is a register.
	(compute_logical_op_cc): Likewise.
	(compute_logical_op_length): Likewise.  Use h8300_length_from_table.
	(h8300_adjust_insn_length): Tighten check for reg<->mem moves.
	* config/h8300/h8300.md (length_table): New attribute.
	(length): When an instruction has a length_table attribute, use
	h8300_insn_length_from_table to calculate its default length.
	(cmpqi): Use h8300_dst_operand for the first operand and
	h8300_src_operand for the second.
	(cmphi, *cmphi_h8300hs, cmpsi, negqi2, neghi2, neghi2_h8300h, negsi2,
	negsi2_h8300h, addqi3, addhi3, *addhi3_h8300, *addhi3_h8300hs, addsi3,
	addsi_h8300, addsi_h8300h, andhi3, andsi3, iorhi3,
	iorsi3, xorhi3, xorsi3): Likewise.
	(andqi3): Use h8300_src_operand for operand 2.  Adjust the condition
	so that it allows any combination of operands for TARGET_H8300SX.
	(iorqi3, xorqi3): Likewise.
	(cmpqi): Use the length_table attribute.
	(*cmphi_h8300hs, cmpsi, addqi, *addhi3_h8300hs, andqi3, iorqi3,
	xorqi3, negqi2, neghi2_h8300h, negsi2_h8300h): Likewise.
	(cmpqi): Add 'Q' constraint.
	(*cmphi_h8300hs, cmpsi, addqi, *addhi3_h8300hs, addsi_h8300h, andqi3,
	iorqi3, xorqi3, negqi2, neghi2_h8300h, negsi2_h8300h): Likewise.
	2003-05-14  Richard Sandiford  <rsandifo@redhat.com>
	* config/h8300/h8300.h (MASK_H8300SX): New macro.
	(TARGET_H8300S): True for both -ms and -msx.
	(TARGET_H8300SX): New macro.
	(TARGET_SWITCHES): Add entries for -msx and -mno-sx.
	* config/h8300/h8300.c (asm_file_start): Write .h8300sx for -msx.
	* config/h8300/elf.h (LINK_SPEC): Use -m h8300sxelf for -msx.
	* config/h8300/t-h8300 (MULTILIB_MATCHES): Use -ms multilibs for -msx.
	[Temporary change.]
	2003-02-28  Alexandre Oliva  <aoliva@redhat.com>
	* config/h8300/h8300.h (SIZE_TYPE, PTRDIFF_TYPE): Use short with
	16-bit pointers and 32-bit ints.
	* config/h8300/h8300.h (LEGITIMATE_CONSTANT_P): Accept
	CONST_DOUBLE with mode no wider than SImode.
	* config/h8300/h8300.md (extendqisi2_h8300): Add constraints for
	output operand.
	2003-02-27  Alexandre Oliva  <aoliva@redhat.com>
	* config/h8300/h8300.c (general_operand_src): Match CONSTANT_P_RTX
	or SUBREG thereof.
	* config/h8300/h8300.h (PREDICATE_CODES): Adjust.
	2003-02-22  Alexandre Oliva  <aoliva@redhat.com>
	* config/h8300/h8300.c (dosize): Truncate sign * size to Pmode.

2004-05-28  Aaron W. LaFramboise <aaronraolete36@aaronwl.com>

	* config.gcc (i[34567]86-*-mingw32*): Enable threads by default.

2004-07-07  Per Bothner  <per@bothner.com>

	* flow.c (attempt_auto_inc):  Remove now-redundant PUT_CODE.

2004-07-07  Mike Stump  <mrs@apple.com>

	* darwin.h (ASM_OUTPUT_LABELREF): Fix -fno-leading-underscore.
	* darwin.c (machopic_non_lazy_ptr_name, machopic_stub_name)
	(machopic_finish): Likewise.

2004-07-07  Richard Henderson  <rth@redhat.com>

	* tree-ssa-dom.c (simplify_switch_and_lookup_avail_expr): Look
	through any value-preserving cast.

2004-07-07  Alexandre Oliva  <aoliva@redhat.com>

	* function.c (assign_parm_find_data_types): Call
	FUNCTION_ARG_PASS_BY_REFERENCE only if it's defined.

2004-07-07  Steven Bosscher  <stevenb@suse.de>

	* tree-cfg.c (group_case_labels): Remove case labels that have
	the same target as the default case.

2004-07-07  Steven Bosscher  <stevenb@suse.de>

	* tree-inline.c (optimize_inline_calls): Set DECL_INLINED_FNS
	regardless of DECL_LANG_SPECIFIC being present or not.
	* tree.h (DECL_NUM_STMTS): Purge.

2004-07-07  Andrew Pinski  <apinski@apple.com>

	* configure: Regenerate with the right autoconf.

2004-07-07  David Edelsohn  <edelsohn@gnu.org>

	* ifcvt.c (total_bb_rtx_cost): New function.
	(find_if_case_1): Compare rtx_cost of basic block to cost of
	BRANCH_COST insns.
	(find_if_case_2): Same.

2004-07-07  Eric Botcazou  <ebotcazou@libertysurf.fr>

	PR target/10567
	* config/sparc/sparc.c (load_pic_register): Honor flag_delayed_branch.
	(output_return): Likewise.
	(output_sibcall): Abort if !flag_delayed_branch.
	(sparc_function_ok_for_sibcall): Return 0 if !flag_delayed_branch.
	(emit_and_preserve): New function.
	(sparc_output_mi_thunk): Use it.  Honor flag_delayed_branch.  Emit an
	indirect jump to the thunked-to function if !flag_delayed_branch.
	* config/sparc/sparc.md (delayed_branch): New attribute.
	(load_pcrel_sym): Honor flag_delayed_branch.  Use above
	attribute to compute the length of the insn.
	(goto_handler_and_restore): Likewise.

2004-07-07  Andrew Pinski  <apinski@apple.com>

	PR tree-optimization/15777
	* fold-const.c (fold_single_bit_test): Fold the x^1 expression.

	* expr.c (expand_expr_real_1): Fix formating.
	BUFFER_REF and IN_EXPR are dead.
	* fold-const.c (non_lvalue): BUFFER_REF is dead.
	* tree-inline.c (estimate_num_insns_1): Likewise.
	* tree-pretty-print.c (dump_generic_node): BUFFER_REF,
	IN_EXPR, SET_LE_EXPR, and CARD_EXPR are dead.
	* tree.def (BUFFER_REF, IN_EXPR, SET_LE_EXPR, CARD_EXPR): Kill.

2004-07-07  H.J. Lu  <hongjiu.lu@intel.com>

	* collect2.c (dump_file): Don't call cplus_demangle if
	HAVE_LD_DEMANGLE is defined.
	(main): Pass "--demangle" to ld if no_demangle is not 0 and
	HAVE_LD_DEMANGLE is defined. Don't set current_demangling_style
	if HAVE_LD_DEMANGLE is defined.

	* configure.ac (--with-demangler-in-ld): Added
	(HAVE_LD_DEMANGLE): Define if ld supports --demangle when
	--with-demangler-in-ld is used.
	* config.in: Regenerated.
	* configure: Likewise.

2004-07-07  Roger Sayle  <roger@eyesopen.com>

	* config/rs6000/rs6000.c (struct processor_costs): Add new fields
	for simple floating point operations "fp", double precision
	multiplication "dmul", and single and double precision division
	"sdiv" and "ddiv".  Update all CPU variant tables as appropriate.
	(ppc630_cost): New table split from ppc620_cost, to distinguish
	differences in floating point latencies.
	(rs6000_override_options): Use ppc630_cost for PROCESSOR_PPC630.
	(rs6000_rtx_costs): Add support for single and double precision
	floating point addition, subtraction, multiplication, division,
	fused-multiply-add, fused-multiply-sub, negation, absolute value
	and negative absolute value.  Tweak MEM case to use prefered idiom.

2004-07-07  Richard Henderson  <rth@redhat.com>

	* tree-flow-inline.h (may_propagate_copy): Move...
	* tree-ssa-copy.c (may_propagate_copy): ... here.  Fail if we
	attempt to copy between types requiring conversion.
	* tree-flow.h (may_propagate_copy): Update decl.
	* tree-ssa-dom.c (cprop_operand): Tidy redundant tests.

2004-07-07  Jakub Jelinek  <jakub@redhat.com>

	* config/i386/i386.c (override_options): Don't set x86_prefetch_sse
	from -mtune= option.

2004-07-07  Alexandre Oliva  <aoliva@redhat.com>

	* builtins.c: Rename movstr*, except for movstrict*, to
	movmem* and clrstr* to clrmem*.
	* expr.c: Likewise.
	* expr.h: Likewise.
	* genopinit.c: Likewise.
	* integrate.c: Likewise.
	* local-alloc.c: Likewise.
	* optabs.c: Likewise.
	* optabs.h: Likewise.
	* config/alpha/alpha.h: Likewise.
	* config/alpha/alpha.md: Likewise.
	* config/arm/arm-protos.h: Likewise.
	* config/arm/arm.c: Likewise.
	* config/arm/arm.md: Likewise.
	* config/avr/avr.md: Likewise.
	* config/c4x/c4x.c: Likewise.
	* config/c4x/c4x.md: Likewise.
	* config/frv/frv.md: Likewise.
	* config/i386/i386-protos.h: Likewise.
	* config/i386/i386.c: Likewise.
	* config/i386/i386.h: Likewise.
	* config/i386/i386.md: Likewise.
	* config/i860/i860.c: Likewise.
	* config/i860/i860.md: Likewise.
	* config/ip2k/ip2k.md: Likewise.
	* config/ip2k/libgcc.S: Likewise.
	* config/ip2k/t-ip2k: Likewise.
	* config/m32r/m32r.c: Likewise.
	* config/m32r/m32r.md: Likewise.
	* config/mcore/mcore.md: Likewise.
	* config/mips/mips.c: Likewise.
	* config/mips/mips.md: Likewise.
	* config/ns32k/ns32k.c: Likewise.
	* config/ns32k/ns32k.h: Likewise.
	* config/ns32k/ns32k.md: Likewise.
	* config/pa/pa.c: Likewise.
	* config/pa/pa.md: Likewise.
	* config/pdp11/pdp11.h: Likewise.
	* config/pdp11/pdp11.md: Likewise.
	* config/rs6000/rs6000.c: Likewise.
	* config/rs6000/rs6000.md: Likewise.
	* config/s390/s390-protos.h: Likewise.
	* config/s390/s390.c: Likewise.
	* config/s390/s390.md: Likewise.
	* config/sh/lib1funcs.asm: Likewise.
	* config/sh/sh.c: Likewise.
	* config/sh/sh.md: Likewise.
	* config/sh/t-sh: Likewise.
	* config/sparc/sparc.h: Likewise.
	* config/vax/vax.md: Likewise.
	* config/xtensa/xtensa.c: Likewise.
	* config/xtensa/xtensa.md: Likewise.
	* doc/invoke.texi: Likewise.
	* doc/md.texi: Likewise.
	* doc/rtl.texi: Likewise.

2004-07-07  Richard Sandiford  <rsandifo@redhat.com>

	PR target/16407
	* config/mips/mips-protos.h (mips_declare_common_object): Declare.
	* config/mips/mips.c (mips_declare_common_object): New function,
	mostly split out from...
	(mips_output_aligned_decl_common): ...here.
	* config/mips/mips.h (ASM_OUTPUT_LOCAL): Remove in favor of...
	(ASM_OUTPUT_ALIGNED_LOCAL): ...this new definition.
	* config/mips/iris6.h (ASM_OUTPUT_ALIGNED_LOCAL): Undefine this
	rather than ASM_OUTPUT_LOCAL.  Call mips_declare_common_object.

2004-07-07  John David Anglin  <dave.anglin@nrc-cnrc.gc.ca>

	PR c/16392
	* function.c (assign_parms): Fix typo from previous change.

2004-07-07  Jason Merrill  <jason@redhat.com>

	PR c++/15815
	* doc/extend.texi (C++ Interface): Correct information and
	discourage use.

2004-07-07  Vladimir Makarov  <vmakarov@redhat.com>

	PR target/16130
	PR target/16142
	PR target/16143
	* config/ia64/ia64.c (ia64_dfa_new_cycle): Reset DFA state for asm
	insn.

2004-07-06  Kazuhiro Inaoka  <inaoka.kazuhiro@renesas.com>

	PR target/1679.
	* config/m32r/m32r.c (m32r_function_symbol): New function:
	Generate a symbol name RTX with the correct m32r specific flags
	set.
	(block_move_call): Use new function to generate correct symbol.
	* config/m32r/m32r-protos.h: Add prototype for new funcion.
	* config/m32r/m32r.h (INITIALIZE_TRAMPOLINE): Use the new
	function.

2004-07-07  Nathan Sidwell  <nathan@codesourcery.com>

	* tree.h (TYPE_BINFO_OFFSET, TYPE_BINFO_VTABLE,
	TYPE_BINFO_VIRTUALS, TYPE_BINFO_BASETYPES,
	TYPE_BINFO_BASETYPE): Remove.
	(BINFO_BASETYPES, BINFO_N_BASETYPES, BINFO_BASETYPE): Rename
	to ...
	(BINFO_BASE_BINFOS, BINFO_N_BASE_BINFOS, BINFO_BASE_BINFO): ...
	here.
	(BINFO_BASEACCESSES, BINFO_BASEACCESS): Rename to ...
	(BINFO_BASE_ACCESSES, BINFO_BASE_ACCESS): ... here.
	(BINFO_INHERITANCE_CHAIN): Redocument as it is actually used.
	(struct tree_binfo): Rename base_types to base_binfos.
	* alias.c (record_component_aliases): Adjust BINFO macros.
	* dbxout.c (dbxout_type): Likewise.
	* dwarf2out.c (gen_member_die): Likewise.
	* sdbout.c (sdbout_one_type): Likewise.
	* tree-dump.c (deque_and_dump): Likewise.
	* config/i386/i386.c (classify_argument,
	contains_128bit_aligned_vector_p): Likewise.

2004-07-07  Nick Clifton  <nickc@redhat.com>

	* config/fr30/fr30.c (fr30_setup_incoming_varargs): Change
	arguments to match TARGET_SETUP_INCOMING_VARARGS prototype.

2004-07-07  Nathan Sidwell  <nathan@codesourcery.com>

	* vec.h: Fix the example use.

2004-07-06  Richard Henderson  <rth@redhat.com>

	* langhooks-def.h (LANG_HOOKS_GIMPLE_BEFORE_INLINING): Remove.
	* langhooks.h (struct lang_hooks): Remove gimple_before_inlining.
	* tree-inline.c (copy_body_r, setup_one_parameter,
	initialize_inlined_parameters, expand_call_inline,
	declare_inline_vars): Don't check it.
	(expand_calls_inline): Remove old version, rename new version
	from gimple_expand_calls_inline.
	* tree-optimize.c (execute_gimple): Remove.
	(pass_gimple): Don't run anything.

2004-07-06  Joseph S. Myers  <jsm@polyomino.org.uk>

	* doc/sourcebuild.texi: Use semicolons instead of commas in
	section title.

2004-07-06  Richard Henderson  <rth@redhat.com>

	* tree-sra.c (struct sra_walk_fns): Revert 2004-07-05 change.
	(sra_walk_modify_expr, scan_init): Likewise.
	(generate_element_zero): Check visited before scanning children.
	(generate_element_init): Set visited on error.
	(scalarize_init): Handle generate_element_init failure similar
	to use_block_copy.

2004-07-06  Joseph S. Myers  <jsm@polyomino.org.uk>

	* toplev.h (NO_FRONT_END_DIAG, ATTRIBUTE_GCC_FE_DIAG): Define.
	(warning, error, pedwarn, sorry): Use ATTRIBUTE_GCC_FE_DIAG.

2004-07-06  Richard Henderson  <rth@redhat.com>

	* config/i386/i386.c (legitimize_pic_address): Make static.
	(legitimize_address): Handle CONST with TLS operand.
	(ix86_expand_move): Don't call legitimize_pic_address directly.
	* config/i386/i386-protos.h (legitimize_pic_address): Remove.

2004-07-06  Roger Sayle  <roger@eyesopen.com>

	* ifcvt.c (struct noce_if_info): Add a Boolean b_unconditional field.
	(noce_try_sign_mask): Tweak rtx_cost check if t is evaluated anyway.
	(noce_process_if_block): Initialize if_info.b_unconditional if insn_b
	is currently executed unconditionally, i.e. not in "else_bb".

2004-07-06  Steven Bosscher  <stevenb@suse.de>

	* config/alpha/alpha.c (alpha_use_dfa_pipeline_interface): Remove.
	(TARGET_SCHED_USE_DFA_PIPELINE_INTERFACE): Define to hook_int_void_1.
	* config/arm/arm.c (arm_use_dfa_pipeline_interface): Remove.
	(TARGET_SCHED_USE_DFA_PIPELINE_INTERFACE): Define to hook_int_void_1.
	* config/frv/frv.c (frv_use_dfa_pipeline_interface): Remove.
	(TARGET_SCHED_USE_DFA_PIPELINE_INTERFACE): Define to hook_int_void_1.
	* config/i386/i386.c (ia32_use_dfa_pipeline_interface): Remove.
	(TARGET_SCHED_USE_DFA_PIPELINE_INTERFACE): Define to hook_int_void_1.
	* config/ia64/ia64.c (ia64_use_dfa_pipeline_interface): Remove.
	(TARGET_SCHED_USE_DFA_PIPELINE_INTERFACE): Define to hook_int_void_1.
	* config/pa/pa.c (hhpa_use_dfa_pipeline_interface): Remove.
	(TARGET_SCHED_USE_DFA_PIPELINE_INTERFACE): Define to hook_int_void_1.
	* config/sparc/sparc.c (sparc_use_dfa_pipeline_interface): Remove.
	(TARGET_SCHED_USE_DFA_PIPELINE_INTERFACE): Define to hook_int_void_1.
	* config/v850/v850.c (v850_use_dfa_pipeline_interface): Remove.
	(TARGET_SCHED_USE_DFA_PIPELINE_INTERFACE): Define to hook_int_void_1.

2004-07-06  Daniel Berlin  <dberlin@dberlin.org>

	* dojump.c (do_jump): REFERENCE_EXPR is dead.
	* expr.c (expand_expr_real_1): Ditto.
	* tree-inline.c (estimate_num_insns_1): Ditto.
	* tree-pretty-print.c (dump_generic_node): Ditto.
	(op_symbol): Ditto.
	* tree.def: Ditto.

2004-07-06  Daniel Berlin  <dberlin@dberlin.org>

	* tree-ssa-pre.c (reference_node_pool): New pool.
	(find_or_generate_expression): Class 'r' is okay too.
	(create_value_expr_from): Ditto.
	(add_to_sets): LHS should not include vuses.
	(eliminate): Ditto.
	(compute_avail): Reverse ordering of tests.
	Valuize INDIRECT_REF as well.

2004-07-06  Richard Sandiford  <rsandifo@redhat.com>

	PR rtl-optimization/16380
	* loop.c (check_dbra_loop): Sink comparison instructions if they
	do something other than set cc0.

2004-07-06  James E Wilson  <wilson@specifixinc.com>

	* doc/interface.texi (longjmp and automatic variables): Delete
	paragraph recommending taking the address of a variable.

2004-07-06  Nathan Sidwell  <nathan@codesourcery.com>

	* vec.h (VEC_embedded_alloc): Remove.
	(VEC_embedded_size, VEC_embedded_init): New.
	(VEC_alloc, VEC_reserve, VEC_safe_push, VEC_safe_insert): Add
	MEM_STAT_INFO.
	(VEC_truncate): New.
	(vec_p_reserve, vec_o_reserve): Add MEM_STAT_DECL.
	(vec_embedded_alloc): Remove.
	* vec.c (vec_p_reserve, vec_o_reserve): Add MEM_STAT_DECL, adjust.
	(vec_embedded_alloc): Remove.

2004-07-06  Mark Mitchell  <mark@codesourcery.com>

	* Makefile.in (langhooks.o): Do not depend on gt-langhooks.h.
	(gt-langhooks.h): Remove.

2004-07-06  George Helffrich <george@gly.bris.ac.uk>

	* xcoffout.h (DBX_FINISH_SYMBOL): Fix typo.

2004-07-06  Eric Botcazou  <ebotcazou@libertysurf.fr>

	* config/sparc/sparc.c (get_pc_symbol): Rename into
	add_pc_to_pic_symbol.
	(get_pc_symbol_name): Rename into add_pc_to_pic_symbol_name.
	(load_pic_register): Account for previous changes.
	Use reg_names.  Don't create the label twice.
	* config/sparc/sparc.md (UNSPEC_GET_PC): Rename into
	UNSPEC_LOAD_PCREL_SYM.
	(get_pc): Rename into load_pcrel_sym.  Add predicate to
	operands.  Remove condition.

2004-07-06  Nathan Sidwell  <nathan@codesourcery.com>

	* dbxout.c (dbxout_type): Don't test whether the binfo slot of
	RECORD, UNION & QUAL_UNION is actually a binfo.

	* tree.h (TREE_VIA_VIRTUAL): Rename to ...
	(BINFO_VIRTUAL_P): ... here. Require TREE_BINFO only.
	(BINFO_MARKED, BINFO_FLAG_[16]): New binfo flags.
	* dbxout.c (dbxout_type): Use BINFO_VIRTUAL_P.
	* dwarf2out.c (add_data_member_location_attribute): Likewise.
	(gen_inheritance_die): Likewise.
	* tree-dump.c (deque_and_dump): Likewise.
	* doc/c-tree.texi (Binfos): Add under reconstruction note.

2004-07-06  Steven Bosscher  <stevenb@suse.de>

	* config/mcore/mcore.c (TARGET_SCHED_USE_DFA_PIPELINE_INTERFACE):
	Define.
	* config/mcore/mcore.md: Model memory latency with a simple DFA
	pipeline description instead of a define_function_unit.

2004-07-05  Richard Kenner  <kenner@vlsi1.ultra.nyu.edu>

	* langhooks-def.h (LANG_HOOKS_TREE_INLINING_VAR_MOD_TYPE_P): Extra arg.
	* langhooks.h (var_mod_type_p): Likewise.
	* c-decl.c (finish_decl): Add extra arg to variably_modified_type_p.
	* expr.c (count_type_elements): Properly handle return from
	array_type_nelts and properly test for overflow.
	* gimplify.c (gimplify_init_constructor): Properly handle return
	from array_type_nelts.
	(gimplify_addr_expr): Remove redundant clear of TREE_SIDE_EFFECTS.
	* integrate.c (copy_decl_for_inlining): Correct comments.
	* tree-inline.c (remap_decl): Update comments, remove dead code,
	and copy DECL_FIELD_OFFSET and DECL_QUALIFIER, if they exist.
	(remap_type): Only remap if variably modified by vars in function
	being inlined.
	(copy_body_r): Use compatible_type langhooks to see when can fold.
	(setup_one_parameter): Don't remap type.
	(inline_forbidden_p_1): Add arg to variably_modified_type_p.
	* tree.c (recompute_tree_invarant_for_addr_expr): Properly
	compute TREE_INVARIANT for decl case.
	(find_var_from_fn): New function.
	(variably_modified_type_p): Add arg and call new function.
	* tree.h (variably_modified_type_p): Add extra arg.

2004-07-05  Eric Botcazou  <ebotcazou@libertysurf.fr>

	* config/sparc/sparc.md (nonlocal_goto): Remove disabled code.
	(goto_handler_and_restore_v9): Delete disabled insn.
	(goto_handler_and_restore_v9_sp64): Likewise.

2004-07-05  Roger Sayle  <roger@eyesopen.com>

	* calls.c (load_register_parameters): Call expand_shift instead
	of expand_binop with ashl_optab (or other shift optab) directly.
	* expr.c (emit_group_load, emit_group_store): Likewise.
	* function.c (assign_parm_setup_block): Likewise.
	* stmt.c (shift_return_value): Likewise.

2004-07-05  Jakub Jelinek  <jakub@redhat.com>

	* expr.c (expand_assignment): Disable the bitfield += optimizations.

2004-07-05  Joseph S. Myers  <jsm@polyomino.org.uk>

	* doc/sourcebuild.texi: Revert previous patch.

2004-07-05  Joseph S. Myers  <jsm@polyomino.org.uk>

	* c-decl.c, config/m32r/m32r.c, expr.c, optabs.c: Don't check
	TARGET_MEM_FUNCTIONS.
	* system.h: Poison TARGET_MEM_FUNCTIONS.
	* libfuncs.h (LTI_bcopy, LTI_bcmp, LTI_bzero, bcopy_libfunc,
	bcmp_libfunc, bzero_libfunc): Remove.
	* optabs.c (init_obtabs): Don't set bcopy_libfunc, bcmp_libfunc or
	bzero_libfunc.
	* doc/tm.texi (TARGET_MEM_FUNCTIONS): Remove.
	* doc/standards.texi: Don't mention calling BSD string functions.
	* doc/invoke.texi: Likewise.  Mention that memmove may be called.
	* config/vax/t-memfuncs: New.
	* config/memcmp.c, config/memcpy.c, config/memmove.c,
	config/memset.c: New.
	* config/pdp11/t-pdp11 (LIB2FUNCS_EXTRA): Use these files.
	* config.gcc (vax-*-bsd*, vax-*-sysv*, vax-*-ultrix*): Use
	vax/t-memfuncs.
	* config/alpha/alpha.h, config/arc/arc.h, config/arm/arm.h,
	config/avr/avr.h, config/c4x/c4x.h, config/cris/aout.h,
	config/elfos.h, config/gnu.h, config/h8300/h8300.h,
	config/i386/gas.h, config/ia64/ia64.h, config/interix.h,
	config/ip2k/ip2k.h, config/lynx-ng.h, config/m32r/m32r.h,
	config/mcore/mcore.h, config/mips/mips.h, config/mmix/mmix.h,
	config/netbsd.h, config/openbsd.h, config/pa/pa.h,
	config/rs6000/rs6000.h, config/rtems.h, config/s390/s390.h,
	config/sh/sh.h, config/sparc/sparc.h, config/stormy16/stormy16.h,
	config/svr3.h: Don't define TARGET_MEM_FUNCTIONS.

2004-07-05  Richard Henderson  <rth@redhat.com>

	* function.c (assign_parm_setup_reg): Properly rename variables in
	FUNCTION_ARG_CALLEE_COPIES section.

2004-07-05  Zack Weinberg  <zack@codesourcery.com>

	* tree-mudflap.c: Include cgraph.h.
	(mf_init_extern_trees): Rename to mudflap_init.  Export.
	Rewrite to create synthetic declarations instead of looking
	up declarations from mf-runtime.h.
	(mf_make_builtin, mf_make_cache_struct_type): New functions.
	(mf_cache_shift_decl, mf_cache_mask_decl, mf_unregister_fndecl):
	Correct commentary.
	(execute_mudflap_function_decls, mudflap_register_call):
	Don't call mf_init_extern_trees.
	(mudflap_finish_file): Use cgraph_build_static_cdtor.

	* tree-mudflap.h: Update prototypes.
	* c-mudflap.c: Delete file.
	* c-common.c: Include tree-mudflap.h.
	(c_common_nodes_and_builtins): Call mudflap_init if appropriate.
	* Makefile.in: Remove all references to c-mudflap.o.
	Update dependencies.

2004-07-05  John David Anglin  <dave.anglin@nrc-cnrc.gc.ca>

	* pa.md (prefetch, prefetch_32, prefetch_64): Only allow short
	displacements with the spatial-locality cache-control completer.

2004-07-05  Zack Weinberg  <zack@codesourcery.com>

	* langhooks.c: Don't include gt-langhooks.h.
	(var_labelno): Delete.
	(lhd_set_decl_assembler_name): Do not append a distinguishing
	number to file-scope internal-linkage declarations for the first
	input file, even if they have DECL_CONTEXT set.  Use DECL_UID of
	the declaration itself (if at block scope), or its containing
	TRANSLATION_UNIT_DECL (if at file scope) for the distinguishing
	number.

	* opts.c (cur_in_fname): New global.
	* opts.h: Declare it.
	* tree.c: Include opts.h.
	(make_node_stat): If creating a TRANSLATION_UNIT_DECL, give it
	DECL_UID equal to cur_in_fname.
	(copy_node_stat): Do not change DECL_UID when copying a
	TRANSLATION_UNIT_DECL.
	(build_common_tree_nodes): Adjust next_decl_uid to reserve the
	range 0 .. num_in_fnames-1 for TRANSLATION_UNIT_DECLs.

	* c-decl.c (c_static_assembler_name): Delete.
	* c-tree.h (c_static_assembler_name): Delete prototype.
	* c-lang.c, objc/objc-lang.c: Don't override
	LANG_HOOKS_SET_DECL_ASSEMBLER_NAME.

	* Makefile.in (tree.o): Update dependencies.
	(GTFILES): Remove langhooks.c.

2004-07-05  Roger Sayle  <roger@eyesopen.com>

	* fold-const.c (fold) <TRUNC_MOD_EXPR>: Optimize unsigned modulus
	by a power of two into a bit-wise AND, i.e. "X % C" as "X & (C-1)".
	Normalize "X % C" as "X % -C" for signed modulus and negative C.
	Optimize "X % -Y" as "X % Y" for signed modulus.
	<EQ_EXPR>: Recursively call "fold" when transforming "(X % Y) == 0"
	into "((unsigned) X % Y) == 0".

2004-07-05  Joseph S. Myers  <jsm@polyomino.org.uk>

	* sourcebuild.texi (Config Fragments): Use @comma{} in
	cross-reference to section title.

2004-07-05  Richard Kenner  <kenner@vlsi1.ultra.nyu.edu>

	* tree.h (DECL_SEEN_IN_BIND_EXPR_P): New macro.
	* gimplify.c (gimple_add_tmp_var, gimplify_bind_expr): Use it.
	(gimplify_target_expr, gimplify_expr): Likewise.
	(copy_if_shared_r): No longer need special case for BIND_EXPR.
	(unshare_body, unvisit_body): Only look at nested if BODY_P is
	whole function.
	(gimplify_compound_lval): See if we can strip any useless conversion.
	(gimplify_modify_expr, gimplify_modify_expr_to_memcpy): Take size
	from RHS, not LHS.
	(gimplify_modify_expr_to_memset): Likewise.
	(gimplify_expr, case CONSTRUCTOR): Handle use as statement.
	* tree-inline.c (setup_one_parameter): Use DECL_SEEN_IN_BIND_EXPR_P.
	(declare_inline_vars): Likewise.
	(walk_type_fields): New function.
	(walk_tree): Use it.
	* tree-nested.c (create_tmp_var_for): Show seen in BIND_EXPR.

	* tree-sra.c (struct sra_walk_fns): Init function now returns bool.
	(sra_walk_modify_expr): Allow init function to fail.
	(scan_init): Now returns bool.
	(generate_element_init): If can't understand INIT, return false.
	(scalarize_init): Return false if generate_element_init does.

	* tree-pretty-print.c (dump_generic_node, case ARRAY_TYPE): Properly
	print bounds.

	* expr.c (expand_expr_real_1, case SWITCH_EXPR): Don't check against
	bounds if bounds aren't constant.

	* tree-cfg.c (verify_expr): Use CHECK_OP in binary case.

	* function.c, langhooks-def.h, langhooks.h: Move max_size hook
	to type hooks; remove bogus PARAMS.

2004-07-05  Nathan Sidwell  <nathan@codesourcery.com>

	* c-tree.h (TYPE_ACTUAL_ARG_TYPES): Use TYPE_LANG_SLOT_1.
	* dwarf2out.c (add_data_member_location_attribute): Check for
	TREE_BINFO.
	* tree.c (tree_node_kinds): Add "binfos".
	(binfo_lang_slots): New.
	(make_node_stat): Add TREE_BINFO.
	(make_tree_binfo_stat): New.
	(tree_node_structure): Add TREE_BINFO.
	* tree.def (TREE_BINFO): New.
	* tree.h (REC_OR_UNION_CHECK): Rename to ...
	(RECORD_OR_UNION_CHECK): ... here.
	(NOT_RECORD_OR_UNION_CHECK): New.
	(TRE_VIA_VIRTUAL): Allow TREE_LIST or TREE_BINFO.
	(TYPE_FIELDS, TYPE_METHODS, TYPE_VFIELD): Adjust for
	RECORD_OR_UNION_CHECK.
	(TYPE_BINFO): Use RECORD_OR_UNION_CHECK.
	(TYPE_LANG_SLOT_1): New.
	(BINFO_TYPE, BINFO_OFFSET, BINFO_VTABLE, BINFO_VIRTUALS,
	BINFO_BASETYPES, TYPE_BINFO_BASETYPES, BINFO_VPTR_FIELD,
	BINFO_BASEACCESSES, BINFO_INHERITANCE_CHAIN): Adjust.
	(BINFO_ELTS): Remove.
	(BINFO_LANG_SLOT): New.
	(struct tree_binfo): New.
	(binfo_lang_slots): Declare.
	(enum tree_node_structure_enum): Add TS_BINFO.
	(union tree_node): Add binfo.
	(make_tree_binfo_stat): Declare.
	(make_tree_binfo): New.
	(enum tree_node_kind): Add binfo_kind.

	* objc/objc-act.c (start_class, objc_declare_protocols,
	start_protocols): Use TYPE_LANG_SLOT_1.
	* objc/objc-act.h (CLASS_BINFO_ELTS, PROTOCOL_BINFO_ELTS): Rename
	to ...
	(CLASS_LANG_SLOT_ELTS, PROTOCOL_LANG_SLOT_ELTS): ... here.
	(CLASS_IVARS, CLASS_RAW_IVARS, CLASS_STATIC_TEMPLATE,
	CLASS_CATEGORY_LIST, CLASS_PROTOCOL_LIST, CLASS_OWN_IVARS,
	PROTOCOL_LIST, PROTOCOL_FORWARD_DECL): Use TYPE_LANG_SLOT_1.

2004-07-05  Steven Bosscher  <stevenb@suse.de>

	* rtl.h (struct rtx_def): Remove the integrated flag.
	Use the return_val flag for MEM_SCALAR_P.
	Reshuffle and update flags in CLEAR_RTX_FLAGS.

2004-07-05  Richard Sandiford  <rsandifo@redhat.com>

	PR target/16357
	* config/mips/mips.c (mips_block_move_straight): Pass BLKmode memrefs
	to mips_expand_unaligned_load, mips_expand_unaligned_store, and
	move_by_pieces.

2004-07-05  Josef Zlomek  <zlomekj@suse.cz>

	* var-tracking.c: Fix some comments.
	(frame_stack_adjust): New.
	(vt_stack_adjustments): Init stack_adjust of entry block to
	minus stack adjustment of function prologue.
	(adjust_stack_reference): Do not adjust if adjustment == 0.
	(compute_bb_dataflow): Use plus_constant instead of gen_rtx_PLUS.
	(emit_notes_in_bb): Likewise.
	(vt_add_function_parameters): Do not adjust locations of
	function arguments.
	(vt_initialize): Compute the stack adjustment of function
	prologue and offset the initial "location" of frame_base_decl
	from the stack pointer after prologue.

2004-07-04  Richard Henderson  <rth@redhat.com>

	* function.c (struct assign_parm_data_all): New.
	(struct assign_parm_data_one): New.
	(assign_parms_initialize_all, assign_parms_augmented_arg_list,
	assign_parm_find_data_types, assign_parms_setup_varargs,
	assign_parm_find_entry_rtl, assign_parm_is_stack_parm,
	assign_parm_find_stack_rtl, assign_parm_adjust_entry_rtl,
	assign_parm_adjust_stack_rtl, assign_parm_setup_block_p,
	assign_parm_setup_block, assign_parm_setup_reg,
	assign_parm_setup_stack, assign_parms_unsplit_complex): Split from ...
	(assign_parms): ... here.

2004-07-04  Daniel Berlin  <dberlin@dberlin.org>

	* tree-ssa-pre.c (bb_value_sets): phi_gen, tmp_gen, new_sets
	now are bitmap_set_t's.
	(bitmap_insert_into_set): No point in inserting the value if
	it's invariant.
	(bitmap_set_contains): New function.
	(bitmap_set_replace_value): Add comment on why we do it
	this way.
	(set_contains): Removed.
	(bitmap_set_subtract_from_value_set): New name of
	set_subtract now that it's arguments are two different
	types of sets.
	Update callers.
	(bitmap_find_leader): Change algorithm used.
	(find_or_generate_expression): Update use of functions for new
	bitmap sets.
	(create_expression_by_pieces): Ditto.
	(insert_aux): Ditto.
	(insert): Ditto.
	(add_to_sets): Ditto.
	(init_pre): Ditto.
	(execute_pre): Ditto.
	(compute_avail): Ditto.
	Also ignore virtual phis.

2004-07-04  Richard Sandiford  <rsandifo@redhat.com>

	* combine.c (simplify_comparison): Fix comment typo.

2004-07-04  Eric Botcazou  <ebotcazou@libertysurf.fr>

	* config/sparc/sparc.c (SIBCALL_SLOT_EMPTY_P): Rename
	into LEAF_SIBCALL_SLOT_RESERVED_P after negation.
	(eligible_for_sibcall_delay): Adjust use of SIBCALL_SLOT_EMPTY_P.
	(output_restore): Change parameter from 'insn' to 'pat'.
	(output_return): Adjust call to output_restore.
	(output_sibcall): Adjust use of SIBCALL_SLOT_EMPTY_P.
	Adjust call to output_restore.

2004-07-04  Neil Booth  <neil@duron.akihabara.co.uk>

	* config/netbsd.h (NETBSD_OS_CPP_BUILTINS_COMMON): Define __unix__
	and assert system is bsd.

2004-07-04  Richard Sandiford  <rsandifo@redhat.com>

	* config/mips/mips.h (MASK_DEBUG_C, TARGET_DEBUG_C_MODE): Delete.
	(TARGET_SWITCHES): Remove -mdebugc.
	* config/mips/mips.md (seq, sne, sgt, sge, slt, sle, sgtu, sgeu)
	(sltu, sleu): Remove TARGET_DEBUG_C_MODE handling.
	(seq_[sd]i, sne_[sd]i, sge_[sd]i, sle_[sd]i_reg, sgeu_[sd]i)
	(sle_[sd]i_reg): Delete.

2004-07-04  Steven Bosscher  <stevenb@suse.de>

	* config/iq2000/iq2000.c (TARGET_SCHED_USE_DFA_PIPELINE_INTERFACE):
	Define.
	* config/iq2000/iq2000.md: Translate old pipeline description to an
	equivalent new one.

2004-07-04  Roger Sayle  <roger@eyesopen.com>

	* tree-ssa-ccp.c (set_rhs): Change function to return a bool.
	Ensure the replacement rhs is valid gimple before performing
	the substitution.  Return false if these sanity checks fail.
	(fold_stmt): Only set changed to true, if set_rhs returns true.
	(execute_fold_all_builtins): Only call modify_stmt if set_rhs
	succeeds.

2004-07-04  Richard Henderson  <rth@redhat.com>

	PR c/16348
	* c-typeck.c (c_finish_loop): Don't clear cond for cond_is_first loops.

2004-07-04  Mark Mitchell  <mark@codesourcery.com>

	* configure.ac (ranlib_flags): New variable.
	* Makefile.in (RANLIB_FLAGS): New variable.
	(libbackend.a): Use it.
	* configure: Regenerated.

2004-07-04  Roger Sayle  <roger@eyesopen.com>

	* ifcvt.c (noce_try_sign_mask): Call emit_store_flag to generate
	a "sign mask" instead of using ashr_optab directly.

2004-07-04  Neil Booth  <neil@duron.akihabara.co.uk>

	* doc/cpp.texi: Don't document what we do for ill-formed expressions.
	* doc/cppopts.texi: Clarify processing of command-line defines.

2004-07-04  Gerald Pfeifer  <gerald@pfeifer.com>

	* doc/contrib.texi (Contributors): Adjust link for GNU Classpath.

2004-07-04  Richard Henderson  <rth@redhat.com>

	* rtl.def (ADDRESSOF): Remove.
	* alias.c (rtx_equal_for_memref_p): Don't handle addressof.
	(find_base_term, memrefs_conflict_p): Likewise.
	* cse.c (fixed_base_plus_p, find_best_addr: Likewise.
	(fold_rtx, cse_insn, set_live_p): Likewise.
	* dwarf2out.c (mem_loc_descriptor): Likewise.
	(add_location_or_const_value_attribute): Likewise.
	* emit-rtl.c (copy_insn_1): Likewise.
	* explow.c (memory_address): Likewise.
	* expmed.c (store_split_bit_field): Likewise.
	* expr.c (expand_expr_real_1): Likewise.
	* function.c (instantiate_decl
	(instantiate_virtual_regs_1, fix_lexical_addr): Likewise.
	* genrecog.c (preds, validate_pattern): Likewise.
	* integrate.c (copy_rtx_and_substitute): Likewise.
	* recog.c (general_operand, register_operand): Likewise.
	(memory_address_p): Likwise.
	* reload1.c (eliminate_regs, elimination_effects): Likewise.
	* rtl.c (copy_rtx): Likewise.
	* rtlanal.c (rtx_unstable_p, rtx_varies_p): Likewise.
	(rtx_addr_can_trap_p, nonzero_address_p, address_cost): Likewise.
	* rtlhooks.c (gen_lowpart_general): Likewise.
	* stmt.c (expand_asm_operands): Likewise.
	* web.c (entry_register, replace_ref, web_main): Likewise.
	* config/alpha/alpha.c (input_operand, alpha_legitimate_address_p,
	alpha_expand_block_move, alpha_expand_block_clear): Likewise.
	* config/arm/arm.c (thumb_rtx_costs): Likewise.
	* config/c4x/c4x.c (c4x_valid_operands): Likewise.
	* config/frv/frv.c (move_destination_operand, move_source_operand,
	condexec_dest_operand, condexec_source_operand,
	condexec_memory_operand): Likewise.
	* config/h8300/h8300.h (PREDICATE_CODES): Likewise.
	* config/ia64/ia64.c (general_xfmode_operand): Likewise.
	(destination_xfmode_operand): Likewise.
	* config/mips/mips.h (PREDICATE_CODES): Likewise.
	* config/mn10300/mn10300.c (mn10300_address_cost_1): Likewise.
	* config/s390/s390.c (general_s_operand): Likewise.
	* config/s390/s390.md (mov*): Likewise.
	* config/sparc/sparc.h (PREDICATE_CODES): Likewise.

	* c-typeck.c (c_mark_addressable): Don't put_var_into_stack.
	* expr.c (expand_expr_real_1): Likewise.
	* stmt.c (expand_decl): Likewise.
	* config/c4x/c4x.c (c4x_expand_builtin): Likewise.

	* function.c (struct fixup_replacement, struct insns_for_mem_entry,
	postponed_insns, put_var_into_stack, put_reg_into_stack,
	schedule_fixup_var_refs, fixup_var_refs, find_fixup_replacement,
	fixup_var_refs_insns, fixup_var_refs_insns_with_hash,
	fixup_var_refs_insn, fixup_var_refs_1, fixup_memory_subreg,
	walk_fixup_memory_subreg, fixup_stack_1, optimize_bit_field,
	gen_mem_addressof, flush_addressof, put_addressof_into_stack,
	purge_bitfield_addressof_replacements, purge_addressof_replacements,
	purge_addressof_1, insns_for_mem_hash, insns_for_mem_comp,
	struct insns_for_mem_walk_info, insns_for_mem_walk,
	compute_insns_for_mem, is_addressof, purge_addressof, setjmp_protect,
	setjmp_protect_args): Remove.
	(push_function_context_to): Don't handle var_refs_queue.
	(pop_function_context_from, free_after_compilation): Likewise.
	(instantiate_virtual_regs): Don't handle parm_reg_stack_loc.
	(assign_parms, allocate_struct_function): Likewise.
	(use_register_for_decl): New.
	(expand_function_end): Don't setjmp_protect.
	* function.h (struct emit_status): Update commentary.
	(struct function): Remove x_max_parm_reg, x_parm_reg_stack_loc.
	(max_parm_reg, parm_reg_stack_loc): Remove.
	* passes.c (DFI_addressof): Remove.
	(dump_file_info): Remove addressof.
	(rest_of_handle_addressof): Remove.
	(rest_of_compilation): Don't call it.
	* rtl.h (ADDRESSOF_REGNO, ADDRESSOF_DECL): Remove.
	* stmt.c (expand_decl): Use use_register_for_decl.
	* tree.h: Update decls.
	* web.c (mark_addressof): Remove.
	* doc/invoke.texi (-dF): Remove.

2004-07-03  Richard Henderson  <rth@redhat.com>

	* config/ia64/ia64.c (spill_xfmode_operand): Use assign_stack_temp
	instead of gen_mem_addressof.
	* config/ia64/ia64.md (movxf): Use assign_stack_temp to handle
	TImode output register.

2004-07-03  Richard Henderson  <rth@redhat.com>

	PR tree-optimization/16341
	* tree-sra.c (sra_walk_function): Increment to next stmt before
	processing the current stmt.
	(sra_insert_after): Always use BSI_SAME_STMT.

2004-07-03  Richard Henderson  <rth@redhat.com>

	* tree-ssa-dom.c (simplify_rhs_and_lookup_avail_expr): Don't fold
	fp plus with minus.

2004-07-03  Joseph S. Myers  <jsm@polyomino.org.uk>

	* tree.c (type_hash_eq): Allow TYPE_MIN_VALUE which compares equal
	with tree_int_cst_equal.

2004-07-03  Andreas Schwab  <schwab@suse.de>

	* config/ia64/ia64.md: Define new attribute "empty".
	(prologue_use, nop_x, insn_group_barrier): Set it.

	* config/ia64/ia64.c (ia64_reorg): When looking for trailing call
	skip over "empty" insns.

2004-07-03  Richard Kenner  <kenner@vlsi1.ultra.nyu.edu>

	* tree-inline.c (initialize_inlined_parameters): Pass proper function
	context to gimplify_body.
	(walk_tree): Don't walk into types twice.
	(walk_tree, case POINTER_TYPE): Deal with mutually recursive pointers.

	* tree-sra.c (generate_element_init): Remove any useless conversions.

	* gimplify.c (gimplify_conversion): Remove stripping useless
	conversions from here.
	(gimplify_expr): Put it here, in place of call to STRIP_MAIN_TYPE_NOPS.
	(gimplify_modify_expr_to_memcpy, gimplify_variable_sized_compare):
	Unshare before substituting PLACEHOLDER_EXPR.
	(gimplify_modify_expr_to_memset): Likewise.
	Pass address of TO to memset, not TO itself.
	(gimplify_init_constructor): Make copy of OBJECT so we have it each
	time we make an expression (to match a PLACEHOLDER_EXPR).

	* tree-ssa.c (tree_ssa_useless_type_conversion): Also look at
	VIEW_CONVERT_EXPR and NON_LVALUE_EXPR.
	* tree-ssa-ccp.c (fold_stmt): Call just STRIP_USELESS_TYPE_CONVERSION.
	* tree-ssa-dom.c (local_fold): Likewise.

	* langhooks-def.h (LANG_HOOKS_TYPE_MAX_SIZE): New langhook.
	* langhooks.h (strct lang_hooks): New field type_max_size.
	* function.c (assign_temp): Call it.

2004-07-03  Steven Bosscher  <stevenb@suse.de>

	* config/sh/sh.c (sh_use_dfa_interface): Add TARGET_SH1.
	* config/sh/sh.md: Convert the SH1 pipeline description to
	a DFA model.

2004-07-02  Zack Weinberg  <zack@codesourcery.com>

	* c-decl.c (struct c_binding): Remove contour field; add
	depth, invisible, nested fields.
	(B_IN_SCOPE, B_IN_CURRENT_SCOPE, B_IN_FILE_SCOPE)
	(B_IN_EXTERNAL_SCOPE): New convenience macros.
	(bind): Add invisible and nested arguments. Initialize
	new fields of struct c_binding; adjust loop scanning for
	insertion point.
	(free_binding_and_advance): Clear structure with memset.
	(pop_scope): Adjust to match.  Set DECL_CONTEXT on everything
	in file scope, even if it's in external scope too.
	(pushdecl): Adjust to match.  Create invisible file-scope
	declarations for block-scope forward declarations of static functions.
	(pushtag, warn_if_shadowing, pushdecl_top_level, implicitly_declare)
	(undeclared_variable, lookup_label, declare_label, define_label)
	(lookup_tag, lookup_name, lookup_name_in_scope, builtin_function)
	(c_make_fname_decl, store_parm_decls_newstyle, identifier_global_value)
	(store_parm_decls_oldstyle): Adjust to match.
	(diagnose_mismatched_decls): Correct handling of linkage clashes.
	(merge_decls): No need to copy C_DECL_IN_EXTERNAL_SCOPE.

	* c-tree.h (C_DECL_IN_EXTERNAL_SCOPE): Delete.
	(C_DECL_DECLARED_BUILTIN, C_DECL_REGISTER): Slide down one.

2004-07-02  Richard Henderson  <rth@redhat.com>

	* c-decl.c (grokdeclarator): Don't frob current_function_decl
	around variable_size.
	(set_decl_nonlocal): Remove.
	(store_parm_decls): Add stmts for pending sizes.
	* calls.c (calls_function, calls_function_1): Remove.
	(precompute_arguments): Don't call it.
	* cfgexpand.c (set_save_expr_context): Remove.
	(tree_expand_cfg): Don't call it.
	* dwarf2out.c (add_bound_info): Don't handle SAVE_EXPR.
	(dwarf2out_finish): Likewise.
	* expr.c (emit_block_move): Adjust addresses to BLKmode.
	(store_constructor): Don't pre-evaluate SAVE_EXPR.
	(safe_from_p): Don't queue SAVE_EXPRs.
	(expand_expr_real_1 <case SAVE_EXPR>): Rewrite to expect,
	or build plain VAR_DECLs.
	* fold-const.c (twoval_comparison_p): Don't look at SAVE_EXPR_RTL.
	(fold): Likewise.
	(fold_checksum_tree): Don't special-case SAVE_EXPR.
	* function.c (free_after_compilation): Don't clear x_save_expr_regs.
	(put_var_into_stack): Don't handle SAVE_EXPR.
	(gen_mem_addressof): Likewise.
	* function.h (struct function): Remove x_save_expr_regs.
	(save_expr_regs): Remove.
	* gengtype.c (adjust_field_tree_exp): Don't special-case SAVE_EXPR.
	* print-tree.c (print_node): Don't dump SAVE_EXPR_NOPLACEHOLDER.
	* stor-layout.c (variable_size): Don't set it.
	(force_type_save_exprs, force_type_save_exprs_1): Remove.
	* tree-inline.c (remap_save_expr): Remove fn argument.  Update
	all callers.  Don't set SAVE_EXPR_CONTEXT.
	* tree-inline.h (remap_save_expr): Update decl.
	* tree.c (save_expr): Update build size.
	(first_rtl_op): Don't handle SAVE_EXPR.
	(unsave_expr_1, contains_placeholder_p): Likewise.
	(decl_function_context): Likewise.
	* tree.def (SAVE_EXPR): Remove args 1 and 2.
	* tree.h (SAVE_EXPR_CONTEXT, SAVE_EXPR_RTL): Remove.
	(SAVE_EXPR_NOPLACEHOLDER, SAVE_EXPR_PERSISTENT_P): Remove.

2004-07-03  Joseph S. Myers  <jsm@polyomino.org.uk>

	* doc/bugreport.texi, doc/configterms.texi, doc/contrib.texi,
	doc/contribute.texi, doc/cpp.texi, doc/cppinternals.texi,
	doc/extend.texi, doc/install.texi, doc/invoke.texi, doc/md.texi,
	doc/portability.texi, doc/tree-ssa.texi, doc/trouble.texi: Avoid
	some first-person references and patronizing comments.  Based on
	printed manual.
	* doc/invoke.texi: Don't reference fortran@gnu.org.
	* doc/trouble.texi (Warning when a non-void function value is
	ignored): Rewrite.  From Russ Allbery and Chris Devers.

2004-07-02  Daniel Berlin  <dberlin@dberlin.org)

	* tree-ssa-pre.c (bitmap_set_t): New.
	(bb_value_sets): avail_out is now a bitmap_set_t.
	(bitmap_find_leader): New function.
	(bitmap_value_insert_into_set): Ditto.
	(bitmap_set_copy): Ditto.
	(bitmap_value_replace_in_set): Ditto.
	(bitmap_set_contains_value): Ditto.
	(bitmap_set_new): Ditto.
	(bitmap_set_pool): New pool.
	(find_or_generate_expression): Use bitmap_ functions on AVAIL sets.
	(insert_aux): Ditto.
	(add_to_sets): Ditto.
	(compute_avail): Ditto
	(eliminate): Ditto.
	(init_pre): Ditto.
	(fini_pre): Ditto.
	(execute_pre): Ditto.

2004-07-02  Roger Sayle  <roger@eyesopen.com>

	* config/rs6000/rs6000.c (struct processor_costs): New structure
	used to hold instruction latencies/sizes for processor types.
	(rs6000_cost): New global variable pointing to current CPU's costs.
	(rs6000_override_options): Initialize rs6000_cost to point to the
	appropriate cost table based upon rs6000_cpu and optimize_size.
	(rs6000_rtx_costs): Use rs6000_cost to avoid hardcoding processor
	timings inline.

2004-07-02  Richard Henderson  <rth@redhat.com>

	* expmed.c (make_tree): Don't use SET_DECL_RTL.

2004-07-02  Steven Bosscher  <stevenb@suse.de>

	* tree-flow.h (bb_ann_d): Remove ephi_nodes field.

2004-07-01  Richard Henderson  <rth@redhat.com>

	* config/alpha/alpha.c (struct machine_function): Add gp_save_rtx.
	(alpha_gp_save_rtx): Use assign_stack_local instead of
	gen_mem_addressof.

2004-07-01  Richard Henderson  <rth@redhat.com>

	* config/alpha/alpha.c (struct alpha_rtx_cost_data): Add int_div.
	(alpha_rtx_cost_data): Update to match.
	(alpha_rtx_cost_size): New.
	(alpha_rtx_costs): Honor optimize_size.

2004-07-01  Richard Henderson  <rth@redhat.com>

	* gimple-low.c (lower_function_body): Don't reset_block_changes here.
	* cfgexpand.c (tree_expand_cfg): Do it here.
	* config/alpha/alpha.c (alpha_output_mi_thunk_osf): And here.
	* config/ia64/ia64.c (ia64_output_mi_thunk): And here.
	* config/mips/mips.c (mips_output_mi_thunk): And here.
	* config/rs6000/rs6000.c (rs6000_output_mi_thunk): And here.
	* config/sh/sh.c (sh_output_mi_thunk): And here.
	* config/sparc/sparc.c (sparc_output_mi_thunk): And here.

2004-07-01  Richard Henderson  <rth@redhat.com>

	* tree.def (RTL_EXPR): Remove.
	* c-typeck.c (lvalue_p): Don't handle it.
	* expr.c (safe_from_p): Likewise.
	(expand_expr_real_1): Likewise.
	* fold-const.c (non_lvalue, operand_equal_p, fold): Likewise.
	(fold_checksum_tree, tree_expr_nonnegative_p): Likewise.
	* gengtype.c (adjust_field_tree_exp): Likewise.
	* stmt.c (warn_if_unused_value): Likewise.
	* tree-gimple.c (recalculate_side_effects): Likewise.
	* tree-pretty-print.c (dump_generic_node): Likewise.
	* tree.c (make_node_stat, first_rtl_op, unsave_expr_1): Likewise.
	(unsafe_for_reeval, stabilize_reference, build1_stat): Likewise.
	* tree.h (RTL_EXPR_SEQUENCE, RTL_EXPR_RTL, RTL_EXPR_ALT_RTL): Remove.

	* stmt.c (struct stmt_status): Remove x_last_expr_type,
	x_last_expr_value, x_last_expr_alt_rtl, x_expr_stmts_for_value.
	(last_expr_type, last_expr_value, last_expr_alt_rtl): Remove.
	(expand_expr_stmt): Merge with expand_expr_stmt_value.  Remove
	all the bits that tracked last_expr.
	(expand_end_bindings): Don't track last_expr.
	(expand_start_stmt_expr, expand_end_stmt_expr): Remove.
	(clear_last_expr): Remove.
	(expand_asm): Don't call it.
	(expand_asm_operands, expand_end_cond): Likewise.
	(expand_naked_return, expand_null_return_1): Likewise.
	* c-typeck.c (c_begin_compound_stmt): Likewise.
	* cfgexpand.c (expand_block): Use expand_expr_stmt.
	* expr.c (expand_expr_real_1): Likewise.
	* tree.h: Update prototypes.

	* function.h (struct sequence_stack): Remove sequence_rtl_expr.
	(struct emit_status): Remove sequence_rtl_expr.
	(struct function): Remove x_rtl_expr_chain.
	(seq_rtl_expr, rtl_expr_chain): Remove.
	* function.c (struct temp_slot): Remove rtl_expr.
	(assign_stack_temp_for_type): Don't set it.
	(free_temp_slots, pop_temp_slots): Don't check it.
	(free_after_compilation): Don't clear x_rtl_expr_chain.
	(fixup_var_refs): Don't search it.
	(preserve_rtl_expr_result, free_temps_for_rtl_expr): Remove.
	* emit-rtl.c (start_sequence): Don't use sequence_rtl_expr
	or seq_rtl_expr.
	(push_topmost_sequence): Likewise.
	(end_sequence, init_emit): Likewise.
	(start_sequence_for_rtl_expr): Remove.
	* expmed.c (make_tree): Build a VAR_DECL instead of an RTL_EXPR.
	* rtl.h (preserve_rtl_expr_result): Remove.

2004-07-02  Kazu Hirata  <kazu@cs.umass.edu>

	* ifcvt.c, modulo-sched.c, tree-alias-common.c, tree-sra.c,
	tree-ssa-copy.c, tree-ssa-dom.c, tree-ssa-pre.c: Fix comment
	typos.

2004-07-02  Aaron W. LaFramboise <aaronraolete36@aaronwl.com>

	* gcc.c (STANDARD_STARTFILE_PREFIX_1): Define.
	(STANDARD_STARTFILE_PREFIX_2): Define.
	(standard_startfile_prefix_1): Initialize to
	STANDARD_STARTFILE_PREFIX_1.
	(standard_startfile_prefix_2): Initialize to
	STANDARD_STARTFILE_PREFIX_2.
	* config/i386/mingw32.h (MD_STARTFILE_PREFIX): Remove.
	(STANDARD_STARTFILE_PREFIX_1): Define.
	(STANDARD_STARTFILE_PREFIX_2): Define.
	* doc/tm.texi (STANDARD_STARTFILE_PREFIX_1): Document.
	(STANDARD_STARTFILE_PREFIX_2): Document.

2004-07-01  Richard Henderson  <rth@redhat.com>

	* tree-sra.c (sra_walk_expr): Don't maybe_lookup_element_for_expr
	in order to disable scalarization.  Instead set a flag and wait
	for a candidate decl.

2004-07-01  Joseph S. Myers  <jsm@polyomino.org.uk>

	* doc/cppinternals.texi, doc/install.texi, doc/invoke.texi,
	doc/md.texi, doc/sourcebuild.texi, doc/tm.texi, doc/trouble.texi:
	Use terminology "testsuite" and "enumerated".

2004-07-01  Richard Henderson  <rth@redhat.com>

	* dwarf2out.c (reg_save): Use INVALID_REGNUM.
	(dwarf2out_reg_save, dwarf2out_return_save): Likewise.
	(initial_return_save): Likewise.
	(flush_queued_reg_saves): Remap register numbers.
	(dwarf2out_return_reg): Likewise.

2004-07-01  Richard Kenner  <kenner@vlsi1.ultra.nyu.edu>

	* gimplify.c (gimplify_one_sizepos): Don't do anything if any VAR_DECL.

	* tree-pretty-print.c (dump_generic_node, case ARRAY_REF): Use
	access functions for lower bound and element size and only output
	if lower bound nonzero or element size not same as that of type.
	(dump_generic_node, case COMPONENT_REF): Use access func. for offset.

2004-07-01  Paolo Bonzini  <bonzini@gnu.org>

	* c-pretty-print.c (pp_c_postfix_expression): Fix pasto.

2004-07-01  Per Bothner  <per@bothner.com>

	* final.c (final):  Fix typo reported by Aaron W. LaFramboise.

2004-07-01  Jakub Jelinek  <jakub@redhat.com>

	* expr.c (expand_assignment): Optimize bitfld += cst for 1 bit
	bitfields as well.  STRIP_NOPS from src operand and PLUS_EXPR's
	first operand.  Don't optimize if the bitfield is volatile.

2004-07-01  Paolo Bonzini  <bonzini@gnu.org>

	* c-pretty-print.c (pp_c_postfix_expression): Handle
	floating-point comparison operators.
	(pp_c_expression): Pass floating-point comparison
	operators to pp_c_postfix_expression.

2004-07-01  Roger Sayle  <roger@eyesopen.com>

	* simplify-rtx.c (simplify_binary_operation) <PLUS, MINUS>: Use
	rtx_cost instead of "had_mult" to determine whether the transformed
	expression is cheaper than the original.

2004-07-01  Jerry Quinn  <jlquinn@optonline.net>

	* alias.c (get_alias_set, canon_rtx, get_addr,
	nonoverlapping_memrefs_p, nonlocal_referenced_p_1, memory_modified_1):
	Use MEM_P.
	* builtins.c (expand_builtin_prefetch, expand_builtin_profile_func,
	expand_builtin): Likewise.
	* calls.c (expand_call, emit_library_call_value_1, store_one_arg):
	Likewise.
	* combine.c (can_combine_p, combinable_i3pat, try_combine,
	find_split_point, combine_simplify_rtx, simplify_set, make_extraction,
	rtx_equal_for_field_assignment_p, gen_lowpart_for_combine,
	record_dead_and_set_regs_1, get_last_value_validate,
	mark_used_regs_combine, move_deaths, unmentioned_reg_p_1): Likewise.
	* cse.c (check_dependence, canon_hash, equiv_constant,
	gen_lowpart_if_possible, cse_insn, invalidate_from_clobbers,
	cse_around_loop, cse_check_loop_start, cse_set_around_loop,
	count_reg_usage): Likewise.
	* cselib.c (rtx_equal_for_cselib_p, add_mem_for_addr, cselib_lookup,
	cselib_invalidate_mem, cselib_invalidate_rtx, cselib_record_set,
	cselib_record_sets): Likewise.
	* dbxout.c (PARM_PASSED_IN_MEMORY, dbxout_symbol,
	dbxout_symbol_location, dbxout_parms, dbxout_reg_parms): Likewise.
	* ddg.c (mark_mem_use, mark_mem_store, rtx_mem_access_p): Likewise.
	* df.c (df_uses_record): Likewise.
	* dojump (do_jump): Likewise.
	* dwarf2out.c (stack_adjust_offset, mem_loc_descriptor,
	loc_descriptor_from_tree, rtl_for_decl_location, add_bound_info,
	decl_start_label): Likewise.
	* emit-rtl.c (gen_complex_constant_part, gen_highpart,
	operand_subword, change_address_1, make_safe_from): Likewise.
	* explow.c (break_out_memory_refs, copy_all_regs, validize_mem,
	stabilize, force_not_mem): Likewise.
	* expmed.c (store_bit_field, store_split_bit_field, extract_bit_field,
	expand_mult_const, expand_divmod, emit_store_flag): Likewise.
	* expr.c (convert_move, convert_modes, emit_block_move,
	emit_group_load, emit_group_store, clear_storage, emit_move_insn,
	emit_move_insn_1, expand_assignment, store_expr,
	store_constructor_field, store_constructor, store_field,
	force_operand, safe_from_p, expand_expr_real_1, expand_increment):
	Likewise.
	* final.c (cleanup_subreg_operands, alter_subreg,
	get_mem_expr_from_op): Likewise.
	* flow.c (notice_stack_pointer_modification_1,
	init_propagate_block_info, insn_dead_p, mark_set_1, mark_used_regs):
	Likewise.
	* function.c (mark_temp_addr_taken, preserve_temp_slots,
	preserve_rtl_expr_result, put_var_into_stack, fixup_var_refs_1,
	optimize_bit_field, flush_addressof, purge_addressof_1,
	instantiate_decl, instantiate_virtual_regs_1, assign_parms,
	setjmp_protect, setjmp_protect_args, fix_lexical_addr,
	keep_stack_depressed): Likewise.
	* ifcvt.c (noce_try_cmove_arith, noce_try_abs, noce_operand_ok,
	noce_process_if_block, find_memory): Likewise.
	* integrate.c (subst_constants, allocate_initial_values): Likewise.
	* local-alloc.c (validate_equiv_mem_from_store, memref_referenced_p,
	update_equiv_regs): Likewise.
	* loop.c (scan_loop, prescan_loop, note_addr_stored, check_store,
	maybe_eliminate_biv_1, find_mem_in_note_1): Likewise.
	* optabs.c (expand_abs, emit_unop_insn): Likewise.
	* passes.c (rest_of_handle_final): Likewise.
	* postreload.c (reload_cse_simplify_set, reload_cse_simplify_operands,
	move2add_note_store): Likewise.
	* ra-build.c (detect_remat_webs): Likewise.
	* ra-debug.c (dump_static_insn_cost): Likewise.
	* ra-rewrite.c (slots_overlap_p, insert_stores): Likewise.
	* recog.c (validate_change, apply_change_group, cancel_changes,
	validate_replace_rtx_1, general_operand, register_operand,
	nonmemory_operand, push_operand, pop_operand, memory_operand,
	indirect_operand, asm_operand_ok, offsettable_memref_p,
	offsettable_nonstrict_memref_p, constrain_operands,
	store_data_bypass_p): Likewise.
	* reg-stack.c (subst_stack_regs_pat): Likewise.
	* regclass.c (record_operand_costs, scan_one_insn, record_reg_classes,
	copy_cost, reg_scan_mark_refs): Likewise.
	* regmove.c (optimize_reg_copy_3, stack_memref_p,
	combine_stack_adjustments_for_block): Likewise.
	* regrename.c (copyprop_hardreg_forward_1): Likewise.
	* reload.c (can_reload_into, push_reload, decompose, immune_p,
	find_reloads, find_reloads_address, find_reloads_address_1,
	reg_overlap_mentioned_for_reload_p, refers_to_mem_for_reload_p,
	find_equiv_reg): Likewise.
	* reload1.c (reload, eliminate_regs, eliminate_regs_in_insn,
	reload_as_needed, choose_reload_regs, emit_input_reload_insns,
	do_input_reload, emit_reload_insns, gen_reload, delete_output_reload,
	delete_address_reloads): Likewise.
	* resource.c (mark_referenced_resources): Likewise.
	* rtlanal.c (get_jump_table_offset, count_occurrences,
	reg_referenced_p, reg_set_p, set_of_1, set_noop_p,
	reg_overlap_mentioned_p, note_uses, replace_regs, nonzero_bits1,
	num_sign_bit_copies1): Likewise.
	* rtlhooks.c (gen_lowpart_general): Likewise.
	* sched-deps.c (sched_analyze_1, sched_analyze_2): Likewise.
	* sdbout.c (PARM_PASSED_IN_MEMORY, sdbout_symbol,
	sdbout_toplevel_data, sdbout_parms, sdbout_reg_parms,
	sdbout_global_decl): Likewise.
	* simplify-rtx.c (simplify_subreg): Likewise.
	* stmt.c (expand_asm_operands, expand_expr_stmt_value, expand_decl,
	expand_anon_union_decl, expand_end_case_type): Likewise.
	* unroll.c (calculate_giv_inc): Likewise.
	* var-tracking.c (stack_adjust_offset_pre_post,
	bb_stack_adjust_offset, track_expr_p, count_uses, add_uses,
	add_stores, compute_bb_dataflow, vt_get_decl_and_offset,
	vt_add_function_parameters): Likewise.
	* varasm.c (make_var_volatile, notice_global_symbol,
	assemble_external, decode_addr_const, mark_weak,
	default_encode_section_info): Likewise.

2004-07-01  Steven Bosscher  <stevenb@suse.de>

	* stmt.c (check_seenlabel): Remove.
	(pushcase, pushcase_range, expand_end_case_type): Don't call it.

2004-07-01  Richard Henderson  <rth@redhat.com>

	* function.h (struct function): Remove x_function_call_count.
	(function_call_count): Remove.
	* calls.c (expand_call): Don't set it.
	* integrate.c (copy_rtx_and_substitute): Likewise.

	* function.h (struct function): Remove x_cleanup_label.
	(cleanup_label): Remove.
	* stmt.c (expand_value_return): Don't use it.
	* function.c (free_after_compilation): Don't set it.
	(expand_function_start): Likewise.  Remove parms_have_cleanups arg.
	* cfgexpand.c (tree_expand_cfg): Update call.
	* tree.h (expand_function_start): Update decl.

2004-07-01  Joseph S. Myers  <jsm@polyomino.org.uk>

	PR c/1027
	* c-lang.c (c_initialize_diagnostics): Move from here ...
	* c-objc-common.c: ... to here.  Include "c-pretty-print.h".
	(c_tree_printer): Use pretty-printer to format %T.
	* c-pretty-print.c (pp_c_specifier_qualifier_list): Include space
	before '*' if not C++.
	(pp_c_direct_abstract_declarator): Don't try to print array upper
	bound for flexible array members.
	* c-tree.h: Include "diagnostic.h".
	(c_initialize_diagnostics): Declare.
	* objc/objc-lang.c (LANG_HOOKS_INITIALIZE_DIAGNOSTICS): Define.
	* c-format.c (format_type_warning): New function.  Improve
	diagnostics for incorrect format argument types.
	(check_format_types): Use it.  Add two parameters.  Use the
	TYPE_MAIN_VARIANT of wanted_type.
	(check_format_info_main): Pass new parameters to
	check_format_types.
	(struct format_wanted_type): Update comment.

2004-07-01  Nick Clifton  <nickc@redhat.com>

	* target.h (struct gcc_target): Add new field to struct cxx:
	import_export_class.
	* target-def.h (TARGET_CXX): Initialise the new field.
	(TARGET_CXX_IMPORT_EXPORT_CLASS): Provide a default value for
	the new field.
	* doc/tm.texi: Document the new target hook.

2004-07-01  Paolo Bonzini  <bonzini@gnu.org>

	* builtins.c (fold_builtin_classify): Fix typo.

2004-07-01  Richard Henderson  <rth@redhat.com>

	* function.c (identify_blocks, identify_blocks_1): Remove.
	* function.h (identify_blocks): Remove.
	* rtl.h (NOTE_INSN_BLOCK_BEG): Update comment.

2004-07-01  Paolo Bonzini  <bonzini@gnu.org>

	* builtins.c (fold_builtin_classify): New.
	(fold_builtin_unordered_cmp): Fix commentary.
	(fold_builtin): Use it.
	* builtins.def: Define builtins for isnan,
	isnanf, isnanl, finite, finitef, finitel,
	isinf, isinff, isinfl.

2004-07-01  Richard Henderson  <rth@redhat.com>

	* function.h (struct function): Remove dont_emit_block_notes.
	* gimple-low.c (lower_function_body): Don't set it.
	* cfgexpand.c (expand_block): Don't check it.
	* cfglayout.c (insn_locators_initialize): Likewise.
	* expr.c (expand_expr_real, expand_expr_real_1): Likewise.
	* passes.c (rest_of_compilation): Likewise.
	* stmt.c (expand_start_bindings_and_block): Likewise.
	(expand_end_bindings): Likewise.

2004-07-01  Richard Henderson  <rth@redhat.com>

	* cgraph.h (cgraph_build_static_cdtor): Declare.
	* cgraphunit.c (cgraph_build_static_cdtor): New.
	* c-objc-common.c (build_cdtor): Use it.
	* coverage.c (create_coverage): Likewise.
	* libfuncs.h (LTI_gcov_init, gcov_init_libfunc): Remove.
	* optabs.c (init_optabs): Don't set gcov_init_libfunc.

See ChangeLog.11 for earlier changes.
